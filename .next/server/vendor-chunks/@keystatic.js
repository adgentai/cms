"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@keystatic";
exports.ids = ["vendor-chunks/@keystatic"];
exports.modules = {

/***/ "(ssr)/./node_modules/@keystatic/core/dist/api-51d0094d.node.js":
/*!****************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/api-51d0094d.node.js ***!
  \****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ component)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var _index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-360e5820.node.js */ \"(ssr)/./node_modules/@keystatic/core/dist/index-360e5820.node.js\");\n/* harmony import */ var emery__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! emery */ \"(ssr)/./node_modules/emery/dist/emery.esm.js\");\n/* harmony import */ var _braintree_sanitize_url__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @braintree/sanitize-url */ \"(ssr)/./node_modules/@braintree/sanitize-url/dist/index.js\");\n\n\n\n\n\n// this is written like this rather than ArrayField<ComponentSchema> to avoid TypeScript erroring about circularity\nfunction component(options) {\n  return options;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3QvYXBpLTUxZDAwOTRkLm5vZGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMkI7QUFDTztBQUNuQjtBQUNrQjs7QUFFakM7QUFDQTtBQUNBO0FBQ0E7O0FBRTBCIiwic291cmNlcyI6WyIvVXNlcnMvamFtZXMvRG93bmxvYWRzL25ldy1rZXlzdGF0aWMtcHJvamVjdC9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3QvYXBpLTUxZDAwOTRkLm5vZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdyZWFjdC9qc3gtcnVudGltZSc7XG5pbXBvcnQgJy4vaW5kZXgtMzYwZTU4MjAubm9kZS5qcyc7XG5pbXBvcnQgJ2VtZXJ5JztcbmltcG9ydCAnQGJyYWludHJlZS9zYW5pdGl6ZS11cmwnO1xuXG4vLyB0aGlzIGlzIHdyaXR0ZW4gbGlrZSB0aGlzIHJhdGhlciB0aGFuIEFycmF5RmllbGQ8Q29tcG9uZW50U2NoZW1hPiB0byBhdm9pZCBUeXBlU2NyaXB0IGVycm9yaW5nIGFib3V0IGNpcmN1bGFyaXR5XG5mdW5jdGlvbiBjb21wb25lbnQob3B0aW9ucykge1xuICByZXR1cm4gb3B0aW9ucztcbn1cblxuZXhwb3J0IHsgY29tcG9uZW50IGFzIGMgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@keystatic/core/dist/api-51d0094d.node.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@keystatic/core/dist/index-1a9da0fb.node.js":
/*!******************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/index-1a9da0fb.node.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   B: () => (/* binding */ BlocksFieldInput),\n/* harmony export */   C: () => (/* binding */ CheckboxFieldInput),\n/* harmony export */   D: () => (/* binding */ DateFieldInput),\n/* harmony export */   F: () => (/* binding */ FieldDataError),\n/* harmony export */   I: () => (/* binding */ ImageFieldInput),\n/* harmony export */   M: () => (/* binding */ MultiRelationshipInput),\n/* harmony export */   N: () => (/* binding */ NumberFieldInput),\n/* harmony export */   P: () => (/* binding */ PathReferenceInput),\n/* harmony export */   R: () => (/* binding */ RelationshipInput),\n/* harmony export */   S: () => (/* binding */ SelectFieldInput),\n/* harmony export */   U: () => (/* binding */ UrlFieldInput),\n/* harmony export */   a: () => (/* binding */ CloudImageFieldInput),\n/* harmony export */   b: () => (/* binding */ basicFormFieldWithSimpleReaderParse),\n/* harmony export */   c: () => (/* binding */ assertRequired),\n/* harmony export */   d: () => (/* binding */ DatetimeFieldInput),\n/* harmony export */   e: () => (/* binding */ FileFieldInput),\n/* harmony export */   f: () => (/* binding */ MultiselectFieldInput),\n/* harmony export */   g: () => (/* binding */ SlugFieldInput),\n/* harmony export */   h: () => (/* binding */ DocumentFieldInput),\n/* harmony export */   i: () => (/* binding */ serializeMarkdoc),\n/* harmony export */   j: () => (/* binding */ getDefaultValue),\n/* harmony export */   k: () => (/* binding */ serializeFromEditorState),\n/* harmony export */   l: () => (/* binding */ prosemirrorToYXmlFragment),\n/* harmony export */   m: () => (/* binding */ createEditorStateFromYJS),\n/* harmony export */   n: () => (/* binding */ normalizeDocumentFieldChildren),\n/* harmony export */   o: () => (/* binding */ parseToEditorStateMDX),\n/* harmony export */   p: () => (/* binding */ parseToEditorState),\n/* harmony export */   q: () => (/* binding */ serializeFromEditorStateMDX),\n/* harmony export */   r: () => (/* binding */ createEditorSchema),\n/* harmony export */   s: () => (/* binding */ slugify),\n/* harmony export */   t: () => (/* binding */ text),\n/* harmony export */   u: () => (/* binding */ IntegerFieldInput),\n/* harmony export */   v: () => (/* binding */ validateText)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n\n\nclass FieldDataError extends Error {\n  constructor(message) {\n    super(message);\n    this.name = 'FieldDataError';\n  }\n}\n\nfunction assertRequired(value, validation, label) {\n  if (value === null && validation !== null && validation !== void 0 && validation.isRequired) {\n    throw new FieldDataError(`${label} is required`);\n  }\n}\nfunction basicFormFieldWithSimpleReaderParse(config) {\n  return {\n    kind: 'form',\n    Input: config.Input,\n    defaultValue: config.defaultValue,\n    parse: config.parse,\n    serialize: config.serialize,\n    validate: config.validate,\n    reader: {\n      parse(value) {\n        return config.validate(config.parse(value));\n      }\n    },\n    label: config.label\n  };\n}\n\n// this is used in react-server environments to avoid bundling UI when the reader API is used\n// if you added a new field and get an error that there's missing a missing export here,\n// you probably just need to add another empty export here\n\nfunction empty() {\n  throw new Error(\"unexpected call to function that shouldn't be called in React server component environment\");\n}\nlet SlugFieldInput = empty,\n  TextFieldInput = empty,\n  UrlFieldInput = empty,\n  SelectFieldInput = empty,\n  RelationshipInput = empty,\n  PathReferenceInput = empty,\n  MultiselectFieldInput = empty,\n  MultiRelationshipInput = empty,\n  IntegerFieldInput = empty,\n  NumberFieldInput = empty,\n  ImageFieldInput = empty,\n  FileFieldInput = empty,\n  DatetimeFieldInput = empty,\n  DateFieldInput = empty,\n  CloudImageFieldInput = empty,\n  BlocksFieldInput = empty,\n  DocumentFieldInput = empty,\n  CheckboxFieldInput = empty,\n  createEditorSchema = empty,\n  getDefaultValue = empty,\n  parseToEditorState = empty,\n  serializeFromEditorState = empty,\n  parseToEditorStateMDX = empty,\n  serializeFromEditorStateMDX = empty,\n  createEditorStateFromYJS = empty,\n  prosemirrorToYXmlFragment = empty,\n  normalizeDocumentFieldChildren = empty,\n  slugify = empty,\n  serializeMarkdoc = empty;\n\nfunction validateText(val, min, max, fieldLabel, slugInfo, pattern) {\n  if (val.length < min) {\n    if (min === 1) {\n      return `${fieldLabel} must not be empty`;\n    } else {\n      return `${fieldLabel} must be at least ${min} characters long`;\n    }\n  }\n  if (val.length > max) {\n    return `${fieldLabel} must be no longer than ${max} characters`;\n  }\n  if (pattern && !pattern.regex.test(val)) {\n    return pattern.message || `${fieldLabel} must match the pattern ${pattern.regex}`;\n  }\n  if (slugInfo) {\n    if (val === '') {\n      return `${fieldLabel} must not be empty`;\n    }\n    if (val === '..') {\n      return `${fieldLabel} must not be ..`;\n    }\n    if (val === '.') {\n      return `${fieldLabel} must not be .`;\n    }\n    if (slugInfo.glob === '**') {\n      const split = val.split('/');\n      if (split.some(s => s === '..')) {\n        return `${fieldLabel} must not contain ..`;\n      }\n      if (split.some(s => s === '.')) {\n        return `${fieldLabel} must not be .`;\n      }\n    }\n    if ((slugInfo.glob === '*' ? /[\\\\/]/ : /[\\\\]/).test(val)) {\n      return `${fieldLabel} must not contain slashes`;\n    }\n    if (/^\\s|\\s$/.test(val)) {\n      return `${fieldLabel} must not start or end with spaces`;\n    }\n    if (slugInfo.slugs.has(val)) {\n      return `${fieldLabel} must be unique`;\n    }\n  }\n}\n\nfunction parseAsNormalField(value) {\n  if (value === undefined) {\n    return '';\n  }\n  if (typeof value !== 'string') {\n    throw new FieldDataError('Must be a string');\n  }\n  return value;\n}\nconst emptySet = new Set();\nfunction text({\n  label,\n  defaultValue = '',\n  validation: {\n    length: {\n      max = Infinity,\n      min = 0\n    } = {},\n    pattern,\n    isRequired\n  } = {},\n  description,\n  multiline = false\n}) {\n  min = Math.max(isRequired ? 1 : 0, min);\n  function validate(value, slugField) {\n    const message = validateText(value, min, max, label, slugField, pattern);\n    if (message !== undefined) {\n      throw new FieldDataError(message);\n    }\n    return value;\n  }\n  return {\n    kind: 'form',\n    formKind: 'slug',\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(TextFieldInput, {\n        label: label,\n        description: description,\n        min: min,\n        max: max,\n        multiline: multiline,\n        pattern: pattern,\n        ...props\n      });\n    },\n    defaultValue() {\n      return typeof defaultValue === 'string' ? defaultValue : defaultValue();\n    },\n    parse(value, args) {\n      if ((args === null || args === void 0 ? void 0 : args.slug) !== undefined) {\n        return args.slug;\n      }\n      return parseAsNormalField(value);\n    },\n    serialize(value) {\n      return {\n        value: value === '' ? undefined : value\n      };\n    },\n    serializeWithSlug(value) {\n      return {\n        slug: value,\n        value: undefined\n      };\n    },\n    reader: {\n      parse(value) {\n        const parsed = parseAsNormalField(value);\n        return validate(parsed, undefined);\n      },\n      parseWithSlug(_value, args) {\n        validate(parseAsNormalField(args.slug), {\n          glob: args.glob,\n          slugs: emptySet\n        });\n        return null;\n      }\n    },\n    validate(value, args) {\n      return validate(value, args === null || args === void 0 ? void 0 : args.slugField);\n    }\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3QvaW5kZXgtMWE5ZGEwZmIubm9kZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXdDOztBQUV4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdDQUFnQyxPQUFPO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixZQUFZO0FBQzVCLE1BQU07QUFDTixnQkFBZ0IsWUFBWSxtQkFBbUIsS0FBSztBQUNwRDtBQUNBO0FBQ0E7QUFDQSxjQUFjLFlBQVkseUJBQXlCLEtBQUs7QUFDeEQ7QUFDQTtBQUNBLGlDQUFpQyxZQUFZLHlCQUF5QixjQUFjO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixZQUFZO0FBQzVCO0FBQ0E7QUFDQSxnQkFBZ0IsWUFBWTtBQUM1QjtBQUNBO0FBQ0EsZ0JBQWdCLFlBQVk7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsWUFBWTtBQUM5QjtBQUNBO0FBQ0Esa0JBQWtCLFlBQVk7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFlBQVk7QUFDNUI7QUFDQTtBQUNBLGdCQUFnQixZQUFZO0FBQzVCO0FBQ0E7QUFDQSxnQkFBZ0IsWUFBWTtBQUM1QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sSUFBSTtBQUNWO0FBQ0E7QUFDQSxJQUFJLElBQUk7QUFDUjtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHNEQUFHO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWcwQiIsInNvdXJjZXMiOlsiL1VzZXJzL2phbWVzL0Rvd25sb2Fkcy9uZXcta2V5c3RhdGljLXByb2plY3Qvbm9kZV9tb2R1bGVzL0BrZXlzdGF0aWMvY29yZS9kaXN0L2luZGV4LTFhOWRhMGZiLm5vZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsganN4IH0gZnJvbSAncmVhY3QvanN4LXJ1bnRpbWUnO1xuXG5jbGFzcyBGaWVsZERhdGFFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMubmFtZSA9ICdGaWVsZERhdGFFcnJvcic7XG4gIH1cbn1cblxuZnVuY3Rpb24gYXNzZXJ0UmVxdWlyZWQodmFsdWUsIHZhbGlkYXRpb24sIGxhYmVsKSB7XG4gIGlmICh2YWx1ZSA9PT0gbnVsbCAmJiB2YWxpZGF0aW9uICE9PSBudWxsICYmIHZhbGlkYXRpb24gIT09IHZvaWQgMCAmJiB2YWxpZGF0aW9uLmlzUmVxdWlyZWQpIHtcbiAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoYCR7bGFiZWx9IGlzIHJlcXVpcmVkYCk7XG4gIH1cbn1cbmZ1bmN0aW9uIGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlKGNvbmZpZykge1xuICByZXR1cm4ge1xuICAgIGtpbmQ6ICdmb3JtJyxcbiAgICBJbnB1dDogY29uZmlnLklucHV0LFxuICAgIGRlZmF1bHRWYWx1ZTogY29uZmlnLmRlZmF1bHRWYWx1ZSxcbiAgICBwYXJzZTogY29uZmlnLnBhcnNlLFxuICAgIHNlcmlhbGl6ZTogY29uZmlnLnNlcmlhbGl6ZSxcbiAgICB2YWxpZGF0ZTogY29uZmlnLnZhbGlkYXRlLFxuICAgIHJlYWRlcjoge1xuICAgICAgcGFyc2UodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGNvbmZpZy52YWxpZGF0ZShjb25maWcucGFyc2UodmFsdWUpKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGxhYmVsOiBjb25maWcubGFiZWxcbiAgfTtcbn1cblxuLy8gdGhpcyBpcyB1c2VkIGluIHJlYWN0LXNlcnZlciBlbnZpcm9ubWVudHMgdG8gYXZvaWQgYnVuZGxpbmcgVUkgd2hlbiB0aGUgcmVhZGVyIEFQSSBpcyB1c2VkXG4vLyBpZiB5b3UgYWRkZWQgYSBuZXcgZmllbGQgYW5kIGdldCBhbiBlcnJvciB0aGF0IHRoZXJlJ3MgbWlzc2luZyBhIG1pc3NpbmcgZXhwb3J0IGhlcmUsXG4vLyB5b3UgcHJvYmFibHkganVzdCBuZWVkIHRvIGFkZCBhbm90aGVyIGVtcHR5IGV4cG9ydCBoZXJlXG5cbmZ1bmN0aW9uIGVtcHR5KCkge1xuICB0aHJvdyBuZXcgRXJyb3IoXCJ1bmV4cGVjdGVkIGNhbGwgdG8gZnVuY3Rpb24gdGhhdCBzaG91bGRuJ3QgYmUgY2FsbGVkIGluIFJlYWN0IHNlcnZlciBjb21wb25lbnQgZW52aXJvbm1lbnRcIik7XG59XG5sZXQgU2x1Z0ZpZWxkSW5wdXQgPSBlbXB0eSxcbiAgVGV4dEZpZWxkSW5wdXQgPSBlbXB0eSxcbiAgVXJsRmllbGRJbnB1dCA9IGVtcHR5LFxuICBTZWxlY3RGaWVsZElucHV0ID0gZW1wdHksXG4gIFJlbGF0aW9uc2hpcElucHV0ID0gZW1wdHksXG4gIFBhdGhSZWZlcmVuY2VJbnB1dCA9IGVtcHR5LFxuICBNdWx0aXNlbGVjdEZpZWxkSW5wdXQgPSBlbXB0eSxcbiAgTXVsdGlSZWxhdGlvbnNoaXBJbnB1dCA9IGVtcHR5LFxuICBJbnRlZ2VyRmllbGRJbnB1dCA9IGVtcHR5LFxuICBOdW1iZXJGaWVsZElucHV0ID0gZW1wdHksXG4gIEltYWdlRmllbGRJbnB1dCA9IGVtcHR5LFxuICBGaWxlRmllbGRJbnB1dCA9IGVtcHR5LFxuICBEYXRldGltZUZpZWxkSW5wdXQgPSBlbXB0eSxcbiAgRGF0ZUZpZWxkSW5wdXQgPSBlbXB0eSxcbiAgQ2xvdWRJbWFnZUZpZWxkSW5wdXQgPSBlbXB0eSxcbiAgQmxvY2tzRmllbGRJbnB1dCA9IGVtcHR5LFxuICBEb2N1bWVudEZpZWxkSW5wdXQgPSBlbXB0eSxcbiAgQ2hlY2tib3hGaWVsZElucHV0ID0gZW1wdHksXG4gIGNyZWF0ZUVkaXRvclNjaGVtYSA9IGVtcHR5LFxuICBnZXREZWZhdWx0VmFsdWUgPSBlbXB0eSxcbiAgcGFyc2VUb0VkaXRvclN0YXRlID0gZW1wdHksXG4gIHNlcmlhbGl6ZUZyb21FZGl0b3JTdGF0ZSA9IGVtcHR5LFxuICBwYXJzZVRvRWRpdG9yU3RhdGVNRFggPSBlbXB0eSxcbiAgc2VyaWFsaXplRnJvbUVkaXRvclN0YXRlTURYID0gZW1wdHksXG4gIGNyZWF0ZUVkaXRvclN0YXRlRnJvbVlKUyA9IGVtcHR5LFxuICBwcm9zZW1pcnJvclRvWVhtbEZyYWdtZW50ID0gZW1wdHksXG4gIG5vcm1hbGl6ZURvY3VtZW50RmllbGRDaGlsZHJlbiA9IGVtcHR5LFxuICBzbHVnaWZ5ID0gZW1wdHksXG4gIHNlcmlhbGl6ZU1hcmtkb2MgPSBlbXB0eTtcblxuZnVuY3Rpb24gdmFsaWRhdGVUZXh0KHZhbCwgbWluLCBtYXgsIGZpZWxkTGFiZWwsIHNsdWdJbmZvLCBwYXR0ZXJuKSB7XG4gIGlmICh2YWwubGVuZ3RoIDwgbWluKSB7XG4gICAgaWYgKG1pbiA9PT0gMSkge1xuICAgICAgcmV0dXJuIGAke2ZpZWxkTGFiZWx9IG11c3Qgbm90IGJlIGVtcHR5YDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGAke2ZpZWxkTGFiZWx9IG11c3QgYmUgYXQgbGVhc3QgJHttaW59IGNoYXJhY3RlcnMgbG9uZ2A7XG4gICAgfVxuICB9XG4gIGlmICh2YWwubGVuZ3RoID4gbWF4KSB7XG4gICAgcmV0dXJuIGAke2ZpZWxkTGFiZWx9IG11c3QgYmUgbm8gbG9uZ2VyIHRoYW4gJHttYXh9IGNoYXJhY3RlcnNgO1xuICB9XG4gIGlmIChwYXR0ZXJuICYmICFwYXR0ZXJuLnJlZ2V4LnRlc3QodmFsKSkge1xuICAgIHJldHVybiBwYXR0ZXJuLm1lc3NhZ2UgfHwgYCR7ZmllbGRMYWJlbH0gbXVzdCBtYXRjaCB0aGUgcGF0dGVybiAke3BhdHRlcm4ucmVnZXh9YDtcbiAgfVxuICBpZiAoc2x1Z0luZm8pIHtcbiAgICBpZiAodmFsID09PSAnJykge1xuICAgICAgcmV0dXJuIGAke2ZpZWxkTGFiZWx9IG11c3Qgbm90IGJlIGVtcHR5YDtcbiAgICB9XG4gICAgaWYgKHZhbCA9PT0gJy4uJykge1xuICAgICAgcmV0dXJuIGAke2ZpZWxkTGFiZWx9IG11c3Qgbm90IGJlIC4uYDtcbiAgICB9XG4gICAgaWYgKHZhbCA9PT0gJy4nKSB7XG4gICAgICByZXR1cm4gYCR7ZmllbGRMYWJlbH0gbXVzdCBub3QgYmUgLmA7XG4gICAgfVxuICAgIGlmIChzbHVnSW5mby5nbG9iID09PSAnKionKSB7XG4gICAgICBjb25zdCBzcGxpdCA9IHZhbC5zcGxpdCgnLycpO1xuICAgICAgaWYgKHNwbGl0LnNvbWUocyA9PiBzID09PSAnLi4nKSkge1xuICAgICAgICByZXR1cm4gYCR7ZmllbGRMYWJlbH0gbXVzdCBub3QgY29udGFpbiAuLmA7XG4gICAgICB9XG4gICAgICBpZiAoc3BsaXQuc29tZShzID0+IHMgPT09ICcuJykpIHtcbiAgICAgICAgcmV0dXJuIGAke2ZpZWxkTGFiZWx9IG11c3Qgbm90IGJlIC5gO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoKHNsdWdJbmZvLmdsb2IgPT09ICcqJyA/IC9bXFxcXC9dLyA6IC9bXFxcXF0vKS50ZXN0KHZhbCkpIHtcbiAgICAgIHJldHVybiBgJHtmaWVsZExhYmVsfSBtdXN0IG5vdCBjb250YWluIHNsYXNoZXNgO1xuICAgIH1cbiAgICBpZiAoL15cXHN8XFxzJC8udGVzdCh2YWwpKSB7XG4gICAgICByZXR1cm4gYCR7ZmllbGRMYWJlbH0gbXVzdCBub3Qgc3RhcnQgb3IgZW5kIHdpdGggc3BhY2VzYDtcbiAgICB9XG4gICAgaWYgKHNsdWdJbmZvLnNsdWdzLmhhcyh2YWwpKSB7XG4gICAgICByZXR1cm4gYCR7ZmllbGRMYWJlbH0gbXVzdCBiZSB1bmlxdWVgO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBwYXJzZUFzTm9ybWFsRmllbGQodmFsdWUpIHtcbiAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYSBzdHJpbmcnKTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5jb25zdCBlbXB0eVNldCA9IG5ldyBTZXQoKTtcbmZ1bmN0aW9uIHRleHQoe1xuICBsYWJlbCxcbiAgZGVmYXVsdFZhbHVlID0gJycsXG4gIHZhbGlkYXRpb246IHtcbiAgICBsZW5ndGg6IHtcbiAgICAgIG1heCA9IEluZmluaXR5LFxuICAgICAgbWluID0gMFxuICAgIH0gPSB7fSxcbiAgICBwYXR0ZXJuLFxuICAgIGlzUmVxdWlyZWRcbiAgfSA9IHt9LFxuICBkZXNjcmlwdGlvbixcbiAgbXVsdGlsaW5lID0gZmFsc2Vcbn0pIHtcbiAgbWluID0gTWF0aC5tYXgoaXNSZXF1aXJlZCA/IDEgOiAwLCBtaW4pO1xuICBmdW5jdGlvbiB2YWxpZGF0ZSh2YWx1ZSwgc2x1Z0ZpZWxkKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IHZhbGlkYXRlVGV4dCh2YWx1ZSwgbWluLCBtYXgsIGxhYmVsLCBzbHVnRmllbGQsIHBhdHRlcm4pO1xuICAgIGlmIChtZXNzYWdlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcihtZXNzYWdlKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIHJldHVybiB7XG4gICAga2luZDogJ2Zvcm0nLFxuICAgIGZvcm1LaW5kOiAnc2x1ZycsXG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KFRleHRGaWVsZElucHV0LCB7XG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICBtaW46IG1pbixcbiAgICAgICAgbWF4OiBtYXgsXG4gICAgICAgIG11bHRpbGluZTogbXVsdGlsaW5lLFxuICAgICAgICBwYXR0ZXJuOiBwYXR0ZXJuLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gdHlwZW9mIGRlZmF1bHRWYWx1ZSA9PT0gJ3N0cmluZycgPyBkZWZhdWx0VmFsdWUgOiBkZWZhdWx0VmFsdWUoKTtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlLCBhcmdzKSB7XG4gICAgICBpZiAoKGFyZ3MgPT09IG51bGwgfHwgYXJncyA9PT0gdm9pZCAwID8gdm9pZCAwIDogYXJncy5zbHVnKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBhcmdzLnNsdWc7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGFyc2VBc05vcm1hbEZpZWxkKHZhbHVlKTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHZhbHVlID09PSAnJyA/IHVuZGVmaW5lZCA6IHZhbHVlXG4gICAgICB9O1xuICAgIH0sXG4gICAgc2VyaWFsaXplV2l0aFNsdWcodmFsdWUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHNsdWc6IHZhbHVlLFxuICAgICAgICB2YWx1ZTogdW5kZWZpbmVkXG4gICAgICB9O1xuICAgIH0sXG4gICAgcmVhZGVyOiB7XG4gICAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgICBjb25zdCBwYXJzZWQgPSBwYXJzZUFzTm9ybWFsRmllbGQodmFsdWUpO1xuICAgICAgICByZXR1cm4gdmFsaWRhdGUocGFyc2VkLCB1bmRlZmluZWQpO1xuICAgICAgfSxcbiAgICAgIHBhcnNlV2l0aFNsdWcoX3ZhbHVlLCBhcmdzKSB7XG4gICAgICAgIHZhbGlkYXRlKHBhcnNlQXNOb3JtYWxGaWVsZChhcmdzLnNsdWcpLCB7XG4gICAgICAgICAgZ2xvYjogYXJncy5nbG9iLFxuICAgICAgICAgIHNsdWdzOiBlbXB0eVNldFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSwgYXJncykge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlKHZhbHVlLCBhcmdzID09PSBudWxsIHx8IGFyZ3MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFyZ3Muc2x1Z0ZpZWxkKTtcbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCB7IEJsb2Nrc0ZpZWxkSW5wdXQgYXMgQiwgQ2hlY2tib3hGaWVsZElucHV0IGFzIEMsIERhdGVGaWVsZElucHV0IGFzIEQsIEZpZWxkRGF0YUVycm9yIGFzIEYsIEltYWdlRmllbGRJbnB1dCBhcyBJLCBNdWx0aVJlbGF0aW9uc2hpcElucHV0IGFzIE0sIE51bWJlckZpZWxkSW5wdXQgYXMgTiwgUGF0aFJlZmVyZW5jZUlucHV0IGFzIFAsIFJlbGF0aW9uc2hpcElucHV0IGFzIFIsIFNlbGVjdEZpZWxkSW5wdXQgYXMgUywgVXJsRmllbGRJbnB1dCBhcyBVLCBDbG91ZEltYWdlRmllbGRJbnB1dCBhcyBhLCBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSBhcyBiLCBhc3NlcnRSZXF1aXJlZCBhcyBjLCBEYXRldGltZUZpZWxkSW5wdXQgYXMgZCwgRmlsZUZpZWxkSW5wdXQgYXMgZSwgTXVsdGlzZWxlY3RGaWVsZElucHV0IGFzIGYsIFNsdWdGaWVsZElucHV0IGFzIGcsIERvY3VtZW50RmllbGRJbnB1dCBhcyBoLCBzZXJpYWxpemVNYXJrZG9jIGFzIGksIGdldERlZmF1bHRWYWx1ZSBhcyBqLCBzZXJpYWxpemVGcm9tRWRpdG9yU3RhdGUgYXMgaywgcHJvc2VtaXJyb3JUb1lYbWxGcmFnbWVudCBhcyBsLCBjcmVhdGVFZGl0b3JTdGF0ZUZyb21ZSlMgYXMgbSwgbm9ybWFsaXplRG9jdW1lbnRGaWVsZENoaWxkcmVuIGFzIG4sIHBhcnNlVG9FZGl0b3JTdGF0ZU1EWCBhcyBvLCBwYXJzZVRvRWRpdG9yU3RhdGUgYXMgcCwgc2VyaWFsaXplRnJvbUVkaXRvclN0YXRlTURYIGFzIHEsIGNyZWF0ZUVkaXRvclNjaGVtYSBhcyByLCBzbHVnaWZ5IGFzIHMsIHRleHQgYXMgdCwgSW50ZWdlckZpZWxkSW5wdXQgYXMgdSwgdmFsaWRhdGVUZXh0IGFzIHYgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@keystatic/core/dist/index-1a9da0fb.node.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@keystatic/core/dist/index-360e5820.node.js":
/*!******************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/index-360e5820.node.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ markdoc),\n/* harmony export */   b: () => (/* binding */ getDirectoriesForTreeKey),\n/* harmony export */   c: () => (/* binding */ getCollectionPath),\n/* harmony export */   d: () => (/* binding */ document),\n/* harmony export */   e: () => (/* binding */ getSingletonFormat),\n/* harmony export */   f: () => (/* binding */ fixPath),\n/* harmony export */   g: () => (/* binding */ getSrcPrefix),\n/* harmony export */   h: () => (/* binding */ getSingletonPath),\n/* harmony export */   i: () => (/* binding */ blobSha),\n/* harmony export */   j: () => (/* binding */ getCollectionFormat),\n/* harmony export */   k: () => (/* binding */ getSlugGlobForCollection),\n/* harmony export */   l: () => (/* binding */ getDataFileExtension),\n/* harmony export */   m: () => (/* binding */ mdx),\n/* harmony export */   n: () => (/* binding */ getCollectionItemPath),\n/* harmony export */   o: () => (/* binding */ object),\n/* harmony export */   p: () => (/* binding */ getEntryDataFilepath),\n/* harmony export */   q: () => (/* binding */ getValueAtPropPath),\n/* harmony export */   r: () => (/* binding */ getTreeNodeAtPath),\n/* harmony export */   t: () => (/* binding */ treeEntriesToTreeNodes),\n/* harmony export */   u: () => (/* binding */ updateTreeWithChanges)\n/* harmony export */ });\n/* harmony import */ var _markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @markdoc/markdoc/dist/index.mjs */ \"(ssr)/./node_modules/@markdoc/markdoc/dist/index.mjs\");\n/* harmony import */ var emery_assertions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! emery/assertions */ \"(ssr)/./node_modules/emery/assertions/dist/emery-assertions.esm.js\");\n/* harmony import */ var emery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! emery */ \"(ssr)/./node_modules/emery/dist/emery.esm.js\");\n/* harmony import */ var _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./index-1a9da0fb.node.js */ \"(ssr)/./node_modules/@keystatic/core/dist/index-1a9da0fb.node.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! crypto */ \"crypto\");\n\n\n\n\n\n\n\nfunction object(fields, opts) {\n  return {\n    ...opts,\n    kind: 'object',\n    fields\n  };\n}\n\nfunction getValueAtPropPath(value, inputPath) {\n  const path = [...inputPath];\n  while (path.length) {\n    const key = path.shift();\n    value = value[key];\n  }\n  return value;\n}\nfunction transformProps(schema, value, visitors, path = []) {\n  if (schema.kind === 'form' || schema.kind === 'child') {\n    if (visitors[schema.kind]) {\n      return visitors[schema.kind](schema, value, path);\n    }\n    return value;\n  }\n  if (schema.kind === 'object') {\n    const val = Object.fromEntries(Object.entries(schema.fields).map(([key, val]) => {\n      return [key, transformProps(val, value[key], visitors, [...path, key])];\n    }));\n    if (visitors.object) {\n      return visitors[schema.kind](schema, val, path);\n    }\n    return val;\n  }\n  if (schema.kind === 'array') {\n    const val = value.map((val, idx) => transformProps(schema.element, val, visitors, path.concat(idx)));\n    if (visitors.array) {\n      return visitors[schema.kind](schema, val, path);\n    }\n    return val;\n  }\n  if (schema.kind === 'conditional') {\n    const discriminant = transformProps(schema.discriminant, value.discriminant, visitors, path.concat('discriminant'));\n    const conditionalVal = transformProps(schema.values[discriminant.toString()], value.value, visitors, path.concat('value'));\n    const val = {\n      discriminant,\n      value: conditionalVal\n    };\n    if (visitors.conditional) {\n      return visitors[schema.kind](schema, val, path);\n    }\n    return val;\n  }\n  (0,emery_assertions__WEBPACK_IMPORTED_MODULE_0__.assertNever)(schema);\n}\n\n// a v important note\n// marks in the markdown ast/html are represented quite differently to how they are in slate\n// if you had the markdown **something https://keystonejs.com something**\n// the bold node is the parent of the link node\n// but in slate, marks are only represented on text nodes\n\nconst currentlyActiveMarks = new Set();\nconst currentlyDisabledMarks = new Set();\nlet currentLink = null;\nfunction addMarkToChildren(mark, cb) {\n  const wasPreviouslyActive = currentlyActiveMarks.has(mark);\n  currentlyActiveMarks.add(mark);\n  try {\n    return cb();\n  } finally {\n    if (!wasPreviouslyActive) {\n      currentlyActiveMarks.delete(mark);\n    }\n  }\n}\nfunction setLinkForChildren(href, cb) {\n  // we'll only use the outer link\n  if (currentLink !== null) {\n    return cb();\n  }\n  currentLink = href;\n  try {\n    return cb();\n  } finally {\n    currentLink = null;\n  }\n}\n\n/**\n * This type is more strict than `Element & { type: 'link'; }` because `children`\n * is constrained to only contain Text nodes. This can't be assumed generally around the editor\n * (because of potentially future inline components or nested links(which are normalized away but the editor needs to not break if it happens))\n * but where this type is used, we're only going to allow links to contain Text and that's important\n * so that we know a block will never be inside an inline because Slate gets unhappy when that happens\n * (really the link inline should probably be a mark rather than an inline,\n * non-void inlines are probably always bad but that would imply changing the document\n * structure which would be such unnecessary breakage)\n */\n\nfunction getInlineNodes(text) {\n  const node = {\n    text\n  };\n  for (const mark of currentlyActiveMarks) {\n    if (!currentlyDisabledMarks.has(mark)) {\n      node[mark] = true;\n    }\n  }\n  if (currentLink !== null) {\n    return [{\n      text: ''\n    }, {\n      type: 'link',\n      href: currentLink,\n      children: [node]\n    }, {\n      text: ''\n    }];\n  }\n  return [node];\n}\n\nclass VariableChildFields extends Error {\n  constructor() {\n    super('There are a variable number of child fields');\n  }\n}\nfunction findSingleChildField(schema) {\n  try {\n    const result = _findConstantChildFields(schema, [], new Set());\n    if (result.length === 1) {\n      return result[0];\n    }\n    return;\n  } catch (err) {\n    if (err instanceof VariableChildFields) {\n      return;\n    }\n    throw err;\n  }\n}\nfunction _findConstantChildFields(schema, path, seenSchemas) {\n  if (seenSchemas.has(schema)) {\n    return [];\n  }\n  seenSchemas.add(schema);\n  switch (schema.kind) {\n    case 'form':\n      return [];\n    case 'child':\n      return [{\n        relativePath: path,\n        options: schema.options,\n        kind: 'child'\n      }];\n    case 'conditional':\n      {\n        if (couldContainChildField(schema)) {\n          throw new VariableChildFields();\n        }\n        return [];\n      }\n    case 'array':\n      {\n        if (schema.asChildTag) {\n          const child = _findConstantChildFields(schema.element, [], seenSchemas);\n          if (child.length > 1) {\n            return [];\n          }\n          return [{\n            kind: 'array',\n            asChildTag: schema.asChildTag,\n            field: schema,\n            relativePath: path,\n            child: child[0]\n          }];\n        }\n        if (couldContainChildField(schema)) {\n          throw new VariableChildFields();\n        }\n        return [];\n      }\n    case 'object':\n      {\n        const paths = [];\n        for (const [key, value] of Object.entries(schema.fields)) {\n          paths.push(..._findConstantChildFields(value, path.concat(key), seenSchemas));\n        }\n        return paths;\n      }\n  }\n}\nfunction couldContainChildField(schema, seen = new Set()) {\n  if (seen.has(schema)) {\n    return false;\n  }\n  seen.add(schema);\n  switch (schema.kind) {\n    case 'form':\n      return false;\n    case 'child':\n      return true;\n    case 'conditional':\n      return Object.values(schema.values).some(value => couldContainChildField(value, seen));\n    case 'object':\n      return Object.keys(schema.fields).some(key => couldContainChildField(schema.fields[key], seen));\n    case 'array':\n      return couldContainChildField(schema.element, seen);\n  }\n}\n\nfunction inlineNodeFromMarkdoc(node) {\n  if (node.type === 'inline') {\n    return inlineChildrenFromMarkdoc(node.children);\n  }\n  if (node.type === 'link') {\n    return setLinkForChildren(node.attributes.href, () => inlineChildrenFromMarkdoc(node.children));\n  }\n  if (node.type === 'text') {\n    return getInlineNodes(node.attributes.content);\n  }\n  if (node.type === 'strong') {\n    return addMarkToChildren('bold', () => inlineChildrenFromMarkdoc(node.children));\n  }\n  if (node.type === 'code') {\n    return addMarkToChildren('code', () => getInlineNodes(node.attributes.content));\n  }\n  if (node.type === 'em') {\n    return addMarkToChildren('italic', () => inlineChildrenFromMarkdoc(node.children));\n  }\n  if (node.type === 's') {\n    return addMarkToChildren('strikethrough', () => inlineChildrenFromMarkdoc(node.children));\n  }\n  if (node.type === 'tag') {\n    if (node.tag === 'u') {\n      return addMarkToChildren('underline', () => inlineChildrenFromMarkdoc(node.children));\n    }\n    if (node.tag === 'kbd') {\n      return addMarkToChildren('keyboard', () => inlineChildrenFromMarkdoc(node.children));\n    }\n    if (node.tag === 'sub') {\n      return addMarkToChildren('subscript', () => inlineChildrenFromMarkdoc(node.children));\n    }\n    if (node.tag === 'sup') {\n      return addMarkToChildren('superscript', () => inlineChildrenFromMarkdoc(node.children));\n    }\n  }\n  if (node.type === 'softbreak') {\n    return getInlineNodes(' ');\n  }\n  if (node.type === 'hardbreak') {\n    return getInlineNodes('\\n');\n  }\n  if (node.tag === 'component-inline-prop' && Array.isArray(node.attributes.propPath) && node.attributes.propPath.every(x => typeof x === 'string' || typeof x === 'number')) {\n    return {\n      type: 'component-inline-prop',\n      children: inlineFromMarkdoc(node.children),\n      propPath: node.attributes.propPath\n    };\n  }\n  throw new Error(`Unknown inline node type: ${node.type}`);\n}\nfunction inlineChildrenFromMarkdoc(nodes) {\n  return nodes.flatMap(inlineNodeFromMarkdoc);\n}\nfunction inlineFromMarkdoc(nodes) {\n  const transformedNodes = nodes.flatMap(inlineNodeFromMarkdoc);\n  const nextNodes = [];\n  let lastNode;\n  for (const [idx, node] of transformedNodes.entries()) {\n    var _lastNode;\n    if (node.type === undefined && node.text === '' && ((_lastNode = lastNode) === null || _lastNode === void 0 ? void 0 : _lastNode.type) === undefined && idx !== transformedNodes.length - 1) {\n      continue;\n    }\n    nextNodes.push(node);\n    lastNode = node;\n  }\n  if (!nextNodes.length) {\n    nextNodes.push({\n      text: ''\n    });\n  }\n  return nextNodes;\n}\nfunction fromMarkdoc(node, componentBlocks) {\n  const nodes = node.children.flatMap(x => fromMarkdocNode(x, componentBlocks));\n  if (nodes.length === 0) {\n    return [{\n      type: 'paragraph',\n      children: [{\n        text: ''\n      }]\n    }];\n  }\n  if (nodes[nodes.length - 1].type !== 'paragraph') {\n    nodes.push({\n      type: 'paragraph',\n      children: [{\n        text: ''\n      }]\n    });\n  }\n  return nodes;\n}\nfunction fromMarkdocNode(node, componentBlocks) {\n  if (node.type === 'blockquote') {\n    return {\n      type: 'blockquote',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'fence') {\n    const {\n      language,\n      content,\n      ...rest\n    } = node.attributes;\n    return {\n      type: 'code',\n      children: [{\n        text: content.replace(/\\n$/, '')\n      }],\n      ...(typeof language === 'string' ? {\n        language\n      } : {}),\n      ...rest\n    };\n  }\n  if (node.type === 'heading') {\n    return {\n      ...node.attributes,\n      level: node.attributes.level,\n      type: 'heading',\n      children: inlineFromMarkdoc(node.children)\n    };\n  }\n  if (node.type === 'list') {\n    return {\n      type: node.attributes.ordered ? 'ordered-list' : 'unordered-list',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'item') {\n    var _node$children$;\n    const children = [{\n      type: 'list-item-content',\n      children: node.children.length ? inlineFromMarkdoc([node.children[0]]) : [{\n        text: ''\n      }]\n    }];\n    if (((_node$children$ = node.children[1]) === null || _node$children$ === void 0 ? void 0 : _node$children$.type) === 'list') {\n      const list = node.children[1];\n      children.push({\n        type: list.attributes.ordered ? 'ordered-list' : 'unordered-list',\n        children: list.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n      });\n    }\n    return {\n      type: 'list-item',\n      children\n    };\n  }\n  if (node.type === 'paragraph') {\n    if (node.children.length === 1 && node.children[0].type === 'inline' && node.children[0].children.length === 1 && node.children[0].children[0].type === 'image') {\n      var _image$attributes$tit;\n      const image = node.children[0].children[0];\n      return {\n        type: 'image',\n        src: decodeURI(image.attributes.src),\n        alt: image.attributes.alt,\n        title: (_image$attributes$tit = image.attributes.title) !== null && _image$attributes$tit !== void 0 ? _image$attributes$tit : '',\n        children: [{\n          text: ''\n        }]\n      };\n    }\n    const children = inlineFromMarkdoc(node.children);\n    if (children.length === 1 && children[0].type === 'component-inline-prop') {\n      return children[0];\n    }\n    return {\n      type: 'paragraph',\n      children,\n      textAlign: node.attributes.textAlign\n    };\n  }\n  if (node.type === 'hr') {\n    return {\n      type: 'divider',\n      children: [{\n        text: ''\n      }]\n    };\n  }\n  if (node.type === 'table') {\n    return {\n      type: 'table',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'tbody') {\n    return {\n      type: 'table-body',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'thead') {\n    if (!node.children.length) return [];\n    return {\n      type: 'table-head',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'tr') {\n    return {\n      type: 'table-row',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'td') {\n    return {\n      type: 'table-cell',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'th') {\n    return {\n      type: 'table-cell',\n      header: true,\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'tag') {\n    if (node.tag === 'table') {\n      return fromMarkdocNode(node.children[0], componentBlocks);\n    }\n    if (node.tag === 'layout') {\n      return {\n        type: 'layout',\n        layout: node.attributes.layout,\n        children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n      };\n    }\n    if (node.tag === 'layout-area') {\n      return {\n        type: 'layout-area',\n        children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n      };\n    }\n    if (node.tag === 'component-block') {\n      return {\n        type: 'component-block',\n        component: node.attributes.component,\n        props: node.attributes.props,\n        children: node.children.length === 0 ? [{\n          type: 'component-inline-prop',\n          children: [{\n            text: ''\n          }]\n        }] : node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n      };\n    }\n    if (node.tag === 'component-block-prop' && Array.isArray(node.attributes.propPath) && node.attributes.propPath.every(x => typeof x === 'string' || typeof x === 'number')) {\n      return {\n        type: 'component-block-prop',\n        children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks)),\n        propPath: node.attributes.propPath\n      };\n    }\n    if (node.tag) {\n      const componentBlock = componentBlocks[node.tag];\n      if (componentBlock) {\n        const singleChildField = findSingleChildField({\n          kind: 'object',\n          fields: componentBlock.schema\n        });\n        if (singleChildField) {\n          const newAttributes = JSON.parse(JSON.stringify(node.attributes));\n          const children = [];\n          toChildrenAndProps(node.children, children, newAttributes, singleChildField, [], componentBlocks);\n          return {\n            type: 'component-block',\n            component: node.tag,\n            props: newAttributes,\n            children\n          };\n        }\n        return {\n          type: 'component-block',\n          component: node.tag,\n          props: node.attributes,\n          children: node.children.length === 0 ? [{\n            type: 'component-inline-prop',\n            children: [{\n              text: ''\n            }]\n          }] : node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n        };\n      }\n    }\n    throw new Error(`Unknown tag: ${node.tag}`);\n  }\n  return inlineNodeFromMarkdoc(node);\n}\nfunction toChildrenAndProps(fromMarkdoc, resultingChildren, value, singleChildField, parentPropPath, componentBlocks) {\n  if (singleChildField.kind === 'child') {\n    const children = fromMarkdoc.flatMap(x => fromMarkdocNode(x, componentBlocks));\n    resultingChildren.push({\n      type: `component-${singleChildField.options.kind}-prop`,\n      propPath: [...parentPropPath, ...singleChildField.relativePath],\n      children\n    });\n  }\n  if (singleChildField.kind === 'array') {\n    const arr = [];\n    for (let [idx, child] of fromMarkdoc.entries()) {\n      if (child.type === 'paragraph') {\n        child = child.children[0].children[0];\n      }\n      if (child.type !== 'tag') {\n        throw new Error(`expected tag ${singleChildField.asChildTag}, found type: ${child.type}`);\n      }\n      if (child.tag !== singleChildField.asChildTag) {\n        throw new Error(`expected tag ${singleChildField.asChildTag}, found tag: ${child.tag}`);\n      }\n      const attributes = JSON.parse(JSON.stringify(child.attributes));\n      if (singleChildField.child) {\n        toChildrenAndProps(child.children, resultingChildren, attributes, singleChildField.child, [...parentPropPath, ...singleChildField.relativePath, idx], componentBlocks);\n      }\n      arr.push(attributes);\n    }\n    const key = singleChildField.relativePath[singleChildField.relativePath.length - 1];\n    const parent = getValueAtPropPath(value, singleChildField.relativePath.slice(0, -1));\n    parent[key] = arr;\n  }\n}\n\n// these are intentionally more restrictive than the types allowed by strong and weak maps\n\nconst emptyCacheNode = Symbol('emptyCacheNode');\n\n// weak keys should always come before strong keys in the arguments though that cannot be enforced with types\nfunction memoize(func) {\n  const cacheNode = {\n    value: emptyCacheNode,\n    strong: undefined,\n    weak: undefined\n  };\n  return (...args) => {\n    let currentCacheNode = cacheNode;\n    for (const arg of args) {\n      if (typeof arg === 'string' || typeof arg === 'number') {\n        if (currentCacheNode.strong === undefined) {\n          currentCacheNode.strong = new Map();\n        }\n        if (!currentCacheNode.strong.has(arg)) {\n          currentCacheNode.strong.set(arg, {\n            value: emptyCacheNode,\n            strong: undefined,\n            weak: undefined\n          });\n        }\n        currentCacheNode = currentCacheNode.strong.get(arg);\n        continue;\n      }\n      if (typeof arg === 'object') {\n        if (currentCacheNode.weak === undefined) {\n          currentCacheNode.weak = new WeakMap();\n        }\n        if (!currentCacheNode.weak.has(arg)) {\n          currentCacheNode.weak.set(arg, {\n            value: emptyCacheNode,\n            strong: undefined,\n            weak: undefined\n          });\n        }\n        currentCacheNode = currentCacheNode.weak.get(arg);\n        continue;\n      }\n    }\n    if (currentCacheNode.value !== emptyCacheNode) {\n      return currentCacheNode.value;\n    }\n    const result = func(...args);\n    currentCacheNode.value = result;\n    return result;\n  };\n}\n\nfunction fixPath(path) {\n  return path.replace(/^\\.?\\/+/, '').replace(/\\/*$/, '');\n}\nconst collectionPath = /\\/\\*\\*?(?:$|\\/)/;\nfunction getConfiguredCollectionPath(config, collection) {\n  var _collectionConfig$pat;\n  const collectionConfig = config.collections[collection];\n  const path = (_collectionConfig$pat = collectionConfig.path) !== null && _collectionConfig$pat !== void 0 ? _collectionConfig$pat : `${collection}/*/`;\n  if (!collectionPath.test(path)) {\n    throw new Error(`Collection path must end with /* or /** or include /*/ or /**/ but ${collection} has ${path}`);\n  }\n  return path;\n}\nfunction getCollectionPath(config, collection) {\n  const configuredPath = getConfiguredCollectionPath(config, collection);\n  const path = fixPath(configuredPath.replace(/\\*\\*?.*$/, ''));\n  return path;\n}\nfunction getCollectionFormat(config, collection) {\n  return getFormatInfo(config, 'collections', collection);\n}\nfunction getSingletonFormat(config, singleton) {\n  return getFormatInfo(config, 'singletons', singleton);\n}\nfunction getCollectionItemPath(config, collection, slug) {\n  const basePath = getCollectionPath(config, collection);\n  const suffix = getCollectionItemSlugSuffix(config, collection);\n  return `${basePath}/${slug}${suffix}`;\n}\nfunction getEntryDataFilepath(dir, formatInfo) {\n  return `${dir}${formatInfo.dataLocation === 'index' ? '/index' : ''}${getDataFileExtension(formatInfo)}`;\n}\nfunction getSlugGlobForCollection(config, collection) {\n  const collectionPath = getConfiguredCollectionPath(config, collection);\n  return collectionPath.includes('**') ? '**' : '*';\n}\nfunction getCollectionItemSlugSuffix(config, collection) {\n  const configuredPath = getConfiguredCollectionPath(config, collection);\n  const path = fixPath(configuredPath.replace(/^[^*]+\\*\\*?/, ''));\n  return path ? `/${path}` : '';\n}\nfunction getSingletonPath(config, singleton) {\n  var _singleton$path, _singleton$path2;\n  if ((_singleton$path = config.singletons[singleton].path) !== null && _singleton$path !== void 0 && _singleton$path.includes('*')) {\n    throw new Error(`Singleton paths cannot include * but ${singleton} has ${config.singletons[singleton].path}`);\n  }\n  return fixPath((_singleton$path2 = config.singletons[singleton].path) !== null && _singleton$path2 !== void 0 ? _singleton$path2 : singleton);\n}\nfunction getDataFileExtension(formatInfo) {\n  return formatInfo.contentField ? formatInfo.contentField.contentExtension : '.' + formatInfo.data;\n}\nconst getFormatInfo = memoize(_getFormatInfo);\nfunction _getFormatInfo(config, type, key) {\n  var _collectionOrSingleto, _format$data;\n  const collectionOrSingleton = type === 'collections' ? config.collections[key] : config.singletons[key];\n  const path = type === 'collections' ? getConfiguredCollectionPath(config, key) : (_collectionOrSingleto = collectionOrSingleton.path) !== null && _collectionOrSingleto !== void 0 ? _collectionOrSingleto : `${key}/`;\n  const dataLocation = path.endsWith('/') ? 'index' : 'outer';\n  const {\n    schema,\n    format = 'yaml'\n  } = collectionOrSingleton;\n  if (typeof format === 'string') {\n    return {\n      dataLocation,\n      contentField: undefined,\n      data: format\n    };\n  }\n  let contentField;\n  if (format.contentField) {\n    let field = {\n      kind: 'object',\n      fields: schema\n    };\n    let path = Array.isArray(format.contentField) ? format.contentField : [format.contentField];\n    let contentExtension;\n    try {\n      contentExtension = getContentExtension(path, field, () => JSON.stringify(format.contentField));\n    } catch (err) {\n      if (err instanceof ContentFieldLocationError) {\n        throw new Error(`${err.message} (${type}.${key})`);\n      }\n      throw err;\n    }\n    contentField = {\n      path,\n      contentExtension\n    };\n  }\n  return {\n    data: (_format$data = format.data) !== null && _format$data !== void 0 ? _format$data : 'yaml',\n    contentField,\n    dataLocation\n  };\n}\nclass ContentFieldLocationError extends Error {\n  constructor(message) {\n    super(message);\n  }\n}\nfunction getContentExtension(path, schema, debugName) {\n  if (path.length === 0) {\n    if (schema.kind !== 'form' || schema.formKind !== 'content') {\n      throw new ContentFieldLocationError(`Content field for ${debugName()} is not a content field`);\n    }\n    return schema.contentExtension;\n  }\n  if (schema.kind === 'object') {\n    const field = schema.fields[path[0]];\n    if (!field) {\n      throw new ContentFieldLocationError(`Field ${debugName()} specified in contentField does not exist`);\n    }\n    return getContentExtension(path.slice(1), field, debugName);\n  }\n  if (schema.kind === 'conditional') {\n    if (path[0] !== 'value') {\n      throw new ContentFieldLocationError(`Conditional fields referenced in a contentField path must only reference the value field (${debugName()})`);\n    }\n    let contentExtension;\n    const innerPath = path.slice(1);\n    for (const value of Object.values(schema.values)) {\n      const foundContentExtension = getContentExtension(innerPath, value, debugName);\n      if (!contentExtension) {\n        contentExtension = foundContentExtension;\n        continue;\n      }\n      if (contentExtension !== foundContentExtension) {\n        throw new ContentFieldLocationError(`contentField ${debugName()} has conflicting content extensions`);\n      }\n    }\n    if (!contentExtension) {\n      throw new ContentFieldLocationError(`contentField ${debugName()} does not point to a content field`);\n    }\n    return contentExtension;\n  }\n  throw new ContentFieldLocationError(`Path specified in contentField ${debugName()} does not point to a content field`);\n}\n\nfunction getSrcPrefix(publicPath, slug) {\n  return typeof publicPath === 'string' ? `${publicPath.replace(/\\/*$/, '')}/${slug === undefined ? '' : slug + '/'}` : '';\n}\n\nfunction deserializeFiles(nodes, componentBlocks, files, otherFiles, mode, documentFeatures, slug) {\n  return nodes.map(node => {\n    if (node.type === 'component-block') {\n      const componentBlock = componentBlocks[node.component];\n      if (!componentBlock) return node;\n      const schema = object(componentBlock.schema);\n      return {\n        ...node,\n        props: deserializeProps(schema, node.props, files, otherFiles, mode, slug)\n      };\n    }\n    if (node.type === 'image' && typeof node.src === 'string' && mode === 'edit') {\n      var _ref;\n      const prefix = getSrcPrefixForImageBlock(documentFeatures, slug);\n      const filename = node.src.slice(prefix.length);\n      const content = (_ref = typeof documentFeatures.images === 'object' && typeof documentFeatures.images.directory === 'string' ? otherFiles.get(fixPath(documentFeatures.images.directory)) : files) === null || _ref === void 0 ? void 0 : _ref.get(filename);\n      if (!content) {\n        return {\n          type: 'paragraph',\n          children: [{\n            text: `Missing image ${filename}`\n          }]\n        };\n      }\n      return {\n        type: 'image',\n        src: {\n          filename,\n          content\n        },\n        alt: node.alt,\n        title: node.title,\n        children: [{\n          text: ''\n        }]\n      };\n    }\n    if (typeof node.type === 'string') {\n      const children = deserializeFiles(node.children, componentBlocks, files, otherFiles, mode, documentFeatures, slug);\n      return {\n        ...node,\n        children\n      };\n    }\n    return node;\n  });\n}\nfunction deserializeProps(schema, value, files, otherFiles, mode, slug) {\n  return transformProps(schema, value, {\n    form: (schema, value) => {\n      if (schema.formKind === 'asset') {\n        var _otherFiles$get;\n        if (mode === 'read') {\n          return schema.reader.parse(value);\n        }\n        const filename = schema.filename(value, {\n          slug,\n          suggestedFilenamePrefix: undefined\n        });\n        return schema.parse(value, {\n          asset: filename ? schema.directory ? (_otherFiles$get = otherFiles.get(schema.directory)) === null || _otherFiles$get === void 0 ? void 0 : _otherFiles$get.get(filename) : files.get(filename) : undefined,\n          slug\n        });\n      }\n      if (schema.formKind === 'content' || schema.formKind === 'assets') {\n        throw new Error('Not implemented');\n      }\n      if (mode === 'read') {\n        return schema.reader.parse(value);\n      }\n      return schema.parse(value, undefined);\n    }\n  });\n}\nfunction getSrcPrefixForImageBlock(documentFeatures, slug) {\n  return getSrcPrefix(typeof documentFeatures.images === 'object' ? documentFeatures.images.publicPath : undefined, slug);\n}\n\nasync function sha1(content) {\n  return (0,crypto__WEBPACK_IMPORTED_MODULE_4__.createHash)('sha1').update(content).digest('hex');\n}\n\nconst textEncoder$1 = new TextEncoder();\nconst blobShaCache = new WeakMap();\nasync function blobSha(contents) {\n  const cached = blobShaCache.get(contents);\n  if (cached !== undefined) return cached;\n  const blobPrefix = textEncoder$1.encode('blob ' + contents.length + '\\0');\n  const array = new Uint8Array(blobPrefix.byteLength + contents.byteLength);\n  array.set(blobPrefix, 0);\n  array.set(contents, blobPrefix.byteLength);\n  const digestPromise = sha1(array);\n  blobShaCache.set(contents, digestPromise);\n  digestPromise.then(digest => blobShaCache.set(contents, digest));\n  return digestPromise;\n}\nfunction getTreeNodeAtPath(root, path) {\n  const parts = path.split('/');\n  let node = root.get(parts[0]);\n  for (const part of parts.slice(1)) {\n    if (!node) return undefined;\n    if (!node.children) return undefined;\n    node = node.children.get(part);\n  }\n  return node;\n}\nfunction getNodeAtPath(tree, path) {\n  if (path === '') return tree;\n  let node = tree;\n  for (const part of path.split('/')) {\n    if (!node.has(part)) {\n      node.set(part, new Map());\n    }\n    const innerNode = node.get(part);\n    (0,emery__WEBPACK_IMPORTED_MODULE_1__.assert)(innerNode instanceof Map, 'expected tree');\n    node = innerNode;\n  }\n  return node;\n}\nfunction getFilename(path) {\n  return path.replace(/.*\\//, '');\n}\nfunction getDirname(path) {\n  if (!path.includes('/')) return '';\n  return path.replace(/\\/[^/]+$/, '');\n}\nfunction toTreeChanges(changes) {\n  const changesRoot = new Map();\n  for (const deletion of changes.deletions) {\n    const parentTree = getNodeAtPath(changesRoot, getDirname(deletion));\n    parentTree.set(getFilename(deletion), 'delete');\n  }\n  for (const addition of changes.additions) {\n    const parentTree = getNodeAtPath(changesRoot, getDirname(addition.path));\n    parentTree.set(getFilename(addition.path), addition.contents);\n  }\n  return changesRoot;\n}\nconst SPACE_CHAR_CODE = 32;\nconst space = new Uint8Array([SPACE_CHAR_CODE]);\nconst nullchar = new Uint8Array([0]);\nconst tree = textEncoder$1.encode('tree ');\n\n// based on https://github.com/isomorphic-git/isomorphic-git/blob/c09dfa20ffe0ab9e6602e0fa172d72ba8994e443/src/models/GitTree.js#L108-L122\nfunction treeSha(children) {\n  const entries = [...children].map(([name, node]) => ({\n    name,\n    sha: node.entry.sha,\n    mode: node.entry.mode\n  }));\n  entries.sort((a, b) => {\n    const aName = a.mode === '040000' ? a.name + '/' : a.name;\n    const bName = b.mode === '040000' ? b.name + '/' : b.name;\n    return aName === bName ? 0 : aName < bName ? -1 : 1;\n  });\n  const treeObject = entries.flatMap(entry => {\n    const mode = textEncoder$1.encode(entry.mode.replace(/^0/, ''));\n    const name = textEncoder$1.encode(entry.name);\n    const sha = hexToBytes(entry.sha);\n    return [mode, space, name, nullchar, sha];\n  });\n  return sha1(concatBytes([tree, textEncoder$1.encode(treeObject.reduce((sum, val) => sum + val.byteLength, 0).toString()), nullchar, ...treeObject]));\n}\nfunction concatBytes(byteArrays) {\n  const totalLength = byteArrays.reduce((sum, arr) => sum + arr.byteLength, 0);\n  const result = new Uint8Array(totalLength);\n  let offset = 0;\n  for (const arr of byteArrays) {\n    result.set(arr, offset);\n    offset += arr.byteLength;\n  }\n  return result;\n}\nfunction hexToBytes(str) {\n  const bytes = new Uint8Array(str.length / 2);\n  for (var i = 0; i < bytes.byteLength; i += 1) {\n    const start = i * 2;\n    bytes[i] = parseInt(str.slice(start, start + 2), 16);\n  }\n  return bytes;\n}\nasync function createTreeNodeEntry(path, children) {\n  const sha = await treeSha(children);\n  return {\n    path,\n    mode: '040000',\n    type: 'tree',\n    sha\n  };\n}\nasync function createBlobNodeEntry(path, contents) {\n  const sha = 'sha' in contents ? contents.sha : await blobSha(contents);\n  return {\n    path,\n    mode: '100644',\n    type: 'blob',\n    sha\n  };\n}\nasync function updateTreeWithChanges(tree, changes) {\n  var _await$updateTree;\n  const newTree = (_await$updateTree = await updateTree(tree, toTreeChanges(changes), [])) !== null && _await$updateTree !== void 0 ? _await$updateTree : new Map();\n  return {\n    entries: treeToEntries(newTree),\n    sha: await treeSha(newTree !== null && newTree !== void 0 ? newTree : new Map())\n  };\n}\nfunction treeToEntries(tree) {\n  return [...tree.values()].flatMap(x => x.children ? [x.entry, ...treeToEntries(x.children)] : [x.entry]);\n}\nasync function updateTree(tree, changedTree, path) {\n  const newTree = new Map(tree);\n  for (const [key, value] of changedTree) {\n    if (value === 'delete') {\n      newTree.delete(key);\n    }\n    if (value instanceof Map) {\n      var _newTree$get$children, _newTree$get;\n      const existingChildren = (_newTree$get$children = (_newTree$get = newTree.get(key)) === null || _newTree$get === void 0 ? void 0 : _newTree$get.children) !== null && _newTree$get$children !== void 0 ? _newTree$get$children : new Map();\n      const children = await updateTree(existingChildren, value, path.concat(key));\n      if (children === undefined) {\n        newTree.delete(key);\n        continue;\n      }\n      const entry = await createTreeNodeEntry(path.concat(key).join('/'), children);\n      newTree.set(key, {\n        entry,\n        children\n      });\n    }\n    if (value instanceof Uint8Array || typeof value === 'object' && 'sha' in value) {\n      const entry = await createBlobNodeEntry(path.concat(key).join('/'), value);\n      newTree.set(key, {\n        entry\n      });\n    }\n  }\n  if (newTree.size === 0) {\n    return undefined;\n  }\n  return newTree;\n}\nfunction treeEntriesToTreeNodes(entries) {\n  const root = new Map();\n  const getChildrenAtPath = parts => {\n    var _node;\n    if (parts.length === 0) {\n      return root;\n    }\n    let node = root.get(parts[0]);\n    for (const part of parts.slice(1)) {\n      if (!node) return undefined;\n      if (!node.children) return undefined;\n      node = node.children.get(part);\n    }\n    return (_node = node) === null || _node === void 0 ? void 0 : _node.children;\n  };\n  for (const entry of entries) {\n    const split = entry.path.split('/');\n    const children = getChildrenAtPath(split.slice(0, -1));\n    if (children) {\n      children.set(split[split.length - 1], {\n        entry,\n        children: entry.type === 'tree' ? new Map() : undefined\n      });\n    }\n  }\n  return root;\n}\n\nfunction collectDirectoriesUsedInSchemaInner(schema, directories, seenSchemas) {\n  if (seenSchemas.has(schema)) {\n    return;\n  }\n  seenSchemas.add(schema);\n  if (schema.kind === 'array') {\n    return collectDirectoriesUsedInSchemaInner(schema.element, directories, seenSchemas);\n  }\n  if (schema.kind === 'child') {\n    return;\n  }\n  if (schema.kind === 'form') {\n    if (schema.formKind === 'asset' && schema.directory !== undefined) {\n      directories.add(fixPath(schema.directory));\n    }\n    if ((schema.formKind === 'content' || schema.formKind === 'assets') && schema.directories !== undefined) {\n      for (const directory of schema.directories) {\n        directories.add(fixPath(directory));\n      }\n    }\n    return;\n  }\n  if (schema.kind === 'object') {\n    for (const field of Object.values(schema.fields)) {\n      collectDirectoriesUsedInSchemaInner(field, directories, seenSchemas);\n    }\n    return;\n  }\n  if (schema.kind === 'conditional') {\n    for (const innerSchema of Object.values(schema.values)) {\n      collectDirectoriesUsedInSchemaInner(innerSchema, directories, seenSchemas);\n    }\n    return;\n  }\n  (0,emery__WEBPACK_IMPORTED_MODULE_1__.assertNever)(schema);\n}\nfunction collectDirectoriesUsedInSchema(schema) {\n  const directories = new Set();\n  collectDirectoriesUsedInSchemaInner(schema, directories, new Set());\n  return directories;\n}\nfunction getDirectoriesForTreeKey(schema, directory, slug, format) {\n  const directories = [fixPath(directory)];\n  if (format.dataLocation === 'outer') {\n    directories.push(fixPath(directory) + getDataFileExtension(format));\n  }\n  const toAdd = slug === undefined ? '' : `/${slug}`;\n  for (const directory of collectDirectoriesUsedInSchema(schema)) {\n    directories.push(directory + toAdd);\n  }\n  return directories;\n}\n\nconst textDecoder$1 = new TextDecoder();\nconst defaultAltField$1 = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.t)({\n  label: 'Alt text',\n  description: 'This text will be used by screen readers and search engines.'\n});\nconst emptyTitleField$1 = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.b)({\n  Input() {\n    return null;\n  },\n  defaultValue() {\n    return '';\n  },\n  parse(value) {\n    if (value === undefined) return '';\n    if (typeof value !== 'string') {\n      throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be string');\n    }\n    return value;\n  },\n  validate(value) {\n    return value;\n  },\n  serialize(value) {\n    return {\n      value\n    };\n  },\n  label: 'Title'\n});\nfunction normaliseDocumentFeatures(config) {\n  var _config$formatting, _formatting$alignment, _formatting$alignment2, _formatting$blockType, _formatting$inlineMar, _formatting$inlineMar2, _formatting$inlineMar3, _formatting$inlineMar4, _formatting$inlineMar5, _formatting$inlineMar6, _formatting$inlineMar7, _formatting$inlineMar8, _formatting$listTypes, _formatting$listTypes2, _imagesConfig$schema$, _imagesConfig$schema, _imagesConfig$schema$2, _imagesConfig$schema2;\n  const formatting = config.formatting === true ? {\n    // alignment: true, // not supported natively in markdown\n    blockTypes: true,\n    headingLevels: true,\n    inlineMarks: true,\n    listTypes: true,\n    softBreaks: true\n  } : (_config$formatting = config.formatting) !== null && _config$formatting !== void 0 ? _config$formatting : {};\n  const imagesConfig = config.images === true ? {} : config.images;\n  return {\n    formatting: {\n      alignment: formatting.alignment === true ? {\n        center: true,\n        end: true\n      } : {\n        center: !!((_formatting$alignment = formatting.alignment) !== null && _formatting$alignment !== void 0 && _formatting$alignment.center),\n        end: !!((_formatting$alignment2 = formatting.alignment) !== null && _formatting$alignment2 !== void 0 && _formatting$alignment2.end)\n      },\n      blockTypes: (formatting === null || formatting === void 0 ? void 0 : formatting.blockTypes) === true ? {\n        blockquote: true,\n        code: {\n          schema: object({})\n        }\n      } : {\n        blockquote: !!((_formatting$blockType = formatting.blockTypes) !== null && _formatting$blockType !== void 0 && _formatting$blockType.blockquote),\n        code: (_formatting$blockType2 => {\n          if (((_formatting$blockType2 = formatting.blockTypes) === null || _formatting$blockType2 === void 0 ? void 0 : _formatting$blockType2.code) === undefined) {\n            return false;\n          }\n          if (formatting.blockTypes.code === true || !formatting.blockTypes.code.schema) {\n            return {\n              schema: object({})\n            };\n          }\n          for (const key of ['type', 'children', 'language']) {\n            if (key in formatting.blockTypes.code.schema) {\n              throw new Error(`\"${key}\" cannot be a key in the schema for code blocks`);\n            }\n          }\n          return {\n            schema: object(formatting.blockTypes.code.schema)\n          };\n        })()\n      },\n      headings: (_obj$schema => {\n        const opt = formatting === null || formatting === void 0 ? void 0 : formatting.headingLevels;\n        const obj = typeof opt === 'object' && 'levels' in opt ? opt : {\n          levels: opt,\n          schema: undefined\n        };\n        if (obj.schema) {\n          for (const key of ['type', 'children', 'level', 'textAlign']) {\n            if (key in obj.schema) {\n              throw new Error(`\"${key}\" cannot be a key in the schema for headings`);\n            }\n          }\n        }\n        return {\n          levels: [...new Set(obj.levels === true ? [1, 2, 3, 4, 5, 6] : obj.levels)],\n          schema: object((_obj$schema = obj.schema) !== null && _obj$schema !== void 0 ? _obj$schema : {})\n        };\n      })(),\n      inlineMarks: formatting.inlineMarks === true ? {\n        bold: true,\n        code: true,\n        italic: true,\n        keyboard: false,\n        // not supported natively in markdown\n        strikethrough: true,\n        subscript: false,\n        // not supported natively in markdown\n        superscript: false,\n        // not supported natively in markdown\n        underline: false // not supported natively in markdown\n      } : {\n        bold: !!((_formatting$inlineMar = formatting.inlineMarks) !== null && _formatting$inlineMar !== void 0 && _formatting$inlineMar.bold),\n        code: !!((_formatting$inlineMar2 = formatting.inlineMarks) !== null && _formatting$inlineMar2 !== void 0 && _formatting$inlineMar2.code),\n        italic: !!((_formatting$inlineMar3 = formatting.inlineMarks) !== null && _formatting$inlineMar3 !== void 0 && _formatting$inlineMar3.italic),\n        strikethrough: !!((_formatting$inlineMar4 = formatting.inlineMarks) !== null && _formatting$inlineMar4 !== void 0 && _formatting$inlineMar4.strikethrough),\n        underline: !!((_formatting$inlineMar5 = formatting.inlineMarks) !== null && _formatting$inlineMar5 !== void 0 && _formatting$inlineMar5.underline),\n        keyboard: !!((_formatting$inlineMar6 = formatting.inlineMarks) !== null && _formatting$inlineMar6 !== void 0 && _formatting$inlineMar6.keyboard),\n        subscript: !!((_formatting$inlineMar7 = formatting.inlineMarks) !== null && _formatting$inlineMar7 !== void 0 && _formatting$inlineMar7.subscript),\n        superscript: !!((_formatting$inlineMar8 = formatting.inlineMarks) !== null && _formatting$inlineMar8 !== void 0 && _formatting$inlineMar8.superscript)\n      },\n      listTypes: formatting.listTypes === true ? {\n        ordered: true,\n        unordered: true\n      } : {\n        ordered: !!((_formatting$listTypes = formatting.listTypes) !== null && _formatting$listTypes !== void 0 && _formatting$listTypes.ordered),\n        unordered: !!((_formatting$listTypes2 = formatting.listTypes) !== null && _formatting$listTypes2 !== void 0 && _formatting$listTypes2.unordered)\n      },\n      softBreaks: !!formatting.softBreaks\n    },\n    links: !!config.links,\n    layouts: [...new Set((config.layouts || []).map(x => JSON.stringify(x)))].map(x => JSON.parse(x)),\n    dividers: !!config.dividers,\n    images: imagesConfig === undefined ? false : {\n      ...imagesConfig,\n      schema: {\n        alt: (_imagesConfig$schema$ = (_imagesConfig$schema = imagesConfig.schema) === null || _imagesConfig$schema === void 0 ? void 0 : _imagesConfig$schema.alt) !== null && _imagesConfig$schema$ !== void 0 ? _imagesConfig$schema$ : defaultAltField$1,\n        title: (_imagesConfig$schema$2 = (_imagesConfig$schema2 = imagesConfig.schema) === null || _imagesConfig$schema2 === void 0 ? void 0 : _imagesConfig$schema2.title) !== null && _imagesConfig$schema$2 !== void 0 ? _imagesConfig$schema$2 : emptyTitleField$1\n      }\n    },\n    tables: !!config.tables\n  };\n}\n\n/**\n * @deprecated `fields.markdoc` has superseded this field. `fields.mdx` is also available if you prefer MDX.\n */\nfunction document({\n  label,\n  componentBlocks = {},\n  description,\n  ...documentFeaturesConfig\n}) {\n  const documentFeatures = normaliseDocumentFeatures(documentFeaturesConfig);\n  return {\n    kind: 'form',\n    formKind: 'content',\n    defaultValue() {\n      return [{\n        type: 'paragraph',\n        children: [{\n          text: ''\n        }]\n      }];\n    },\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.h, {\n        componentBlocks: componentBlocks,\n        description: description,\n        label: label,\n        documentFeatures: documentFeatures,\n        ...props\n      });\n    },\n    parse(_, data) {\n      const markdoc = textDecoder$1.decode(data.content);\n      fromMarkdoc((0,_markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.parse)(markdoc), componentBlocks);\n      return deserializeFiles((0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.n)(), componentBlocks, data.other, data.external, 'edit', documentFeatures, data.slug);\n    },\n    contentExtension: '.mdoc',\n    validate(value) {\n      return value;\n    },\n    directories: [...collectDirectoriesUsedInSchema(object(Object.fromEntries(Object.entries(componentBlocks).map(([name, block]) => [name, object(block.schema)])))), ...(typeof documentFeatures.images === 'object' && typeof documentFeatures.images.directory === 'string' ? [fixPath(documentFeatures.images.directory)] : [])],\n    serialize(value, opts) {\n      return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.i)();\n    },\n    reader: {\n      parse(value, data) {\n        const markdoc = textDecoder$1.decode(data.content);\n        const document = fromMarkdoc((0,_markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.parse)(markdoc), componentBlocks);\n        return deserializeFiles(document, componentBlocks, new Map(), new Map(), 'read', documentFeatures, undefined);\n      }\n    }\n  };\n}\n\nconst defaultAltField = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.t)({\n  label: 'Alt text',\n  description: 'This text will be used by screen readers and search engines.'\n});\nconst emptyTitleField = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.b)({\n  Input() {\n    return null;\n  },\n  defaultValue() {\n    return '';\n  },\n  parse(value) {\n    if (value === undefined) return '';\n    if (typeof value !== 'string') {\n      throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be string');\n    }\n    return value;\n  },\n  validate(value) {\n    return value;\n  },\n  serialize(value) {\n    return {\n      value\n    };\n  },\n  label: 'Title'\n});\nfunction editorOptionsToConfig(options) {\n  var _options$bold, _options$italic, _options$strikethroug, _options$code, _options$blockquote, _options$orderedList, _options$unorderedLis, _options$table, _options$link, _options$divider;\n  return {\n    bold: (_options$bold = options.bold) !== null && _options$bold !== void 0 ? _options$bold : true,\n    italic: (_options$italic = options.italic) !== null && _options$italic !== void 0 ? _options$italic : true,\n    strikethrough: (_options$strikethroug = options.strikethrough) !== null && _options$strikethroug !== void 0 ? _options$strikethroug : true,\n    code: (_options$code = options.code) !== null && _options$code !== void 0 ? _options$code : true,\n    heading: (() => {\n      let levels = [];\n      let levelsOpt = typeof options.heading === 'object' && !Array.isArray(options.heading) ? options.heading.levels : options.heading;\n      if (levelsOpt === true || levelsOpt === undefined) {\n        levels = [1, 2, 3, 4, 5, 6];\n      }\n      if (Array.isArray(levelsOpt)) {\n        levels = levelsOpt;\n      }\n      return {\n        levels,\n        schema: options.heading && typeof options.heading === 'object' && 'schema' in options.heading ? options.heading.schema : {}\n      };\n    })(),\n    blockquote: (_options$blockquote = options.blockquote) !== null && _options$blockquote !== void 0 ? _options$blockquote : true,\n    orderedList: (_options$orderedList = options.orderedList) !== null && _options$orderedList !== void 0 ? _options$orderedList : true,\n    unorderedList: (_options$unorderedLis = options.unorderedList) !== null && _options$unorderedLis !== void 0 ? _options$unorderedLis : true,\n    table: (_options$table = options.table) !== null && _options$table !== void 0 ? _options$table : true,\n    link: (_options$link = options.link) !== null && _options$link !== void 0 ? _options$link : true,\n    image: options.image !== false ? ((_opts$transformFilena, _opts$schema$alt, _opts$schema, _opts$schema$title, _opts$schema2) => {\n      const opts = options.image === true ? undefined : options.image;\n      return {\n        directory: opts === null || opts === void 0 ? void 0 : opts.directory,\n        publicPath: opts === null || opts === void 0 ? void 0 : opts.publicPath,\n        transformFilename: (_opts$transformFilena = opts === null || opts === void 0 ? void 0 : opts.transformFilename) !== null && _opts$transformFilena !== void 0 ? _opts$transformFilena : x => x,\n        schema: {\n          alt: (_opts$schema$alt = opts === null || opts === void 0 || (_opts$schema = opts.schema) === null || _opts$schema === void 0 ? void 0 : _opts$schema.alt) !== null && _opts$schema$alt !== void 0 ? _opts$schema$alt : defaultAltField,\n          title: (_opts$schema$title = opts === null || opts === void 0 || (_opts$schema2 = opts.schema) === null || _opts$schema2 === void 0 ? void 0 : _opts$schema2.title) !== null && _opts$schema$title !== void 0 ? _opts$schema$title : emptyTitleField\n        }\n      };\n    })() : undefined,\n    divider: (_options$divider = options.divider) !== null && _options$divider !== void 0 ? _options$divider : true,\n    codeBlock: options.codeBlock === false ? undefined : {\n      schema: typeof options.codeBlock === 'object' ? options.codeBlock.schema : {}\n    }\n  };\n}\n\nfunction getTypeForField(field) {\n  if (field.kind === 'object' || field.kind === 'conditional') {\n    return {\n      type: Object,\n      required: true\n    };\n  }\n  if (field.kind === 'array') {\n    return {\n      type: Array,\n      required: true\n    };\n  }\n  if (field.kind === 'child') {\n    return {};\n  }\n  if (field.formKind === undefined) {\n    if (typeof field.defaultValue === 'string' && 'options' in field && Array.isArray(field.options) && field.options.every(val => typeof val === 'object' && val !== null && 'value' in val && typeof val.value === 'string')) {\n      return {\n        type: String,\n        matches: field.options.map(x => x.value),\n        required: true\n      };\n    }\n    if (typeof field.defaultValue === 'string') {\n      let required = false;\n      try {\n        field.parse('');\n      } catch {\n        required = true;\n      }\n      return {\n        type: String,\n        required\n      };\n    }\n    try {\n      field.parse(1);\n      return {\n        type: Number\n      };\n    } catch {}\n    if (typeof field.defaultValue === 'boolean') {\n      return {\n        type: Boolean,\n        required: true\n      };\n    }\n    return {};\n  }\n  if (field.formKind === 'slug') {\n    let required = false;\n    try {\n      field.parse('', undefined);\n    } catch {\n      required = true;\n    }\n    return {\n      type: String,\n      required\n    };\n  }\n  if (field.formKind === 'asset') {\n    let required = false;\n    try {\n      field.validate(null);\n    } catch {\n      required = true;\n    }\n    return {\n      type: String,\n      required\n    };\n  }\n  return {};\n}\nfunction fieldsToMarkdocAttributes(fields) {\n  return Object.fromEntries(Object.entries(fields).map(([name, field]) => {\n    const schema = getTypeForField(field);\n    return [name, schema];\n  }));\n}\nfunction createMarkdocConfig(opts) {\n  const editorConfig = editorOptionsToConfig(opts.options || {});\n  const config = {\n    nodes: {\n      ..._markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.nodes\n    },\n    tags: {}\n  };\n  if (editorConfig.heading.levels.length) {\n    config.nodes.heading = {\n      ..._markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.nodes.heading,\n      attributes: {\n        ..._markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.nodes.heading.attributes,\n        ...fieldsToMarkdocAttributes(editorConfig.heading.schema)\n      }\n    };\n  } else {\n    config.nodes.heading = undefined;\n  }\n  if (!editorConfig.blockquote) {\n    config.nodes.blockquote = undefined;\n  }\n  if (editorConfig.codeBlock) {\n    config.nodes.fence = {\n      ..._markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.nodes.fence,\n      attributes: {\n        ..._markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.nodes.fence.attributes,\n        ...fieldsToMarkdocAttributes(editorConfig.codeBlock.schema)\n      }\n    };\n  } else {\n    config.nodes.fence = undefined;\n  }\n  if (!editorConfig.orderedList && !editorConfig.unorderedList) {\n    config.nodes.list = undefined;\n  }\n  if (!editorConfig.bold) {\n    config.nodes.strong = undefined;\n  }\n  if (!editorConfig.italic) {\n    config.nodes.em = undefined;\n  }\n  if (!editorConfig.strikethrough) {\n    config.nodes.s = undefined;\n  }\n  if (!editorConfig.link) {\n    config.nodes.link = undefined;\n  }\n  if (!editorConfig.image) {\n    config.nodes.image = undefined;\n  }\n  if (!editorConfig.divider) {\n    config.nodes.hr = undefined;\n  }\n  if (!editorConfig.table) {\n    config.nodes.table = undefined;\n  }\n  for (const [name, component] of Object.entries(opts.components || {})) {\n    var _opts$render;\n    const isEmpty = component.kind === 'block' || component.kind === 'inline';\n    config.tags[name] = {\n      render: (_opts$render = opts.render) === null || _opts$render === void 0 || (_opts$render = _opts$render.tags) === null || _opts$render === void 0 ? void 0 : _opts$render[name],\n      children: isEmpty ? [] : undefined,\n      selfClosing: isEmpty,\n      attributes: fieldsToMarkdocAttributes(component.schema),\n      description: 'description' in component ? component.description : undefined,\n      inline: component.kind === 'inline' || component.kind === 'mark'\n    };\n  }\n  for (const [name, render] of Object.entries(((_opts$render2 = opts.render) === null || _opts$render2 === void 0 ? void 0 : _opts$render2.nodes) || {})) {\n    var _opts$render2;\n    const nodeSchema = config.nodes[name];\n    if (nodeSchema) {\n      nodeSchema.render = render;\n    }\n  }\n  return config;\n}\n\nconst textDecoder = new TextDecoder();\nconst textEncoder = new TextEncoder();\nfunction getDirectoriesForEditorField(components, config) {\n  return [...collectDirectoriesUsedInSchema(object(Object.fromEntries(Object.entries(components).map(([name, component]) => [name, object(component.schema)])))), ...(typeof config.image === 'object' && typeof config.image.directory === 'string' ? [fixPath(config.image.directory)] : [])];\n}\nfunction markdoc({\n  label,\n  description,\n  options = {},\n  components = {},\n  extension = 'mdoc'\n}) {\n  let schema;\n  const config = editorOptionsToConfig(options);\n  let getSchema = () => {\n    if (!schema) {\n      schema = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.r)();\n    }\n    return schema;\n  };\n  return {\n    kind: 'form',\n    formKind: 'content',\n    defaultValue() {\n      return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.j)(getSchema());\n    },\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.h, {\n        description: description,\n        label: label,\n        ...props\n      });\n    },\n    parse: (_, {\n      content,\n      other,\n      external,\n      slug\n    }) => {\n      const text = textDecoder.decode(content);\n      return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.p)(text, getSchema());\n    },\n    contentExtension: `.${extension}`,\n    validate(value) {\n      return value;\n    },\n    directories: getDirectoriesForEditorField(components, config),\n    serialize(value, {\n      slug\n    }) {\n      const out = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.k)();\n      return {\n        content: textEncoder.encode(out.content),\n        external: out.external,\n        other: out.other,\n        value: undefined\n      };\n    },\n    reader: {\n      parse: (_, {\n        content\n      }) => {\n        const text = textDecoder.decode(content);\n        return {\n          node: (0,_markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.parse)(text)\n        };\n      }\n    },\n    collaboration: {\n      toYjs(value) {\n        return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.l)(value.doc);\n      },\n      fromYjs(yjsValue, awareness) {\n        return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.m)(getSchema());\n      }\n    }\n  };\n}\nmarkdoc.createMarkdocConfig = createMarkdocConfig;\nmarkdoc.inline = function inlineMarkdoc({\n  label,\n  description,\n  options = {},\n  components = {}\n}) {\n  let schema;\n  const config = editorOptionsToConfig(options);\n  let getSchema = () => {\n    if (!schema) {\n      schema = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.r)();\n    }\n    return schema;\n  };\n  return {\n    kind: 'form',\n    formKind: 'assets',\n    defaultValue() {\n      return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.j)(getSchema());\n    },\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.h, {\n        description: description,\n        label: label,\n        ...props\n      });\n    },\n    parse: (value, {\n      other,\n      external,\n      slug\n    }) => {\n      if (value === undefined) {\n        value = '';\n      }\n      if (typeof value !== 'string') {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be a string');\n      }\n      return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.p)(value, getSchema());\n    },\n    validate(value) {\n      return value;\n    },\n    directories: getDirectoriesForEditorField(components, config),\n    serialize(value, {\n      slug\n    }) {\n      const out = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.k)();\n      return {\n        external: out.external,\n        other: out.other,\n        value: out.content\n      };\n    },\n    reader: {\n      parse: value => {\n        if (value === undefined) {\n          value = '';\n        }\n        if (typeof value !== 'string') {\n          throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be a string');\n        }\n        return {\n          node: (0,_markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.parse)(value)\n        };\n      }\n    },\n    collaboration: {\n      toYjs(value) {\n        return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.l)(value.doc);\n      },\n      fromYjs(yjsValue, awareness) {\n        return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.m)(getSchema());\n      }\n    }\n  };\n};\nfunction mdx({\n  label,\n  description,\n  options = {},\n  components = {},\n  extension = 'mdx'\n}) {\n  let schema;\n  const config = editorOptionsToConfig(options);\n  let getSchema = () => {\n    if (!schema) {\n      schema = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.r)();\n    }\n    return schema;\n  };\n  return {\n    kind: 'form',\n    formKind: 'content',\n    defaultValue() {\n      return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.j)(getSchema());\n    },\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.h, {\n        description: description,\n        label: label,\n        ...props\n      });\n    },\n    parse: (_, {\n      content,\n      other,\n      external,\n      slug\n    }) => {\n      const text = textDecoder.decode(content);\n      return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.o)(text, getSchema());\n    },\n    contentExtension: `.${extension}`,\n    validate(value) {\n      return value;\n    },\n    directories: getDirectoriesForEditorField(components, config),\n    serialize(value, {\n      slug\n    }) {\n      const out = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.q)();\n      return {\n        content: textEncoder.encode(out.content),\n        external: out.external,\n        other: out.other,\n        value: undefined\n      };\n    },\n    reader: {\n      parse: (_, {\n        content\n      }) => {\n        const text = textDecoder.decode(content);\n        return text;\n      }\n    },\n    collaboration: {\n      toYjs(value) {\n        return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.l)(value.doc);\n      },\n      fromYjs(yjsValue, awareness) {\n        return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.m)(getSchema());\n      }\n    }\n  };\n}\nmdx.inline = function mdx({\n  label,\n  description,\n  options = {},\n  components = {}\n}) {\n  let schema;\n  const config = editorOptionsToConfig(options);\n  let getSchema = () => {\n    if (!schema) {\n      schema = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.r)();\n    }\n    return schema;\n  };\n  return {\n    kind: 'form',\n    formKind: 'assets',\n    defaultValue() {\n      return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.j)(getSchema());\n    },\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.h, {\n        description: description,\n        label: label,\n        ...props\n      });\n    },\n    parse: (value, {\n      other,\n      external,\n      slug\n    }) => {\n      if (value === undefined) {\n        value = '';\n      }\n      if (typeof value !== 'string') {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be a string');\n      }\n      return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.o)(value, getSchema());\n    },\n    validate(value) {\n      return value;\n    },\n    directories: getDirectoriesForEditorField(components, config),\n    serialize(value, {\n      slug\n    }) {\n      const out = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.q)();\n      return {\n        external: out.external,\n        other: out.other,\n        value: out.content\n      };\n    },\n    reader: {\n      parse: value => {\n        if (value === undefined) {\n          value = '';\n        }\n        if (typeof value !== 'string') {\n          throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be a string');\n        }\n        return value;\n      }\n    },\n    collaboration: {\n      toYjs(value) {\n        return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.l)(value.doc);\n      },\n      fromYjs(yjsValue, awareness) {\n        return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_2__.m)(getSchema());\n      }\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3QvaW5kZXgtMzYwZTU4MjAubm9kZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUErRDtBQUNoQjtBQUNjO0FBQ2dYO0FBQ3JZO0FBQ0o7O0FBRXBDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLDZEQUFXO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhDQUE4QyxlQUFlO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsVUFBVTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQVEsSUFBSTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FB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Q0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUyxrREFBVTtBQUNuQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSw2Q0FBTTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHNCQUFzQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QUN2Qiw4QkFBOEIsMERBQThCO0FBQzVELEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGFBQWEsMERBQWdCO0FBQzdCLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsc0VBQUs7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSx3QkFBd0IsMERBQUk7QUFDNUI7QUFDQTtBQUNBLENBQUM7QUFDRCx3QkFBd0IsMERBQW1DO0FBQzNEO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0Isc0RBQWM7QUFDOUI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFD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QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGtCQUFrQiwwREFBMkI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isc0RBQWM7QUFDbEM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxlQUFlLDBEQUF5QjtBQUN4QyxPQUFPO0FBQ1A7QUFDQSxlQUFlLDBEQUF3QjtBQUN2QztBQUNBO0FBQ0E7QUFDQTs7QUFFeWMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYW1lcy9Eb3dubG9hZHMvbmV3LWtleXN0YXRpYy1wcm9qZWN0L25vZGVfbW9kdWxlcy9Aa2V5c3RhdGljL2NvcmUvZGlzdC9pbmRleC0zNjBlNTgyMC5ub2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlLCBub2RlcyB9IGZyb20gJ0BtYXJrZG9jL21hcmtkb2MvZGlzdC9pbmRleC5tanMnO1xuaW1wb3J0IHsgYXNzZXJ0TmV2ZXIgfSBmcm9tICdlbWVyeS9hc3NlcnRpb25zJztcbmltcG9ydCB7IGFzc2VydCwgYXNzZXJ0TmV2ZXIgYXMgYXNzZXJ0TmV2ZXIkMSB9IGZyb20gJ2VtZXJ5JztcbmltcG9ydCB7IGIgYXMgYmFzaWNGb3JtRmllbGRXaXRoU2ltcGxlUmVhZGVyUGFyc2UsIHQgYXMgdGV4dCwgRiBhcyBGaWVsZERhdGFFcnJvciwgaCBhcyBEb2N1bWVudEZpZWxkSW5wdXQsIG4gYXMgbm9ybWFsaXplRG9jdW1lbnRGaWVsZENoaWxkcmVuLCBpIGFzIHNlcmlhbGl6ZU1hcmtkb2MsIGogYXMgZ2V0RGVmYXVsdFZhbHVlLCBwIGFzIHBhcnNlVG9FZGl0b3JTdGF0ZSwgayBhcyBzZXJpYWxpemVGcm9tRWRpdG9yU3RhdGUsIGwgYXMgcHJvc2VtaXJyb3JUb1lYbWxGcmFnbWVudCwgbSBhcyBjcmVhdGVFZGl0b3JTdGF0ZUZyb21ZSlMsIG8gYXMgcGFyc2VUb0VkaXRvclN0YXRlTURYLCBxIGFzIHNlcmlhbGl6ZUZyb21FZGl0b3JTdGF0ZU1EWCwgciBhcyBjcmVhdGVFZGl0b3JTY2hlbWEgfSBmcm9tICcuL2luZGV4LTFhOWRhMGZiLm5vZGUuanMnO1xuaW1wb3J0IHsganN4IH0gZnJvbSAncmVhY3QvanN4LXJ1bnRpbWUnO1xuaW1wb3J0IHsgY3JlYXRlSGFzaCB9IGZyb20gJ2NyeXB0byc7XG5cbmZ1bmN0aW9uIG9iamVjdChmaWVsZHMsIG9wdHMpIHtcbiAgcmV0dXJuIHtcbiAgICAuLi5vcHRzLFxuICAgIGtpbmQ6ICdvYmplY3QnLFxuICAgIGZpZWxkc1xuICB9O1xufVxuXG5mdW5jdGlvbiBnZXRWYWx1ZUF0UHJvcFBhdGgodmFsdWUsIGlucHV0UGF0aCkge1xuICBjb25zdCBwYXRoID0gWy4uLmlucHV0UGF0aF07XG4gIHdoaWxlIChwYXRoLmxlbmd0aCkge1xuICAgIGNvbnN0IGtleSA9IHBhdGguc2hpZnQoKTtcbiAgICB2YWx1ZSA9IHZhbHVlW2tleV07XG4gIH1cbiAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gdHJhbnNmb3JtUHJvcHMoc2NoZW1hLCB2YWx1ZSwgdmlzaXRvcnMsIHBhdGggPSBbXSkge1xuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdmb3JtJyB8fCBzY2hlbWEua2luZCA9PT0gJ2NoaWxkJykge1xuICAgIGlmICh2aXNpdG9yc1tzY2hlbWEua2luZF0pIHtcbiAgICAgIHJldHVybiB2aXNpdG9yc1tzY2hlbWEua2luZF0oc2NoZW1hLCB2YWx1ZSwgcGF0aCk7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdvYmplY3QnKSB7XG4gICAgY29uc3QgdmFsID0gT2JqZWN0LmZyb21FbnRyaWVzKE9iamVjdC5lbnRyaWVzKHNjaGVtYS5maWVsZHMpLm1hcCgoW2tleSwgdmFsXSkgPT4ge1xuICAgICAgcmV0dXJuIFtrZXksIHRyYW5zZm9ybVByb3BzKHZhbCwgdmFsdWVba2V5XSwgdmlzaXRvcnMsIFsuLi5wYXRoLCBrZXldKV07XG4gICAgfSkpO1xuICAgIGlmICh2aXNpdG9ycy5vYmplY3QpIHtcbiAgICAgIHJldHVybiB2aXNpdG9yc1tzY2hlbWEua2luZF0oc2NoZW1hLCB2YWwsIHBhdGgpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsO1xuICB9XG4gIGlmIChzY2hlbWEua2luZCA9PT0gJ2FycmF5Jykge1xuICAgIGNvbnN0IHZhbCA9IHZhbHVlLm1hcCgodmFsLCBpZHgpID0+IHRyYW5zZm9ybVByb3BzKHNjaGVtYS5lbGVtZW50LCB2YWwsIHZpc2l0b3JzLCBwYXRoLmNvbmNhdChpZHgpKSk7XG4gICAgaWYgKHZpc2l0b3JzLmFycmF5KSB7XG4gICAgICByZXR1cm4gdmlzaXRvcnNbc2NoZW1hLmtpbmRdKHNjaGVtYSwgdmFsLCBwYXRoKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbDtcbiAgfVxuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdjb25kaXRpb25hbCcpIHtcbiAgICBjb25zdCBkaXNjcmltaW5hbnQgPSB0cmFuc2Zvcm1Qcm9wcyhzY2hlbWEuZGlzY3JpbWluYW50LCB2YWx1ZS5kaXNjcmltaW5hbnQsIHZpc2l0b3JzLCBwYXRoLmNvbmNhdCgnZGlzY3JpbWluYW50JykpO1xuICAgIGNvbnN0IGNvbmRpdGlvbmFsVmFsID0gdHJhbnNmb3JtUHJvcHMoc2NoZW1hLnZhbHVlc1tkaXNjcmltaW5hbnQudG9TdHJpbmcoKV0sIHZhbHVlLnZhbHVlLCB2aXNpdG9ycywgcGF0aC5jb25jYXQoJ3ZhbHVlJykpO1xuICAgIGNvbnN0IHZhbCA9IHtcbiAgICAgIGRpc2NyaW1pbmFudCxcbiAgICAgIHZhbHVlOiBjb25kaXRpb25hbFZhbFxuICAgIH07XG4gICAgaWYgKHZpc2l0b3JzLmNvbmRpdGlvbmFsKSB7XG4gICAgICByZXR1cm4gdmlzaXRvcnNbc2NoZW1hLmtpbmRdKHNjaGVtYSwgdmFsLCBwYXRoKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbDtcbiAgfVxuICBhc3NlcnROZXZlcihzY2hlbWEpO1xufVxuXG4vLyBhIHYgaW1wb3J0YW50IG5vdGVcbi8vIG1hcmtzIGluIHRoZSBtYXJrZG93biBhc3QvaHRtbCBhcmUgcmVwcmVzZW50ZWQgcXVpdGUgZGlmZmVyZW50bHkgdG8gaG93IHRoZXkgYXJlIGluIHNsYXRlXG4vLyBpZiB5b3UgaGFkIHRoZSBtYXJrZG93biAqKnNvbWV0aGluZyBodHRwczovL2tleXN0b25lanMuY29tIHNvbWV0aGluZyoqXG4vLyB0aGUgYm9sZCBub2RlIGlzIHRoZSBwYXJlbnQgb2YgdGhlIGxpbmsgbm9kZVxuLy8gYnV0IGluIHNsYXRlLCBtYXJrcyBhcmUgb25seSByZXByZXNlbnRlZCBvbiB0ZXh0IG5vZGVzXG5cbmNvbnN0IGN1cnJlbnRseUFjdGl2ZU1hcmtzID0gbmV3IFNldCgpO1xuY29uc3QgY3VycmVudGx5RGlzYWJsZWRNYXJrcyA9IG5ldyBTZXQoKTtcbmxldCBjdXJyZW50TGluayA9IG51bGw7XG5mdW5jdGlvbiBhZGRNYXJrVG9DaGlsZHJlbihtYXJrLCBjYikge1xuICBjb25zdCB3YXNQcmV2aW91c2x5QWN0aXZlID0gY3VycmVudGx5QWN0aXZlTWFya3MuaGFzKG1hcmspO1xuICBjdXJyZW50bHlBY3RpdmVNYXJrcy5hZGQobWFyayk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGNiKCk7XG4gIH0gZmluYWxseSB7XG4gICAgaWYgKCF3YXNQcmV2aW91c2x5QWN0aXZlKSB7XG4gICAgICBjdXJyZW50bHlBY3RpdmVNYXJrcy5kZWxldGUobWFyayk7XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBzZXRMaW5rRm9yQ2hpbGRyZW4oaHJlZiwgY2IpIHtcbiAgLy8gd2UnbGwgb25seSB1c2UgdGhlIG91dGVyIGxpbmtcbiAgaWYgKGN1cnJlbnRMaW5rICE9PSBudWxsKSB7XG4gICAgcmV0dXJuIGNiKCk7XG4gIH1cbiAgY3VycmVudExpbmsgPSBocmVmO1xuICB0cnkge1xuICAgIHJldHVybiBjYigpO1xuICB9IGZpbmFsbHkge1xuICAgIGN1cnJlbnRMaW5rID0gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgdHlwZSBpcyBtb3JlIHN0cmljdCB0aGFuIGBFbGVtZW50ICYgeyB0eXBlOiAnbGluayc7IH1gIGJlY2F1c2UgYGNoaWxkcmVuYFxuICogaXMgY29uc3RyYWluZWQgdG8gb25seSBjb250YWluIFRleHQgbm9kZXMuIFRoaXMgY2FuJ3QgYmUgYXNzdW1lZCBnZW5lcmFsbHkgYXJvdW5kIHRoZSBlZGl0b3JcbiAqIChiZWNhdXNlIG9mIHBvdGVudGlhbGx5IGZ1dHVyZSBpbmxpbmUgY29tcG9uZW50cyBvciBuZXN0ZWQgbGlua3Mod2hpY2ggYXJlIG5vcm1hbGl6ZWQgYXdheSBidXQgdGhlIGVkaXRvciBuZWVkcyB0byBub3QgYnJlYWsgaWYgaXQgaGFwcGVucykpXG4gKiBidXQgd2hlcmUgdGhpcyB0eXBlIGlzIHVzZWQsIHdlJ3JlIG9ubHkgZ29pbmcgdG8gYWxsb3cgbGlua3MgdG8gY29udGFpbiBUZXh0IGFuZCB0aGF0J3MgaW1wb3J0YW50XG4gKiBzbyB0aGF0IHdlIGtub3cgYSBibG9jayB3aWxsIG5ldmVyIGJlIGluc2lkZSBhbiBpbmxpbmUgYmVjYXVzZSBTbGF0ZSBnZXRzIHVuaGFwcHkgd2hlbiB0aGF0IGhhcHBlbnNcbiAqIChyZWFsbHkgdGhlIGxpbmsgaW5saW5lIHNob3VsZCBwcm9iYWJseSBiZSBhIG1hcmsgcmF0aGVyIHRoYW4gYW4gaW5saW5lLFxuICogbm9uLXZvaWQgaW5saW5lcyBhcmUgcHJvYmFibHkgYWx3YXlzIGJhZCBidXQgdGhhdCB3b3VsZCBpbXBseSBjaGFuZ2luZyB0aGUgZG9jdW1lbnRcbiAqIHN0cnVjdHVyZSB3aGljaCB3b3VsZCBiZSBzdWNoIHVubmVjZXNzYXJ5IGJyZWFrYWdlKVxuICovXG5cbmZ1bmN0aW9uIGdldElubGluZU5vZGVzKHRleHQpIHtcbiAgY29uc3Qgbm9kZSA9IHtcbiAgICB0ZXh0XG4gIH07XG4gIGZvciAoY29uc3QgbWFyayBvZiBjdXJyZW50bHlBY3RpdmVNYXJrcykge1xuICAgIGlmICghY3VycmVudGx5RGlzYWJsZWRNYXJrcy5oYXMobWFyaykpIHtcbiAgICAgIG5vZGVbbWFya10gPSB0cnVlO1xuICAgIH1cbiAgfVxuICBpZiAoY3VycmVudExpbmsgIT09IG51bGwpIHtcbiAgICByZXR1cm4gW3tcbiAgICAgIHRleHQ6ICcnXG4gICAgfSwge1xuICAgICAgdHlwZTogJ2xpbmsnLFxuICAgICAgaHJlZjogY3VycmVudExpbmssXG4gICAgICBjaGlsZHJlbjogW25vZGVdXG4gICAgfSwge1xuICAgICAgdGV4dDogJydcbiAgICB9XTtcbiAgfVxuICByZXR1cm4gW25vZGVdO1xufVxuXG5jbGFzcyBWYXJpYWJsZUNoaWxkRmllbGRzIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcignVGhlcmUgYXJlIGEgdmFyaWFibGUgbnVtYmVyIG9mIGNoaWxkIGZpZWxkcycpO1xuICB9XG59XG5mdW5jdGlvbiBmaW5kU2luZ2xlQ2hpbGRGaWVsZChzY2hlbWEpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBfZmluZENvbnN0YW50Q2hpbGRGaWVsZHMoc2NoZW1hLCBbXSwgbmV3IFNldCgpKTtcbiAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgcmV0dXJuIHJlc3VsdFswXTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBpZiAoZXJyIGluc3RhbmNlb2YgVmFyaWFibGVDaGlsZEZpZWxkcykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aHJvdyBlcnI7XG4gIH1cbn1cbmZ1bmN0aW9uIF9maW5kQ29uc3RhbnRDaGlsZEZpZWxkcyhzY2hlbWEsIHBhdGgsIHNlZW5TY2hlbWFzKSB7XG4gIGlmIChzZWVuU2NoZW1hcy5oYXMoc2NoZW1hKSkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBzZWVuU2NoZW1hcy5hZGQoc2NoZW1hKTtcbiAgc3dpdGNoIChzY2hlbWEua2luZCkge1xuICAgIGNhc2UgJ2Zvcm0nOlxuICAgICAgcmV0dXJuIFtdO1xuICAgIGNhc2UgJ2NoaWxkJzpcbiAgICAgIHJldHVybiBbe1xuICAgICAgICByZWxhdGl2ZVBhdGg6IHBhdGgsXG4gICAgICAgIG9wdGlvbnM6IHNjaGVtYS5vcHRpb25zLFxuICAgICAgICBraW5kOiAnY2hpbGQnXG4gICAgICB9XTtcbiAgICBjYXNlICdjb25kaXRpb25hbCc6XG4gICAgICB7XG4gICAgICAgIGlmIChjb3VsZENvbnRhaW5DaGlsZEZpZWxkKHNjaGVtYSkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVmFyaWFibGVDaGlsZEZpZWxkcygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICBjYXNlICdhcnJheSc6XG4gICAgICB7XG4gICAgICAgIGlmIChzY2hlbWEuYXNDaGlsZFRhZykge1xuICAgICAgICAgIGNvbnN0IGNoaWxkID0gX2ZpbmRDb25zdGFudENoaWxkRmllbGRzKHNjaGVtYS5lbGVtZW50LCBbXSwgc2VlblNjaGVtYXMpO1xuICAgICAgICAgIGlmIChjaGlsZC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBbe1xuICAgICAgICAgICAga2luZDogJ2FycmF5JyxcbiAgICAgICAgICAgIGFzQ2hpbGRUYWc6IHNjaGVtYS5hc0NoaWxkVGFnLFxuICAgICAgICAgICAgZmllbGQ6IHNjaGVtYSxcbiAgICAgICAgICAgIHJlbGF0aXZlUGF0aDogcGF0aCxcbiAgICAgICAgICAgIGNoaWxkOiBjaGlsZFswXVxuICAgICAgICAgIH1dO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb3VsZENvbnRhaW5DaGlsZEZpZWxkKHNjaGVtYSkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVmFyaWFibGVDaGlsZEZpZWxkcygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICBjYXNlICdvYmplY3QnOlxuICAgICAge1xuICAgICAgICBjb25zdCBwYXRocyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhzY2hlbWEuZmllbGRzKSkge1xuICAgICAgICAgIHBhdGhzLnB1c2goLi4uX2ZpbmRDb25zdGFudENoaWxkRmllbGRzKHZhbHVlLCBwYXRoLmNvbmNhdChrZXkpLCBzZWVuU2NoZW1hcykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXRocztcbiAgICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gY291bGRDb250YWluQ2hpbGRGaWVsZChzY2hlbWEsIHNlZW4gPSBuZXcgU2V0KCkpIHtcbiAgaWYgKHNlZW4uaGFzKHNjaGVtYSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgc2Vlbi5hZGQoc2NoZW1hKTtcbiAgc3dpdGNoIChzY2hlbWEua2luZCkge1xuICAgIGNhc2UgJ2Zvcm0nOlxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGNhc2UgJ2NoaWxkJzpcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIGNhc2UgJ2NvbmRpdGlvbmFsJzpcbiAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHNjaGVtYS52YWx1ZXMpLnNvbWUodmFsdWUgPT4gY291bGRDb250YWluQ2hpbGRGaWVsZCh2YWx1ZSwgc2VlbikpO1xuICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICByZXR1cm4gT2JqZWN0LmtleXMoc2NoZW1hLmZpZWxkcykuc29tZShrZXkgPT4gY291bGRDb250YWluQ2hpbGRGaWVsZChzY2hlbWEuZmllbGRzW2tleV0sIHNlZW4pKTtcbiAgICBjYXNlICdhcnJheSc6XG4gICAgICByZXR1cm4gY291bGRDb250YWluQ2hpbGRGaWVsZChzY2hlbWEuZWxlbWVudCwgc2Vlbik7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5saW5lTm9kZUZyb21NYXJrZG9jKG5vZGUpIHtcbiAgaWYgKG5vZGUudHlwZSA9PT0gJ2lubGluZScpIHtcbiAgICByZXR1cm4gaW5saW5lQ2hpbGRyZW5Gcm9tTWFya2RvYyhub2RlLmNoaWxkcmVuKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAnbGluaycpIHtcbiAgICByZXR1cm4gc2V0TGlua0ZvckNoaWxkcmVuKG5vZGUuYXR0cmlidXRlcy5ocmVmLCAoKSA9PiBpbmxpbmVDaGlsZHJlbkZyb21NYXJrZG9jKG5vZGUuY2hpbGRyZW4pKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAndGV4dCcpIHtcbiAgICByZXR1cm4gZ2V0SW5saW5lTm9kZXMobm9kZS5hdHRyaWJ1dGVzLmNvbnRlbnQpO1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICdzdHJvbmcnKSB7XG4gICAgcmV0dXJuIGFkZE1hcmtUb0NoaWxkcmVuKCdib2xkJywgKCkgPT4gaW5saW5lQ2hpbGRyZW5Gcm9tTWFya2RvYyhub2RlLmNoaWxkcmVuKSk7XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ2NvZGUnKSB7XG4gICAgcmV0dXJuIGFkZE1hcmtUb0NoaWxkcmVuKCdjb2RlJywgKCkgPT4gZ2V0SW5saW5lTm9kZXMobm9kZS5hdHRyaWJ1dGVzLmNvbnRlbnQpKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAnZW0nKSB7XG4gICAgcmV0dXJuIGFkZE1hcmtUb0NoaWxkcmVuKCdpdGFsaWMnLCAoKSA9PiBpbmxpbmVDaGlsZHJlbkZyb21NYXJrZG9jKG5vZGUuY2hpbGRyZW4pKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAncycpIHtcbiAgICByZXR1cm4gYWRkTWFya1RvQ2hpbGRyZW4oJ3N0cmlrZXRocm91Z2gnLCAoKSA9PiBpbmxpbmVDaGlsZHJlbkZyb21NYXJrZG9jKG5vZGUuY2hpbGRyZW4pKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAndGFnJykge1xuICAgIGlmIChub2RlLnRhZyA9PT0gJ3UnKSB7XG4gICAgICByZXR1cm4gYWRkTWFya1RvQ2hpbGRyZW4oJ3VuZGVybGluZScsICgpID0+IGlubGluZUNoaWxkcmVuRnJvbU1hcmtkb2Mobm9kZS5jaGlsZHJlbikpO1xuICAgIH1cbiAgICBpZiAobm9kZS50YWcgPT09ICdrYmQnKSB7XG4gICAgICByZXR1cm4gYWRkTWFya1RvQ2hpbGRyZW4oJ2tleWJvYXJkJywgKCkgPT4gaW5saW5lQ2hpbGRyZW5Gcm9tTWFya2RvYyhub2RlLmNoaWxkcmVuKSk7XG4gICAgfVxuICAgIGlmIChub2RlLnRhZyA9PT0gJ3N1YicpIHtcbiAgICAgIHJldHVybiBhZGRNYXJrVG9DaGlsZHJlbignc3Vic2NyaXB0JywgKCkgPT4gaW5saW5lQ2hpbGRyZW5Gcm9tTWFya2RvYyhub2RlLmNoaWxkcmVuKSk7XG4gICAgfVxuICAgIGlmIChub2RlLnRhZyA9PT0gJ3N1cCcpIHtcbiAgICAgIHJldHVybiBhZGRNYXJrVG9DaGlsZHJlbignc3VwZXJzY3JpcHQnLCAoKSA9PiBpbmxpbmVDaGlsZHJlbkZyb21NYXJrZG9jKG5vZGUuY2hpbGRyZW4pKTtcbiAgICB9XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ3NvZnRicmVhaycpIHtcbiAgICByZXR1cm4gZ2V0SW5saW5lTm9kZXMoJyAnKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAnaGFyZGJyZWFrJykge1xuICAgIHJldHVybiBnZXRJbmxpbmVOb2RlcygnXFxuJyk7XG4gIH1cbiAgaWYgKG5vZGUudGFnID09PSAnY29tcG9uZW50LWlubGluZS1wcm9wJyAmJiBBcnJheS5pc0FycmF5KG5vZGUuYXR0cmlidXRlcy5wcm9wUGF0aCkgJiYgbm9kZS5hdHRyaWJ1dGVzLnByb3BQYXRoLmV2ZXJ5KHggPT4gdHlwZW9mIHggPT09ICdzdHJpbmcnIHx8IHR5cGVvZiB4ID09PSAnbnVtYmVyJykpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ2NvbXBvbmVudC1pbmxpbmUtcHJvcCcsXG4gICAgICBjaGlsZHJlbjogaW5saW5lRnJvbU1hcmtkb2Mobm9kZS5jaGlsZHJlbiksXG4gICAgICBwcm9wUGF0aDogbm9kZS5hdHRyaWJ1dGVzLnByb3BQYXRoXG4gICAgfTtcbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gaW5saW5lIG5vZGUgdHlwZTogJHtub2RlLnR5cGV9YCk7XG59XG5mdW5jdGlvbiBpbmxpbmVDaGlsZHJlbkZyb21NYXJrZG9jKG5vZGVzKSB7XG4gIHJldHVybiBub2Rlcy5mbGF0TWFwKGlubGluZU5vZGVGcm9tTWFya2RvYyk7XG59XG5mdW5jdGlvbiBpbmxpbmVGcm9tTWFya2RvYyhub2Rlcykge1xuICBjb25zdCB0cmFuc2Zvcm1lZE5vZGVzID0gbm9kZXMuZmxhdE1hcChpbmxpbmVOb2RlRnJvbU1hcmtkb2MpO1xuICBjb25zdCBuZXh0Tm9kZXMgPSBbXTtcbiAgbGV0IGxhc3ROb2RlO1xuICBmb3IgKGNvbnN0IFtpZHgsIG5vZGVdIG9mIHRyYW5zZm9ybWVkTm9kZXMuZW50cmllcygpKSB7XG4gICAgdmFyIF9sYXN0Tm9kZTtcbiAgICBpZiAobm9kZS50eXBlID09PSB1bmRlZmluZWQgJiYgbm9kZS50ZXh0ID09PSAnJyAmJiAoKF9sYXN0Tm9kZSA9IGxhc3ROb2RlKSA9PT0gbnVsbCB8fCBfbGFzdE5vZGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9sYXN0Tm9kZS50eXBlKSA9PT0gdW5kZWZpbmVkICYmIGlkeCAhPT0gdHJhbnNmb3JtZWROb2Rlcy5sZW5ndGggLSAxKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgbmV4dE5vZGVzLnB1c2gobm9kZSk7XG4gICAgbGFzdE5vZGUgPSBub2RlO1xuICB9XG4gIGlmICghbmV4dE5vZGVzLmxlbmd0aCkge1xuICAgIG5leHROb2Rlcy5wdXNoKHtcbiAgICAgIHRleHQ6ICcnXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIG5leHROb2Rlcztcbn1cbmZ1bmN0aW9uIGZyb21NYXJrZG9jKG5vZGUsIGNvbXBvbmVudEJsb2Nrcykge1xuICBjb25zdCBub2RlcyA9IG5vZGUuY2hpbGRyZW4uZmxhdE1hcCh4ID0+IGZyb21NYXJrZG9jTm9kZSh4LCBjb21wb25lbnRCbG9ja3MpKTtcbiAgaWYgKG5vZGVzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBbe1xuICAgICAgdHlwZTogJ3BhcmFncmFwaCcsXG4gICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgdGV4dDogJydcbiAgICAgIH1dXG4gICAgfV07XG4gIH1cbiAgaWYgKG5vZGVzW25vZGVzLmxlbmd0aCAtIDFdLnR5cGUgIT09ICdwYXJhZ3JhcGgnKSB7XG4gICAgbm9kZXMucHVzaCh7XG4gICAgICB0eXBlOiAncGFyYWdyYXBoJyxcbiAgICAgIGNoaWxkcmVuOiBbe1xuICAgICAgICB0ZXh0OiAnJ1xuICAgICAgfV1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gbm9kZXM7XG59XG5mdW5jdGlvbiBmcm9tTWFya2RvY05vZGUobm9kZSwgY29tcG9uZW50QmxvY2tzKSB7XG4gIGlmIChub2RlLnR5cGUgPT09ICdibG9ja3F1b3RlJykge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnYmxvY2txdW90ZScsXG4gICAgICBjaGlsZHJlbjogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpXG4gICAgfTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAnZmVuY2UnKSB7XG4gICAgY29uc3Qge1xuICAgICAgbGFuZ3VhZ2UsXG4gICAgICBjb250ZW50LFxuICAgICAgLi4ucmVzdFxuICAgIH0gPSBub2RlLmF0dHJpYnV0ZXM7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdjb2RlJyxcbiAgICAgIGNoaWxkcmVuOiBbe1xuICAgICAgICB0ZXh0OiBjb250ZW50LnJlcGxhY2UoL1xcbiQvLCAnJylcbiAgICAgIH1dLFxuICAgICAgLi4uKHR5cGVvZiBsYW5ndWFnZSA9PT0gJ3N0cmluZycgPyB7XG4gICAgICAgIGxhbmd1YWdlXG4gICAgICB9IDoge30pLFxuICAgICAgLi4ucmVzdFxuICAgIH07XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ2hlYWRpbmcnKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm5vZGUuYXR0cmlidXRlcyxcbiAgICAgIGxldmVsOiBub2RlLmF0dHJpYnV0ZXMubGV2ZWwsXG4gICAgICB0eXBlOiAnaGVhZGluZycsXG4gICAgICBjaGlsZHJlbjogaW5saW5lRnJvbU1hcmtkb2Mobm9kZS5jaGlsZHJlbilcbiAgICB9O1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICdsaXN0Jykge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBub2RlLmF0dHJpYnV0ZXMub3JkZXJlZCA/ICdvcmRlcmVkLWxpc3QnIDogJ3Vub3JkZXJlZC1saXN0JyxcbiAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmZsYXRNYXAoeCA9PiBmcm9tTWFya2RvY05vZGUoeCwgY29tcG9uZW50QmxvY2tzKSlcbiAgICB9O1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICdpdGVtJykge1xuICAgIHZhciBfbm9kZSRjaGlsZHJlbiQ7XG4gICAgY29uc3QgY2hpbGRyZW4gPSBbe1xuICAgICAgdHlwZTogJ2xpc3QtaXRlbS1jb250ZW50JyxcbiAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmxlbmd0aCA/IGlubGluZUZyb21NYXJrZG9jKFtub2RlLmNoaWxkcmVuWzBdXSkgOiBbe1xuICAgICAgICB0ZXh0OiAnJ1xuICAgICAgfV1cbiAgICB9XTtcbiAgICBpZiAoKChfbm9kZSRjaGlsZHJlbiQgPSBub2RlLmNoaWxkcmVuWzFdKSA9PT0gbnVsbCB8fCBfbm9kZSRjaGlsZHJlbiQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ub2RlJGNoaWxkcmVuJC50eXBlKSA9PT0gJ2xpc3QnKSB7XG4gICAgICBjb25zdCBsaXN0ID0gbm9kZS5jaGlsZHJlblsxXTtcbiAgICAgIGNoaWxkcmVuLnB1c2goe1xuICAgICAgICB0eXBlOiBsaXN0LmF0dHJpYnV0ZXMub3JkZXJlZCA/ICdvcmRlcmVkLWxpc3QnIDogJ3Vub3JkZXJlZC1saXN0JyxcbiAgICAgICAgY2hpbGRyZW46IGxpc3QuY2hpbGRyZW4uZmxhdE1hcCh4ID0+IGZyb21NYXJrZG9jTm9kZSh4LCBjb21wb25lbnRCbG9ja3MpKVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnbGlzdC1pdGVtJyxcbiAgICAgIGNoaWxkcmVuXG4gICAgfTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAncGFyYWdyYXBoJykge1xuICAgIGlmIChub2RlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMSAmJiBub2RlLmNoaWxkcmVuWzBdLnR5cGUgPT09ICdpbmxpbmUnICYmIG5vZGUuY2hpbGRyZW5bMF0uY2hpbGRyZW4ubGVuZ3RoID09PSAxICYmIG5vZGUuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0udHlwZSA9PT0gJ2ltYWdlJykge1xuICAgICAgdmFyIF9pbWFnZSRhdHRyaWJ1dGVzJHRpdDtcbiAgICAgIGNvbnN0IGltYWdlID0gbm9kZS5jaGlsZHJlblswXS5jaGlsZHJlblswXTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdpbWFnZScsXG4gICAgICAgIHNyYzogZGVjb2RlVVJJKGltYWdlLmF0dHJpYnV0ZXMuc3JjKSxcbiAgICAgICAgYWx0OiBpbWFnZS5hdHRyaWJ1dGVzLmFsdCxcbiAgICAgICAgdGl0bGU6IChfaW1hZ2UkYXR0cmlidXRlcyR0aXQgPSBpbWFnZS5hdHRyaWJ1dGVzLnRpdGxlKSAhPT0gbnVsbCAmJiBfaW1hZ2UkYXR0cmlidXRlcyR0aXQgIT09IHZvaWQgMCA/IF9pbWFnZSRhdHRyaWJ1dGVzJHRpdCA6ICcnLFxuICAgICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgICB0ZXh0OiAnJ1xuICAgICAgICB9XVxuICAgICAgfTtcbiAgICB9XG4gICAgY29uc3QgY2hpbGRyZW4gPSBpbmxpbmVGcm9tTWFya2RvYyhub2RlLmNoaWxkcmVuKTtcbiAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID09PSAxICYmIGNoaWxkcmVuWzBdLnR5cGUgPT09ICdjb21wb25lbnQtaW5saW5lLXByb3AnKSB7XG4gICAgICByZXR1cm4gY2hpbGRyZW5bMF07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAncGFyYWdyYXBoJyxcbiAgICAgIGNoaWxkcmVuLFxuICAgICAgdGV4dEFsaWduOiBub2RlLmF0dHJpYnV0ZXMudGV4dEFsaWduXG4gICAgfTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAnaHInKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdkaXZpZGVyJyxcbiAgICAgIGNoaWxkcmVuOiBbe1xuICAgICAgICB0ZXh0OiAnJ1xuICAgICAgfV1cbiAgICB9O1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICd0YWJsZScpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ3RhYmxlJyxcbiAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmZsYXRNYXAoeCA9PiBmcm9tTWFya2RvY05vZGUoeCwgY29tcG9uZW50QmxvY2tzKSlcbiAgICB9O1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICd0Ym9keScpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ3RhYmxlLWJvZHknLFxuICAgICAgY2hpbGRyZW46IG5vZGUuY2hpbGRyZW4uZmxhdE1hcCh4ID0+IGZyb21NYXJrZG9jTm9kZSh4LCBjb21wb25lbnRCbG9ja3MpKVxuICAgIH07XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ3RoZWFkJykge1xuICAgIGlmICghbm9kZS5jaGlsZHJlbi5sZW5ndGgpIHJldHVybiBbXTtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ3RhYmxlLWhlYWQnLFxuICAgICAgY2hpbGRyZW46IG5vZGUuY2hpbGRyZW4uZmxhdE1hcCh4ID0+IGZyb21NYXJrZG9jTm9kZSh4LCBjb21wb25lbnRCbG9ja3MpKVxuICAgIH07XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ3RyJykge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAndGFibGUtcm93JyxcbiAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmZsYXRNYXAoeCA9PiBmcm9tTWFya2RvY05vZGUoeCwgY29tcG9uZW50QmxvY2tzKSlcbiAgICB9O1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICd0ZCcpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ3RhYmxlLWNlbGwnLFxuICAgICAgY2hpbGRyZW46IG5vZGUuY2hpbGRyZW4uZmxhdE1hcCh4ID0+IGZyb21NYXJrZG9jTm9kZSh4LCBjb21wb25lbnRCbG9ja3MpKVxuICAgIH07XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ3RoJykge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAndGFibGUtY2VsbCcsXG4gICAgICBoZWFkZXI6IHRydWUsXG4gICAgICBjaGlsZHJlbjogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpXG4gICAgfTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAndGFnJykge1xuICAgIGlmIChub2RlLnRhZyA9PT0gJ3RhYmxlJykge1xuICAgICAgcmV0dXJuIGZyb21NYXJrZG9jTm9kZShub2RlLmNoaWxkcmVuWzBdLCBjb21wb25lbnRCbG9ja3MpO1xuICAgIH1cbiAgICBpZiAobm9kZS50YWcgPT09ICdsYXlvdXQnKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnbGF5b3V0JyxcbiAgICAgICAgbGF5b3V0OiBub2RlLmF0dHJpYnV0ZXMubGF5b3V0LFxuICAgICAgICBjaGlsZHJlbjogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpXG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAobm9kZS50YWcgPT09ICdsYXlvdXQtYXJlYScpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdsYXlvdXQtYXJlYScsXG4gICAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmZsYXRNYXAoeCA9PiBmcm9tTWFya2RvY05vZGUoeCwgY29tcG9uZW50QmxvY2tzKSlcbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChub2RlLnRhZyA9PT0gJ2NvbXBvbmVudC1ibG9jaycpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdjb21wb25lbnQtYmxvY2snLFxuICAgICAgICBjb21wb25lbnQ6IG5vZGUuYXR0cmlidXRlcy5jb21wb25lbnQsXG4gICAgICAgIHByb3BzOiBub2RlLmF0dHJpYnV0ZXMucHJvcHMsXG4gICAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCA/IFt7XG4gICAgICAgICAgdHlwZTogJ2NvbXBvbmVudC1pbmxpbmUtcHJvcCcsXG4gICAgICAgICAgY2hpbGRyZW46IFt7XG4gICAgICAgICAgICB0ZXh0OiAnJ1xuICAgICAgICAgIH1dXG4gICAgICAgIH1dIDogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpXG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAobm9kZS50YWcgPT09ICdjb21wb25lbnQtYmxvY2stcHJvcCcgJiYgQXJyYXkuaXNBcnJheShub2RlLmF0dHJpYnV0ZXMucHJvcFBhdGgpICYmIG5vZGUuYXR0cmlidXRlcy5wcm9wUGF0aC5ldmVyeSh4ID0+IHR5cGVvZiB4ID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgeCA9PT0gJ251bWJlcicpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnY29tcG9uZW50LWJsb2NrLXByb3AnLFxuICAgICAgICBjaGlsZHJlbjogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpLFxuICAgICAgICBwcm9wUGF0aDogbm9kZS5hdHRyaWJ1dGVzLnByb3BQYXRoXG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAobm9kZS50YWcpIHtcbiAgICAgIGNvbnN0IGNvbXBvbmVudEJsb2NrID0gY29tcG9uZW50QmxvY2tzW25vZGUudGFnXTtcbiAgICAgIGlmIChjb21wb25lbnRCbG9jaykge1xuICAgICAgICBjb25zdCBzaW5nbGVDaGlsZEZpZWxkID0gZmluZFNpbmdsZUNoaWxkRmllbGQoe1xuICAgICAgICAgIGtpbmQ6ICdvYmplY3QnLFxuICAgICAgICAgIGZpZWxkczogY29tcG9uZW50QmxvY2suc2NoZW1hXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoc2luZ2xlQ2hpbGRGaWVsZCkge1xuICAgICAgICAgIGNvbnN0IG5ld0F0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG5vZGUuYXR0cmlidXRlcykpO1xuICAgICAgICAgIGNvbnN0IGNoaWxkcmVuID0gW107XG4gICAgICAgICAgdG9DaGlsZHJlbkFuZFByb3BzKG5vZGUuY2hpbGRyZW4sIGNoaWxkcmVuLCBuZXdBdHRyaWJ1dGVzLCBzaW5nbGVDaGlsZEZpZWxkLCBbXSwgY29tcG9uZW50QmxvY2tzKTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ2NvbXBvbmVudC1ibG9jaycsXG4gICAgICAgICAgICBjb21wb25lbnQ6IG5vZGUudGFnLFxuICAgICAgICAgICAgcHJvcHM6IG5ld0F0dHJpYnV0ZXMsXG4gICAgICAgICAgICBjaGlsZHJlblxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiAnY29tcG9uZW50LWJsb2NrJyxcbiAgICAgICAgICBjb21wb25lbnQ6IG5vZGUudGFnLFxuICAgICAgICAgIHByb3BzOiBub2RlLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgY2hpbGRyZW46IG5vZGUuY2hpbGRyZW4ubGVuZ3RoID09PSAwID8gW3tcbiAgICAgICAgICAgIHR5cGU6ICdjb21wb25lbnQtaW5saW5lLXByb3AnLFxuICAgICAgICAgICAgY2hpbGRyZW46IFt7XG4gICAgICAgICAgICAgIHRleHQ6ICcnXG4gICAgICAgICAgICB9XVxuICAgICAgICAgIH1dIDogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biB0YWc6ICR7bm9kZS50YWd9YCk7XG4gIH1cbiAgcmV0dXJuIGlubGluZU5vZGVGcm9tTWFya2RvYyhub2RlKTtcbn1cbmZ1bmN0aW9uIHRvQ2hpbGRyZW5BbmRQcm9wcyhmcm9tTWFya2RvYywgcmVzdWx0aW5nQ2hpbGRyZW4sIHZhbHVlLCBzaW5nbGVDaGlsZEZpZWxkLCBwYXJlbnRQcm9wUGF0aCwgY29tcG9uZW50QmxvY2tzKSB7XG4gIGlmIChzaW5nbGVDaGlsZEZpZWxkLmtpbmQgPT09ICdjaGlsZCcpIHtcbiAgICBjb25zdCBjaGlsZHJlbiA9IGZyb21NYXJrZG9jLmZsYXRNYXAoeCA9PiBmcm9tTWFya2RvY05vZGUoeCwgY29tcG9uZW50QmxvY2tzKSk7XG4gICAgcmVzdWx0aW5nQ2hpbGRyZW4ucHVzaCh7XG4gICAgICB0eXBlOiBgY29tcG9uZW50LSR7c2luZ2xlQ2hpbGRGaWVsZC5vcHRpb25zLmtpbmR9LXByb3BgLFxuICAgICAgcHJvcFBhdGg6IFsuLi5wYXJlbnRQcm9wUGF0aCwgLi4uc2luZ2xlQ2hpbGRGaWVsZC5yZWxhdGl2ZVBhdGhdLFxuICAgICAgY2hpbGRyZW5cbiAgICB9KTtcbiAgfVxuICBpZiAoc2luZ2xlQ2hpbGRGaWVsZC5raW5kID09PSAnYXJyYXknKSB7XG4gICAgY29uc3QgYXJyID0gW107XG4gICAgZm9yIChsZXQgW2lkeCwgY2hpbGRdIG9mIGZyb21NYXJrZG9jLmVudHJpZXMoKSkge1xuICAgICAgaWYgKGNoaWxkLnR5cGUgPT09ICdwYXJhZ3JhcGgnKSB7XG4gICAgICAgIGNoaWxkID0gY2hpbGQuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF07XG4gICAgICB9XG4gICAgICBpZiAoY2hpbGQudHlwZSAhPT0gJ3RhZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBleHBlY3RlZCB0YWcgJHtzaW5nbGVDaGlsZEZpZWxkLmFzQ2hpbGRUYWd9LCBmb3VuZCB0eXBlOiAke2NoaWxkLnR5cGV9YCk7XG4gICAgICB9XG4gICAgICBpZiAoY2hpbGQudGFnICE9PSBzaW5nbGVDaGlsZEZpZWxkLmFzQ2hpbGRUYWcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBleHBlY3RlZCB0YWcgJHtzaW5nbGVDaGlsZEZpZWxkLmFzQ2hpbGRUYWd9LCBmb3VuZCB0YWc6ICR7Y2hpbGQudGFnfWApO1xuICAgICAgfVxuICAgICAgY29uc3QgYXR0cmlidXRlcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY2hpbGQuYXR0cmlidXRlcykpO1xuICAgICAgaWYgKHNpbmdsZUNoaWxkRmllbGQuY2hpbGQpIHtcbiAgICAgICAgdG9DaGlsZHJlbkFuZFByb3BzKGNoaWxkLmNoaWxkcmVuLCByZXN1bHRpbmdDaGlsZHJlbiwgYXR0cmlidXRlcywgc2luZ2xlQ2hpbGRGaWVsZC5jaGlsZCwgWy4uLnBhcmVudFByb3BQYXRoLCAuLi5zaW5nbGVDaGlsZEZpZWxkLnJlbGF0aXZlUGF0aCwgaWR4XSwgY29tcG9uZW50QmxvY2tzKTtcbiAgICAgIH1cbiAgICAgIGFyci5wdXNoKGF0dHJpYnV0ZXMpO1xuICAgIH1cbiAgICBjb25zdCBrZXkgPSBzaW5nbGVDaGlsZEZpZWxkLnJlbGF0aXZlUGF0aFtzaW5nbGVDaGlsZEZpZWxkLnJlbGF0aXZlUGF0aC5sZW5ndGggLSAxXTtcbiAgICBjb25zdCBwYXJlbnQgPSBnZXRWYWx1ZUF0UHJvcFBhdGgodmFsdWUsIHNpbmdsZUNoaWxkRmllbGQucmVsYXRpdmVQYXRoLnNsaWNlKDAsIC0xKSk7XG4gICAgcGFyZW50W2tleV0gPSBhcnI7XG4gIH1cbn1cblxuLy8gdGhlc2UgYXJlIGludGVudGlvbmFsbHkgbW9yZSByZXN0cmljdGl2ZSB0aGFuIHRoZSB0eXBlcyBhbGxvd2VkIGJ5IHN0cm9uZyBhbmQgd2VhayBtYXBzXG5cbmNvbnN0IGVtcHR5Q2FjaGVOb2RlID0gU3ltYm9sKCdlbXB0eUNhY2hlTm9kZScpO1xuXG4vLyB3ZWFrIGtleXMgc2hvdWxkIGFsd2F5cyBjb21lIGJlZm9yZSBzdHJvbmcga2V5cyBpbiB0aGUgYXJndW1lbnRzIHRob3VnaCB0aGF0IGNhbm5vdCBiZSBlbmZvcmNlZCB3aXRoIHR5cGVzXG5mdW5jdGlvbiBtZW1vaXplKGZ1bmMpIHtcbiAgY29uc3QgY2FjaGVOb2RlID0ge1xuICAgIHZhbHVlOiBlbXB0eUNhY2hlTm9kZSxcbiAgICBzdHJvbmc6IHVuZGVmaW5lZCxcbiAgICB3ZWFrOiB1bmRlZmluZWRcbiAgfTtcbiAgcmV0dXJuICguLi5hcmdzKSA9PiB7XG4gICAgbGV0IGN1cnJlbnRDYWNoZU5vZGUgPSBjYWNoZU5vZGU7XG4gICAgZm9yIChjb25zdCBhcmcgb2YgYXJncykge1xuICAgICAgaWYgKHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBhcmcgPT09ICdudW1iZXInKSB7XG4gICAgICAgIGlmIChjdXJyZW50Q2FjaGVOb2RlLnN0cm9uZyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgY3VycmVudENhY2hlTm9kZS5zdHJvbmcgPSBuZXcgTWFwKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFjdXJyZW50Q2FjaGVOb2RlLnN0cm9uZy5oYXMoYXJnKSkge1xuICAgICAgICAgIGN1cnJlbnRDYWNoZU5vZGUuc3Ryb25nLnNldChhcmcsIHtcbiAgICAgICAgICAgIHZhbHVlOiBlbXB0eUNhY2hlTm9kZSxcbiAgICAgICAgICAgIHN0cm9uZzogdW5kZWZpbmVkLFxuICAgICAgICAgICAgd2VhazogdW5kZWZpbmVkXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY3VycmVudENhY2hlTm9kZSA9IGN1cnJlbnRDYWNoZU5vZGUuc3Ryb25nLmdldChhcmcpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgYXJnID09PSAnb2JqZWN0Jykge1xuICAgICAgICBpZiAoY3VycmVudENhY2hlTm9kZS53ZWFrID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBjdXJyZW50Q2FjaGVOb2RlLndlYWsgPSBuZXcgV2Vha01hcCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY3VycmVudENhY2hlTm9kZS53ZWFrLmhhcyhhcmcpKSB7XG4gICAgICAgICAgY3VycmVudENhY2hlTm9kZS53ZWFrLnNldChhcmcsIHtcbiAgICAgICAgICAgIHZhbHVlOiBlbXB0eUNhY2hlTm9kZSxcbiAgICAgICAgICAgIHN0cm9uZzogdW5kZWZpbmVkLFxuICAgICAgICAgICAgd2VhazogdW5kZWZpbmVkXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY3VycmVudENhY2hlTm9kZSA9IGN1cnJlbnRDYWNoZU5vZGUud2Vhay5nZXQoYXJnKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjdXJyZW50Q2FjaGVOb2RlLnZhbHVlICE9PSBlbXB0eUNhY2hlTm9kZSkge1xuICAgICAgcmV0dXJuIGN1cnJlbnRDYWNoZU5vZGUudmFsdWU7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IGZ1bmMoLi4uYXJncyk7XG4gICAgY3VycmVudENhY2hlTm9kZS52YWx1ZSA9IHJlc3VsdDtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xufVxuXG5mdW5jdGlvbiBmaXhQYXRoKHBhdGgpIHtcbiAgcmV0dXJuIHBhdGgucmVwbGFjZSgvXlxcLj9cXC8rLywgJycpLnJlcGxhY2UoL1xcLyokLywgJycpO1xufVxuY29uc3QgY29sbGVjdGlvblBhdGggPSAvXFwvXFwqXFwqPyg/OiR8XFwvKS87XG5mdW5jdGlvbiBnZXRDb25maWd1cmVkQ29sbGVjdGlvblBhdGgoY29uZmlnLCBjb2xsZWN0aW9uKSB7XG4gIHZhciBfY29sbGVjdGlvbkNvbmZpZyRwYXQ7XG4gIGNvbnN0IGNvbGxlY3Rpb25Db25maWcgPSBjb25maWcuY29sbGVjdGlvbnNbY29sbGVjdGlvbl07XG4gIGNvbnN0IHBhdGggPSAoX2NvbGxlY3Rpb25Db25maWckcGF0ID0gY29sbGVjdGlvbkNvbmZpZy5wYXRoKSAhPT0gbnVsbCAmJiBfY29sbGVjdGlvbkNvbmZpZyRwYXQgIT09IHZvaWQgMCA/IF9jb2xsZWN0aW9uQ29uZmlnJHBhdCA6IGAke2NvbGxlY3Rpb259LyovYDtcbiAgaWYgKCFjb2xsZWN0aW9uUGF0aC50ZXN0KHBhdGgpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBDb2xsZWN0aW9uIHBhdGggbXVzdCBlbmQgd2l0aCAvKiBvciAvKiogb3IgaW5jbHVkZSAvKi8gb3IgLyoqLyBidXQgJHtjb2xsZWN0aW9ufSBoYXMgJHtwYXRofWApO1xuICB9XG4gIHJldHVybiBwYXRoO1xufVxuZnVuY3Rpb24gZ2V0Q29sbGVjdGlvblBhdGgoY29uZmlnLCBjb2xsZWN0aW9uKSB7XG4gIGNvbnN0IGNvbmZpZ3VyZWRQYXRoID0gZ2V0Q29uZmlndXJlZENvbGxlY3Rpb25QYXRoKGNvbmZpZywgY29sbGVjdGlvbik7XG4gIGNvbnN0IHBhdGggPSBmaXhQYXRoKGNvbmZpZ3VyZWRQYXRoLnJlcGxhY2UoL1xcKlxcKj8uKiQvLCAnJykpO1xuICByZXR1cm4gcGF0aDtcbn1cbmZ1bmN0aW9uIGdldENvbGxlY3Rpb25Gb3JtYXQoY29uZmlnLCBjb2xsZWN0aW9uKSB7XG4gIHJldHVybiBnZXRGb3JtYXRJbmZvKGNvbmZpZywgJ2NvbGxlY3Rpb25zJywgY29sbGVjdGlvbik7XG59XG5mdW5jdGlvbiBnZXRTaW5nbGV0b25Gb3JtYXQoY29uZmlnLCBzaW5nbGV0b24pIHtcbiAgcmV0dXJuIGdldEZvcm1hdEluZm8oY29uZmlnLCAnc2luZ2xldG9ucycsIHNpbmdsZXRvbik7XG59XG5mdW5jdGlvbiBnZXRDb2xsZWN0aW9uSXRlbVBhdGgoY29uZmlnLCBjb2xsZWN0aW9uLCBzbHVnKSB7XG4gIGNvbnN0IGJhc2VQYXRoID0gZ2V0Q29sbGVjdGlvblBhdGgoY29uZmlnLCBjb2xsZWN0aW9uKTtcbiAgY29uc3Qgc3VmZml4ID0gZ2V0Q29sbGVjdGlvbkl0ZW1TbHVnU3VmZml4KGNvbmZpZywgY29sbGVjdGlvbik7XG4gIHJldHVybiBgJHtiYXNlUGF0aH0vJHtzbHVnfSR7c3VmZml4fWA7XG59XG5mdW5jdGlvbiBnZXRFbnRyeURhdGFGaWxlcGF0aChkaXIsIGZvcm1hdEluZm8pIHtcbiAgcmV0dXJuIGAke2Rpcn0ke2Zvcm1hdEluZm8uZGF0YUxvY2F0aW9uID09PSAnaW5kZXgnID8gJy9pbmRleCcgOiAnJ30ke2dldERhdGFGaWxlRXh0ZW5zaW9uKGZvcm1hdEluZm8pfWA7XG59XG5mdW5jdGlvbiBnZXRTbHVnR2xvYkZvckNvbGxlY3Rpb24oY29uZmlnLCBjb2xsZWN0aW9uKSB7XG4gIGNvbnN0IGNvbGxlY3Rpb25QYXRoID0gZ2V0Q29uZmlndXJlZENvbGxlY3Rpb25QYXRoKGNvbmZpZywgY29sbGVjdGlvbik7XG4gIHJldHVybiBjb2xsZWN0aW9uUGF0aC5pbmNsdWRlcygnKionKSA/ICcqKicgOiAnKic7XG59XG5mdW5jdGlvbiBnZXRDb2xsZWN0aW9uSXRlbVNsdWdTdWZmaXgoY29uZmlnLCBjb2xsZWN0aW9uKSB7XG4gIGNvbnN0IGNvbmZpZ3VyZWRQYXRoID0gZ2V0Q29uZmlndXJlZENvbGxlY3Rpb25QYXRoKGNvbmZpZywgY29sbGVjdGlvbik7XG4gIGNvbnN0IHBhdGggPSBmaXhQYXRoKGNvbmZpZ3VyZWRQYXRoLnJlcGxhY2UoL15bXipdK1xcKlxcKj8vLCAnJykpO1xuICByZXR1cm4gcGF0aCA/IGAvJHtwYXRofWAgOiAnJztcbn1cbmZ1bmN0aW9uIGdldFNpbmdsZXRvblBhdGgoY29uZmlnLCBzaW5nbGV0b24pIHtcbiAgdmFyIF9zaW5nbGV0b24kcGF0aCwgX3NpbmdsZXRvbiRwYXRoMjtcbiAgaWYgKChfc2luZ2xldG9uJHBhdGggPSBjb25maWcuc2luZ2xldG9uc1tzaW5nbGV0b25dLnBhdGgpICE9PSBudWxsICYmIF9zaW5nbGV0b24kcGF0aCAhPT0gdm9pZCAwICYmIF9zaW5nbGV0b24kcGF0aC5pbmNsdWRlcygnKicpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBTaW5nbGV0b24gcGF0aHMgY2Fubm90IGluY2x1ZGUgKiBidXQgJHtzaW5nbGV0b259IGhhcyAke2NvbmZpZy5zaW5nbGV0b25zW3NpbmdsZXRvbl0ucGF0aH1gKTtcbiAgfVxuICByZXR1cm4gZml4UGF0aCgoX3NpbmdsZXRvbiRwYXRoMiA9IGNvbmZpZy5zaW5nbGV0b25zW3NpbmdsZXRvbl0ucGF0aCkgIT09IG51bGwgJiYgX3NpbmdsZXRvbiRwYXRoMiAhPT0gdm9pZCAwID8gX3NpbmdsZXRvbiRwYXRoMiA6IHNpbmdsZXRvbik7XG59XG5mdW5jdGlvbiBnZXREYXRhRmlsZUV4dGVuc2lvbihmb3JtYXRJbmZvKSB7XG4gIHJldHVybiBmb3JtYXRJbmZvLmNvbnRlbnRGaWVsZCA/IGZvcm1hdEluZm8uY29udGVudEZpZWxkLmNvbnRlbnRFeHRlbnNpb24gOiAnLicgKyBmb3JtYXRJbmZvLmRhdGE7XG59XG5jb25zdCBnZXRGb3JtYXRJbmZvID0gbWVtb2l6ZShfZ2V0Rm9ybWF0SW5mbyk7XG5mdW5jdGlvbiBfZ2V0Rm9ybWF0SW5mbyhjb25maWcsIHR5cGUsIGtleSkge1xuICB2YXIgX2NvbGxlY3Rpb25PclNpbmdsZXRvLCBfZm9ybWF0JGRhdGE7XG4gIGNvbnN0IGNvbGxlY3Rpb25PclNpbmdsZXRvbiA9IHR5cGUgPT09ICdjb2xsZWN0aW9ucycgPyBjb25maWcuY29sbGVjdGlvbnNba2V5XSA6IGNvbmZpZy5zaW5nbGV0b25zW2tleV07XG4gIGNvbnN0IHBhdGggPSB0eXBlID09PSAnY29sbGVjdGlvbnMnID8gZ2V0Q29uZmlndXJlZENvbGxlY3Rpb25QYXRoKGNvbmZpZywga2V5KSA6IChfY29sbGVjdGlvbk9yU2luZ2xldG8gPSBjb2xsZWN0aW9uT3JTaW5nbGV0b24ucGF0aCkgIT09IG51bGwgJiYgX2NvbGxlY3Rpb25PclNpbmdsZXRvICE9PSB2b2lkIDAgPyBfY29sbGVjdGlvbk9yU2luZ2xldG8gOiBgJHtrZXl9L2A7XG4gIGNvbnN0IGRhdGFMb2NhdGlvbiA9IHBhdGguZW5kc1dpdGgoJy8nKSA/ICdpbmRleCcgOiAnb3V0ZXInO1xuICBjb25zdCB7XG4gICAgc2NoZW1hLFxuICAgIGZvcm1hdCA9ICd5YW1sJ1xuICB9ID0gY29sbGVjdGlvbk9yU2luZ2xldG9uO1xuICBpZiAodHlwZW9mIGZvcm1hdCA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZGF0YUxvY2F0aW9uLFxuICAgICAgY29udGVudEZpZWxkOiB1bmRlZmluZWQsXG4gICAgICBkYXRhOiBmb3JtYXRcbiAgICB9O1xuICB9XG4gIGxldCBjb250ZW50RmllbGQ7XG4gIGlmIChmb3JtYXQuY29udGVudEZpZWxkKSB7XG4gICAgbGV0IGZpZWxkID0ge1xuICAgICAga2luZDogJ29iamVjdCcsXG4gICAgICBmaWVsZHM6IHNjaGVtYVxuICAgIH07XG4gICAgbGV0IHBhdGggPSBBcnJheS5pc0FycmF5KGZvcm1hdC5jb250ZW50RmllbGQpID8gZm9ybWF0LmNvbnRlbnRGaWVsZCA6IFtmb3JtYXQuY29udGVudEZpZWxkXTtcbiAgICBsZXQgY29udGVudEV4dGVuc2lvbjtcbiAgICB0cnkge1xuICAgICAgY29udGVudEV4dGVuc2lvbiA9IGdldENvbnRlbnRFeHRlbnNpb24ocGF0aCwgZmllbGQsICgpID0+IEpTT04uc3RyaW5naWZ5KGZvcm1hdC5jb250ZW50RmllbGQpKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBDb250ZW50RmllbGRMb2NhdGlvbkVycm9yKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtlcnIubWVzc2FnZX0gKCR7dHlwZX0uJHtrZXl9KWApO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICBjb250ZW50RmllbGQgPSB7XG4gICAgICBwYXRoLFxuICAgICAgY29udGVudEV4dGVuc2lvblxuICAgIH07XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBkYXRhOiAoX2Zvcm1hdCRkYXRhID0gZm9ybWF0LmRhdGEpICE9PSBudWxsICYmIF9mb3JtYXQkZGF0YSAhPT0gdm9pZCAwID8gX2Zvcm1hdCRkYXRhIDogJ3lhbWwnLFxuICAgIGNvbnRlbnRGaWVsZCxcbiAgICBkYXRhTG9jYXRpb25cbiAgfTtcbn1cbmNsYXNzIENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgfVxufVxuZnVuY3Rpb24gZ2V0Q29udGVudEV4dGVuc2lvbihwYXRoLCBzY2hlbWEsIGRlYnVnTmFtZSkge1xuICBpZiAocGF0aC5sZW5ndGggPT09IDApIHtcbiAgICBpZiAoc2NoZW1hLmtpbmQgIT09ICdmb3JtJyB8fCBzY2hlbWEuZm9ybUtpbmQgIT09ICdjb250ZW50Jykge1xuICAgICAgdGhyb3cgbmV3IENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IoYENvbnRlbnQgZmllbGQgZm9yICR7ZGVidWdOYW1lKCl9IGlzIG5vdCBhIGNvbnRlbnQgZmllbGRgKTtcbiAgICB9XG4gICAgcmV0dXJuIHNjaGVtYS5jb250ZW50RXh0ZW5zaW9uO1xuICB9XG4gIGlmIChzY2hlbWEua2luZCA9PT0gJ29iamVjdCcpIHtcbiAgICBjb25zdCBmaWVsZCA9IHNjaGVtYS5maWVsZHNbcGF0aFswXV07XG4gICAgaWYgKCFmaWVsZCkge1xuICAgICAgdGhyb3cgbmV3IENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IoYEZpZWxkICR7ZGVidWdOYW1lKCl9IHNwZWNpZmllZCBpbiBjb250ZW50RmllbGQgZG9lcyBub3QgZXhpc3RgKTtcbiAgICB9XG4gICAgcmV0dXJuIGdldENvbnRlbnRFeHRlbnNpb24ocGF0aC5zbGljZSgxKSwgZmllbGQsIGRlYnVnTmFtZSk7XG4gIH1cbiAgaWYgKHNjaGVtYS5raW5kID09PSAnY29uZGl0aW9uYWwnKSB7XG4gICAgaWYgKHBhdGhbMF0gIT09ICd2YWx1ZScpIHtcbiAgICAgIHRocm93IG5ldyBDb250ZW50RmllbGRMb2NhdGlvbkVycm9yKGBDb25kaXRpb25hbCBmaWVsZHMgcmVmZXJlbmNlZCBpbiBhIGNvbnRlbnRGaWVsZCBwYXRoIG11c3Qgb25seSByZWZlcmVuY2UgdGhlIHZhbHVlIGZpZWxkICgke2RlYnVnTmFtZSgpfSlgKTtcbiAgICB9XG4gICAgbGV0IGNvbnRlbnRFeHRlbnNpb247XG4gICAgY29uc3QgaW5uZXJQYXRoID0gcGF0aC5zbGljZSgxKTtcbiAgICBmb3IgKGNvbnN0IHZhbHVlIG9mIE9iamVjdC52YWx1ZXMoc2NoZW1hLnZhbHVlcykpIHtcbiAgICAgIGNvbnN0IGZvdW5kQ29udGVudEV4dGVuc2lvbiA9IGdldENvbnRlbnRFeHRlbnNpb24oaW5uZXJQYXRoLCB2YWx1ZSwgZGVidWdOYW1lKTtcbiAgICAgIGlmICghY29udGVudEV4dGVuc2lvbikge1xuICAgICAgICBjb250ZW50RXh0ZW5zaW9uID0gZm91bmRDb250ZW50RXh0ZW5zaW9uO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmIChjb250ZW50RXh0ZW5zaW9uICE9PSBmb3VuZENvbnRlbnRFeHRlbnNpb24pIHtcbiAgICAgICAgdGhyb3cgbmV3IENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IoYGNvbnRlbnRGaWVsZCAke2RlYnVnTmFtZSgpfSBoYXMgY29uZmxpY3RpbmcgY29udGVudCBleHRlbnNpb25zYCk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghY29udGVudEV4dGVuc2lvbikge1xuICAgICAgdGhyb3cgbmV3IENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IoYGNvbnRlbnRGaWVsZCAke2RlYnVnTmFtZSgpfSBkb2VzIG5vdCBwb2ludCB0byBhIGNvbnRlbnQgZmllbGRgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbnRlbnRFeHRlbnNpb247XG4gIH1cbiAgdGhyb3cgbmV3IENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IoYFBhdGggc3BlY2lmaWVkIGluIGNvbnRlbnRGaWVsZCAke2RlYnVnTmFtZSgpfSBkb2VzIG5vdCBwb2ludCB0byBhIGNvbnRlbnQgZmllbGRgKTtcbn1cblxuZnVuY3Rpb24gZ2V0U3JjUHJlZml4KHB1YmxpY1BhdGgsIHNsdWcpIHtcbiAgcmV0dXJuIHR5cGVvZiBwdWJsaWNQYXRoID09PSAnc3RyaW5nJyA/IGAke3B1YmxpY1BhdGgucmVwbGFjZSgvXFwvKiQvLCAnJyl9LyR7c2x1ZyA9PT0gdW5kZWZpbmVkID8gJycgOiBzbHVnICsgJy8nfWAgOiAnJztcbn1cblxuZnVuY3Rpb24gZGVzZXJpYWxpemVGaWxlcyhub2RlcywgY29tcG9uZW50QmxvY2tzLCBmaWxlcywgb3RoZXJGaWxlcywgbW9kZSwgZG9jdW1lbnRGZWF0dXJlcywgc2x1Zykge1xuICByZXR1cm4gbm9kZXMubWFwKG5vZGUgPT4ge1xuICAgIGlmIChub2RlLnR5cGUgPT09ICdjb21wb25lbnQtYmxvY2snKSB7XG4gICAgICBjb25zdCBjb21wb25lbnRCbG9jayA9IGNvbXBvbmVudEJsb2Nrc1tub2RlLmNvbXBvbmVudF07XG4gICAgICBpZiAoIWNvbXBvbmVudEJsb2NrKSByZXR1cm4gbm9kZTtcbiAgICAgIGNvbnN0IHNjaGVtYSA9IG9iamVjdChjb21wb25lbnRCbG9jay5zY2hlbWEpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4ubm9kZSxcbiAgICAgICAgcHJvcHM6IGRlc2VyaWFsaXplUHJvcHMoc2NoZW1hLCBub2RlLnByb3BzLCBmaWxlcywgb3RoZXJGaWxlcywgbW9kZSwgc2x1ZylcbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChub2RlLnR5cGUgPT09ICdpbWFnZScgJiYgdHlwZW9mIG5vZGUuc3JjID09PSAnc3RyaW5nJyAmJiBtb2RlID09PSAnZWRpdCcpIHtcbiAgICAgIHZhciBfcmVmO1xuICAgICAgY29uc3QgcHJlZml4ID0gZ2V0U3JjUHJlZml4Rm9ySW1hZ2VCbG9jayhkb2N1bWVudEZlYXR1cmVzLCBzbHVnKTtcbiAgICAgIGNvbnN0IGZpbGVuYW1lID0gbm9kZS5zcmMuc2xpY2UocHJlZml4Lmxlbmd0aCk7XG4gICAgICBjb25zdCBjb250ZW50ID0gKF9yZWYgPSB0eXBlb2YgZG9jdW1lbnRGZWF0dXJlcy5pbWFnZXMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBkb2N1bWVudEZlYXR1cmVzLmltYWdlcy5kaXJlY3RvcnkgPT09ICdzdHJpbmcnID8gb3RoZXJGaWxlcy5nZXQoZml4UGF0aChkb2N1bWVudEZlYXR1cmVzLmltYWdlcy5kaXJlY3RvcnkpKSA6IGZpbGVzKSA9PT0gbnVsbCB8fCBfcmVmID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcmVmLmdldChmaWxlbmFtZSk7XG4gICAgICBpZiAoIWNvbnRlbnQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiAncGFyYWdyYXBoJyxcbiAgICAgICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgICAgIHRleHQ6IGBNaXNzaW5nIGltYWdlICR7ZmlsZW5hbWV9YFxuICAgICAgICAgIH1dXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnaW1hZ2UnLFxuICAgICAgICBzcmM6IHtcbiAgICAgICAgICBmaWxlbmFtZSxcbiAgICAgICAgICBjb250ZW50XG4gICAgICAgIH0sXG4gICAgICAgIGFsdDogbm9kZS5hbHQsXG4gICAgICAgIHRpdGxlOiBub2RlLnRpdGxlLFxuICAgICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgICB0ZXh0OiAnJ1xuICAgICAgICB9XVxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBub2RlLnR5cGUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBjb25zdCBjaGlsZHJlbiA9IGRlc2VyaWFsaXplRmlsZXMobm9kZS5jaGlsZHJlbiwgY29tcG9uZW50QmxvY2tzLCBmaWxlcywgb3RoZXJGaWxlcywgbW9kZSwgZG9jdW1lbnRGZWF0dXJlcywgc2x1Zyk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5ub2RlLFxuICAgICAgICBjaGlsZHJlblxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIG5vZGU7XG4gIH0pO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVQcm9wcyhzY2hlbWEsIHZhbHVlLCBmaWxlcywgb3RoZXJGaWxlcywgbW9kZSwgc2x1Zykge1xuICByZXR1cm4gdHJhbnNmb3JtUHJvcHMoc2NoZW1hLCB2YWx1ZSwge1xuICAgIGZvcm06IChzY2hlbWEsIHZhbHVlKSA9PiB7XG4gICAgICBpZiAoc2NoZW1hLmZvcm1LaW5kID09PSAnYXNzZXQnKSB7XG4gICAgICAgIHZhciBfb3RoZXJGaWxlcyRnZXQ7XG4gICAgICAgIGlmIChtb2RlID09PSAncmVhZCcpIHtcbiAgICAgICAgICByZXR1cm4gc2NoZW1hLnJlYWRlci5wYXJzZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBzY2hlbWEuZmlsZW5hbWUodmFsdWUsIHtcbiAgICAgICAgICBzbHVnLFxuICAgICAgICAgIHN1Z2dlc3RlZEZpbGVuYW1lUHJlZml4OiB1bmRlZmluZWRcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzY2hlbWEucGFyc2UodmFsdWUsIHtcbiAgICAgICAgICBhc3NldDogZmlsZW5hbWUgPyBzY2hlbWEuZGlyZWN0b3J5ID8gKF9vdGhlckZpbGVzJGdldCA9IG90aGVyRmlsZXMuZ2V0KHNjaGVtYS5kaXJlY3RvcnkpKSA9PT0gbnVsbCB8fCBfb3RoZXJGaWxlcyRnZXQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9vdGhlckZpbGVzJGdldC5nZXQoZmlsZW5hbWUpIDogZmlsZXMuZ2V0KGZpbGVuYW1lKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICBzbHVnXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHNjaGVtYS5mb3JtS2luZCA9PT0gJ2NvbnRlbnQnIHx8IHNjaGVtYS5mb3JtS2luZCA9PT0gJ2Fzc2V0cycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOb3QgaW1wbGVtZW50ZWQnKTtcbiAgICAgIH1cbiAgICAgIGlmIChtb2RlID09PSAncmVhZCcpIHtcbiAgICAgICAgcmV0dXJuIHNjaGVtYS5yZWFkZXIucGFyc2UodmFsdWUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNjaGVtYS5wYXJzZSh2YWx1ZSwgdW5kZWZpbmVkKTtcbiAgICB9XG4gIH0pO1xufVxuZnVuY3Rpb24gZ2V0U3JjUHJlZml4Rm9ySW1hZ2VCbG9jayhkb2N1bWVudEZlYXR1cmVzLCBzbHVnKSB7XG4gIHJldHVybiBnZXRTcmNQcmVmaXgodHlwZW9mIGRvY3VtZW50RmVhdHVyZXMuaW1hZ2VzID09PSAnb2JqZWN0JyA/IGRvY3VtZW50RmVhdHVyZXMuaW1hZ2VzLnB1YmxpY1BhdGggOiB1bmRlZmluZWQsIHNsdWcpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBzaGExKGNvbnRlbnQpIHtcbiAgcmV0dXJuIGNyZWF0ZUhhc2goJ3NoYTEnKS51cGRhdGUoY29udGVudCkuZGlnZXN0KCdoZXgnKTtcbn1cblxuY29uc3QgdGV4dEVuY29kZXIkMSA9IG5ldyBUZXh0RW5jb2RlcigpO1xuY29uc3QgYmxvYlNoYUNhY2hlID0gbmV3IFdlYWtNYXAoKTtcbmFzeW5jIGZ1bmN0aW9uIGJsb2JTaGEoY29udGVudHMpIHtcbiAgY29uc3QgY2FjaGVkID0gYmxvYlNoYUNhY2hlLmdldChjb250ZW50cyk7XG4gIGlmIChjYWNoZWQgIT09IHVuZGVmaW5lZCkgcmV0dXJuIGNhY2hlZDtcbiAgY29uc3QgYmxvYlByZWZpeCA9IHRleHRFbmNvZGVyJDEuZW5jb2RlKCdibG9iICcgKyBjb250ZW50cy5sZW5ndGggKyAnXFwwJyk7XG4gIGNvbnN0IGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYmxvYlByZWZpeC5ieXRlTGVuZ3RoICsgY29udGVudHMuYnl0ZUxlbmd0aCk7XG4gIGFycmF5LnNldChibG9iUHJlZml4LCAwKTtcbiAgYXJyYXkuc2V0KGNvbnRlbnRzLCBibG9iUHJlZml4LmJ5dGVMZW5ndGgpO1xuICBjb25zdCBkaWdlc3RQcm9taXNlID0gc2hhMShhcnJheSk7XG4gIGJsb2JTaGFDYWNoZS5zZXQoY29udGVudHMsIGRpZ2VzdFByb21pc2UpO1xuICBkaWdlc3RQcm9taXNlLnRoZW4oZGlnZXN0ID0+IGJsb2JTaGFDYWNoZS5zZXQoY29udGVudHMsIGRpZ2VzdCkpO1xuICByZXR1cm4gZGlnZXN0UHJvbWlzZTtcbn1cbmZ1bmN0aW9uIGdldFRyZWVOb2RlQXRQYXRoKHJvb3QsIHBhdGgpIHtcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XG4gIGxldCBub2RlID0gcm9vdC5nZXQocGFydHNbMF0pO1xuICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMuc2xpY2UoMSkpIHtcbiAgICBpZiAoIW5vZGUpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgaWYgKCFub2RlLmNoaWxkcmVuKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIG5vZGUgPSBub2RlLmNoaWxkcmVuLmdldChwYXJ0KTtcbiAgfVxuICByZXR1cm4gbm9kZTtcbn1cbmZ1bmN0aW9uIGdldE5vZGVBdFBhdGgodHJlZSwgcGF0aCkge1xuICBpZiAocGF0aCA9PT0gJycpIHJldHVybiB0cmVlO1xuICBsZXQgbm9kZSA9IHRyZWU7XG4gIGZvciAoY29uc3QgcGFydCBvZiBwYXRoLnNwbGl0KCcvJykpIHtcbiAgICBpZiAoIW5vZGUuaGFzKHBhcnQpKSB7XG4gICAgICBub2RlLnNldChwYXJ0LCBuZXcgTWFwKCkpO1xuICAgIH1cbiAgICBjb25zdCBpbm5lck5vZGUgPSBub2RlLmdldChwYXJ0KTtcbiAgICBhc3NlcnQoaW5uZXJOb2RlIGluc3RhbmNlb2YgTWFwLCAnZXhwZWN0ZWQgdHJlZScpO1xuICAgIG5vZGUgPSBpbm5lck5vZGU7XG4gIH1cbiAgcmV0dXJuIG5vZGU7XG59XG5mdW5jdGlvbiBnZXRGaWxlbmFtZShwYXRoKSB7XG4gIHJldHVybiBwYXRoLnJlcGxhY2UoLy4qXFwvLywgJycpO1xufVxuZnVuY3Rpb24gZ2V0RGlybmFtZShwYXRoKSB7XG4gIGlmICghcGF0aC5pbmNsdWRlcygnLycpKSByZXR1cm4gJyc7XG4gIHJldHVybiBwYXRoLnJlcGxhY2UoL1xcL1teL10rJC8sICcnKTtcbn1cbmZ1bmN0aW9uIHRvVHJlZUNoYW5nZXMoY2hhbmdlcykge1xuICBjb25zdCBjaGFuZ2VzUm9vdCA9IG5ldyBNYXAoKTtcbiAgZm9yIChjb25zdCBkZWxldGlvbiBvZiBjaGFuZ2VzLmRlbGV0aW9ucykge1xuICAgIGNvbnN0IHBhcmVudFRyZWUgPSBnZXROb2RlQXRQYXRoKGNoYW5nZXNSb290LCBnZXREaXJuYW1lKGRlbGV0aW9uKSk7XG4gICAgcGFyZW50VHJlZS5zZXQoZ2V0RmlsZW5hbWUoZGVsZXRpb24pLCAnZGVsZXRlJyk7XG4gIH1cbiAgZm9yIChjb25zdCBhZGRpdGlvbiBvZiBjaGFuZ2VzLmFkZGl0aW9ucykge1xuICAgIGNvbnN0IHBhcmVudFRyZWUgPSBnZXROb2RlQXRQYXRoKGNoYW5nZXNSb290LCBnZXREaXJuYW1lKGFkZGl0aW9uLnBhdGgpKTtcbiAgICBwYXJlbnRUcmVlLnNldChnZXRGaWxlbmFtZShhZGRpdGlvbi5wYXRoKSwgYWRkaXRpb24uY29udGVudHMpO1xuICB9XG4gIHJldHVybiBjaGFuZ2VzUm9vdDtcbn1cbmNvbnN0IFNQQUNFX0NIQVJfQ09ERSA9IDMyO1xuY29uc3Qgc3BhY2UgPSBuZXcgVWludDhBcnJheShbU1BBQ0VfQ0hBUl9DT0RFXSk7XG5jb25zdCBudWxsY2hhciA9IG5ldyBVaW50OEFycmF5KFswXSk7XG5jb25zdCB0cmVlID0gdGV4dEVuY29kZXIkMS5lbmNvZGUoJ3RyZWUgJyk7XG5cbi8vIGJhc2VkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS9pc29tb3JwaGljLWdpdC9pc29tb3JwaGljLWdpdC9ibG9iL2MwOWRmYTIwZmZlMGFiOWU2NjAyZTBmYTE3MmQ3MmJhODk5NGU0NDMvc3JjL21vZGVscy9HaXRUcmVlLmpzI0wxMDgtTDEyMlxuZnVuY3Rpb24gdHJlZVNoYShjaGlsZHJlbikge1xuICBjb25zdCBlbnRyaWVzID0gWy4uLmNoaWxkcmVuXS5tYXAoKFtuYW1lLCBub2RlXSkgPT4gKHtcbiAgICBuYW1lLFxuICAgIHNoYTogbm9kZS5lbnRyeS5zaGEsXG4gICAgbW9kZTogbm9kZS5lbnRyeS5tb2RlXG4gIH0pKTtcbiAgZW50cmllcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgY29uc3QgYU5hbWUgPSBhLm1vZGUgPT09ICcwNDAwMDAnID8gYS5uYW1lICsgJy8nIDogYS5uYW1lO1xuICAgIGNvbnN0IGJOYW1lID0gYi5tb2RlID09PSAnMDQwMDAwJyA/IGIubmFtZSArICcvJyA6IGIubmFtZTtcbiAgICByZXR1cm4gYU5hbWUgPT09IGJOYW1lID8gMCA6IGFOYW1lIDwgYk5hbWUgPyAtMSA6IDE7XG4gIH0pO1xuICBjb25zdCB0cmVlT2JqZWN0ID0gZW50cmllcy5mbGF0TWFwKGVudHJ5ID0+IHtcbiAgICBjb25zdCBtb2RlID0gdGV4dEVuY29kZXIkMS5lbmNvZGUoZW50cnkubW9kZS5yZXBsYWNlKC9eMC8sICcnKSk7XG4gICAgY29uc3QgbmFtZSA9IHRleHRFbmNvZGVyJDEuZW5jb2RlKGVudHJ5Lm5hbWUpO1xuICAgIGNvbnN0IHNoYSA9IGhleFRvQnl0ZXMoZW50cnkuc2hhKTtcbiAgICByZXR1cm4gW21vZGUsIHNwYWNlLCBuYW1lLCBudWxsY2hhciwgc2hhXTtcbiAgfSk7XG4gIHJldHVybiBzaGExKGNvbmNhdEJ5dGVzKFt0cmVlLCB0ZXh0RW5jb2RlciQxLmVuY29kZSh0cmVlT2JqZWN0LnJlZHVjZSgoc3VtLCB2YWwpID0+IHN1bSArIHZhbC5ieXRlTGVuZ3RoLCAwKS50b1N0cmluZygpKSwgbnVsbGNoYXIsIC4uLnRyZWVPYmplY3RdKSk7XG59XG5mdW5jdGlvbiBjb25jYXRCeXRlcyhieXRlQXJyYXlzKSB7XG4gIGNvbnN0IHRvdGFsTGVuZ3RoID0gYnl0ZUFycmF5cy5yZWR1Y2UoKHN1bSwgYXJyKSA9PiBzdW0gKyBhcnIuYnl0ZUxlbmd0aCwgMCk7XG4gIGNvbnN0IHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KHRvdGFsTGVuZ3RoKTtcbiAgbGV0IG9mZnNldCA9IDA7XG4gIGZvciAoY29uc3QgYXJyIG9mIGJ5dGVBcnJheXMpIHtcbiAgICByZXN1bHQuc2V0KGFyciwgb2Zmc2V0KTtcbiAgICBvZmZzZXQgKz0gYXJyLmJ5dGVMZW5ndGg7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGhleFRvQnl0ZXMoc3RyKSB7XG4gIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoc3RyLmxlbmd0aCAvIDIpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzLmJ5dGVMZW5ndGg7IGkgKz0gMSkge1xuICAgIGNvbnN0IHN0YXJ0ID0gaSAqIDI7XG4gICAgYnl0ZXNbaV0gPSBwYXJzZUludChzdHIuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgMiksIDE2KTtcbiAgfVxuICByZXR1cm4gYnl0ZXM7XG59XG5hc3luYyBmdW5jdGlvbiBjcmVhdGVUcmVlTm9kZUVudHJ5KHBhdGgsIGNoaWxkcmVuKSB7XG4gIGNvbnN0IHNoYSA9IGF3YWl0IHRyZWVTaGEoY2hpbGRyZW4pO1xuICByZXR1cm4ge1xuICAgIHBhdGgsXG4gICAgbW9kZTogJzA0MDAwMCcsXG4gICAgdHlwZTogJ3RyZWUnLFxuICAgIHNoYVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlQmxvYk5vZGVFbnRyeShwYXRoLCBjb250ZW50cykge1xuICBjb25zdCBzaGEgPSAnc2hhJyBpbiBjb250ZW50cyA/IGNvbnRlbnRzLnNoYSA6IGF3YWl0IGJsb2JTaGEoY29udGVudHMpO1xuICByZXR1cm4ge1xuICAgIHBhdGgsXG4gICAgbW9kZTogJzEwMDY0NCcsXG4gICAgdHlwZTogJ2Jsb2InLFxuICAgIHNoYVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlVHJlZVdpdGhDaGFuZ2VzKHRyZWUsIGNoYW5nZXMpIHtcbiAgdmFyIF9hd2FpdCR1cGRhdGVUcmVlO1xuICBjb25zdCBuZXdUcmVlID0gKF9hd2FpdCR1cGRhdGVUcmVlID0gYXdhaXQgdXBkYXRlVHJlZSh0cmVlLCB0b1RyZWVDaGFuZ2VzKGNoYW5nZXMpLCBbXSkpICE9PSBudWxsICYmIF9hd2FpdCR1cGRhdGVUcmVlICE9PSB2b2lkIDAgPyBfYXdhaXQkdXBkYXRlVHJlZSA6IG5ldyBNYXAoKTtcbiAgcmV0dXJuIHtcbiAgICBlbnRyaWVzOiB0cmVlVG9FbnRyaWVzKG5ld1RyZWUpLFxuICAgIHNoYTogYXdhaXQgdHJlZVNoYShuZXdUcmVlICE9PSBudWxsICYmIG5ld1RyZWUgIT09IHZvaWQgMCA/IG5ld1RyZWUgOiBuZXcgTWFwKCkpXG4gIH07XG59XG5mdW5jdGlvbiB0cmVlVG9FbnRyaWVzKHRyZWUpIHtcbiAgcmV0dXJuIFsuLi50cmVlLnZhbHVlcygpXS5mbGF0TWFwKHggPT4geC5jaGlsZHJlbiA/IFt4LmVudHJ5LCAuLi50cmVlVG9FbnRyaWVzKHguY2hpbGRyZW4pXSA6IFt4LmVudHJ5XSk7XG59XG5hc3luYyBmdW5jdGlvbiB1cGRhdGVUcmVlKHRyZWUsIGNoYW5nZWRUcmVlLCBwYXRoKSB7XG4gIGNvbnN0IG5ld1RyZWUgPSBuZXcgTWFwKHRyZWUpO1xuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBjaGFuZ2VkVHJlZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gJ2RlbGV0ZScpIHtcbiAgICAgIG5ld1RyZWUuZGVsZXRlKGtleSk7XG4gICAgfVxuICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE1hcCkge1xuICAgICAgdmFyIF9uZXdUcmVlJGdldCRjaGlsZHJlbiwgX25ld1RyZWUkZ2V0O1xuICAgICAgY29uc3QgZXhpc3RpbmdDaGlsZHJlbiA9IChfbmV3VHJlZSRnZXQkY2hpbGRyZW4gPSAoX25ld1RyZWUkZ2V0ID0gbmV3VHJlZS5nZXQoa2V5KSkgPT09IG51bGwgfHwgX25ld1RyZWUkZ2V0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbmV3VHJlZSRnZXQuY2hpbGRyZW4pICE9PSBudWxsICYmIF9uZXdUcmVlJGdldCRjaGlsZHJlbiAhPT0gdm9pZCAwID8gX25ld1RyZWUkZ2V0JGNoaWxkcmVuIDogbmV3IE1hcCgpO1xuICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB1cGRhdGVUcmVlKGV4aXN0aW5nQ2hpbGRyZW4sIHZhbHVlLCBwYXRoLmNvbmNhdChrZXkpKTtcbiAgICAgIGlmIChjaGlsZHJlbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG5ld1RyZWUuZGVsZXRlKGtleSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgZW50cnkgPSBhd2FpdCBjcmVhdGVUcmVlTm9kZUVudHJ5KHBhdGguY29uY2F0KGtleSkuam9pbignLycpLCBjaGlsZHJlbik7XG4gICAgICBuZXdUcmVlLnNldChrZXksIHtcbiAgICAgICAgZW50cnksXG4gICAgICAgIGNoaWxkcmVuXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSB8fCB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmICdzaGEnIGluIHZhbHVlKSB7XG4gICAgICBjb25zdCBlbnRyeSA9IGF3YWl0IGNyZWF0ZUJsb2JOb2RlRW50cnkocGF0aC5jb25jYXQoa2V5KS5qb2luKCcvJyksIHZhbHVlKTtcbiAgICAgIG5ld1RyZWUuc2V0KGtleSwge1xuICAgICAgICBlbnRyeVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGlmIChuZXdUcmVlLnNpemUgPT09IDApIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIHJldHVybiBuZXdUcmVlO1xufVxuZnVuY3Rpb24gdHJlZUVudHJpZXNUb1RyZWVOb2RlcyhlbnRyaWVzKSB7XG4gIGNvbnN0IHJvb3QgPSBuZXcgTWFwKCk7XG4gIGNvbnN0IGdldENoaWxkcmVuQXRQYXRoID0gcGFydHMgPT4ge1xuICAgIHZhciBfbm9kZTtcbiAgICBpZiAocGFydHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gcm9vdDtcbiAgICB9XG4gICAgbGV0IG5vZGUgPSByb290LmdldChwYXJ0c1swXSk7XG4gICAgZm9yIChjb25zdCBwYXJ0IG9mIHBhcnRzLnNsaWNlKDEpKSB7XG4gICAgICBpZiAoIW5vZGUpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICBpZiAoIW5vZGUuY2hpbGRyZW4pIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICBub2RlID0gbm9kZS5jaGlsZHJlbi5nZXQocGFydCk7XG4gICAgfVxuICAgIHJldHVybiAoX25vZGUgPSBub2RlKSA9PT0gbnVsbCB8fCBfbm9kZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX25vZGUuY2hpbGRyZW47XG4gIH07XG4gIGZvciAoY29uc3QgZW50cnkgb2YgZW50cmllcykge1xuICAgIGNvbnN0IHNwbGl0ID0gZW50cnkucGF0aC5zcGxpdCgnLycpO1xuICAgIGNvbnN0IGNoaWxkcmVuID0gZ2V0Q2hpbGRyZW5BdFBhdGgoc3BsaXQuc2xpY2UoMCwgLTEpKTtcbiAgICBpZiAoY2hpbGRyZW4pIHtcbiAgICAgIGNoaWxkcmVuLnNldChzcGxpdFtzcGxpdC5sZW5ndGggLSAxXSwge1xuICAgICAgICBlbnRyeSxcbiAgICAgICAgY2hpbGRyZW46IGVudHJ5LnR5cGUgPT09ICd0cmVlJyA/IG5ldyBNYXAoKSA6IHVuZGVmaW5lZFxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIHJldHVybiByb290O1xufVxuXG5mdW5jdGlvbiBjb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWFJbm5lcihzY2hlbWEsIGRpcmVjdG9yaWVzLCBzZWVuU2NoZW1hcykge1xuICBpZiAoc2VlblNjaGVtYXMuaGFzKHNjaGVtYSkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgc2VlblNjaGVtYXMuYWRkKHNjaGVtYSk7XG4gIGlmIChzY2hlbWEua2luZCA9PT0gJ2FycmF5Jykge1xuICAgIHJldHVybiBjb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWFJbm5lcihzY2hlbWEuZWxlbWVudCwgZGlyZWN0b3JpZXMsIHNlZW5TY2hlbWFzKTtcbiAgfVxuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdjaGlsZCcpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKHNjaGVtYS5raW5kID09PSAnZm9ybScpIHtcbiAgICBpZiAoc2NoZW1hLmZvcm1LaW5kID09PSAnYXNzZXQnICYmIHNjaGVtYS5kaXJlY3RvcnkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZGlyZWN0b3JpZXMuYWRkKGZpeFBhdGgoc2NoZW1hLmRpcmVjdG9yeSkpO1xuICAgIH1cbiAgICBpZiAoKHNjaGVtYS5mb3JtS2luZCA9PT0gJ2NvbnRlbnQnIHx8IHNjaGVtYS5mb3JtS2luZCA9PT0gJ2Fzc2V0cycpICYmIHNjaGVtYS5kaXJlY3RvcmllcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBmb3IgKGNvbnN0IGRpcmVjdG9yeSBvZiBzY2hlbWEuZGlyZWN0b3JpZXMpIHtcbiAgICAgICAgZGlyZWN0b3JpZXMuYWRkKGZpeFBhdGgoZGlyZWN0b3J5KSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybjtcbiAgfVxuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdvYmplY3QnKSB7XG4gICAgZm9yIChjb25zdCBmaWVsZCBvZiBPYmplY3QudmFsdWVzKHNjaGVtYS5maWVsZHMpKSB7XG4gICAgICBjb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWFJbm5lcihmaWVsZCwgZGlyZWN0b3JpZXMsIHNlZW5TY2hlbWFzKTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChzY2hlbWEua2luZCA9PT0gJ2NvbmRpdGlvbmFsJykge1xuICAgIGZvciAoY29uc3QgaW5uZXJTY2hlbWEgb2YgT2JqZWN0LnZhbHVlcyhzY2hlbWEudmFsdWVzKSkge1xuICAgICAgY29sbGVjdERpcmVjdG9yaWVzVXNlZEluU2NoZW1hSW5uZXIoaW5uZXJTY2hlbWEsIGRpcmVjdG9yaWVzLCBzZWVuU2NoZW1hcyk7XG4gICAgfVxuICAgIHJldHVybjtcbiAgfVxuICBhc3NlcnROZXZlciQxKHNjaGVtYSk7XG59XG5mdW5jdGlvbiBjb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWEoc2NoZW1hKSB7XG4gIGNvbnN0IGRpcmVjdG9yaWVzID0gbmV3IFNldCgpO1xuICBjb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWFJbm5lcihzY2hlbWEsIGRpcmVjdG9yaWVzLCBuZXcgU2V0KCkpO1xuICByZXR1cm4gZGlyZWN0b3JpZXM7XG59XG5mdW5jdGlvbiBnZXREaXJlY3Rvcmllc0ZvclRyZWVLZXkoc2NoZW1hLCBkaXJlY3RvcnksIHNsdWcsIGZvcm1hdCkge1xuICBjb25zdCBkaXJlY3RvcmllcyA9IFtmaXhQYXRoKGRpcmVjdG9yeSldO1xuICBpZiAoZm9ybWF0LmRhdGFMb2NhdGlvbiA9PT0gJ291dGVyJykge1xuICAgIGRpcmVjdG9yaWVzLnB1c2goZml4UGF0aChkaXJlY3RvcnkpICsgZ2V0RGF0YUZpbGVFeHRlbnNpb24oZm9ybWF0KSk7XG4gIH1cbiAgY29uc3QgdG9BZGQgPSBzbHVnID09PSB1bmRlZmluZWQgPyAnJyA6IGAvJHtzbHVnfWA7XG4gIGZvciAoY29uc3QgZGlyZWN0b3J5IG9mIGNvbGxlY3REaXJlY3Rvcmllc1VzZWRJblNjaGVtYShzY2hlbWEpKSB7XG4gICAgZGlyZWN0b3JpZXMucHVzaChkaXJlY3RvcnkgKyB0b0FkZCk7XG4gIH1cbiAgcmV0dXJuIGRpcmVjdG9yaWVzO1xufVxuXG5jb25zdCB0ZXh0RGVjb2RlciQxID0gbmV3IFRleHREZWNvZGVyKCk7XG5jb25zdCBkZWZhdWx0QWx0RmllbGQkMSA9IHRleHQoe1xuICBsYWJlbDogJ0FsdCB0ZXh0JyxcbiAgZGVzY3JpcHRpb246ICdUaGlzIHRleHQgd2lsbCBiZSB1c2VkIGJ5IHNjcmVlbiByZWFkZXJzIGFuZCBzZWFyY2ggZW5naW5lcy4nXG59KTtcbmNvbnN0IGVtcHR5VGl0bGVGaWVsZCQxID0gYmFzaWNGb3JtRmllbGRXaXRoU2ltcGxlUmVhZGVyUGFyc2Uoe1xuICBJbnB1dCgpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfSxcbiAgZGVmYXVsdFZhbHVlKCkge1xuICAgIHJldHVybiAnJztcbiAgfSxcbiAgcGFyc2UodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuICcnO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgc3RyaW5nJyk7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfSxcbiAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH0sXG4gIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgIHJldHVybiB7XG4gICAgICB2YWx1ZVxuICAgIH07XG4gIH0sXG4gIGxhYmVsOiAnVGl0bGUnXG59KTtcbmZ1bmN0aW9uIG5vcm1hbGlzZURvY3VtZW50RmVhdHVyZXMoY29uZmlnKSB7XG4gIHZhciBfY29uZmlnJGZvcm1hdHRpbmcsIF9mb3JtYXR0aW5nJGFsaWdubWVudCwgX2Zvcm1hdHRpbmckYWxpZ25tZW50MiwgX2Zvcm1hdHRpbmckYmxvY2tUeXBlLCBfZm9ybWF0dGluZyRpbmxpbmVNYXIsIF9mb3JtYXR0aW5nJGlubGluZU1hcjIsIF9mb3JtYXR0aW5nJGlubGluZU1hcjMsIF9mb3JtYXR0aW5nJGlubGluZU1hcjQsIF9mb3JtYXR0aW5nJGlubGluZU1hcjUsIF9mb3JtYXR0aW5nJGlubGluZU1hcjYsIF9mb3JtYXR0aW5nJGlubGluZU1hcjcsIF9mb3JtYXR0aW5nJGlubGluZU1hcjgsIF9mb3JtYXR0aW5nJGxpc3RUeXBlcywgX2Zvcm1hdHRpbmckbGlzdFR5cGVzMiwgX2ltYWdlc0NvbmZpZyRzY2hlbWEkLCBfaW1hZ2VzQ29uZmlnJHNjaGVtYSwgX2ltYWdlc0NvbmZpZyRzY2hlbWEkMiwgX2ltYWdlc0NvbmZpZyRzY2hlbWEyO1xuICBjb25zdCBmb3JtYXR0aW5nID0gY29uZmlnLmZvcm1hdHRpbmcgPT09IHRydWUgPyB7XG4gICAgLy8gYWxpZ25tZW50OiB0cnVlLCAvLyBub3Qgc3VwcG9ydGVkIG5hdGl2ZWx5IGluIG1hcmtkb3duXG4gICAgYmxvY2tUeXBlczogdHJ1ZSxcbiAgICBoZWFkaW5nTGV2ZWxzOiB0cnVlLFxuICAgIGlubGluZU1hcmtzOiB0cnVlLFxuICAgIGxpc3RUeXBlczogdHJ1ZSxcbiAgICBzb2Z0QnJlYWtzOiB0cnVlXG4gIH0gOiAoX2NvbmZpZyRmb3JtYXR0aW5nID0gY29uZmlnLmZvcm1hdHRpbmcpICE9PSBudWxsICYmIF9jb25maWckZm9ybWF0dGluZyAhPT0gdm9pZCAwID8gX2NvbmZpZyRmb3JtYXR0aW5nIDoge307XG4gIGNvbnN0IGltYWdlc0NvbmZpZyA9IGNvbmZpZy5pbWFnZXMgPT09IHRydWUgPyB7fSA6IGNvbmZpZy5pbWFnZXM7XG4gIHJldHVybiB7XG4gICAgZm9ybWF0dGluZzoge1xuICAgICAgYWxpZ25tZW50OiBmb3JtYXR0aW5nLmFsaWdubWVudCA9PT0gdHJ1ZSA/IHtcbiAgICAgICAgY2VudGVyOiB0cnVlLFxuICAgICAgICBlbmQ6IHRydWVcbiAgICAgIH0gOiB7XG4gICAgICAgIGNlbnRlcjogISEoKF9mb3JtYXR0aW5nJGFsaWdubWVudCA9IGZvcm1hdHRpbmcuYWxpZ25tZW50KSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRhbGlnbm1lbnQgIT09IHZvaWQgMCAmJiBfZm9ybWF0dGluZyRhbGlnbm1lbnQuY2VudGVyKSxcbiAgICAgICAgZW5kOiAhISgoX2Zvcm1hdHRpbmckYWxpZ25tZW50MiA9IGZvcm1hdHRpbmcuYWxpZ25tZW50KSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRhbGlnbm1lbnQyICE9PSB2b2lkIDAgJiYgX2Zvcm1hdHRpbmckYWxpZ25tZW50Mi5lbmQpXG4gICAgICB9LFxuICAgICAgYmxvY2tUeXBlczogKGZvcm1hdHRpbmcgPT09IG51bGwgfHwgZm9ybWF0dGluZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogZm9ybWF0dGluZy5ibG9ja1R5cGVzKSA9PT0gdHJ1ZSA/IHtcbiAgICAgICAgYmxvY2txdW90ZTogdHJ1ZSxcbiAgICAgICAgY29kZToge1xuICAgICAgICAgIHNjaGVtYTogb2JqZWN0KHt9KVxuICAgICAgICB9XG4gICAgICB9IDoge1xuICAgICAgICBibG9ja3F1b3RlOiAhISgoX2Zvcm1hdHRpbmckYmxvY2tUeXBlID0gZm9ybWF0dGluZy5ibG9ja1R5cGVzKSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRibG9ja1R5cGUgIT09IHZvaWQgMCAmJiBfZm9ybWF0dGluZyRibG9ja1R5cGUuYmxvY2txdW90ZSksXG4gICAgICAgIGNvZGU6IChfZm9ybWF0dGluZyRibG9ja1R5cGUyID0+IHtcbiAgICAgICAgICBpZiAoKChfZm9ybWF0dGluZyRibG9ja1R5cGUyID0gZm9ybWF0dGluZy5ibG9ja1R5cGVzKSA9PT0gbnVsbCB8fCBfZm9ybWF0dGluZyRibG9ja1R5cGUyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZm9ybWF0dGluZyRibG9ja1R5cGUyLmNvZGUpID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZvcm1hdHRpbmcuYmxvY2tUeXBlcy5jb2RlID09PSB0cnVlIHx8ICFmb3JtYXR0aW5nLmJsb2NrVHlwZXMuY29kZS5zY2hlbWEpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHNjaGVtYTogb2JqZWN0KHt9KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgWyd0eXBlJywgJ2NoaWxkcmVuJywgJ2xhbmd1YWdlJ10pIHtcbiAgICAgICAgICAgIGlmIChrZXkgaW4gZm9ybWF0dGluZy5ibG9ja1R5cGVzLmNvZGUuc2NoZW1hKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgXCIke2tleX1cIiBjYW5ub3QgYmUgYSBrZXkgaW4gdGhlIHNjaGVtYSBmb3IgY29kZSBibG9ja3NgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNjaGVtYTogb2JqZWN0KGZvcm1hdHRpbmcuYmxvY2tUeXBlcy5jb2RlLnNjaGVtYSlcbiAgICAgICAgICB9O1xuICAgICAgICB9KSgpXG4gICAgICB9LFxuICAgICAgaGVhZGluZ3M6IChfb2JqJHNjaGVtYSA9PiB7XG4gICAgICAgIGNvbnN0IG9wdCA9IGZvcm1hdHRpbmcgPT09IG51bGwgfHwgZm9ybWF0dGluZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogZm9ybWF0dGluZy5oZWFkaW5nTGV2ZWxzO1xuICAgICAgICBjb25zdCBvYmogPSB0eXBlb2Ygb3B0ID09PSAnb2JqZWN0JyAmJiAnbGV2ZWxzJyBpbiBvcHQgPyBvcHQgOiB7XG4gICAgICAgICAgbGV2ZWxzOiBvcHQsXG4gICAgICAgICAgc2NoZW1hOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG9iai5zY2hlbWEpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBbJ3R5cGUnLCAnY2hpbGRyZW4nLCAnbGV2ZWwnLCAndGV4dEFsaWduJ10pIHtcbiAgICAgICAgICAgIGlmIChrZXkgaW4gb2JqLnNjaGVtYSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFwiJHtrZXl9XCIgY2Fubm90IGJlIGEga2V5IGluIHRoZSBzY2hlbWEgZm9yIGhlYWRpbmdzYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbGV2ZWxzOiBbLi4ubmV3IFNldChvYmoubGV2ZWxzID09PSB0cnVlID8gWzEsIDIsIDMsIDQsIDUsIDZdIDogb2JqLmxldmVscyldLFxuICAgICAgICAgIHNjaGVtYTogb2JqZWN0KChfb2JqJHNjaGVtYSA9IG9iai5zY2hlbWEpICE9PSBudWxsICYmIF9vYmokc2NoZW1hICE9PSB2b2lkIDAgPyBfb2JqJHNjaGVtYSA6IHt9KVxuICAgICAgICB9O1xuICAgICAgfSkoKSxcbiAgICAgIGlubGluZU1hcmtzOiBmb3JtYXR0aW5nLmlubGluZU1hcmtzID09PSB0cnVlID8ge1xuICAgICAgICBib2xkOiB0cnVlLFxuICAgICAgICBjb2RlOiB0cnVlLFxuICAgICAgICBpdGFsaWM6IHRydWUsXG4gICAgICAgIGtleWJvYXJkOiBmYWxzZSxcbiAgICAgICAgLy8gbm90IHN1cHBvcnRlZCBuYXRpdmVseSBpbiBtYXJrZG93blxuICAgICAgICBzdHJpa2V0aHJvdWdoOiB0cnVlLFxuICAgICAgICBzdWJzY3JpcHQ6IGZhbHNlLFxuICAgICAgICAvLyBub3Qgc3VwcG9ydGVkIG5hdGl2ZWx5IGluIG1hcmtkb3duXG4gICAgICAgIHN1cGVyc2NyaXB0OiBmYWxzZSxcbiAgICAgICAgLy8gbm90IHN1cHBvcnRlZCBuYXRpdmVseSBpbiBtYXJrZG93blxuICAgICAgICB1bmRlcmxpbmU6IGZhbHNlIC8vIG5vdCBzdXBwb3J0ZWQgbmF0aXZlbHkgaW4gbWFya2Rvd25cbiAgICAgIH0gOiB7XG4gICAgICAgIGJvbGQ6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXIgPSBmb3JtYXR0aW5nLmlubGluZU1hcmtzKSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRpbmxpbmVNYXIgIT09IHZvaWQgMCAmJiBfZm9ybWF0dGluZyRpbmxpbmVNYXIuYm9sZCksXG4gICAgICAgIGNvZGU6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXIyID0gZm9ybWF0dGluZy5pbmxpbmVNYXJrcykgIT09IG51bGwgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyMiAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjIuY29kZSksXG4gICAgICAgIGl0YWxpYzogISEoKF9mb3JtYXR0aW5nJGlubGluZU1hcjMgPSBmb3JtYXR0aW5nLmlubGluZU1hcmtzKSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRpbmxpbmVNYXIzICE9PSB2b2lkIDAgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyMy5pdGFsaWMpLFxuICAgICAgICBzdHJpa2V0aHJvdWdoOiAhISgoX2Zvcm1hdHRpbmckaW5saW5lTWFyNCA9IGZvcm1hdHRpbmcuaW5saW5lTWFya3MpICE9PSBudWxsICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjQgIT09IHZvaWQgMCAmJiBfZm9ybWF0dGluZyRpbmxpbmVNYXI0LnN0cmlrZXRocm91Z2gpLFxuICAgICAgICB1bmRlcmxpbmU6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXI1ID0gZm9ybWF0dGluZy5pbmxpbmVNYXJrcykgIT09IG51bGwgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyNSAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjUudW5kZXJsaW5lKSxcbiAgICAgICAga2V5Ym9hcmQ6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXI2ID0gZm9ybWF0dGluZy5pbmxpbmVNYXJrcykgIT09IG51bGwgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyNiAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjYua2V5Ym9hcmQpLFxuICAgICAgICBzdWJzY3JpcHQ6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXI3ID0gZm9ybWF0dGluZy5pbmxpbmVNYXJrcykgIT09IG51bGwgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyNyAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjcuc3Vic2NyaXB0KSxcbiAgICAgICAgc3VwZXJzY3JpcHQ6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXI4ID0gZm9ybWF0dGluZy5pbmxpbmVNYXJrcykgIT09IG51bGwgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyOCAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjguc3VwZXJzY3JpcHQpXG4gICAgICB9LFxuICAgICAgbGlzdFR5cGVzOiBmb3JtYXR0aW5nLmxpc3RUeXBlcyA9PT0gdHJ1ZSA/IHtcbiAgICAgICAgb3JkZXJlZDogdHJ1ZSxcbiAgICAgICAgdW5vcmRlcmVkOiB0cnVlXG4gICAgICB9IDoge1xuICAgICAgICBvcmRlcmVkOiAhISgoX2Zvcm1hdHRpbmckbGlzdFR5cGVzID0gZm9ybWF0dGluZy5saXN0VHlwZXMpICE9PSBudWxsICYmIF9mb3JtYXR0aW5nJGxpc3RUeXBlcyAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGxpc3RUeXBlcy5vcmRlcmVkKSxcbiAgICAgICAgdW5vcmRlcmVkOiAhISgoX2Zvcm1hdHRpbmckbGlzdFR5cGVzMiA9IGZvcm1hdHRpbmcubGlzdFR5cGVzKSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRsaXN0VHlwZXMyICE9PSB2b2lkIDAgJiYgX2Zvcm1hdHRpbmckbGlzdFR5cGVzMi51bm9yZGVyZWQpXG4gICAgICB9LFxuICAgICAgc29mdEJyZWFrczogISFmb3JtYXR0aW5nLnNvZnRCcmVha3NcbiAgICB9LFxuICAgIGxpbmtzOiAhIWNvbmZpZy5saW5rcyxcbiAgICBsYXlvdXRzOiBbLi4ubmV3IFNldCgoY29uZmlnLmxheW91dHMgfHwgW10pLm1hcCh4ID0+IEpTT04uc3RyaW5naWZ5KHgpKSldLm1hcCh4ID0+IEpTT04ucGFyc2UoeCkpLFxuICAgIGRpdmlkZXJzOiAhIWNvbmZpZy5kaXZpZGVycyxcbiAgICBpbWFnZXM6IGltYWdlc0NvbmZpZyA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiB7XG4gICAgICAuLi5pbWFnZXNDb25maWcsXG4gICAgICBzY2hlbWE6IHtcbiAgICAgICAgYWx0OiAoX2ltYWdlc0NvbmZpZyRzY2hlbWEkID0gKF9pbWFnZXNDb25maWckc2NoZW1hID0gaW1hZ2VzQ29uZmlnLnNjaGVtYSkgPT09IG51bGwgfHwgX2ltYWdlc0NvbmZpZyRzY2hlbWEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9pbWFnZXNDb25maWckc2NoZW1hLmFsdCkgIT09IG51bGwgJiYgX2ltYWdlc0NvbmZpZyRzY2hlbWEkICE9PSB2b2lkIDAgPyBfaW1hZ2VzQ29uZmlnJHNjaGVtYSQgOiBkZWZhdWx0QWx0RmllbGQkMSxcbiAgICAgICAgdGl0bGU6IChfaW1hZ2VzQ29uZmlnJHNjaGVtYSQyID0gKF9pbWFnZXNDb25maWckc2NoZW1hMiA9IGltYWdlc0NvbmZpZy5zY2hlbWEpID09PSBudWxsIHx8IF9pbWFnZXNDb25maWckc2NoZW1hMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2ltYWdlc0NvbmZpZyRzY2hlbWEyLnRpdGxlKSAhPT0gbnVsbCAmJiBfaW1hZ2VzQ29uZmlnJHNjaGVtYSQyICE9PSB2b2lkIDAgPyBfaW1hZ2VzQ29uZmlnJHNjaGVtYSQyIDogZW1wdHlUaXRsZUZpZWxkJDFcbiAgICAgIH1cbiAgICB9LFxuICAgIHRhYmxlczogISFjb25maWcudGFibGVzXG4gIH07XG59XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgYGZpZWxkcy5tYXJrZG9jYCBoYXMgc3VwZXJzZWRlZCB0aGlzIGZpZWxkLiBgZmllbGRzLm1keGAgaXMgYWxzbyBhdmFpbGFibGUgaWYgeW91IHByZWZlciBNRFguXG4gKi9cbmZ1bmN0aW9uIGRvY3VtZW50KHtcbiAgbGFiZWwsXG4gIGNvbXBvbmVudEJsb2NrcyA9IHt9LFxuICBkZXNjcmlwdGlvbixcbiAgLi4uZG9jdW1lbnRGZWF0dXJlc0NvbmZpZ1xufSkge1xuICBjb25zdCBkb2N1bWVudEZlYXR1cmVzID0gbm9ybWFsaXNlRG9jdW1lbnRGZWF0dXJlcyhkb2N1bWVudEZlYXR1cmVzQ29uZmlnKTtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgZm9ybUtpbmQ6ICdjb250ZW50JyxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gW3tcbiAgICAgICAgdHlwZTogJ3BhcmFncmFwaCcsXG4gICAgICAgIGNoaWxkcmVuOiBbe1xuICAgICAgICAgIHRleHQ6ICcnXG4gICAgICAgIH1dXG4gICAgICB9XTtcbiAgICB9LFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChEb2N1bWVudEZpZWxkSW5wdXQsIHtcbiAgICAgICAgY29tcG9uZW50QmxvY2tzOiBjb21wb25lbnRCbG9ja3MsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBkb2N1bWVudEZlYXR1cmVzOiBkb2N1bWVudEZlYXR1cmVzLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBwYXJzZShfLCBkYXRhKSB7XG4gICAgICBjb25zdCBtYXJrZG9jID0gdGV4dERlY29kZXIkMS5kZWNvZGUoZGF0YS5jb250ZW50KTtcbiAgICAgIGZyb21NYXJrZG9jKHBhcnNlKG1hcmtkb2MpLCBjb21wb25lbnRCbG9ja3MpO1xuICAgICAgcmV0dXJuIGRlc2VyaWFsaXplRmlsZXMobm9ybWFsaXplRG9jdW1lbnRGaWVsZENoaWxkcmVuKCksIGNvbXBvbmVudEJsb2NrcywgZGF0YS5vdGhlciwgZGF0YS5leHRlcm5hbCwgJ2VkaXQnLCBkb2N1bWVudEZlYXR1cmVzLCBkYXRhLnNsdWcpO1xuICAgIH0sXG4gICAgY29udGVudEV4dGVuc2lvbjogJy5tZG9jJyxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgZGlyZWN0b3JpZXM6IFsuLi5jb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWEob2JqZWN0KE9iamVjdC5mcm9tRW50cmllcyhPYmplY3QuZW50cmllcyhjb21wb25lbnRCbG9ja3MpLm1hcCgoW25hbWUsIGJsb2NrXSkgPT4gW25hbWUsIG9iamVjdChibG9jay5zY2hlbWEpXSkpKSksIC4uLih0eXBlb2YgZG9jdW1lbnRGZWF0dXJlcy5pbWFnZXMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBkb2N1bWVudEZlYXR1cmVzLmltYWdlcy5kaXJlY3RvcnkgPT09ICdzdHJpbmcnID8gW2ZpeFBhdGgoZG9jdW1lbnRGZWF0dXJlcy5pbWFnZXMuZGlyZWN0b3J5KV0gOiBbXSldLFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSwgb3B0cykge1xuICAgICAgcmV0dXJuIHNlcmlhbGl6ZU1hcmtkb2MoKTtcbiAgICB9LFxuICAgIHJlYWRlcjoge1xuICAgICAgcGFyc2UodmFsdWUsIGRhdGEpIHtcbiAgICAgICAgY29uc3QgbWFya2RvYyA9IHRleHREZWNvZGVyJDEuZGVjb2RlKGRhdGEuY29udGVudCk7XG4gICAgICAgIGNvbnN0IGRvY3VtZW50ID0gZnJvbU1hcmtkb2MocGFyc2UobWFya2RvYyksIGNvbXBvbmVudEJsb2Nrcyk7XG4gICAgICAgIHJldHVybiBkZXNlcmlhbGl6ZUZpbGVzKGRvY3VtZW50LCBjb21wb25lbnRCbG9ja3MsIG5ldyBNYXAoKSwgbmV3IE1hcCgpLCAncmVhZCcsIGRvY3VtZW50RmVhdHVyZXMsIHVuZGVmaW5lZCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuXG5jb25zdCBkZWZhdWx0QWx0RmllbGQgPSB0ZXh0KHtcbiAgbGFiZWw6ICdBbHQgdGV4dCcsXG4gIGRlc2NyaXB0aW9uOiAnVGhpcyB0ZXh0IHdpbGwgYmUgdXNlZCBieSBzY3JlZW4gcmVhZGVycyBhbmQgc2VhcmNoIGVuZ2luZXMuJ1xufSk7XG5jb25zdCBlbXB0eVRpdGxlRmllbGQgPSBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gIElucHV0KCkge1xuICAgIHJldHVybiBudWxsO1xuICB9LFxuICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgcmV0dXJuICcnO1xuICB9LFxuICBwYXJzZSh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gJyc7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBzdHJpbmcnKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9LFxuICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfSxcbiAgc2VyaWFsaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbHVlXG4gICAgfTtcbiAgfSxcbiAgbGFiZWw6ICdUaXRsZSdcbn0pO1xuZnVuY3Rpb24gZWRpdG9yT3B0aW9uc1RvQ29uZmlnKG9wdGlvbnMpIHtcbiAgdmFyIF9vcHRpb25zJGJvbGQsIF9vcHRpb25zJGl0YWxpYywgX29wdGlvbnMkc3RyaWtldGhyb3VnLCBfb3B0aW9ucyRjb2RlLCBfb3B0aW9ucyRibG9ja3F1b3RlLCBfb3B0aW9ucyRvcmRlcmVkTGlzdCwgX29wdGlvbnMkdW5vcmRlcmVkTGlzLCBfb3B0aW9ucyR0YWJsZSwgX29wdGlvbnMkbGluaywgX29wdGlvbnMkZGl2aWRlcjtcbiAgcmV0dXJuIHtcbiAgICBib2xkOiAoX29wdGlvbnMkYm9sZCA9IG9wdGlvbnMuYm9sZCkgIT09IG51bGwgJiYgX29wdGlvbnMkYm9sZCAhPT0gdm9pZCAwID8gX29wdGlvbnMkYm9sZCA6IHRydWUsXG4gICAgaXRhbGljOiAoX29wdGlvbnMkaXRhbGljID0gb3B0aW9ucy5pdGFsaWMpICE9PSBudWxsICYmIF9vcHRpb25zJGl0YWxpYyAhPT0gdm9pZCAwID8gX29wdGlvbnMkaXRhbGljIDogdHJ1ZSxcbiAgICBzdHJpa2V0aHJvdWdoOiAoX29wdGlvbnMkc3RyaWtldGhyb3VnID0gb3B0aW9ucy5zdHJpa2V0aHJvdWdoKSAhPT0gbnVsbCAmJiBfb3B0aW9ucyRzdHJpa2V0aHJvdWcgIT09IHZvaWQgMCA/IF9vcHRpb25zJHN0cmlrZXRocm91ZyA6IHRydWUsXG4gICAgY29kZTogKF9vcHRpb25zJGNvZGUgPSBvcHRpb25zLmNvZGUpICE9PSBudWxsICYmIF9vcHRpb25zJGNvZGUgIT09IHZvaWQgMCA/IF9vcHRpb25zJGNvZGUgOiB0cnVlLFxuICAgIGhlYWRpbmc6ICgoKSA9PiB7XG4gICAgICBsZXQgbGV2ZWxzID0gW107XG4gICAgICBsZXQgbGV2ZWxzT3B0ID0gdHlwZW9mIG9wdGlvbnMuaGVhZGluZyA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkob3B0aW9ucy5oZWFkaW5nKSA/IG9wdGlvbnMuaGVhZGluZy5sZXZlbHMgOiBvcHRpb25zLmhlYWRpbmc7XG4gICAgICBpZiAobGV2ZWxzT3B0ID09PSB0cnVlIHx8IGxldmVsc09wdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGxldmVscyA9IFsxLCAyLCAzLCA0LCA1LCA2XTtcbiAgICAgIH1cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGxldmVsc09wdCkpIHtcbiAgICAgICAgbGV2ZWxzID0gbGV2ZWxzT3B0O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbGV2ZWxzLFxuICAgICAgICBzY2hlbWE6IG9wdGlvbnMuaGVhZGluZyAmJiB0eXBlb2Ygb3B0aW9ucy5oZWFkaW5nID09PSAnb2JqZWN0JyAmJiAnc2NoZW1hJyBpbiBvcHRpb25zLmhlYWRpbmcgPyBvcHRpb25zLmhlYWRpbmcuc2NoZW1hIDoge31cbiAgICAgIH07XG4gICAgfSkoKSxcbiAgICBibG9ja3F1b3RlOiAoX29wdGlvbnMkYmxvY2txdW90ZSA9IG9wdGlvbnMuYmxvY2txdW90ZSkgIT09IG51bGwgJiYgX29wdGlvbnMkYmxvY2txdW90ZSAhPT0gdm9pZCAwID8gX29wdGlvbnMkYmxvY2txdW90ZSA6IHRydWUsXG4gICAgb3JkZXJlZExpc3Q6IChfb3B0aW9ucyRvcmRlcmVkTGlzdCA9IG9wdGlvbnMub3JkZXJlZExpc3QpICE9PSBudWxsICYmIF9vcHRpb25zJG9yZGVyZWRMaXN0ICE9PSB2b2lkIDAgPyBfb3B0aW9ucyRvcmRlcmVkTGlzdCA6IHRydWUsXG4gICAgdW5vcmRlcmVkTGlzdDogKF9vcHRpb25zJHVub3JkZXJlZExpcyA9IG9wdGlvbnMudW5vcmRlcmVkTGlzdCkgIT09IG51bGwgJiYgX29wdGlvbnMkdW5vcmRlcmVkTGlzICE9PSB2b2lkIDAgPyBfb3B0aW9ucyR1bm9yZGVyZWRMaXMgOiB0cnVlLFxuICAgIHRhYmxlOiAoX29wdGlvbnMkdGFibGUgPSBvcHRpb25zLnRhYmxlKSAhPT0gbnVsbCAmJiBfb3B0aW9ucyR0YWJsZSAhPT0gdm9pZCAwID8gX29wdGlvbnMkdGFibGUgOiB0cnVlLFxuICAgIGxpbms6IChfb3B0aW9ucyRsaW5rID0gb3B0aW9ucy5saW5rKSAhPT0gbnVsbCAmJiBfb3B0aW9ucyRsaW5rICE9PSB2b2lkIDAgPyBfb3B0aW9ucyRsaW5rIDogdHJ1ZSxcbiAgICBpbWFnZTogb3B0aW9ucy5pbWFnZSAhPT0gZmFsc2UgPyAoKF9vcHRzJHRyYW5zZm9ybUZpbGVuYSwgX29wdHMkc2NoZW1hJGFsdCwgX29wdHMkc2NoZW1hLCBfb3B0cyRzY2hlbWEkdGl0bGUsIF9vcHRzJHNjaGVtYTIpID0+IHtcbiAgICAgIGNvbnN0IG9wdHMgPSBvcHRpb25zLmltYWdlID09PSB0cnVlID8gdW5kZWZpbmVkIDogb3B0aW9ucy5pbWFnZTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRpcmVjdG9yeTogb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLmRpcmVjdG9yeSxcbiAgICAgICAgcHVibGljUGF0aDogb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLnB1YmxpY1BhdGgsXG4gICAgICAgIHRyYW5zZm9ybUZpbGVuYW1lOiAoX29wdHMkdHJhbnNmb3JtRmlsZW5hID0gb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLnRyYW5zZm9ybUZpbGVuYW1lKSAhPT0gbnVsbCAmJiBfb3B0cyR0cmFuc2Zvcm1GaWxlbmEgIT09IHZvaWQgMCA/IF9vcHRzJHRyYW5zZm9ybUZpbGVuYSA6IHggPT4geCxcbiAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgYWx0OiAoX29wdHMkc2NoZW1hJGFsdCA9IG9wdHMgPT09IG51bGwgfHwgb3B0cyA9PT0gdm9pZCAwIHx8IChfb3B0cyRzY2hlbWEgPSBvcHRzLnNjaGVtYSkgPT09IG51bGwgfHwgX29wdHMkc2NoZW1hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3B0cyRzY2hlbWEuYWx0KSAhPT0gbnVsbCAmJiBfb3B0cyRzY2hlbWEkYWx0ICE9PSB2b2lkIDAgPyBfb3B0cyRzY2hlbWEkYWx0IDogZGVmYXVsdEFsdEZpZWxkLFxuICAgICAgICAgIHRpdGxlOiAoX29wdHMkc2NoZW1hJHRpdGxlID0gb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgfHwgKF9vcHRzJHNjaGVtYTIgPSBvcHRzLnNjaGVtYSkgPT09IG51bGwgfHwgX29wdHMkc2NoZW1hMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX29wdHMkc2NoZW1hMi50aXRsZSkgIT09IG51bGwgJiYgX29wdHMkc2NoZW1hJHRpdGxlICE9PSB2b2lkIDAgPyBfb3B0cyRzY2hlbWEkdGl0bGUgOiBlbXB0eVRpdGxlRmllbGRcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KSgpIDogdW5kZWZpbmVkLFxuICAgIGRpdmlkZXI6IChfb3B0aW9ucyRkaXZpZGVyID0gb3B0aW9ucy5kaXZpZGVyKSAhPT0gbnVsbCAmJiBfb3B0aW9ucyRkaXZpZGVyICE9PSB2b2lkIDAgPyBfb3B0aW9ucyRkaXZpZGVyIDogdHJ1ZSxcbiAgICBjb2RlQmxvY2s6IG9wdGlvbnMuY29kZUJsb2NrID09PSBmYWxzZSA/IHVuZGVmaW5lZCA6IHtcbiAgICAgIHNjaGVtYTogdHlwZW9mIG9wdGlvbnMuY29kZUJsb2NrID09PSAnb2JqZWN0JyA/IG9wdGlvbnMuY29kZUJsb2NrLnNjaGVtYSA6IHt9XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBnZXRUeXBlRm9yRmllbGQoZmllbGQpIHtcbiAgaWYgKGZpZWxkLmtpbmQgPT09ICdvYmplY3QnIHx8IGZpZWxkLmtpbmQgPT09ICdjb25kaXRpb25hbCcpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogT2JqZWN0LFxuICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICB9O1xuICB9XG4gIGlmIChmaWVsZC5raW5kID09PSAnYXJyYXknKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IEFycmF5LFxuICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICB9O1xuICB9XG4gIGlmIChmaWVsZC5raW5kID09PSAnY2hpbGQnKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG4gIGlmIChmaWVsZC5mb3JtS2luZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHR5cGVvZiBmaWVsZC5kZWZhdWx0VmFsdWUgPT09ICdzdHJpbmcnICYmICdvcHRpb25zJyBpbiBmaWVsZCAmJiBBcnJheS5pc0FycmF5KGZpZWxkLm9wdGlvbnMpICYmIGZpZWxkLm9wdGlvbnMuZXZlcnkodmFsID0+IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnICYmIHZhbCAhPT0gbnVsbCAmJiAndmFsdWUnIGluIHZhbCAmJiB0eXBlb2YgdmFsLnZhbHVlID09PSAnc3RyaW5nJykpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgbWF0Y2hlczogZmllbGQub3B0aW9ucy5tYXAoeCA9PiB4LnZhbHVlKSxcbiAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgIH07XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZmllbGQuZGVmYXVsdFZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgbGV0IHJlcXVpcmVkID0gZmFsc2U7XG4gICAgICB0cnkge1xuICAgICAgICBmaWVsZC5wYXJzZSgnJyk7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgcmVxdWlyZWQgPSB0cnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgICByZXF1aXJlZFxuICAgICAgfTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGZpZWxkLnBhcnNlKDEpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogTnVtYmVyXG4gICAgICB9O1xuICAgIH0gY2F0Y2gge31cbiAgICBpZiAodHlwZW9mIGZpZWxkLmRlZmF1bHRWYWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBCb29sZWFuLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHt9O1xuICB9XG4gIGlmIChmaWVsZC5mb3JtS2luZCA9PT0gJ3NsdWcnKSB7XG4gICAgbGV0IHJlcXVpcmVkID0gZmFsc2U7XG4gICAgdHJ5IHtcbiAgICAgIGZpZWxkLnBhcnNlKCcnLCB1bmRlZmluZWQpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWRcbiAgICB9O1xuICB9XG4gIGlmIChmaWVsZC5mb3JtS2luZCA9PT0gJ2Fzc2V0Jykge1xuICAgIGxldCByZXF1aXJlZCA9IGZhbHNlO1xuICAgIHRyeSB7XG4gICAgICBmaWVsZC52YWxpZGF0ZShudWxsKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJlcXVpcmVkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkXG4gICAgfTtcbiAgfVxuICByZXR1cm4ge307XG59XG5mdW5jdGlvbiBmaWVsZHNUb01hcmtkb2NBdHRyaWJ1dGVzKGZpZWxkcykge1xuICByZXR1cm4gT2JqZWN0LmZyb21FbnRyaWVzKE9iamVjdC5lbnRyaWVzKGZpZWxkcykubWFwKChbbmFtZSwgZmllbGRdKSA9PiB7XG4gICAgY29uc3Qgc2NoZW1hID0gZ2V0VHlwZUZvckZpZWxkKGZpZWxkKTtcbiAgICByZXR1cm4gW25hbWUsIHNjaGVtYV07XG4gIH0pKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZU1hcmtkb2NDb25maWcob3B0cykge1xuICBjb25zdCBlZGl0b3JDb25maWcgPSBlZGl0b3JPcHRpb25zVG9Db25maWcob3B0cy5vcHRpb25zIHx8IHt9KTtcbiAgY29uc3QgY29uZmlnID0ge1xuICAgIG5vZGVzOiB7XG4gICAgICAuLi5ub2Rlc1xuICAgIH0sXG4gICAgdGFnczoge31cbiAgfTtcbiAgaWYgKGVkaXRvckNvbmZpZy5oZWFkaW5nLmxldmVscy5sZW5ndGgpIHtcbiAgICBjb25maWcubm9kZXMuaGVhZGluZyA9IHtcbiAgICAgIC4uLm5vZGVzLmhlYWRpbmcsXG4gICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgIC4uLm5vZGVzLmhlYWRpbmcuYXR0cmlidXRlcyxcbiAgICAgICAgLi4uZmllbGRzVG9NYXJrZG9jQXR0cmlidXRlcyhlZGl0b3JDb25maWcuaGVhZGluZy5zY2hlbWEpXG4gICAgICB9XG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBjb25maWcubm9kZXMuaGVhZGluZyA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5ibG9ja3F1b3RlKSB7XG4gICAgY29uZmlnLm5vZGVzLmJsb2NrcXVvdGUgPSB1bmRlZmluZWQ7XG4gIH1cbiAgaWYgKGVkaXRvckNvbmZpZy5jb2RlQmxvY2spIHtcbiAgICBjb25maWcubm9kZXMuZmVuY2UgPSB7XG4gICAgICAuLi5ub2Rlcy5mZW5jZSxcbiAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgLi4ubm9kZXMuZmVuY2UuYXR0cmlidXRlcyxcbiAgICAgICAgLi4uZmllbGRzVG9NYXJrZG9jQXR0cmlidXRlcyhlZGl0b3JDb25maWcuY29kZUJsb2NrLnNjaGVtYSlcbiAgICAgIH1cbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGNvbmZpZy5ub2Rlcy5mZW5jZSA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5vcmRlcmVkTGlzdCAmJiAhZWRpdG9yQ29uZmlnLnVub3JkZXJlZExpc3QpIHtcbiAgICBjb25maWcubm9kZXMubGlzdCA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5ib2xkKSB7XG4gICAgY29uZmlnLm5vZGVzLnN0cm9uZyA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5pdGFsaWMpIHtcbiAgICBjb25maWcubm9kZXMuZW0gPSB1bmRlZmluZWQ7XG4gIH1cbiAgaWYgKCFlZGl0b3JDb25maWcuc3RyaWtldGhyb3VnaCkge1xuICAgIGNvbmZpZy5ub2Rlcy5zID0gdW5kZWZpbmVkO1xuICB9XG4gIGlmICghZWRpdG9yQ29uZmlnLmxpbmspIHtcbiAgICBjb25maWcubm9kZXMubGluayA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5pbWFnZSkge1xuICAgIGNvbmZpZy5ub2Rlcy5pbWFnZSA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5kaXZpZGVyKSB7XG4gICAgY29uZmlnLm5vZGVzLmhyID0gdW5kZWZpbmVkO1xuICB9XG4gIGlmICghZWRpdG9yQ29uZmlnLnRhYmxlKSB7XG4gICAgY29uZmlnLm5vZGVzLnRhYmxlID0gdW5kZWZpbmVkO1xuICB9XG4gIGZvciAoY29uc3QgW25hbWUsIGNvbXBvbmVudF0gb2YgT2JqZWN0LmVudHJpZXMob3B0cy5jb21wb25lbnRzIHx8IHt9KSkge1xuICAgIHZhciBfb3B0cyRyZW5kZXI7XG4gICAgY29uc3QgaXNFbXB0eSA9IGNvbXBvbmVudC5raW5kID09PSAnYmxvY2snIHx8IGNvbXBvbmVudC5raW5kID09PSAnaW5saW5lJztcbiAgICBjb25maWcudGFnc1tuYW1lXSA9IHtcbiAgICAgIHJlbmRlcjogKF9vcHRzJHJlbmRlciA9IG9wdHMucmVuZGVyKSA9PT0gbnVsbCB8fCBfb3B0cyRyZW5kZXIgPT09IHZvaWQgMCB8fCAoX29wdHMkcmVuZGVyID0gX29wdHMkcmVuZGVyLnRhZ3MpID09PSBudWxsIHx8IF9vcHRzJHJlbmRlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogX29wdHMkcmVuZGVyW25hbWVdLFxuICAgICAgY2hpbGRyZW46IGlzRW1wdHkgPyBbXSA6IHVuZGVmaW5lZCxcbiAgICAgIHNlbGZDbG9zaW5nOiBpc0VtcHR5LFxuICAgICAgYXR0cmlidXRlczogZmllbGRzVG9NYXJrZG9jQXR0cmlidXRlcyhjb21wb25lbnQuc2NoZW1hKSxcbiAgICAgIGRlc2NyaXB0aW9uOiAnZGVzY3JpcHRpb24nIGluIGNvbXBvbmVudCA/IGNvbXBvbmVudC5kZXNjcmlwdGlvbiA6IHVuZGVmaW5lZCxcbiAgICAgIGlubGluZTogY29tcG9uZW50LmtpbmQgPT09ICdpbmxpbmUnIHx8IGNvbXBvbmVudC5raW5kID09PSAnbWFyaydcbiAgICB9O1xuICB9XG4gIGZvciAoY29uc3QgW25hbWUsIHJlbmRlcl0gb2YgT2JqZWN0LmVudHJpZXMoKChfb3B0cyRyZW5kZXIyID0gb3B0cy5yZW5kZXIpID09PSBudWxsIHx8IF9vcHRzJHJlbmRlcjIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9vcHRzJHJlbmRlcjIubm9kZXMpIHx8IHt9KSkge1xuICAgIHZhciBfb3B0cyRyZW5kZXIyO1xuICAgIGNvbnN0IG5vZGVTY2hlbWEgPSBjb25maWcubm9kZXNbbmFtZV07XG4gICAgaWYgKG5vZGVTY2hlbWEpIHtcbiAgICAgIG5vZGVTY2hlbWEucmVuZGVyID0gcmVuZGVyO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY29uZmlnO1xufVxuXG5jb25zdCB0ZXh0RGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuY29uc3QgdGV4dEVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbmZ1bmN0aW9uIGdldERpcmVjdG9yaWVzRm9yRWRpdG9yRmllbGQoY29tcG9uZW50cywgY29uZmlnKSB7XG4gIHJldHVybiBbLi4uY29sbGVjdERpcmVjdG9yaWVzVXNlZEluU2NoZW1hKG9iamVjdChPYmplY3QuZnJvbUVudHJpZXMoT2JqZWN0LmVudHJpZXMoY29tcG9uZW50cykubWFwKChbbmFtZSwgY29tcG9uZW50XSkgPT4gW25hbWUsIG9iamVjdChjb21wb25lbnQuc2NoZW1hKV0pKSkpLCAuLi4odHlwZW9mIGNvbmZpZy5pbWFnZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIGNvbmZpZy5pbWFnZS5kaXJlY3RvcnkgPT09ICdzdHJpbmcnID8gW2ZpeFBhdGgoY29uZmlnLmltYWdlLmRpcmVjdG9yeSldIDogW10pXTtcbn1cbmZ1bmN0aW9uIG1hcmtkb2Moe1xuICBsYWJlbCxcbiAgZGVzY3JpcHRpb24sXG4gIG9wdGlvbnMgPSB7fSxcbiAgY29tcG9uZW50cyA9IHt9LFxuICBleHRlbnNpb24gPSAnbWRvYydcbn0pIHtcbiAgbGV0IHNjaGVtYTtcbiAgY29uc3QgY29uZmlnID0gZWRpdG9yT3B0aW9uc1RvQ29uZmlnKG9wdGlvbnMpO1xuICBsZXQgZ2V0U2NoZW1hID0gKCkgPT4ge1xuICAgIGlmICghc2NoZW1hKSB7XG4gICAgICBzY2hlbWEgPSBjcmVhdGVFZGl0b3JTY2hlbWEoKTtcbiAgICB9XG4gICAgcmV0dXJuIHNjaGVtYTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgZm9ybUtpbmQ6ICdjb250ZW50JyxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gZ2V0RGVmYXVsdFZhbHVlKGdldFNjaGVtYSgpKTtcbiAgICB9LFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChEb2N1bWVudEZpZWxkSW5wdXQsIHtcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHBhcnNlOiAoXywge1xuICAgICAgY29udGVudCxcbiAgICAgIG90aGVyLFxuICAgICAgZXh0ZXJuYWwsXG4gICAgICBzbHVnXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3QgdGV4dCA9IHRleHREZWNvZGVyLmRlY29kZShjb250ZW50KTtcbiAgICAgIHJldHVybiBwYXJzZVRvRWRpdG9yU3RhdGUodGV4dCwgZ2V0U2NoZW1hKCkpO1xuICAgIH0sXG4gICAgY29udGVudEV4dGVuc2lvbjogYC4ke2V4dGVuc2lvbn1gLFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBkaXJlY3RvcmllczogZ2V0RGlyZWN0b3JpZXNGb3JFZGl0b3JGaWVsZChjb21wb25lbnRzLCBjb25maWcpLFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSwge1xuICAgICAgc2x1Z1xuICAgIH0pIHtcbiAgICAgIGNvbnN0IG91dCA9IHNlcmlhbGl6ZUZyb21FZGl0b3JTdGF0ZSgpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29udGVudDogdGV4dEVuY29kZXIuZW5jb2RlKG91dC5jb250ZW50KSxcbiAgICAgICAgZXh0ZXJuYWw6IG91dC5leHRlcm5hbCxcbiAgICAgICAgb3RoZXI6IG91dC5vdGhlcixcbiAgICAgICAgdmFsdWU6IHVuZGVmaW5lZFxuICAgICAgfTtcbiAgICB9LFxuICAgIHJlYWRlcjoge1xuICAgICAgcGFyc2U6IChfLCB7XG4gICAgICAgIGNvbnRlbnRcbiAgICAgIH0pID0+IHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRleHREZWNvZGVyLmRlY29kZShjb250ZW50KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBub2RlOiBwYXJzZSh0ZXh0KVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0sXG4gICAgY29sbGFib3JhdGlvbjoge1xuICAgICAgdG9ZanModmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHByb3NlbWlycm9yVG9ZWG1sRnJhZ21lbnQodmFsdWUuZG9jKTtcbiAgICAgIH0sXG4gICAgICBmcm9tWWpzKHlqc1ZhbHVlLCBhd2FyZW5lc3MpIHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZUVkaXRvclN0YXRlRnJvbVlKUyhnZXRTY2hlbWEoKSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxubWFya2RvYy5jcmVhdGVNYXJrZG9jQ29uZmlnID0gY3JlYXRlTWFya2RvY0NvbmZpZztcbm1hcmtkb2MuaW5saW5lID0gZnVuY3Rpb24gaW5saW5lTWFya2RvYyh7XG4gIGxhYmVsLFxuICBkZXNjcmlwdGlvbixcbiAgb3B0aW9ucyA9IHt9LFxuICBjb21wb25lbnRzID0ge31cbn0pIHtcbiAgbGV0IHNjaGVtYTtcbiAgY29uc3QgY29uZmlnID0gZWRpdG9yT3B0aW9uc1RvQ29uZmlnKG9wdGlvbnMpO1xuICBsZXQgZ2V0U2NoZW1hID0gKCkgPT4ge1xuICAgIGlmICghc2NoZW1hKSB7XG4gICAgICBzY2hlbWEgPSBjcmVhdGVFZGl0b3JTY2hlbWEoKTtcbiAgICB9XG4gICAgcmV0dXJuIHNjaGVtYTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgZm9ybUtpbmQ6ICdhc3NldHMnLFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBnZXREZWZhdWx0VmFsdWUoZ2V0U2NoZW1hKCkpO1xuICAgIH0sXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KERvY3VtZW50RmllbGRJbnB1dCwge1xuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgLi4ucHJvcHNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcGFyc2U6ICh2YWx1ZSwge1xuICAgICAgb3RoZXIsXG4gICAgICBleHRlcm5hbCxcbiAgICAgIHNsdWdcbiAgICB9KSA9PiB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YWx1ZSA9ICcnO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGFyc2VUb0VkaXRvclN0YXRlKHZhbHVlLCBnZXRTY2hlbWEoKSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgZGlyZWN0b3JpZXM6IGdldERpcmVjdG9yaWVzRm9yRWRpdG9yRmllbGQoY29tcG9uZW50cywgY29uZmlnKSxcbiAgICBzZXJpYWxpemUodmFsdWUsIHtcbiAgICAgIHNsdWdcbiAgICB9KSB7XG4gICAgICBjb25zdCBvdXQgPSBzZXJpYWxpemVGcm9tRWRpdG9yU3RhdGUoKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGV4dGVybmFsOiBvdXQuZXh0ZXJuYWwsXG4gICAgICAgIG90aGVyOiBvdXQub3RoZXIsXG4gICAgICAgIHZhbHVlOiBvdXQuY29udGVudFxuICAgICAgfTtcbiAgICB9LFxuICAgIHJlYWRlcjoge1xuICAgICAgcGFyc2U6IHZhbHVlID0+IHtcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB2YWx1ZSA9ICcnO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBub2RlOiBwYXJzZSh2YWx1ZSlcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGNvbGxhYm9yYXRpb246IHtcbiAgICAgIHRvWWpzKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBwcm9zZW1pcnJvclRvWVhtbEZyYWdtZW50KHZhbHVlLmRvYyk7XG4gICAgICB9LFxuICAgICAgZnJvbVlqcyh5anNWYWx1ZSwgYXdhcmVuZXNzKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVFZGl0b3JTdGF0ZUZyb21ZSlMoZ2V0U2NoZW1hKCkpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn07XG5mdW5jdGlvbiBtZHgoe1xuICBsYWJlbCxcbiAgZGVzY3JpcHRpb24sXG4gIG9wdGlvbnMgPSB7fSxcbiAgY29tcG9uZW50cyA9IHt9LFxuICBleHRlbnNpb24gPSAnbWR4J1xufSkge1xuICBsZXQgc2NoZW1hO1xuICBjb25zdCBjb25maWcgPSBlZGl0b3JPcHRpb25zVG9Db25maWcob3B0aW9ucyk7XG4gIGxldCBnZXRTY2hlbWEgPSAoKSA9PiB7XG4gICAgaWYgKCFzY2hlbWEpIHtcbiAgICAgIHNjaGVtYSA9IGNyZWF0ZUVkaXRvclNjaGVtYSgpO1xuICAgIH1cbiAgICByZXR1cm4gc2NoZW1hO1xuICB9O1xuICByZXR1cm4ge1xuICAgIGtpbmQ6ICdmb3JtJyxcbiAgICBmb3JtS2luZDogJ2NvbnRlbnQnLFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBnZXREZWZhdWx0VmFsdWUoZ2V0U2NoZW1hKCkpO1xuICAgIH0sXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KERvY3VtZW50RmllbGRJbnB1dCwge1xuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgLi4ucHJvcHNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcGFyc2U6IChfLCB7XG4gICAgICBjb250ZW50LFxuICAgICAgb3RoZXIsXG4gICAgICBleHRlcm5hbCxcbiAgICAgIHNsdWdcbiAgICB9KSA9PiB7XG4gICAgICBjb25zdCB0ZXh0ID0gdGV4dERlY29kZXIuZGVjb2RlKGNvbnRlbnQpO1xuICAgICAgcmV0dXJuIHBhcnNlVG9FZGl0b3JTdGF0ZU1EWCh0ZXh0LCBnZXRTY2hlbWEoKSk7XG4gICAgfSxcbiAgICBjb250ZW50RXh0ZW5zaW9uOiBgLiR7ZXh0ZW5zaW9ufWAsXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIGRpcmVjdG9yaWVzOiBnZXREaXJlY3Rvcmllc0ZvckVkaXRvckZpZWxkKGNvbXBvbmVudHMsIGNvbmZpZyksXG4gICAgc2VyaWFsaXplKHZhbHVlLCB7XG4gICAgICBzbHVnXG4gICAgfSkge1xuICAgICAgY29uc3Qgb3V0ID0gc2VyaWFsaXplRnJvbUVkaXRvclN0YXRlTURYKCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb250ZW50OiB0ZXh0RW5jb2Rlci5lbmNvZGUob3V0LmNvbnRlbnQpLFxuICAgICAgICBleHRlcm5hbDogb3V0LmV4dGVybmFsLFxuICAgICAgICBvdGhlcjogb3V0Lm90aGVyLFxuICAgICAgICB2YWx1ZTogdW5kZWZpbmVkXG4gICAgICB9O1xuICAgIH0sXG4gICAgcmVhZGVyOiB7XG4gICAgICBwYXJzZTogKF8sIHtcbiAgICAgICAgY29udGVudFxuICAgICAgfSkgPT4ge1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGV4dERlY29kZXIuZGVjb2RlKGNvbnRlbnQpO1xuICAgICAgICByZXR1cm4gdGV4dDtcbiAgICAgIH1cbiAgICB9LFxuICAgIGNvbGxhYm9yYXRpb246IHtcbiAgICAgIHRvWWpzKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBwcm9zZW1pcnJvclRvWVhtbEZyYWdtZW50KHZhbHVlLmRvYyk7XG4gICAgICB9LFxuICAgICAgZnJvbVlqcyh5anNWYWx1ZSwgYXdhcmVuZXNzKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVFZGl0b3JTdGF0ZUZyb21ZSlMoZ2V0U2NoZW1hKCkpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cbm1keC5pbmxpbmUgPSBmdW5jdGlvbiBtZHgoe1xuICBsYWJlbCxcbiAgZGVzY3JpcHRpb24sXG4gIG9wdGlvbnMgPSB7fSxcbiAgY29tcG9uZW50cyA9IHt9XG59KSB7XG4gIGxldCBzY2hlbWE7XG4gIGNvbnN0IGNvbmZpZyA9IGVkaXRvck9wdGlvbnNUb0NvbmZpZyhvcHRpb25zKTtcbiAgbGV0IGdldFNjaGVtYSA9ICgpID0+IHtcbiAgICBpZiAoIXNjaGVtYSkge1xuICAgICAgc2NoZW1hID0gY3JlYXRlRWRpdG9yU2NoZW1hKCk7XG4gICAgfVxuICAgIHJldHVybiBzY2hlbWE7XG4gIH07XG4gIHJldHVybiB7XG4gICAga2luZDogJ2Zvcm0nLFxuICAgIGZvcm1LaW5kOiAnYXNzZXRzJyxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gZ2V0RGVmYXVsdFZhbHVlKGdldFNjaGVtYSgpKTtcbiAgICB9LFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChEb2N1bWVudEZpZWxkSW5wdXQsIHtcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHBhcnNlOiAodmFsdWUsIHtcbiAgICAgIG90aGVyLFxuICAgICAgZXh0ZXJuYWwsXG4gICAgICBzbHVnXG4gICAgfSkgPT4ge1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHBhcnNlVG9FZGl0b3JTdGF0ZU1EWCh2YWx1ZSwgZ2V0U2NoZW1hKCkpO1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIGRpcmVjdG9yaWVzOiBnZXREaXJlY3Rvcmllc0ZvckVkaXRvckZpZWxkKGNvbXBvbmVudHMsIGNvbmZpZyksXG4gICAgc2VyaWFsaXplKHZhbHVlLCB7XG4gICAgICBzbHVnXG4gICAgfSkge1xuICAgICAgY29uc3Qgb3V0ID0gc2VyaWFsaXplRnJvbUVkaXRvclN0YXRlTURYKCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBleHRlcm5hbDogb3V0LmV4dGVybmFsLFxuICAgICAgICBvdGhlcjogb3V0Lm90aGVyLFxuICAgICAgICB2YWx1ZTogb3V0LmNvbnRlbnRcbiAgICAgIH07XG4gICAgfSxcbiAgICByZWFkZXI6IHtcbiAgICAgIHBhcnNlOiB2YWx1ZSA9PiB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGNvbGxhYm9yYXRpb246IHtcbiAgICAgIHRvWWpzKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBwcm9zZW1pcnJvclRvWVhtbEZyYWdtZW50KHZhbHVlLmRvYyk7XG4gICAgICB9LFxuICAgICAgZnJvbVlqcyh5anNWYWx1ZSwgYXdhcmVuZXNzKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVFZGl0b3JTdGF0ZUZyb21ZSlMoZ2V0U2NoZW1hKCkpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCB7IG1hcmtkb2MgYXMgYSwgZ2V0RGlyZWN0b3JpZXNGb3JUcmVlS2V5IGFzIGIsIGdldENvbGxlY3Rpb25QYXRoIGFzIGMsIGRvY3VtZW50IGFzIGQsIGdldFNpbmdsZXRvbkZvcm1hdCBhcyBlLCBmaXhQYXRoIGFzIGYsIGdldFNyY1ByZWZpeCBhcyBnLCBnZXRTaW5nbGV0b25QYXRoIGFzIGgsIGJsb2JTaGEgYXMgaSwgZ2V0Q29sbGVjdGlvbkZvcm1hdCBhcyBqLCBnZXRTbHVnR2xvYkZvckNvbGxlY3Rpb24gYXMgaywgZ2V0RGF0YUZpbGVFeHRlbnNpb24gYXMgbCwgbWR4IGFzIG0sIGdldENvbGxlY3Rpb25JdGVtUGF0aCBhcyBuLCBvYmplY3QgYXMgbywgZ2V0RW50cnlEYXRhRmlsZXBhdGggYXMgcCwgZ2V0VmFsdWVBdFByb3BQYXRoIGFzIHEsIGdldFRyZWVOb2RlQXRQYXRoIGFzIHIsIHRyZWVFbnRyaWVzVG9UcmVlTm9kZXMgYXMgdCwgdXBkYXRlVHJlZVdpdGhDaGFuZ2VzIGFzIHUgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@keystatic/core/dist/index-360e5820.node.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@keystatic/core/dist/index-39d45899.node.js":
/*!******************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/index-39d45899.node.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   i: () => (/* binding */ integer)\n/* harmony export */ });\n/* harmony import */ var _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-1a9da0fb.node.js */ \"(ssr)/./node_modules/@keystatic/core/dist/index-1a9da0fb.node.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n\n\n\nfunction validateInteger(validation, value, label) {\n  if (value !== null && (typeof value !== 'number' || !Number.isInteger(value))) {\n    return `${label} must be a whole number`;\n  }\n  if (validation !== null && validation !== void 0 && validation.isRequired && value === null) {\n    return `${label} is required`;\n  }\n  if (value !== null) {\n    if ((validation === null || validation === void 0 ? void 0 : validation.min) !== undefined && value < validation.min) {\n      return `${label} must be at least ${validation.min}`;\n    }\n    if ((validation === null || validation === void 0 ? void 0 : validation.max) !== undefined && value > validation.max) {\n      return `${label} must be at most ${validation.max}`;\n    }\n  }\n}\n\nfunction integer({\n  label,\n  defaultValue,\n  validation,\n  description\n}) {\n  return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_0__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_0__.u, {\n        label: label,\n        description: description,\n        validation: validation,\n        ...props\n      });\n    },\n    defaultValue() {\n      return defaultValue !== null && defaultValue !== void 0 ? defaultValue : null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value === 'number') {\n        return value;\n      }\n      throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_0__.F('Must be a number');\n    },\n    validate(value) {\n      const message = validateInteger(validation, value, label);\n      if (message !== undefined) {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_0__.F(message);\n      }\n      (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_0__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value) {\n      return {\n        value: value === null ? undefined : value\n      };\n    }\n  });\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3QvaW5kZXgtMzlkNDU4OTkubm9kZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0o7QUFDOUc7O0FBRXhDO0FBQ0E7QUFDQSxjQUFjLE9BQU87QUFDckI7QUFDQTtBQUNBLGNBQWMsT0FBTztBQUNyQjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsT0FBTyxtQkFBbUIsZUFBZTtBQUN6RDtBQUNBO0FBQ0EsZ0JBQWdCLE9BQU8sa0JBQWtCLGVBQWU7QUFDeEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsU0FBUywwREFBbUM7QUFDNUM7QUFDQTtBQUNBLDBCQUEwQixzREFBRyxDQUFDLHNEQUFpQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixzREFBYztBQUM5QixLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHNEQUFjO0FBQ2hDO0FBQ0EsTUFBTSwwREFBYztBQUNwQjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUV3QiIsInNvdXJjZXMiOlsiL1VzZXJzL2phbWVzL0Rvd25sb2Fkcy9uZXcta2V5c3RhdGljLXByb2plY3Qvbm9kZV9tb2R1bGVzL0BrZXlzdGF0aWMvY29yZS9kaXN0L2luZGV4LTM5ZDQ1ODk5Lm5vZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYiBhcyBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSwgdSBhcyBJbnRlZ2VyRmllbGRJbnB1dCwgRiBhcyBGaWVsZERhdGFFcnJvciwgYyBhcyBhc3NlcnRSZXF1aXJlZCB9IGZyb20gJy4vaW5kZXgtMWE5ZGEwZmIubm9kZS5qcyc7XG5pbXBvcnQgeyBqc3ggfSBmcm9tICdyZWFjdC9qc3gtcnVudGltZSc7XG5cbmZ1bmN0aW9uIHZhbGlkYXRlSW50ZWdlcih2YWxpZGF0aW9uLCB2YWx1ZSwgbGFiZWwpIHtcbiAgaWYgKHZhbHVlICE9PSBudWxsICYmICh0eXBlb2YgdmFsdWUgIT09ICdudW1iZXInIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKHZhbHVlKSkpIHtcbiAgICByZXR1cm4gYCR7bGFiZWx9IG11c3QgYmUgYSB3aG9sZSBudW1iZXJgO1xuICB9XG4gIGlmICh2YWxpZGF0aW9uICE9PSBudWxsICYmIHZhbGlkYXRpb24gIT09IHZvaWQgMCAmJiB2YWxpZGF0aW9uLmlzUmVxdWlyZWQgJiYgdmFsdWUgPT09IG51bGwpIHtcbiAgICByZXR1cm4gYCR7bGFiZWx9IGlzIHJlcXVpcmVkYDtcbiAgfVxuICBpZiAodmFsdWUgIT09IG51bGwpIHtcbiAgICBpZiAoKHZhbGlkYXRpb24gPT09IG51bGwgfHwgdmFsaWRhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogdmFsaWRhdGlvbi5taW4pICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgPCB2YWxpZGF0aW9uLm1pbikge1xuICAgICAgcmV0dXJuIGAke2xhYmVsfSBtdXN0IGJlIGF0IGxlYXN0ICR7dmFsaWRhdGlvbi5taW59YDtcbiAgICB9XG4gICAgaWYgKCh2YWxpZGF0aW9uID09PSBudWxsIHx8IHZhbGlkYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbGlkYXRpb24ubWF4KSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlID4gdmFsaWRhdGlvbi5tYXgpIHtcbiAgICAgIHJldHVybiBgJHtsYWJlbH0gbXVzdCBiZSBhdCBtb3N0ICR7dmFsaWRhdGlvbi5tYXh9YDtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaW50ZWdlcih7XG4gIGxhYmVsLFxuICBkZWZhdWx0VmFsdWUsXG4gIHZhbGlkYXRpb24sXG4gIGRlc2NyaXB0aW9uXG59KSB7XG4gIHJldHVybiBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KEludGVnZXJGaWVsZElucHV0LCB7XG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICB2YWxpZGF0aW9uOiB2YWxpZGF0aW9uLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gZGVmYXVsdFZhbHVlICE9PSBudWxsICYmIGRlZmF1bHRWYWx1ZSAhPT0gdm9pZCAwID8gZGVmYXVsdFZhbHVlIDogbnVsbDtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIG51bWJlcicpO1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSB2YWxpZGF0ZUludGVnZXIodmFsaWRhdGlvbiwgdmFsdWUsIGxhYmVsKTtcbiAgICAgIGlmIChtZXNzYWdlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKG1lc3NhZ2UpO1xuICAgICAgfVxuICAgICAgYXNzZXJ0UmVxdWlyZWQodmFsdWUsIHZhbGlkYXRpb24sIGxhYmVsKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHZhbHVlID09PSBudWxsID8gdW5kZWZpbmVkIDogdmFsdWVcbiAgICAgIH07XG4gICAgfVxuICB9KTtcbn1cblxuZXhwb3J0IHsgaW50ZWdlciBhcyBpIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@keystatic/core/dist/index-39d45899.node.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@keystatic/core/dist/keystatic-core-ui.node.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/keystatic-core-ui.node.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Keystatic: () => (/* binding */ Keystatic)\n/* harmony export */ });\nfunction assertValidRepoConfig(repo) {\n  if (typeof repo === 'string') {\n    if (!repo.includes('/')) {\n      throw new Error(`Invalid repo config: ${repo}. It must be in the form owner/name`);\n    }\n  }\n  if (typeof repo === 'object') {\n    if (!repo.owner && !repo.name) {\n      throw new Error(`Invalid repo config: owner and name are missing`);\n    }\n    if (!repo.owner) {\n      throw new Error(`Invalid repo config: owner is missing`);\n    }\n    if (!repo.name) {\n      throw new Error(`Invalid repo config: name is missing`);\n    }\n  }\n}\n\nfunction Keystatic(props) {\n  if (props.config.storage.kind === 'github') {\n    assertValidRepoConfig(props.config.storage.repo);\n  }\n  return null;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3Qva2V5c3RhdGljLWNvcmUtdWkubm9kZS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLEtBQUs7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXFCIiwic291cmNlcyI6WyIvVXNlcnMvamFtZXMvRG93bmxvYWRzL25ldy1rZXlzdGF0aWMtcHJvamVjdC9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3Qva2V5c3RhdGljLWNvcmUtdWkubm9kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBhc3NlcnRWYWxpZFJlcG9Db25maWcocmVwbykge1xuICBpZiAodHlwZW9mIHJlcG8gPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKCFyZXBvLmluY2x1ZGVzKCcvJykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCByZXBvIGNvbmZpZzogJHtyZXBvfS4gSXQgbXVzdCBiZSBpbiB0aGUgZm9ybSBvd25lci9uYW1lYCk7XG4gICAgfVxuICB9XG4gIGlmICh0eXBlb2YgcmVwbyA9PT0gJ29iamVjdCcpIHtcbiAgICBpZiAoIXJlcG8ub3duZXIgJiYgIXJlcG8ubmFtZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHJlcG8gY29uZmlnOiBvd25lciBhbmQgbmFtZSBhcmUgbWlzc2luZ2ApO1xuICAgIH1cbiAgICBpZiAoIXJlcG8ub3duZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCByZXBvIGNvbmZpZzogb3duZXIgaXMgbWlzc2luZ2ApO1xuICAgIH1cbiAgICBpZiAoIXJlcG8ubmFtZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHJlcG8gY29uZmlnOiBuYW1lIGlzIG1pc3NpbmdgKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gS2V5c3RhdGljKHByb3BzKSB7XG4gIGlmIChwcm9wcy5jb25maWcuc3RvcmFnZS5raW5kID09PSAnZ2l0aHViJykge1xuICAgIGFzc2VydFZhbGlkUmVwb0NvbmZpZyhwcm9wcy5jb25maWcuc3RvcmFnZS5yZXBvKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IHsgS2V5c3RhdGljIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@keystatic/core/dist/keystatic-core-ui.node.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@keystatic/core/dist/keystatic-core.node.js":
/*!******************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/keystatic-core.node.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BlockWrapper: () => (/* binding */ BlockWrapper),\n/* harmony export */   NotEditable: () => (/* binding */ NotEditable),\n/* harmony export */   ToolbarSeparator: () => (/* binding */ ToolbarSeparator),\n/* harmony export */   collection: () => (/* binding */ collection),\n/* harmony export */   component: () => (/* reexport safe */ _api_51d0094d_node_js__WEBPACK_IMPORTED_MODULE_0__.c),\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   fields: () => (/* binding */ index),\n/* harmony export */   singleton: () => (/* binding */ singleton)\n/* harmony export */ });\n/* harmony import */ var _api_51d0094d_node_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./api-51d0094d.node.js */ \"(ssr)/./node_modules/@keystatic/core/dist/api-51d0094d.node.js\");\n/* harmony import */ var _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-1a9da0fb.node.js */ \"(ssr)/./node_modules/@keystatic/core/dist/index-1a9da0fb.node.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var _index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./index-360e5820.node.js */ \"(ssr)/./node_modules/@keystatic/core/dist/index-360e5820.node.js\");\n/* harmony import */ var emery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! emery */ \"(ssr)/./node_modules/emery/dist/emery.esm.js\");\n/* harmony import */ var _braintree_sanitize_url__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @braintree/sanitize-url */ \"(ssr)/./node_modules/@braintree/sanitize-url/dist/index.js\");\n/* harmony import */ var _index_39d45899_node_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./index-39d45899.node.js */ \"(ssr)/./node_modules/@keystatic/core/dist/index-39d45899.node.js\");\n/* harmony import */ var emery_assertions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! emery/assertions */ \"(ssr)/./node_modules/emery/assertions/dist/emery-assertions.esm.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! crypto */ \"crypto\");\n\n\n\n\n\n\n\n\n\n\n\n// Common\n\n// Storage\n// ----------------------------------------------------------------------------\n\n// ============================================================================\n// Functions\n// ============================================================================\n\nfunction config(config) {\n  return config;\n}\nfunction collection(collection) {\n  return collection;\n}\nfunction singleton(collection) {\n  return collection;\n}\n\nfunction array(element, opts) {\n  var _opts$label;\n  return {\n    kind: 'array',\n    element,\n    label: (_opts$label = opts === null || opts === void 0 ? void 0 : opts.label) !== null && _opts$label !== void 0 ? _opts$label : 'Items',\n    description: opts === null || opts === void 0 ? void 0 : opts.description,\n    itemLabel: opts === null || opts === void 0 ? void 0 : opts.itemLabel,\n    asChildTag: opts === null || opts === void 0 ? void 0 : opts.asChildTag,\n    slugField: opts === null || opts === void 0 ? void 0 : opts.slugField,\n    validation: opts === null || opts === void 0 ? void 0 : opts.validation\n  };\n}\n\nfunction select({\n  label,\n  options,\n  defaultValue,\n  description\n}) {\n  const optionValuesSet = new Set(options.map(x => x.value));\n  if (!optionValuesSet.has(defaultValue)) {\n    throw new Error(`A defaultValue of ${defaultValue} was provided to a select field but it does not match the value of one of the options provided`);\n  }\n  const field = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.S, {\n        label: label,\n        options: options,\n        description: description,\n        ...props\n      });\n    },\n    defaultValue() {\n      return defaultValue;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return defaultValue;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      if (!optionValuesSet.has(value)) {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a valid option');\n      }\n      return value;\n    },\n    validate(value) {\n      return value;\n    },\n    serialize(value) {\n      return {\n        value\n      };\n    }\n  });\n  return {\n    ...field,\n    options\n  };\n}\n\nfunction blocks(blocks, opts) {\n  const entries = Object.entries(blocks);\n  if (!entries.length) {\n    throw new Error('fields.blocks must have at least one entry');\n  }\n  const select$1 = select({\n    label: 'Kind',\n    defaultValue: entries[0][0],\n    options: Object.entries(blocks).map(([key, {\n      label\n    }]) => ({\n      label,\n      value: key\n    }))\n  });\n  const element = conditional(select$1, Object.fromEntries(entries.map(([key, {\n    schema\n  }]) => [key, schema])));\n  return {\n    ...array(element, {\n      label: opts.label,\n      description: opts.description,\n      validation: opts.validation,\n      itemLabel(props) {\n        const kind = props.discriminant;\n        const block = blocks[kind];\n        if (!block.itemLabel) return block.label;\n        return block.itemLabel(props.value);\n      }\n    }),\n    Input: _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.B\n  };\n}\n\nfunction checkbox({\n  label,\n  defaultValue = false,\n  description\n}) {\n  return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.C, {\n        ...props,\n        label: label,\n        description: description\n      });\n    },\n    defaultValue() {\n      return defaultValue;\n    },\n    parse(value) {\n      if (value === undefined) return defaultValue;\n      if (typeof value !== 'boolean') {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a boolean');\n      }\n      return value;\n    },\n    validate(value) {\n      return value;\n    },\n    serialize(value) {\n      return {\n        value\n      };\n    }\n  });\n}\n\nfunction child(options) {\n  return {\n    kind: 'child',\n    options: options.kind === 'block' ? {\n      ...options,\n      dividers: options.dividers,\n      formatting: options.formatting === 'inherit' ? {\n        blockTypes: 'inherit',\n        headingLevels: 'inherit',\n        inlineMarks: 'inherit',\n        listTypes: 'inherit',\n        alignment: 'inherit',\n        softBreaks: 'inherit'\n      } : options.formatting,\n      links: options.links,\n      images: options.images,\n      tables: options.tables,\n      componentBlocks: options.componentBlocks\n    } : {\n      kind: 'inline',\n      placeholder: options.placeholder,\n      formatting: options.formatting === 'inherit' ? {\n        inlineMarks: 'inherit',\n        softBreaks: 'inherit'\n      } : options.formatting,\n      links: options.links\n    }\n  };\n}\n\nfunction cloudImage({\n  label,\n  description,\n  validation\n}) {\n  return {\n    ...(0,_index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.o)({\n      src: (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.t)({\n        label: 'URL',\n        validation: {\n          length: {\n            min: validation !== null && validation !== void 0 && validation.isRequired ? 1 : 0\n          }\n        }\n      }),\n      alt: (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.t)({\n        label: 'Alt text'\n      }),\n      height: (0,_index_39d45899_node_js__WEBPACK_IMPORTED_MODULE_6__.i)({\n        label: 'Height'\n      }),\n      width: (0,_index_39d45899_node_js__WEBPACK_IMPORTED_MODULE_6__.i)({\n        label: 'Width'\n      })\n    }, {\n      label,\n      description\n    }),\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.a, {\n        ...props,\n        isRequired: validation === null || validation === void 0 ? void 0 : validation.isRequired\n      });\n    }\n  };\n}\n\nfunction conditional(discriminant, values) {\n  return {\n    kind: 'conditional',\n    discriminant,\n    values: values\n  };\n}\n\nfunction validateDate(validation, value, label) {\n  if (value !== null && !/^\\d{4}-\\d{2}-\\d{2}$/.test(value)) {\n    return `${label} is not a valid date`;\n  }\n  if (validation !== null && validation !== void 0 && validation.isRequired && value === null) {\n    return `${label} is required`;\n  }\n  if ((validation !== null && validation !== void 0 && validation.min || validation !== null && validation !== void 0 && validation.max) && value !== null) {\n    const date = new Date(value);\n    if ((validation === null || validation === void 0 ? void 0 : validation.min) !== undefined) {\n      const min = new Date(validation.min);\n      if (date < min) {\n        return `${label} must be after ${min.toLocaleDateString()}`;\n      }\n    }\n    if ((validation === null || validation === void 0 ? void 0 : validation.max) !== undefined) {\n      const max = new Date(validation.max);\n      if (date > max) {\n        return `${label} must be no later than ${max.toLocaleDateString()}`;\n      }\n    }\n  }\n}\n\nfunction date({\n  label,\n  defaultValue,\n  validation,\n  description\n}) {\n  return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.D, {\n        validation: validation,\n        label: label,\n        description: description,\n        ...props\n      });\n    },\n    defaultValue() {\n      if (defaultValue === undefined) {\n        return null;\n      }\n      if (typeof defaultValue === 'string') {\n        return defaultValue;\n      }\n      const today = new Date();\n      const year = today.getFullYear();\n      const month = String(today.getMonth() + 1).padStart(2, '0');\n      const day = String(today.getDate()).padStart(2, '0');\n      return `${year}-${month}-${day}`;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (value instanceof Date) {\n        const year = value.getUTCFullYear();\n        const month = String(value.getUTCMonth() + 1).padStart(2, '0');\n        const day = String(value.getUTCDate()).padStart(2, '0');\n        return `${year}-${month}-${day}`;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      return value;\n    },\n    serialize(value) {\n      if (value === null) return {\n        value: undefined\n      };\n      const date = new Date(value);\n      date.toISOString = () => value;\n      date.toString = () => value;\n      return {\n        value: date\n      };\n    },\n    validate(value) {\n      const message = validateDate(validation, value, label);\n      if (message !== undefined) {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F(message);\n      }\n      (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    }\n  });\n}\n\nfunction validateDatetime(validation, value, label) {\n  if (value !== null && !/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}$/.test(value)) {\n    return `${label} is not a valid datetime`;\n  }\n  if (validation !== null && validation !== void 0 && validation.isRequired && value === null) {\n    return `${label} is required`;\n  }\n  if ((validation !== null && validation !== void 0 && validation.min || validation !== null && validation !== void 0 && validation.max) && value !== null) {\n    const datetime = new Date(value);\n    if ((validation === null || validation === void 0 ? void 0 : validation.min) !== undefined) {\n      const min = new Date(validation.min);\n      if (datetime < min) {\n        return `${label} must be after ${min.toISOString()}`;\n      }\n    }\n    if ((validation === null || validation === void 0 ? void 0 : validation.max) !== undefined) {\n      const max = new Date(validation.max);\n      if (datetime > max) {\n        return `${label} must be no later than ${max.toISOString()}`;\n      }\n    }\n  }\n}\n\nfunction datetime({\n  label,\n  defaultValue,\n  validation,\n  description\n}) {\n  return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.d, {\n        validation: validation,\n        label: label,\n        description: description,\n        ...props\n      });\n    },\n    defaultValue() {\n      if (defaultValue === undefined) {\n        return null;\n      }\n      if (typeof defaultValue === 'string') {\n        return defaultValue;\n      }\n      if (defaultValue.kind === 'now') {\n        const now = new Date();\n        return new Date(now.getTime() - now.getTimezoneOffset() * 60 * 1000).toISOString().slice(0, -8);\n      }\n      return null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (value instanceof Date) {\n        return value.toISOString().slice(0, -8);\n      }\n      if (typeof value !== 'string') {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string or date');\n      }\n      return value;\n    },\n    serialize(value) {\n      if (value === null) return {\n        value: undefined\n      };\n      const date = new Date(value + 'Z');\n      date.toJSON = () => date.toISOString().slice(0, -8);\n      date.toString = () => date.toISOString().slice(0, -8);\n      return {\n        value: date\n      };\n    },\n    validate(value) {\n      const message = validateDatetime(validation, value, label);\n      if (message !== undefined) {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F(message);\n      }\n      (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    }\n  });\n}\n\nfunction empty() {\n  return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    Input() {\n      return null;\n    },\n    defaultValue() {\n      return null;\n    },\n    parse() {\n      return null;\n    },\n    serialize() {\n      return {\n        value: undefined\n      };\n    },\n    validate(value) {\n      return value;\n    },\n    label: 'Empty'\n  });\n}\n\n/**\n * @deprecated `emptyDocument` has been replaced with the `emptyContent` field\n */\nfunction emptyDocument() {\n  return {\n    kind: 'form',\n    formKind: 'content',\n    Input() {\n      return null;\n    },\n    defaultValue() {\n      return null;\n    },\n    parse() {\n      return null;\n    },\n    contentExtension: '.mdoc',\n    serialize() {\n      return {\n        value: undefined,\n        content: new Uint8Array(),\n        external: new Map(),\n        other: new Map()\n      };\n    },\n    validate(value) {\n      return value;\n    },\n    reader: {\n      parse() {\n        return null;\n      }\n    }\n  };\n}\n\nfunction emptyContent(opts) {\n  return {\n    kind: 'form',\n    formKind: 'content',\n    Input() {\n      return null;\n    },\n    defaultValue() {\n      return null;\n    },\n    parse() {\n      return null;\n    },\n    contentExtension: `.${opts.extension}`,\n    serialize() {\n      return {\n        value: undefined,\n        content: new Uint8Array(),\n        external: new Map(),\n        other: new Map()\n      };\n    },\n    validate(value) {\n      return value;\n    },\n    reader: {\n      parse() {\n        return null;\n      }\n    }\n  };\n}\n\nfunction file({\n  label,\n  directory,\n  validation,\n  description,\n  publicPath,\n  transformFilename\n}) {\n  return {\n    kind: 'form',\n    formKind: 'asset',\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.e, {\n        label: label,\n        description: description,\n        validation: validation,\n        transformFilename: transformFilename,\n        ...props\n      });\n    },\n    defaultValue() {\n      return null;\n    },\n    filename(value, args) {\n      if (typeof value === 'string') {\n        return value.slice((0,_index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug).length);\n      }\n      return undefined;\n    },\n    parse(value, args) {\n      var _value$match$, _value$match;\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      if (args.asset === undefined) {\n        return null;\n      }\n      return {\n        data: args.asset,\n        filename: value.slice((0,_index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug).length),\n        extension: (_value$match$ = (_value$match = value.match(/\\.([^.]+$)/)) === null || _value$match === void 0 ? void 0 : _value$match[1]) !== null && _value$match$ !== void 0 ? _value$match$ : ''\n      };\n    },\n    validate(value) {\n      (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value, args) {\n      if (value === null) {\n        return {\n          value: undefined,\n          asset: undefined\n        };\n      }\n      const filename = args.suggestedFilenamePrefix ? args.suggestedFilenamePrefix + '.' + value.extension : value.filename;\n      return {\n        value: `${(0,_index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug)}${filename}`,\n        asset: {\n          filename,\n          content: value.data\n        }\n      };\n    },\n    directory: directory ? (0,_index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.f)(directory) : undefined,\n    reader: {\n      parse(value) {\n        if (typeof value !== 'string' && value !== undefined) {\n          throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n        }\n        const val = value === undefined ? null : value;\n        (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.c)(val, validation, label);\n        return val;\n      }\n    }\n  };\n}\n\nfunction image({\n  label,\n  directory,\n  validation,\n  description,\n  publicPath,\n  transformFilename\n}) {\n  return {\n    kind: 'form',\n    formKind: 'asset',\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.I, {\n        label: label,\n        description: description,\n        validation: validation,\n        transformFilename: transformFilename,\n        ...props\n      });\n    },\n    defaultValue() {\n      return null;\n    },\n    filename(value, args) {\n      if (typeof value === 'string') {\n        return value.slice((0,_index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug).length);\n      }\n      return undefined;\n    },\n    parse(value, args) {\n      var _value$match$, _value$match;\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      if (args.asset === undefined) {\n        return null;\n      }\n      return {\n        data: args.asset,\n        filename: value.slice((0,_index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug).length),\n        extension: (_value$match$ = (_value$match = value.match(/\\.([^.]+$)/)) === null || _value$match === void 0 ? void 0 : _value$match[1]) !== null && _value$match$ !== void 0 ? _value$match$ : ''\n      };\n    },\n    validate(value) {\n      (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value, args) {\n      if (value === null) {\n        return {\n          value: undefined,\n          asset: undefined\n        };\n      }\n      const filename = args.suggestedFilenamePrefix ? args.suggestedFilenamePrefix + '.' + value.extension : value.filename;\n      return {\n        value: `${(0,_index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug)}${filename}`,\n        asset: {\n          filename,\n          content: value.data\n        }\n      };\n    },\n    directory: directory ? (0,_index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.f)(directory) : undefined,\n    reader: {\n      parse(value) {\n        if (typeof value !== 'string' && value !== undefined) {\n          throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n        }\n        const val = value === undefined ? null : value;\n        (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.c)(val, validation, label);\n        return val;\n      }\n    }\n  };\n}\n\nfunction pluralize(count, options) {\n  const {\n    singular,\n    plural = singular + 's',\n    inclusive = true\n  } = options;\n  const variant = count === 1 ? singular : plural;\n  return inclusive ? `${count} ${variant}` : variant;\n}\n\nfunction validateMultiRelationshipLength(validation, value) {\n  var _validation$length$mi, _validation$length, _validation$length$ma, _validation$length2;\n  const minLength = (_validation$length$mi = validation === null || validation === void 0 || (_validation$length = validation.length) === null || _validation$length === void 0 ? void 0 : _validation$length.min) !== null && _validation$length$mi !== void 0 ? _validation$length$mi : 0;\n  if (value.length < minLength) {\n    return `Must have at least ${pluralize(minLength, {\n      singular: 'item'\n    })}.`;\n  }\n  const maxLength = (_validation$length$ma = validation === null || validation === void 0 || (_validation$length2 = validation.length) === null || _validation$length2 === void 0 ? void 0 : _validation$length2.max) !== null && _validation$length$ma !== void 0 ? _validation$length$ma : Infinity;\n  if (value.length > maxLength) {\n    return `Must have at most ${pluralize(maxLength, {\n      singular: 'item'\n    })}.`;\n  }\n}\n\nfunction multiRelationship({\n  label,\n  collection,\n  validation,\n  description\n}) {\n  return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.M, {\n        label: label,\n        collection: collection,\n        description: description,\n        validation: validation,\n        ...props\n      });\n    },\n    defaultValue() {\n      return [];\n    },\n    parse(value) {\n      if (value === undefined) {\n        return [];\n      }\n      if (!Array.isArray(value) || !value.every(emery__WEBPACK_IMPORTED_MODULE_4__.isString)) {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be an array of strings');\n      }\n      return value;\n    },\n    validate(value) {\n      const error = validateMultiRelationshipLength(validation, value);\n      if (error) {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F(error);\n      }\n      return value;\n    },\n    serialize(value) {\n      return {\n        value\n      };\n    }\n  });\n}\n\nfunction multiselect({\n  label,\n  options,\n  defaultValue = [],\n  description\n}) {\n  const valuesToOption = new Map(options.map(x => [x.value, x]));\n  const field = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.f, {\n        label: label,\n        description: description,\n        options: options,\n        ...props\n      });\n    },\n    defaultValue() {\n      return defaultValue;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return [];\n      }\n      if (!Array.isArray(value)) {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be an array of options');\n      }\n      if (!value.every(x => typeof x === 'string' && valuesToOption.has(x))) {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F(`Must be an array with one of ${options.map(x => x.value).join(', ')}`);\n      }\n      return value;\n    },\n    validate(value) {\n      return value;\n    },\n    serialize(value) {\n      return {\n        value\n      };\n    }\n  });\n  return {\n    ...field,\n    options\n  };\n}\n\nfunction validateNumber(validation, value, step, label) {\n  if (value !== null && typeof value !== 'number') {\n    return `${label} must be a number`;\n  }\n  if (validation !== null && validation !== void 0 && validation.isRequired && value === null) {\n    return `${label} is required`;\n  }\n  if (value !== null) {\n    if ((validation === null || validation === void 0 ? void 0 : validation.min) !== undefined && value < validation.min) {\n      return `${label} must be at least ${validation.min}`;\n    }\n    if ((validation === null || validation === void 0 ? void 0 : validation.max) !== undefined && value > validation.max) {\n      return `${label} must be at most ${validation.max}`;\n    }\n    if (step !== undefined && (validation === null || validation === void 0 ? void 0 : validation.validateStep) !== undefined && !isAtStep(value, step)) {\n      return `${label} must be a multiple of ${step}`;\n    }\n  }\n}\nfunction decimalPlaces(value) {\n  const stringified = value.toString();\n  const indexOfDecimal = stringified.indexOf('.');\n  if (indexOfDecimal === -1) {\n    const indexOfE = stringified.indexOf('e-');\n    return indexOfE === -1 ? 0 : parseInt(stringified.slice(indexOfE + 2));\n  }\n  return stringified.length - indexOfDecimal - 1;\n}\nfunction isAtStep(value, step) {\n  const dc = Math.max(decimalPlaces(step), decimalPlaces(value));\n  const base = Math.pow(10, dc);\n  return value * base % (step * base) === 0;\n}\n\nfunction number({\n  label,\n  defaultValue,\n  step,\n  validation,\n  description\n}) {\n  return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.N, {\n        label: label,\n        description: description,\n        validation: validation,\n        step: step,\n        ...props\n      });\n    },\n    defaultValue() {\n      return defaultValue !== null && defaultValue !== void 0 ? defaultValue : null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value === 'number') {\n        return value;\n      }\n      throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a number');\n    },\n    validate(value) {\n      const message = validateNumber(validation, value, step, label);\n      if (message !== undefined) {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F(message);\n      }\n      (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value) {\n      return {\n        value: value === null ? undefined : value\n      };\n    }\n  });\n}\n\nfunction pathReference({\n  label,\n  pattern,\n  validation,\n  description\n}) {\n  return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.P, {\n        label: label,\n        pattern: pattern,\n        description: description,\n        validation: validation,\n        ...props\n      });\n    },\n    defaultValue() {\n      return null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      return value;\n    },\n    validate(value) {\n      (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value) {\n      return {\n        value: value === null ? undefined : value\n      };\n    }\n  });\n}\n\nfunction relationship({\n  label,\n  collection,\n  validation,\n  description\n}) {\n  return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.R, {\n        label: label,\n        collection: collection,\n        description: description,\n        validation: validation,\n        ...props\n      });\n    },\n    defaultValue() {\n      return null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      return value;\n    },\n    validate(value) {\n      (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value) {\n      return {\n        value: value === null ? undefined : value\n      };\n    }\n  });\n}\n\nfunction parseSlugFieldAsNormalField(value) {\n  if (value === undefined) {\n    return {\n      name: '',\n      slug: ''\n    };\n  }\n  if (typeof value !== 'object') {\n    throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be an object');\n  }\n  if (Object.keys(value).length !== 2) {\n    throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Unexpected keys');\n  }\n  if (!('name' in value) || !('slug' in value)) {\n    throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Missing name or slug');\n  }\n  if (typeof value.name !== 'string') {\n    throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('name must be a string');\n  }\n  if (typeof value.slug !== 'string') {\n    throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('slug must be a string');\n  }\n  return {\n    name: value.name,\n    slug: value.slug\n  };\n}\nfunction parseAsSlugField(value, slug) {\n  if (value === undefined) {\n    return {\n      name: '',\n      slug\n    };\n  }\n  if (typeof value !== 'string') {\n    throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n  }\n  return {\n    name: value,\n    slug\n  };\n}\nfunction slug(_args) {\n  var _args$name$validation, _args$name$validation2, _args$name$validation3, _args$name$validation4, _args$name$validation5, _args$slug;\n  const args = {\n    ..._args,\n    name: {\n      ..._args.name,\n      validation: {\n        pattern: (_args$name$validation = _args.name.validation) === null || _args$name$validation === void 0 ? void 0 : _args$name$validation.pattern,\n        length: {\n          min: Math.max((_args$name$validation2 = _args.name.validation) !== null && _args$name$validation2 !== void 0 && _args$name$validation2.isRequired ? 1 : 0, (_args$name$validation3 = (_args$name$validation4 = _args.name.validation) === null || _args$name$validation4 === void 0 || (_args$name$validation4 = _args$name$validation4.length) === null || _args$name$validation4 === void 0 ? void 0 : _args$name$validation4.min) !== null && _args$name$validation3 !== void 0 ? _args$name$validation3 : 0),\n          max: (_args$name$validation5 = _args.name.validation) === null || _args$name$validation5 === void 0 || (_args$name$validation5 = _args$name$validation5.length) === null || _args$name$validation5 === void 0 ? void 0 : _args$name$validation5.max\n        }\n      }\n    }\n  };\n  const naiveGenerateSlug = ((_args$slug = args.slug) === null || _args$slug === void 0 ? void 0 : _args$slug.generate) || _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.s;\n  let _defaultValue;\n  function defaultValue() {\n    if (!_defaultValue) {\n      var _args$name$defaultVal, _args$name$defaultVal2;\n      _defaultValue = {\n        name: (_args$name$defaultVal = args.name.defaultValue) !== null && _args$name$defaultVal !== void 0 ? _args$name$defaultVal : '',\n        slug: naiveGenerateSlug((_args$name$defaultVal2 = args.name.defaultValue) !== null && _args$name$defaultVal2 !== void 0 ? _args$name$defaultVal2 : '')\n      };\n    }\n    return _defaultValue;\n  }\n  function validate(value, {\n    slugField\n  } = {\n    slugField: undefined\n  }) {\n    var _args$name$validation6, _args$name$validation7, _args$name$validation8, _args$name$validation9, _args$name$validation10, _args$slug$validation, _args$slug2, _args$slug$validation2, _args$slug3, _args$slug$label, _args$slug4, _args$slug5;\n    const nameMessage = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.v)(value.name, (_args$name$validation6 = (_args$name$validation7 = args.name.validation) === null || _args$name$validation7 === void 0 || (_args$name$validation7 = _args$name$validation7.length) === null || _args$name$validation7 === void 0 ? void 0 : _args$name$validation7.min) !== null && _args$name$validation6 !== void 0 ? _args$name$validation6 : 0, (_args$name$validation8 = (_args$name$validation9 = args.name.validation) === null || _args$name$validation9 === void 0 || (_args$name$validation9 = _args$name$validation9.length) === null || _args$name$validation9 === void 0 ? void 0 : _args$name$validation9.max) !== null && _args$name$validation8 !== void 0 ? _args$name$validation8 : Infinity, args.name.label, undefined, (_args$name$validation10 = args.name.validation) === null || _args$name$validation10 === void 0 ? void 0 : _args$name$validation10.pattern);\n    if (nameMessage !== undefined) {\n      throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F(nameMessage);\n    }\n    const slugMessage = (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.v)(value.slug, (_args$slug$validation = (_args$slug2 = args.slug) === null || _args$slug2 === void 0 || (_args$slug2 = _args$slug2.validation) === null || _args$slug2 === void 0 || (_args$slug2 = _args$slug2.length) === null || _args$slug2 === void 0 ? void 0 : _args$slug2.min) !== null && _args$slug$validation !== void 0 ? _args$slug$validation : 1, (_args$slug$validation2 = (_args$slug3 = args.slug) === null || _args$slug3 === void 0 || (_args$slug3 = _args$slug3.validation) === null || _args$slug3 === void 0 || (_args$slug3 = _args$slug3.length) === null || _args$slug3 === void 0 ? void 0 : _args$slug3.max) !== null && _args$slug$validation2 !== void 0 ? _args$slug$validation2 : Infinity, (_args$slug$label = (_args$slug4 = args.slug) === null || _args$slug4 === void 0 ? void 0 : _args$slug4.label) !== null && _args$slug$label !== void 0 ? _args$slug$label : 'Slug', slugField ? slugField : {\n      slugs: emptySet,\n      glob: '*'\n    }, (_args$slug5 = args.slug) === null || _args$slug5 === void 0 || (_args$slug5 = _args$slug5.validation) === null || _args$slug5 === void 0 ? void 0 : _args$slug5.pattern);\n    if (slugMessage !== undefined) {\n      throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F(slugMessage);\n    }\n    return value;\n  }\n  const emptySet = new Set();\n  return {\n    kind: 'form',\n    formKind: 'slug',\n    label: args.name.label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.g, {\n        args: args,\n        naiveGenerateSlug: naiveGenerateSlug,\n        defaultValue: defaultValue(),\n        ...props\n      });\n    },\n    defaultValue,\n    parse(value, args) {\n      if ((args === null || args === void 0 ? void 0 : args.slug) !== undefined) {\n        return parseAsSlugField(value, args.slug);\n      }\n      return parseSlugFieldAsNormalField(value);\n    },\n    validate,\n    serialize(value) {\n      return {\n        value\n      };\n    },\n    serializeWithSlug(value) {\n      return {\n        value: value.name,\n        slug: value.slug\n      };\n    },\n    reader: {\n      parse(value) {\n        const parsed = parseSlugFieldAsNormalField(value);\n        return validate(parsed);\n      },\n      parseWithSlug(value, args) {\n        return validate(parseAsSlugField(value, args.slug), {\n          slugField: {\n            glob: args.glob,\n            slugs: emptySet\n          }\n        }).name;\n      }\n    }\n  };\n}\n\nfunction isValidURL(url) {\n  return url === (0,_braintree_sanitize_url__WEBPACK_IMPORTED_MODULE_5__.sanitizeUrl)(url);\n}\n\nfunction validateUrl(validation, value, label) {\n  if (value !== null && (typeof value !== 'string' || !isValidURL(value))) {\n    return `${label} is not a valid URL`;\n  }\n  if (validation !== null && validation !== void 0 && validation.isRequired && value === null) {\n    return `${label} is required`;\n  }\n}\n\nfunction url({\n  label,\n  defaultValue,\n  validation,\n  description\n}) {\n  return (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.U, {\n        label: label,\n        description: description,\n        validation: validation,\n        ...props\n      });\n    },\n    defaultValue() {\n      return defaultValue || null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      return value === '' ? null : value;\n    },\n    validate(value) {\n      const message = validateUrl(validation, value, label);\n      if (message !== undefined) {\n        throw new _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.F(message);\n      }\n      (0,_index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value) {\n      return {\n        value: value === null ? undefined : value\n      };\n    }\n  });\n}\n\nfunction ignored() {\n  return {\n    kind: 'form',\n    Input() {\n      return null;\n    },\n    defaultValue() {\n      return {\n        value: undefined\n      };\n    },\n    parse(value) {\n      return {\n        value\n      };\n    },\n    serialize(value) {\n      return value;\n    },\n    validate(value) {\n      return value;\n    },\n    label: 'Ignored',\n    reader: {\n      parse(value) {\n        return value;\n      }\n    }\n  };\n}\n\nvar index = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  array: array,\n  blocks: blocks,\n  checkbox: checkbox,\n  child: child,\n  cloudImage: cloudImage,\n  conditional: conditional,\n  date: date,\n  datetime: datetime,\n  document: _index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.d,\n  empty: empty,\n  emptyDocument: emptyDocument,\n  emptyContent: emptyContent,\n  file: file,\n  image: image,\n  integer: _index_39d45899_node_js__WEBPACK_IMPORTED_MODULE_6__.i,\n  multiRelationship: multiRelationship,\n  multiselect: multiselect,\n  number: number,\n  object: _index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.o,\n  pathReference: pathReference,\n  relationship: relationship,\n  select: select,\n  slug: slug,\n  text: _index_1a9da0fb_node_js__WEBPACK_IMPORTED_MODULE_1__.t,\n  url: url,\n  ignored: ignored,\n  mdx: _index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.m,\n  markdoc: _index_360e5820_node_js__WEBPACK_IMPORTED_MODULE_3__.a\n});\n\nfunction BlockWrapper() {}\nfunction NotEditable() {}\nfunction ToolbarSeparator() {}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3Qva2V5c3RhdGljLWNvcmUubm9kZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF3RDtBQUN1ZDtBQUN2ZTtBQUN1RjtBQUM5RjtBQUNxQjtBQUNFO0FBQ2Y7QUFDZjtBQUNWOztBQUVoQjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EseUNBQXlDLGNBQWM7QUFDdkQ7QUFDQSxnQkFBZ0IsMERBQW1DO0FBQ25EO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQUcsQ0FBQyxzREFBZ0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixzREFBYztBQUNoQztBQUNBO0FBQ0Esa0JBQWtCLHNEQUFjO0FBQ2hDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFdBQVcsc0RBQWdCO0FBQzNCO0FBQ0E7O0FBRUE7QUFDQTtB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Q2hDO0FBQ0EsTUFBTSwwREFBYztBQUNwQjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHNEQUFRO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLHNEQUFPO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLFVBQVUsc0RBQU07QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFJO0FBQ1o7QUFDQTtBQUNBLE9BQU8sc0RBQUc7QUFDVixXQUFXLHNEQUFPO0FBQ2xCLENBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUV1RyIsInNvdXJjZXMiOlsiL1VzZXJzL2phbWVzL0Rvd25sb2Fkcy9uZXcta2V5c3RhdGljLXByb2plY3Qvbm9kZV9tb2R1bGVzL0BrZXlzdGF0aWMvY29yZS9kaXN0L2tleXN0YXRpYy1jb3JlLm5vZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHsgYyBhcyBjb21wb25lbnQgfSBmcm9tICcuL2FwaS01MWQwMDk0ZC5ub2RlLmpzJztcbmltcG9ydCB7IGIgYXMgYmFzaWNGb3JtRmllbGRXaXRoU2ltcGxlUmVhZGVyUGFyc2UsIFMgYXMgU2VsZWN0RmllbGRJbnB1dCwgRiBhcyBGaWVsZERhdGFFcnJvciwgQiBhcyBCbG9ja3NGaWVsZElucHV0LCBDIGFzIENoZWNrYm94RmllbGRJbnB1dCwgdCBhcyB0ZXh0LCBhIGFzIENsb3VkSW1hZ2VGaWVsZElucHV0LCBEIGFzIERhdGVGaWVsZElucHV0LCBjIGFzIGFzc2VydFJlcXVpcmVkLCBkIGFzIERhdGV0aW1lRmllbGRJbnB1dCwgZSBhcyBGaWxlRmllbGRJbnB1dCwgSSBhcyBJbWFnZUZpZWxkSW5wdXQsIE0gYXMgTXVsdGlSZWxhdGlvbnNoaXBJbnB1dCwgZiBhcyBNdWx0aXNlbGVjdEZpZWxkSW5wdXQsIE4gYXMgTnVtYmVyRmllbGRJbnB1dCwgUCBhcyBQYXRoUmVmZXJlbmNlSW5wdXQsIFIgYXMgUmVsYXRpb25zaGlwSW5wdXQsIHMgYXMgc2x1Z2lmeSwgZyBhcyBTbHVnRmllbGRJbnB1dCwgdiBhcyB2YWxpZGF0ZVRleHQsIFUgYXMgVXJsRmllbGRJbnB1dCB9IGZyb20gJy4vaW5kZXgtMWE5ZGEwZmIubm9kZS5qcyc7XG5pbXBvcnQgeyBqc3ggfSBmcm9tICdyZWFjdC9qc3gtcnVudGltZSc7XG5pbXBvcnQgeyBvIGFzIG9iamVjdCwgZyBhcyBnZXRTcmNQcmVmaXgsIGYgYXMgZml4UGF0aCwgZCBhcyBkb2N1bWVudCwgbSBhcyBtZHgsIGEgYXMgbWFya2RvYyB9IGZyb20gJy4vaW5kZXgtMzYwZTU4MjAubm9kZS5qcyc7XG5pbXBvcnQgeyBpc1N0cmluZyB9IGZyb20gJ2VtZXJ5JztcbmltcG9ydCB7IHNhbml0aXplVXJsIH0gZnJvbSAnQGJyYWludHJlZS9zYW5pdGl6ZS11cmwnO1xuaW1wb3J0IHsgaSBhcyBpbnRlZ2VyIH0gZnJvbSAnLi9pbmRleC0zOWQ0NTg5OS5ub2RlLmpzJztcbmltcG9ydCAnQG1hcmtkb2MvbWFya2RvYy9kaXN0L2luZGV4Lm1qcyc7XG5pbXBvcnQgJ2VtZXJ5L2Fzc2VydGlvbnMnO1xuaW1wb3J0ICdjcnlwdG8nO1xuXG4vLyBDb21tb25cblxuLy8gU3RvcmFnZVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBGdW5jdGlvbnNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gY29uZmlnKGNvbmZpZykge1xuICByZXR1cm4gY29uZmlnO1xufVxuZnVuY3Rpb24gY29sbGVjdGlvbihjb2xsZWN0aW9uKSB7XG4gIHJldHVybiBjb2xsZWN0aW9uO1xufVxuZnVuY3Rpb24gc2luZ2xldG9uKGNvbGxlY3Rpb24pIHtcbiAgcmV0dXJuIGNvbGxlY3Rpb247XG59XG5cbmZ1bmN0aW9uIGFycmF5KGVsZW1lbnQsIG9wdHMpIHtcbiAgdmFyIF9vcHRzJGxhYmVsO1xuICByZXR1cm4ge1xuICAgIGtpbmQ6ICdhcnJheScsXG4gICAgZWxlbWVudCxcbiAgICBsYWJlbDogKF9vcHRzJGxhYmVsID0gb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLmxhYmVsKSAhPT0gbnVsbCAmJiBfb3B0cyRsYWJlbCAhPT0gdm9pZCAwID8gX29wdHMkbGFiZWwgOiAnSXRlbXMnLFxuICAgIGRlc2NyaXB0aW9uOiBvcHRzID09PSBudWxsIHx8IG9wdHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdHMuZGVzY3JpcHRpb24sXG4gICAgaXRlbUxhYmVsOiBvcHRzID09PSBudWxsIHx8IG9wdHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdHMuaXRlbUxhYmVsLFxuICAgIGFzQ2hpbGRUYWc6IG9wdHMgPT09IG51bGwgfHwgb3B0cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0cy5hc0NoaWxkVGFnLFxuICAgIHNsdWdGaWVsZDogb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLnNsdWdGaWVsZCxcbiAgICB2YWxpZGF0aW9uOiBvcHRzID09PSBudWxsIHx8IG9wdHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdHMudmFsaWRhdGlvblxuICB9O1xufVxuXG5mdW5jdGlvbiBzZWxlY3Qoe1xuICBsYWJlbCxcbiAgb3B0aW9ucyxcbiAgZGVmYXVsdFZhbHVlLFxuICBkZXNjcmlwdGlvblxufSkge1xuICBjb25zdCBvcHRpb25WYWx1ZXNTZXQgPSBuZXcgU2V0KG9wdGlvbnMubWFwKHggPT4geC52YWx1ZSkpO1xuICBpZiAoIW9wdGlvblZhbHVlc1NldC5oYXMoZGVmYXVsdFZhbHVlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgQSBkZWZhdWx0VmFsdWUgb2YgJHtkZWZhdWx0VmFsdWV9IHdhcyBwcm92aWRlZCB0byBhIHNlbGVjdCBmaWVsZCBidXQgaXQgZG9lcyBub3QgbWF0Y2ggdGhlIHZhbHVlIG9mIG9uZSBvZiB0aGUgb3B0aW9ucyBwcm92aWRlZGApO1xuICB9XG4gIGNvbnN0IGZpZWxkID0gYmFzaWNGb3JtRmllbGRXaXRoU2ltcGxlUmVhZGVyUGFyc2Uoe1xuICAgIGxhYmVsLFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChTZWxlY3RGaWVsZElucHV0LCB7XG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgb3B0aW9uczogb3B0aW9ucyxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgIH0sXG4gICAgcGFyc2UodmFsdWUpIHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYSBzdHJpbmcnKTtcbiAgICAgIH1cbiAgICAgIGlmICghb3B0aW9uVmFsdWVzU2V0Lmhhcyh2YWx1ZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgdmFsaWQgb3B0aW9uJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKHZhbHVlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZVxuICAgICAgfTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4ge1xuICAgIC4uLmZpZWxkLFxuICAgIG9wdGlvbnNcbiAgfTtcbn1cblxuZnVuY3Rpb24gYmxvY2tzKGJsb2Nrcywgb3B0cykge1xuICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMoYmxvY2tzKTtcbiAgaWYgKCFlbnRyaWVzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBFcnJvcignZmllbGRzLmJsb2NrcyBtdXN0IGhhdmUgYXQgbGVhc3Qgb25lIGVudHJ5Jyk7XG4gIH1cbiAgY29uc3Qgc2VsZWN0JDEgPSBzZWxlY3Qoe1xuICAgIGxhYmVsOiAnS2luZCcsXG4gICAgZGVmYXVsdFZhbHVlOiBlbnRyaWVzWzBdWzBdLFxuICAgIG9wdGlvbnM6IE9iamVjdC5lbnRyaWVzKGJsb2NrcykubWFwKChba2V5LCB7XG4gICAgICBsYWJlbFxuICAgIH1dKSA9PiAoe1xuICAgICAgbGFiZWwsXG4gICAgICB2YWx1ZToga2V5XG4gICAgfSkpXG4gIH0pO1xuICBjb25zdCBlbGVtZW50ID0gY29uZGl0aW9uYWwoc2VsZWN0JDEsIE9iamVjdC5mcm9tRW50cmllcyhlbnRyaWVzLm1hcCgoW2tleSwge1xuICAgIHNjaGVtYVxuICB9XSkgPT4gW2tleSwgc2NoZW1hXSkpKTtcbiAgcmV0dXJuIHtcbiAgICAuLi5hcnJheShlbGVtZW50LCB7XG4gICAgICBsYWJlbDogb3B0cy5sYWJlbCxcbiAgICAgIGRlc2NyaXB0aW9uOiBvcHRzLmRlc2NyaXB0aW9uLFxuICAgICAgdmFsaWRhdGlvbjogb3B0cy52YWxpZGF0aW9uLFxuICAgICAgaXRlbUxhYmVsKHByb3BzKSB7XG4gICAgICAgIGNvbnN0IGtpbmQgPSBwcm9wcy5kaXNjcmltaW5hbnQ7XG4gICAgICAgIGNvbnN0IGJsb2NrID0gYmxvY2tzW2tpbmRdO1xuICAgICAgICBpZiAoIWJsb2NrLml0ZW1MYWJlbCkgcmV0dXJuIGJsb2NrLmxhYmVsO1xuICAgICAgICByZXR1cm4gYmxvY2suaXRlbUxhYmVsKHByb3BzLnZhbHVlKTtcbiAgICAgIH1cbiAgICB9KSxcbiAgICBJbnB1dDogQmxvY2tzRmllbGRJbnB1dFxuICB9O1xufVxuXG5mdW5jdGlvbiBjaGVja2JveCh7XG4gIGxhYmVsLFxuICBkZWZhdWx0VmFsdWUgPSBmYWxzZSxcbiAgZGVzY3JpcHRpb25cbn0pIHtcbiAgcmV0dXJuIGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlKHtcbiAgICBsYWJlbCxcbiAgICBJbnB1dChwcm9wcykge1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9qc3goQ2hlY2tib3hGaWVsZElucHV0LCB7XG4gICAgICAgIC4uLnByb3BzLFxuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvblxuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgIH0sXG4gICAgcGFyc2UodmFsdWUpIHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIGJvb2xlYW4nKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBzZXJpYWxpemUodmFsdWUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlXG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGNoaWxkKG9wdGlvbnMpIHtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnY2hpbGQnLFxuICAgIG9wdGlvbnM6IG9wdGlvbnMua2luZCA9PT0gJ2Jsb2NrJyA/IHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICBkaXZpZGVyczogb3B0aW9ucy5kaXZpZGVycyxcbiAgICAgIGZvcm1hdHRpbmc6IG9wdGlvbnMuZm9ybWF0dGluZyA9PT0gJ2luaGVyaXQnID8ge1xuICAgICAgICBibG9ja1R5cGVzOiAnaW5oZXJpdCcsXG4gICAgICAgIGhlYWRpbmdMZXZlbHM6ICdpbmhlcml0JyxcbiAgICAgICAgaW5saW5lTWFya3M6ICdpbmhlcml0JyxcbiAgICAgICAgbGlzdFR5cGVzOiAnaW5oZXJpdCcsXG4gICAgICAgIGFsaWdubWVudDogJ2luaGVyaXQnLFxuICAgICAgICBzb2Z0QnJlYWtzOiAnaW5oZXJpdCdcbiAgICAgIH0gOiBvcHRpb25zLmZvcm1hdHRpbmcsXG4gICAgICBsaW5rczogb3B0aW9ucy5saW5rcyxcbiAgICAgIGltYWdlczogb3B0aW9ucy5pbWFnZXMsXG4gICAgICB0YWJsZXM6IG9wdGlvbnMudGFibGVzLFxuICAgICAgY29tcG9uZW50QmxvY2tzOiBvcHRpb25zLmNvbXBvbmVudEJsb2Nrc1xuICAgIH0gOiB7XG4gICAgICBraW5kOiAnaW5saW5lJyxcbiAgICAgIHBsYWNlaG9sZGVyOiBvcHRpb25zLnBsYWNlaG9sZGVyLFxuICAgICAgZm9ybWF0dGluZzogb3B0aW9ucy5mb3JtYXR0aW5nID09PSAnaW5oZXJpdCcgPyB7XG4gICAgICAgIGlubGluZU1hcmtzOiAnaW5oZXJpdCcsXG4gICAgICAgIHNvZnRCcmVha3M6ICdpbmhlcml0J1xuICAgICAgfSA6IG9wdGlvbnMuZm9ybWF0dGluZyxcbiAgICAgIGxpbmtzOiBvcHRpb25zLmxpbmtzXG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBjbG91ZEltYWdlKHtcbiAgbGFiZWwsXG4gIGRlc2NyaXB0aW9uLFxuICB2YWxpZGF0aW9uXG59KSB7XG4gIHJldHVybiB7XG4gICAgLi4ub2JqZWN0KHtcbiAgICAgIHNyYzogdGV4dCh7XG4gICAgICAgIGxhYmVsOiAnVVJMJyxcbiAgICAgICAgdmFsaWRhdGlvbjoge1xuICAgICAgICAgIGxlbmd0aDoge1xuICAgICAgICAgICAgbWluOiB2YWxpZGF0aW9uICE9PSBudWxsICYmIHZhbGlkYXRpb24gIT09IHZvaWQgMCAmJiB2YWxpZGF0aW9uLmlzUmVxdWlyZWQgPyAxIDogMFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSksXG4gICAgICBhbHQ6IHRleHQoe1xuICAgICAgICBsYWJlbDogJ0FsdCB0ZXh0J1xuICAgICAgfSksXG4gICAgICBoZWlnaHQ6IGludGVnZXIoe1xuICAgICAgICBsYWJlbDogJ0hlaWdodCdcbiAgICAgIH0pLFxuICAgICAgd2lkdGg6IGludGVnZXIoe1xuICAgICAgICBsYWJlbDogJ1dpZHRoJ1xuICAgICAgfSlcbiAgICB9LCB7XG4gICAgICBsYWJlbCxcbiAgICAgIGRlc2NyaXB0aW9uXG4gICAgfSksXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KENsb3VkSW1hZ2VGaWVsZElucHV0LCB7XG4gICAgICAgIC4uLnByb3BzLFxuICAgICAgICBpc1JlcXVpcmVkOiB2YWxpZGF0aW9uID09PSBudWxsIHx8IHZhbGlkYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbGlkYXRpb24uaXNSZXF1aXJlZFxuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBjb25kaXRpb25hbChkaXNjcmltaW5hbnQsIHZhbHVlcykge1xuICByZXR1cm4ge1xuICAgIGtpbmQ6ICdjb25kaXRpb25hbCcsXG4gICAgZGlzY3JpbWluYW50LFxuICAgIHZhbHVlczogdmFsdWVzXG4gIH07XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlRGF0ZSh2YWxpZGF0aW9uLCB2YWx1ZSwgbGFiZWwpIHtcbiAgaWYgKHZhbHVlICE9PSBudWxsICYmICEvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9JC8udGVzdCh2YWx1ZSkpIHtcbiAgICByZXR1cm4gYCR7bGFiZWx9IGlzIG5vdCBhIHZhbGlkIGRhdGVgO1xuICB9XG4gIGlmICh2YWxpZGF0aW9uICE9PSBudWxsICYmIHZhbGlkYXRpb24gIT09IHZvaWQgMCAmJiB2YWxpZGF0aW9uLmlzUmVxdWlyZWQgJiYgdmFsdWUgPT09IG51bGwpIHtcbiAgICByZXR1cm4gYCR7bGFiZWx9IGlzIHJlcXVpcmVkYDtcbiAgfVxuICBpZiAoKHZhbGlkYXRpb24gIT09IG51bGwgJiYgdmFsaWRhdGlvbiAhPT0gdm9pZCAwICYmIHZhbGlkYXRpb24ubWluIHx8IHZhbGlkYXRpb24gIT09IG51bGwgJiYgdmFsaWRhdGlvbiAhPT0gdm9pZCAwICYmIHZhbGlkYXRpb24ubWF4KSAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh2YWx1ZSk7XG4gICAgaWYgKCh2YWxpZGF0aW9uID09PSBudWxsIHx8IHZhbGlkYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbGlkYXRpb24ubWluKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBtaW4gPSBuZXcgRGF0ZSh2YWxpZGF0aW9uLm1pbik7XG4gICAgICBpZiAoZGF0ZSA8IG1pbikge1xuICAgICAgICByZXR1cm4gYCR7bGFiZWx9IG11c3QgYmUgYWZ0ZXIgJHttaW4udG9Mb2NhbGVEYXRlU3RyaW5nKCl9YDtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCh2YWxpZGF0aW9uID09PSBudWxsIHx8IHZhbGlkYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbGlkYXRpb24ubWF4KSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBtYXggPSBuZXcgRGF0ZSh2YWxpZGF0aW9uLm1heCk7XG4gICAgICBpZiAoZGF0ZSA+IG1heCkge1xuICAgICAgICByZXR1cm4gYCR7bGFiZWx9IG11c3QgYmUgbm8gbGF0ZXIgdGhhbiAke21heC50b0xvY2FsZURhdGVTdHJpbmcoKX1gO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBkYXRlKHtcbiAgbGFiZWwsXG4gIGRlZmF1bHRWYWx1ZSxcbiAgdmFsaWRhdGlvbixcbiAgZGVzY3JpcHRpb25cbn0pIHtcbiAgcmV0dXJuIGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlKHtcbiAgICBsYWJlbCxcbiAgICBJbnB1dChwcm9wcykge1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9qc3goRGF0ZUZpZWxkSW5wdXQsIHtcbiAgICAgICAgdmFsaWRhdGlvbjogdmFsaWRhdGlvbixcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIGlmIChkZWZhdWx0VmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgZGVmYXVsdFZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgICAgfVxuICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuICAgICAgY29uc3QgeWVhciA9IHRvZGF5LmdldEZ1bGxZZWFyKCk7XG4gICAgICBjb25zdCBtb250aCA9IFN0cmluZyh0b2RheS5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTtcbiAgICAgIGNvbnN0IGRheSA9IFN0cmluZyh0b2RheS5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsICcwJyk7XG4gICAgICByZXR1cm4gYCR7eWVhcn0tJHttb250aH0tJHtkYXl9YDtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgY29uc3QgeWVhciA9IHZhbHVlLmdldFVUQ0Z1bGxZZWFyKCk7XG4gICAgICAgIGNvbnN0IG1vbnRoID0gU3RyaW5nKHZhbHVlLmdldFVUQ01vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgICAgICBjb25zdCBkYXkgPSBTdHJpbmcodmFsdWUuZ2V0VVRDRGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgICAgICByZXR1cm4gYCR7eWVhcn0tJHttb250aH0tJHtkYXl9YDtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IG51bGwpIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB1bmRlZmluZWRcbiAgICAgIH07XG4gICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodmFsdWUpO1xuICAgICAgZGF0ZS50b0lTT1N0cmluZyA9ICgpID0+IHZhbHVlO1xuICAgICAgZGF0ZS50b1N0cmluZyA9ICgpID0+IHZhbHVlO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IGRhdGVcbiAgICAgIH07XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IHZhbGlkYXRlRGF0ZSh2YWxpZGF0aW9uLCB2YWx1ZSwgbGFiZWwpO1xuICAgICAgaWYgKG1lc3NhZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IobWVzc2FnZSk7XG4gICAgICB9XG4gICAgICBhc3NlcnRSZXF1aXJlZCh2YWx1ZSwgdmFsaWRhdGlvbiwgbGFiZWwpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlRGF0ZXRpbWUodmFsaWRhdGlvbiwgdmFsdWUsIGxhYmVsKSB7XG4gIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiAhL15cXGR7NH0tXFxkezJ9LVxcZHsyfVRcXGR7Mn06XFxkezJ9JC8udGVzdCh2YWx1ZSkpIHtcbiAgICByZXR1cm4gYCR7bGFiZWx9IGlzIG5vdCBhIHZhbGlkIGRhdGV0aW1lYDtcbiAgfVxuICBpZiAodmFsaWRhdGlvbiAhPT0gbnVsbCAmJiB2YWxpZGF0aW9uICE9PSB2b2lkIDAgJiYgdmFsaWRhdGlvbi5pc1JlcXVpcmVkICYmIHZhbHVlID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGAke2xhYmVsfSBpcyByZXF1aXJlZGA7XG4gIH1cbiAgaWYgKCh2YWxpZGF0aW9uICE9PSBudWxsICYmIHZhbGlkYXRpb24gIT09IHZvaWQgMCAmJiB2YWxpZGF0aW9uLm1pbiB8fCB2YWxpZGF0aW9uICE9PSBudWxsICYmIHZhbGlkYXRpb24gIT09IHZvaWQgMCAmJiB2YWxpZGF0aW9uLm1heCkgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICBjb25zdCBkYXRldGltZSA9IG5ldyBEYXRlKHZhbHVlKTtcbiAgICBpZiAoKHZhbGlkYXRpb24gPT09IG51bGwgfHwgdmFsaWRhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogdmFsaWRhdGlvbi5taW4pICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnN0IG1pbiA9IG5ldyBEYXRlKHZhbGlkYXRpb24ubWluKTtcbiAgICAgIGlmIChkYXRldGltZSA8IG1pbikge1xuICAgICAgICByZXR1cm4gYCR7bGFiZWx9IG11c3QgYmUgYWZ0ZXIgJHttaW4udG9JU09TdHJpbmcoKX1gO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoKHZhbGlkYXRpb24gPT09IG51bGwgfHwgdmFsaWRhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogdmFsaWRhdGlvbi5tYXgpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnN0IG1heCA9IG5ldyBEYXRlKHZhbGlkYXRpb24ubWF4KTtcbiAgICAgIGlmIChkYXRldGltZSA+IG1heCkge1xuICAgICAgICByZXR1cm4gYCR7bGFiZWx9IG11c3QgYmUgbm8gbGF0ZXIgdGhhbiAke21heC50b0lTT1N0cmluZygpfWA7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGRhdGV0aW1lKHtcbiAgbGFiZWwsXG4gIGRlZmF1bHRWYWx1ZSxcbiAgdmFsaWRhdGlvbixcbiAgZGVzY3JpcHRpb25cbn0pIHtcbiAgcmV0dXJuIGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlKHtcbiAgICBsYWJlbCxcbiAgICBJbnB1dChwcm9wcykge1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9qc3goRGF0ZXRpbWVGaWVsZElucHV0LCB7XG4gICAgICAgIHZhbGlkYXRpb246IHZhbGlkYXRpb24sXG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICBpZiAoZGVmYXVsdFZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIGRlZmF1bHRWYWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChkZWZhdWx0VmFsdWUua2luZCA9PT0gJ25vdycpIHtcbiAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSBub3cuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwICogMTAwMCkudG9JU09TdHJpbmcoKS5zbGljZSgwLCAtOCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgLTgpO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nIG9yIGRhdGUnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlID09PSBudWxsKSByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogdW5kZWZpbmVkXG4gICAgICB9O1xuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHZhbHVlICsgJ1onKTtcbiAgICAgIGRhdGUudG9KU09OID0gKCkgPT4gZGF0ZS50b0lTT1N0cmluZygpLnNsaWNlKDAsIC04KTtcbiAgICAgIGRhdGUudG9TdHJpbmcgPSAoKSA9PiBkYXRlLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgLTgpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IGRhdGVcbiAgICAgIH07XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IHZhbGlkYXRlRGF0ZXRpbWUodmFsaWRhdGlvbiwgdmFsdWUsIGxhYmVsKTtcbiAgICAgIGlmIChtZXNzYWdlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKG1lc3NhZ2UpO1xuICAgICAgfVxuICAgICAgYXNzZXJ0UmVxdWlyZWQodmFsdWUsIHZhbGlkYXRpb24sIGxhYmVsKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBlbXB0eSgpIHtcbiAgcmV0dXJuIGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlKHtcbiAgICBJbnB1dCgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcbiAgICBwYXJzZSgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHVuZGVmaW5lZFxuICAgICAgfTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBsYWJlbDogJ0VtcHR5J1xuICB9KTtcbn1cblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBgZW1wdHlEb2N1bWVudGAgaGFzIGJlZW4gcmVwbGFjZWQgd2l0aCB0aGUgYGVtcHR5Q29udGVudGAgZmllbGRcbiAqL1xuZnVuY3Rpb24gZW1wdHlEb2N1bWVudCgpIHtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgZm9ybUtpbmQ6ICdjb250ZW50JyxcbiAgICBJbnB1dCgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcbiAgICBwYXJzZSgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgY29udGVudEV4dGVuc2lvbjogJy5tZG9jJyxcbiAgICBzZXJpYWxpemUoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogdW5kZWZpbmVkLFxuICAgICAgICBjb250ZW50OiBuZXcgVWludDhBcnJheSgpLFxuICAgICAgICBleHRlcm5hbDogbmV3IE1hcCgpLFxuICAgICAgICBvdGhlcjogbmV3IE1hcCgpXG4gICAgICB9O1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHJlYWRlcjoge1xuICAgICAgcGFyc2UoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gZW1wdHlDb250ZW50KG9wdHMpIHtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgZm9ybUtpbmQ6ICdjb250ZW50JyxcbiAgICBJbnB1dCgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcbiAgICBwYXJzZSgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgY29udGVudEV4dGVuc2lvbjogYC4ke29wdHMuZXh0ZW5zaW9ufWAsXG4gICAgc2VyaWFsaXplKCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgY29udGVudDogbmV3IFVpbnQ4QXJyYXkoKSxcbiAgICAgICAgZXh0ZXJuYWw6IG5ldyBNYXAoKSxcbiAgICAgICAgb3RoZXI6IG5ldyBNYXAoKVxuICAgICAgfTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICByZWFkZXI6IHtcbiAgICAgIHBhcnNlKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG5cbmZ1bmN0aW9uIGZpbGUoe1xuICBsYWJlbCxcbiAgZGlyZWN0b3J5LFxuICB2YWxpZGF0aW9uLFxuICBkZXNjcmlwdGlvbixcbiAgcHVibGljUGF0aCxcbiAgdHJhbnNmb3JtRmlsZW5hbWVcbn0pIHtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgZm9ybUtpbmQ6ICdhc3NldCcsXG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KEZpbGVGaWVsZElucHV0LCB7XG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICB2YWxpZGF0aW9uOiB2YWxpZGF0aW9uLFxuICAgICAgICB0cmFuc2Zvcm1GaWxlbmFtZTogdHJhbnNmb3JtRmlsZW5hbWUsXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgZmlsZW5hbWUodmFsdWUsIGFyZ3MpIHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZS5zbGljZShnZXRTcmNQcmVmaXgocHVibGljUGF0aCwgYXJncy5zbHVnKS5sZW5ndGgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlLCBhcmdzKSB7XG4gICAgICB2YXIgX3ZhbHVlJG1hdGNoJCwgX3ZhbHVlJG1hdGNoO1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYSBzdHJpbmcnKTtcbiAgICAgIH1cbiAgICAgIGlmIChhcmdzLmFzc2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkYXRhOiBhcmdzLmFzc2V0LFxuICAgICAgICBmaWxlbmFtZTogdmFsdWUuc2xpY2UoZ2V0U3JjUHJlZml4KHB1YmxpY1BhdGgsIGFyZ3Muc2x1ZykubGVuZ3RoKSxcbiAgICAgICAgZXh0ZW5zaW9uOiAoX3ZhbHVlJG1hdGNoJCA9IChfdmFsdWUkbWF0Y2ggPSB2YWx1ZS5tYXRjaCgvXFwuKFteLl0rJCkvKSkgPT09IG51bGwgfHwgX3ZhbHVlJG1hdGNoID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdmFsdWUkbWF0Y2hbMV0pICE9PSBudWxsICYmIF92YWx1ZSRtYXRjaCQgIT09IHZvaWQgMCA/IF92YWx1ZSRtYXRjaCQgOiAnJ1xuICAgICAgfTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICBhc3NlcnRSZXF1aXJlZCh2YWx1ZSwgdmFsaWRhdGlvbiwgbGFiZWwpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKHZhbHVlLCBhcmdzKSB7XG4gICAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB2YWx1ZTogdW5kZWZpbmVkLFxuICAgICAgICAgIGFzc2V0OiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZpbGVuYW1lID0gYXJncy5zdWdnZXN0ZWRGaWxlbmFtZVByZWZpeCA/IGFyZ3Muc3VnZ2VzdGVkRmlsZW5hbWVQcmVmaXggKyAnLicgKyB2YWx1ZS5leHRlbnNpb24gOiB2YWx1ZS5maWxlbmFtZTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiBgJHtnZXRTcmNQcmVmaXgocHVibGljUGF0aCwgYXJncy5zbHVnKX0ke2ZpbGVuYW1lfWAsXG4gICAgICAgIGFzc2V0OiB7XG4gICAgICAgICAgZmlsZW5hbWUsXG4gICAgICAgICAgY29udGVudDogdmFsdWUuZGF0YVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sXG4gICAgZGlyZWN0b3J5OiBkaXJlY3RvcnkgPyBmaXhQYXRoKGRpcmVjdG9yeSkgOiB1bmRlZmluZWQsXG4gICAgcmVhZGVyOiB7XG4gICAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJyAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmFsID0gdmFsdWUgPT09IHVuZGVmaW5lZCA/IG51bGwgOiB2YWx1ZTtcbiAgICAgICAgYXNzZXJ0UmVxdWlyZWQodmFsLCB2YWxpZGF0aW9uLCBsYWJlbCk7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBpbWFnZSh7XG4gIGxhYmVsLFxuICBkaXJlY3RvcnksXG4gIHZhbGlkYXRpb24sXG4gIGRlc2NyaXB0aW9uLFxuICBwdWJsaWNQYXRoLFxuICB0cmFuc2Zvcm1GaWxlbmFtZVxufSkge1xuICByZXR1cm4ge1xuICAgIGtpbmQ6ICdmb3JtJyxcbiAgICBmb3JtS2luZDogJ2Fzc2V0JyxcbiAgICBsYWJlbCxcbiAgICBJbnB1dChwcm9wcykge1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9qc3goSW1hZ2VGaWVsZElucHV0LCB7XG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICB2YWxpZGF0aW9uOiB2YWxpZGF0aW9uLFxuICAgICAgICB0cmFuc2Zvcm1GaWxlbmFtZTogdHJhbnNmb3JtRmlsZW5hbWUsXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgZmlsZW5hbWUodmFsdWUsIGFyZ3MpIHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZS5zbGljZShnZXRTcmNQcmVmaXgocHVibGljUGF0aCwgYXJncy5zbHVnKS5sZW5ndGgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlLCBhcmdzKSB7XG4gICAgICB2YXIgX3ZhbHVlJG1hdGNoJCwgX3ZhbHVlJG1hdGNoO1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYSBzdHJpbmcnKTtcbiAgICAgIH1cbiAgICAgIGlmIChhcmdzLmFzc2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkYXRhOiBhcmdzLmFzc2V0LFxuICAgICAgICBmaWxlbmFtZTogdmFsdWUuc2xpY2UoZ2V0U3JjUHJlZml4KHB1YmxpY1BhdGgsIGFyZ3Muc2x1ZykubGVuZ3RoKSxcbiAgICAgICAgZXh0ZW5zaW9uOiAoX3ZhbHVlJG1hdGNoJCA9IChfdmFsdWUkbWF0Y2ggPSB2YWx1ZS5tYXRjaCgvXFwuKFteLl0rJCkvKSkgPT09IG51bGwgfHwgX3ZhbHVlJG1hdGNoID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdmFsdWUkbWF0Y2hbMV0pICE9PSBudWxsICYmIF92YWx1ZSRtYXRjaCQgIT09IHZvaWQgMCA/IF92YWx1ZSRtYXRjaCQgOiAnJ1xuICAgICAgfTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICBhc3NlcnRSZXF1aXJlZCh2YWx1ZSwgdmFsaWRhdGlvbiwgbGFiZWwpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKHZhbHVlLCBhcmdzKSB7XG4gICAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB2YWx1ZTogdW5kZWZpbmVkLFxuICAgICAgICAgIGFzc2V0OiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZpbGVuYW1lID0gYXJncy5zdWdnZXN0ZWRGaWxlbmFtZVByZWZpeCA/IGFyZ3Muc3VnZ2VzdGVkRmlsZW5hbWVQcmVmaXggKyAnLicgKyB2YWx1ZS5leHRlbnNpb24gOiB2YWx1ZS5maWxlbmFtZTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiBgJHtnZXRTcmNQcmVmaXgocHVibGljUGF0aCwgYXJncy5zbHVnKX0ke2ZpbGVuYW1lfWAsXG4gICAgICAgIGFzc2V0OiB7XG4gICAgICAgICAgZmlsZW5hbWUsXG4gICAgICAgICAgY29udGVudDogdmFsdWUuZGF0YVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sXG4gICAgZGlyZWN0b3J5OiBkaXJlY3RvcnkgPyBmaXhQYXRoKGRpcmVjdG9yeSkgOiB1bmRlZmluZWQsXG4gICAgcmVhZGVyOiB7XG4gICAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJyAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmFsID0gdmFsdWUgPT09IHVuZGVmaW5lZCA/IG51bGwgOiB2YWx1ZTtcbiAgICAgICAgYXNzZXJ0UmVxdWlyZWQodmFsLCB2YWxpZGF0aW9uLCBsYWJlbCk7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBwbHVyYWxpemUoY291bnQsIG9wdGlvbnMpIHtcbiAgY29uc3Qge1xuICAgIHNpbmd1bGFyLFxuICAgIHBsdXJhbCA9IHNpbmd1bGFyICsgJ3MnLFxuICAgIGluY2x1c2l2ZSA9IHRydWVcbiAgfSA9IG9wdGlvbnM7XG4gIGNvbnN0IHZhcmlhbnQgPSBjb3VudCA9PT0gMSA/IHNpbmd1bGFyIDogcGx1cmFsO1xuICByZXR1cm4gaW5jbHVzaXZlID8gYCR7Y291bnR9ICR7dmFyaWFudH1gIDogdmFyaWFudDtcbn1cblxuZnVuY3Rpb24gdmFsaWRhdGVNdWx0aVJlbGF0aW9uc2hpcExlbmd0aCh2YWxpZGF0aW9uLCB2YWx1ZSkge1xuICB2YXIgX3ZhbGlkYXRpb24kbGVuZ3RoJG1pLCBfdmFsaWRhdGlvbiRsZW5ndGgsIF92YWxpZGF0aW9uJGxlbmd0aCRtYSwgX3ZhbGlkYXRpb24kbGVuZ3RoMjtcbiAgY29uc3QgbWluTGVuZ3RoID0gKF92YWxpZGF0aW9uJGxlbmd0aCRtaSA9IHZhbGlkYXRpb24gPT09IG51bGwgfHwgdmFsaWRhdGlvbiA9PT0gdm9pZCAwIHx8IChfdmFsaWRhdGlvbiRsZW5ndGggPSB2YWxpZGF0aW9uLmxlbmd0aCkgPT09IG51bGwgfHwgX3ZhbGlkYXRpb24kbGVuZ3RoID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdmFsaWRhdGlvbiRsZW5ndGgubWluKSAhPT0gbnVsbCAmJiBfdmFsaWRhdGlvbiRsZW5ndGgkbWkgIT09IHZvaWQgMCA/IF92YWxpZGF0aW9uJGxlbmd0aCRtaSA6IDA7XG4gIGlmICh2YWx1ZS5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICByZXR1cm4gYE11c3QgaGF2ZSBhdCBsZWFzdCAke3BsdXJhbGl6ZShtaW5MZW5ndGgsIHtcbiAgICAgIHNpbmd1bGFyOiAnaXRlbSdcbiAgICB9KX0uYDtcbiAgfVxuICBjb25zdCBtYXhMZW5ndGggPSAoX3ZhbGlkYXRpb24kbGVuZ3RoJG1hID0gdmFsaWRhdGlvbiA9PT0gbnVsbCB8fCB2YWxpZGF0aW9uID09PSB2b2lkIDAgfHwgKF92YWxpZGF0aW9uJGxlbmd0aDIgPSB2YWxpZGF0aW9uLmxlbmd0aCkgPT09IG51bGwgfHwgX3ZhbGlkYXRpb24kbGVuZ3RoMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3ZhbGlkYXRpb24kbGVuZ3RoMi5tYXgpICE9PSBudWxsICYmIF92YWxpZGF0aW9uJGxlbmd0aCRtYSAhPT0gdm9pZCAwID8gX3ZhbGlkYXRpb24kbGVuZ3RoJG1hIDogSW5maW5pdHk7XG4gIGlmICh2YWx1ZS5sZW5ndGggPiBtYXhMZW5ndGgpIHtcbiAgICByZXR1cm4gYE11c3QgaGF2ZSBhdCBtb3N0ICR7cGx1cmFsaXplKG1heExlbmd0aCwge1xuICAgICAgc2luZ3VsYXI6ICdpdGVtJ1xuICAgIH0pfS5gO1xuICB9XG59XG5cbmZ1bmN0aW9uIG11bHRpUmVsYXRpb25zaGlwKHtcbiAgbGFiZWwsXG4gIGNvbGxlY3Rpb24sXG4gIHZhbGlkYXRpb24sXG4gIGRlc2NyaXB0aW9uXG59KSB7XG4gIHJldHVybiBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KE11bHRpUmVsYXRpb25zaGlwSW5wdXQsIHtcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBjb2xsZWN0aW9uOiBjb2xsZWN0aW9uLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIHZhbGlkYXRpb246IHZhbGlkYXRpb24sXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpIHx8ICF2YWx1ZS5ldmVyeShpc1N0cmluZykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGFuIGFycmF5IG9mIHN0cmluZ3MnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICBjb25zdCBlcnJvciA9IHZhbGlkYXRlTXVsdGlSZWxhdGlvbnNoaXBMZW5ndGgodmFsaWRhdGlvbiwgdmFsdWUpO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcihlcnJvcik7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBzZXJpYWxpemUodmFsdWUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlXG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIG11bHRpc2VsZWN0KHtcbiAgbGFiZWwsXG4gIG9wdGlvbnMsXG4gIGRlZmF1bHRWYWx1ZSA9IFtdLFxuICBkZXNjcmlwdGlvblxufSkge1xuICBjb25zdCB2YWx1ZXNUb09wdGlvbiA9IG5ldyBNYXAob3B0aW9ucy5tYXAoeCA9PiBbeC52YWx1ZSwgeF0pKTtcbiAgY29uc3QgZmllbGQgPSBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KE11bHRpc2VsZWN0RmllbGRJbnB1dCwge1xuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgb3B0aW9uczogb3B0aW9ucyxcbiAgICAgICAgLi4ucHJvcHNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhbiBhcnJheSBvZiBvcHRpb25zJyk7XG4gICAgICB9XG4gICAgICBpZiAoIXZhbHVlLmV2ZXJ5KHggPT4gdHlwZW9mIHggPT09ICdzdHJpbmcnICYmIHZhbHVlc1RvT3B0aW9uLmhhcyh4KSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKGBNdXN0IGJlIGFuIGFycmF5IHdpdGggb25lIG9mICR7b3B0aW9ucy5tYXAoeCA9PiB4LnZhbHVlKS5qb2luKCcsICcpfWApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWVcbiAgICAgIH07XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICAuLi5maWVsZCxcbiAgICBvcHRpb25zXG4gIH07XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlTnVtYmVyKHZhbGlkYXRpb24sIHZhbHVlLCBzdGVwLCBsYWJlbCkge1xuICBpZiAodmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlICE9PSAnbnVtYmVyJykge1xuICAgIHJldHVybiBgJHtsYWJlbH0gbXVzdCBiZSBhIG51bWJlcmA7XG4gIH1cbiAgaWYgKHZhbGlkYXRpb24gIT09IG51bGwgJiYgdmFsaWRhdGlvbiAhPT0gdm9pZCAwICYmIHZhbGlkYXRpb24uaXNSZXF1aXJlZCAmJiB2YWx1ZSA9PT0gbnVsbCkge1xuICAgIHJldHVybiBgJHtsYWJlbH0gaXMgcmVxdWlyZWRgO1xuICB9XG4gIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xuICAgIGlmICgodmFsaWRhdGlvbiA9PT0gbnVsbCB8fCB2YWxpZGF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiB2YWxpZGF0aW9uLm1pbikgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSA8IHZhbGlkYXRpb24ubWluKSB7XG4gICAgICByZXR1cm4gYCR7bGFiZWx9IG11c3QgYmUgYXQgbGVhc3QgJHt2YWxpZGF0aW9uLm1pbn1gO1xuICAgIH1cbiAgICBpZiAoKHZhbGlkYXRpb24gPT09IG51bGwgfHwgdmFsaWRhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogdmFsaWRhdGlvbi5tYXgpICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgPiB2YWxpZGF0aW9uLm1heCkge1xuICAgICAgcmV0dXJuIGAke2xhYmVsfSBtdXN0IGJlIGF0IG1vc3QgJHt2YWxpZGF0aW9uLm1heH1gO1xuICAgIH1cbiAgICBpZiAoc3RlcCAhPT0gdW5kZWZpbmVkICYmICh2YWxpZGF0aW9uID09PSBudWxsIHx8IHZhbGlkYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbGlkYXRpb24udmFsaWRhdGVTdGVwKSAhPT0gdW5kZWZpbmVkICYmICFpc0F0U3RlcCh2YWx1ZSwgc3RlcCkpIHtcbiAgICAgIHJldHVybiBgJHtsYWJlbH0gbXVzdCBiZSBhIG11bHRpcGxlIG9mICR7c3RlcH1gO1xuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gZGVjaW1hbFBsYWNlcyh2YWx1ZSkge1xuICBjb25zdCBzdHJpbmdpZmllZCA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gIGNvbnN0IGluZGV4T2ZEZWNpbWFsID0gc3RyaW5naWZpZWQuaW5kZXhPZignLicpO1xuICBpZiAoaW5kZXhPZkRlY2ltYWwgPT09IC0xKSB7XG4gICAgY29uc3QgaW5kZXhPZkUgPSBzdHJpbmdpZmllZC5pbmRleE9mKCdlLScpO1xuICAgIHJldHVybiBpbmRleE9mRSA9PT0gLTEgPyAwIDogcGFyc2VJbnQoc3RyaW5naWZpZWQuc2xpY2UoaW5kZXhPZkUgKyAyKSk7XG4gIH1cbiAgcmV0dXJuIHN0cmluZ2lmaWVkLmxlbmd0aCAtIGluZGV4T2ZEZWNpbWFsIC0gMTtcbn1cbmZ1bmN0aW9uIGlzQXRTdGVwKHZhbHVlLCBzdGVwKSB7XG4gIGNvbnN0IGRjID0gTWF0aC5tYXgoZGVjaW1hbFBsYWNlcyhzdGVwKSwgZGVjaW1hbFBsYWNlcyh2YWx1ZSkpO1xuICBjb25zdCBiYXNlID0gTWF0aC5wb3coMTAsIGRjKTtcbiAgcmV0dXJuIHZhbHVlICogYmFzZSAlIChzdGVwICogYmFzZSkgPT09IDA7XG59XG5cbmZ1bmN0aW9uIG51bWJlcih7XG4gIGxhYmVsLFxuICBkZWZhdWx0VmFsdWUsXG4gIHN0ZXAsXG4gIHZhbGlkYXRpb24sXG4gIGRlc2NyaXB0aW9uXG59KSB7XG4gIHJldHVybiBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KE51bWJlckZpZWxkSW5wdXQsIHtcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIHZhbGlkYXRpb246IHZhbGlkYXRpb24sXG4gICAgICAgIHN0ZXA6IHN0ZXAsXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBkZWZhdWx0VmFsdWUgIT09IG51bGwgJiYgZGVmYXVsdFZhbHVlICE9PSB2b2lkIDAgPyBkZWZhdWx0VmFsdWUgOiBudWxsO1xuICAgIH0sXG4gICAgcGFyc2UodmFsdWUpIHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgbnVtYmVyJyk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IHZhbGlkYXRlTnVtYmVyKHZhbGlkYXRpb24sIHZhbHVlLCBzdGVwLCBsYWJlbCk7XG4gICAgICBpZiAobWVzc2FnZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcihtZXNzYWdlKTtcbiAgICAgIH1cbiAgICAgIGFzc2VydFJlcXVpcmVkKHZhbHVlLCB2YWxpZGF0aW9uLCBsYWJlbCk7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBzZXJpYWxpemUodmFsdWUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB2YWx1ZSA9PT0gbnVsbCA/IHVuZGVmaW5lZCA6IHZhbHVlXG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHBhdGhSZWZlcmVuY2Uoe1xuICBsYWJlbCxcbiAgcGF0dGVybixcbiAgdmFsaWRhdGlvbixcbiAgZGVzY3JpcHRpb25cbn0pIHtcbiAgcmV0dXJuIGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlKHtcbiAgICBsYWJlbCxcbiAgICBJbnB1dChwcm9wcykge1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9qc3goUGF0aFJlZmVyZW5jZUlucHV0LCB7XG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgcGF0dGVybjogcGF0dGVybixcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICB2YWxpZGF0aW9uOiB2YWxpZGF0aW9uLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIGFzc2VydFJlcXVpcmVkKHZhbHVlLCB2YWxpZGF0aW9uLCBsYWJlbCk7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBzZXJpYWxpemUodmFsdWUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB2YWx1ZSA9PT0gbnVsbCA/IHVuZGVmaW5lZCA6IHZhbHVlXG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHJlbGF0aW9uc2hpcCh7XG4gIGxhYmVsLFxuICBjb2xsZWN0aW9uLFxuICB2YWxpZGF0aW9uLFxuICBkZXNjcmlwdGlvblxufSkge1xuICByZXR1cm4gYmFzaWNGb3JtRmllbGRXaXRoU2ltcGxlUmVhZGVyUGFyc2Uoe1xuICAgIGxhYmVsLFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChSZWxhdGlvbnNoaXBJbnB1dCwge1xuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIGNvbGxlY3Rpb246IGNvbGxlY3Rpb24sXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgdmFsaWRhdGlvbjogdmFsaWRhdGlvbixcbiAgICAgICAgLi4ucHJvcHNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcbiAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYSBzdHJpbmcnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICBhc3NlcnRSZXF1aXJlZCh2YWx1ZSwgdmFsaWRhdGlvbiwgbGFiZWwpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKHZhbHVlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogdmFsdWUgPT09IG51bGwgPyB1bmRlZmluZWQgOiB2YWx1ZVxuICAgICAgfTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBwYXJzZVNsdWdGaWVsZEFzTm9ybWFsRmllbGQodmFsdWUpIHtcbiAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogJycsXG4gICAgICBzbHVnOiAnJ1xuICAgIH07XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ29iamVjdCcpIHtcbiAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYW4gb2JqZWN0Jyk7XG4gIH1cbiAgaWYgKE9iamVjdC5rZXlzKHZhbHVlKS5sZW5ndGggIT09IDIpIHtcbiAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ1VuZXhwZWN0ZWQga2V5cycpO1xuICB9XG4gIGlmICghKCduYW1lJyBpbiB2YWx1ZSkgfHwgISgnc2x1ZycgaW4gdmFsdWUpKSB7XG4gICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNaXNzaW5nIG5hbWUgb3Igc2x1ZycpO1xuICB9XG4gIGlmICh0eXBlb2YgdmFsdWUubmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ25hbWUgbXVzdCBiZSBhIHN0cmluZycpO1xuICB9XG4gIGlmICh0eXBlb2YgdmFsdWUuc2x1ZyAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ3NsdWcgbXVzdCBiZSBhIHN0cmluZycpO1xuICB9XG4gIHJldHVybiB7XG4gICAgbmFtZTogdmFsdWUubmFtZSxcbiAgICBzbHVnOiB2YWx1ZS5zbHVnXG4gIH07XG59XG5mdW5jdGlvbiBwYXJzZUFzU2x1Z0ZpZWxkKHZhbHVlLCBzbHVnKSB7XG4gIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6ICcnLFxuICAgICAgc2x1Z1xuICAgIH07XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYSBzdHJpbmcnKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIG5hbWU6IHZhbHVlLFxuICAgIHNsdWdcbiAgfTtcbn1cbmZ1bmN0aW9uIHNsdWcoX2FyZ3MpIHtcbiAgdmFyIF9hcmdzJG5hbWUkdmFsaWRhdGlvbiwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uMiwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uMywgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNCwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNSwgX2FyZ3Mkc2x1ZztcbiAgY29uc3QgYXJncyA9IHtcbiAgICAuLi5fYXJncyxcbiAgICBuYW1lOiB7XG4gICAgICAuLi5fYXJncy5uYW1lLFxuICAgICAgdmFsaWRhdGlvbjoge1xuICAgICAgICBwYXR0ZXJuOiAoX2FyZ3MkbmFtZSR2YWxpZGF0aW9uID0gX2FyZ3MubmFtZS52YWxpZGF0aW9uKSA9PT0gbnVsbCB8fCBfYXJncyRuYW1lJHZhbGlkYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcmdzJG5hbWUkdmFsaWRhdGlvbi5wYXR0ZXJuLFxuICAgICAgICBsZW5ndGg6IHtcbiAgICAgICAgICBtaW46IE1hdGgubWF4KChfYXJncyRuYW1lJHZhbGlkYXRpb24yID0gX2FyZ3MubmFtZS52YWxpZGF0aW9uKSAhPT0gbnVsbCAmJiBfYXJncyRuYW1lJHZhbGlkYXRpb24yICE9PSB2b2lkIDAgJiYgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uMi5pc1JlcXVpcmVkID8gMSA6IDAsIChfYXJncyRuYW1lJHZhbGlkYXRpb24zID0gKF9hcmdzJG5hbWUkdmFsaWRhdGlvbjQgPSBfYXJncy5uYW1lLnZhbGlkYXRpb24pID09PSBudWxsIHx8IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjQgPT09IHZvaWQgMCB8fCAoX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNCA9IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjQubGVuZ3RoKSA9PT0gbnVsbCB8fCBfYXJncyRuYW1lJHZhbGlkYXRpb240ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXJncyRuYW1lJHZhbGlkYXRpb240Lm1pbikgIT09IG51bGwgJiYgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uMyAhPT0gdm9pZCAwID8gX2FyZ3MkbmFtZSR2YWxpZGF0aW9uMyA6IDApLFxuICAgICAgICAgIG1heDogKF9hcmdzJG5hbWUkdmFsaWRhdGlvbjUgPSBfYXJncy5uYW1lLnZhbGlkYXRpb24pID09PSBudWxsIHx8IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjUgPT09IHZvaWQgMCB8fCAoX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNSA9IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjUubGVuZ3RoKSA9PT0gbnVsbCB8fCBfYXJncyRuYW1lJHZhbGlkYXRpb241ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXJncyRuYW1lJHZhbGlkYXRpb241Lm1heFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuICBjb25zdCBuYWl2ZUdlbmVyYXRlU2x1ZyA9ICgoX2FyZ3Mkc2x1ZyA9IGFyZ3Muc2x1ZykgPT09IG51bGwgfHwgX2FyZ3Mkc2x1ZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FyZ3Mkc2x1Zy5nZW5lcmF0ZSkgfHwgc2x1Z2lmeTtcbiAgbGV0IF9kZWZhdWx0VmFsdWU7XG4gIGZ1bmN0aW9uIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICBpZiAoIV9kZWZhdWx0VmFsdWUpIHtcbiAgICAgIHZhciBfYXJncyRuYW1lJGRlZmF1bHRWYWwsIF9hcmdzJG5hbWUkZGVmYXVsdFZhbDI7XG4gICAgICBfZGVmYXVsdFZhbHVlID0ge1xuICAgICAgICBuYW1lOiAoX2FyZ3MkbmFtZSRkZWZhdWx0VmFsID0gYXJncy5uYW1lLmRlZmF1bHRWYWx1ZSkgIT09IG51bGwgJiYgX2FyZ3MkbmFtZSRkZWZhdWx0VmFsICE9PSB2b2lkIDAgPyBfYXJncyRuYW1lJGRlZmF1bHRWYWwgOiAnJyxcbiAgICAgICAgc2x1ZzogbmFpdmVHZW5lcmF0ZVNsdWcoKF9hcmdzJG5hbWUkZGVmYXVsdFZhbDIgPSBhcmdzLm5hbWUuZGVmYXVsdFZhbHVlKSAhPT0gbnVsbCAmJiBfYXJncyRuYW1lJGRlZmF1bHRWYWwyICE9PSB2b2lkIDAgPyBfYXJncyRuYW1lJGRlZmF1bHRWYWwyIDogJycpXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gX2RlZmF1bHRWYWx1ZTtcbiAgfVxuICBmdW5jdGlvbiB2YWxpZGF0ZSh2YWx1ZSwge1xuICAgIHNsdWdGaWVsZFxuICB9ID0ge1xuICAgIHNsdWdGaWVsZDogdW5kZWZpbmVkXG4gIH0pIHtcbiAgICB2YXIgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNiwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNywgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uOCwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uOSwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uMTAsIF9hcmdzJHNsdWckdmFsaWRhdGlvbiwgX2FyZ3Mkc2x1ZzIsIF9hcmdzJHNsdWckdmFsaWRhdGlvbjIsIF9hcmdzJHNsdWczLCBfYXJncyRzbHVnJGxhYmVsLCBfYXJncyRzbHVnNCwgX2FyZ3Mkc2x1ZzU7XG4gICAgY29uc3QgbmFtZU1lc3NhZ2UgPSB2YWxpZGF0ZVRleHQodmFsdWUubmFtZSwgKF9hcmdzJG5hbWUkdmFsaWRhdGlvbjYgPSAoX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNyA9IGFyZ3MubmFtZS52YWxpZGF0aW9uKSA9PT0gbnVsbCB8fCBfYXJncyRuYW1lJHZhbGlkYXRpb243ID09PSB2b2lkIDAgfHwgKF9hcmdzJG5hbWUkdmFsaWRhdGlvbjcgPSBfYXJncyRuYW1lJHZhbGlkYXRpb243Lmxlbmd0aCkgPT09IG51bGwgfHwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNy5taW4pICE9PSBudWxsICYmIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjYgIT09IHZvaWQgMCA/IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjYgOiAwLCAoX2FyZ3MkbmFtZSR2YWxpZGF0aW9uOCA9IChfYXJncyRuYW1lJHZhbGlkYXRpb245ID0gYXJncy5uYW1lLnZhbGlkYXRpb24pID09PSBudWxsIHx8IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjkgPT09IHZvaWQgMCB8fCAoX2FyZ3MkbmFtZSR2YWxpZGF0aW9uOSA9IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjkubGVuZ3RoKSA9PT0gbnVsbCB8fCBfYXJncyRuYW1lJHZhbGlkYXRpb245ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXJncyRuYW1lJHZhbGlkYXRpb245Lm1heCkgIT09IG51bGwgJiYgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uOCAhPT0gdm9pZCAwID8gX2FyZ3MkbmFtZSR2YWxpZGF0aW9uOCA6IEluZmluaXR5LCBhcmdzLm5hbWUubGFiZWwsIHVuZGVmaW5lZCwgKF9hcmdzJG5hbWUkdmFsaWRhdGlvbjEwID0gYXJncy5uYW1lLnZhbGlkYXRpb24pID09PSBudWxsIHx8IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjEwID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXJncyRuYW1lJHZhbGlkYXRpb24xMC5wYXR0ZXJuKTtcbiAgICBpZiAobmFtZU1lc3NhZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKG5hbWVNZXNzYWdlKTtcbiAgICB9XG4gICAgY29uc3Qgc2x1Z01lc3NhZ2UgPSB2YWxpZGF0ZVRleHQodmFsdWUuc2x1ZywgKF9hcmdzJHNsdWckdmFsaWRhdGlvbiA9IChfYXJncyRzbHVnMiA9IGFyZ3Muc2x1ZykgPT09IG51bGwgfHwgX2FyZ3Mkc2x1ZzIgPT09IHZvaWQgMCB8fCAoX2FyZ3Mkc2x1ZzIgPSBfYXJncyRzbHVnMi52YWxpZGF0aW9uKSA9PT0gbnVsbCB8fCBfYXJncyRzbHVnMiA9PT0gdm9pZCAwIHx8IChfYXJncyRzbHVnMiA9IF9hcmdzJHNsdWcyLmxlbmd0aCkgPT09IG51bGwgfHwgX2FyZ3Mkc2x1ZzIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcmdzJHNsdWcyLm1pbikgIT09IG51bGwgJiYgX2FyZ3Mkc2x1ZyR2YWxpZGF0aW9uICE9PSB2b2lkIDAgPyBfYXJncyRzbHVnJHZhbGlkYXRpb24gOiAxLCAoX2FyZ3Mkc2x1ZyR2YWxpZGF0aW9uMiA9IChfYXJncyRzbHVnMyA9IGFyZ3Muc2x1ZykgPT09IG51bGwgfHwgX2FyZ3Mkc2x1ZzMgPT09IHZvaWQgMCB8fCAoX2FyZ3Mkc2x1ZzMgPSBfYXJncyRzbHVnMy52YWxpZGF0aW9uKSA9PT0gbnVsbCB8fCBfYXJncyRzbHVnMyA9PT0gdm9pZCAwIHx8IChfYXJncyRzbHVnMyA9IF9hcmdzJHNsdWczLmxlbmd0aCkgPT09IG51bGwgfHwgX2FyZ3Mkc2x1ZzMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcmdzJHNsdWczLm1heCkgIT09IG51bGwgJiYgX2FyZ3Mkc2x1ZyR2YWxpZGF0aW9uMiAhPT0gdm9pZCAwID8gX2FyZ3Mkc2x1ZyR2YWxpZGF0aW9uMiA6IEluZmluaXR5LCAoX2FyZ3Mkc2x1ZyRsYWJlbCA9IChfYXJncyRzbHVnNCA9IGFyZ3Muc2x1ZykgPT09IG51bGwgfHwgX2FyZ3Mkc2x1ZzQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcmdzJHNsdWc0LmxhYmVsKSAhPT0gbnVsbCAmJiBfYXJncyRzbHVnJGxhYmVsICE9PSB2b2lkIDAgPyBfYXJncyRzbHVnJGxhYmVsIDogJ1NsdWcnLCBzbHVnRmllbGQgPyBzbHVnRmllbGQgOiB7XG4gICAgICBzbHVnczogZW1wdHlTZXQsXG4gICAgICBnbG9iOiAnKidcbiAgICB9LCAoX2FyZ3Mkc2x1ZzUgPSBhcmdzLnNsdWcpID09PSBudWxsIHx8IF9hcmdzJHNsdWc1ID09PSB2b2lkIDAgfHwgKF9hcmdzJHNsdWc1ID0gX2FyZ3Mkc2x1ZzUudmFsaWRhdGlvbikgPT09IG51bGwgfHwgX2FyZ3Mkc2x1ZzUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcmdzJHNsdWc1LnBhdHRlcm4pO1xuICAgIGlmIChzbHVnTWVzc2FnZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3Ioc2x1Z01lc3NhZ2UpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgY29uc3QgZW1wdHlTZXQgPSBuZXcgU2V0KCk7XG4gIHJldHVybiB7XG4gICAga2luZDogJ2Zvcm0nLFxuICAgIGZvcm1LaW5kOiAnc2x1ZycsXG4gICAgbGFiZWw6IGFyZ3MubmFtZS5sYWJlbCxcbiAgICBJbnB1dChwcm9wcykge1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9qc3goU2x1Z0ZpZWxkSW5wdXQsIHtcbiAgICAgICAgYXJnczogYXJncyxcbiAgICAgICAgbmFpdmVHZW5lcmF0ZVNsdWc6IG5haXZlR2VuZXJhdGVTbHVnLFxuICAgICAgICBkZWZhdWx0VmFsdWU6IGRlZmF1bHRWYWx1ZSgpLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUsXG4gICAgcGFyc2UodmFsdWUsIGFyZ3MpIHtcbiAgICAgIGlmICgoYXJncyA9PT0gbnVsbCB8fCBhcmdzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhcmdzLnNsdWcpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlQXNTbHVnRmllbGQodmFsdWUsIGFyZ3Muc2x1Zyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGFyc2VTbHVnRmllbGRBc05vcm1hbEZpZWxkKHZhbHVlKTtcbiAgICB9LFxuICAgIHZhbGlkYXRlLFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWVcbiAgICAgIH07XG4gICAgfSxcbiAgICBzZXJpYWxpemVXaXRoU2x1Zyh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHZhbHVlLm5hbWUsXG4gICAgICAgIHNsdWc6IHZhbHVlLnNsdWdcbiAgICAgIH07XG4gICAgfSxcbiAgICByZWFkZXI6IHtcbiAgICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHBhcnNlZCA9IHBhcnNlU2x1Z0ZpZWxkQXNOb3JtYWxGaWVsZCh2YWx1ZSk7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZShwYXJzZWQpO1xuICAgICAgfSxcbiAgICAgIHBhcnNlV2l0aFNsdWcodmFsdWUsIGFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlKHBhcnNlQXNTbHVnRmllbGQodmFsdWUsIGFyZ3Muc2x1ZyksIHtcbiAgICAgICAgICBzbHVnRmllbGQ6IHtcbiAgICAgICAgICAgIGdsb2I6IGFyZ3MuZ2xvYixcbiAgICAgICAgICAgIHNsdWdzOiBlbXB0eVNldFxuICAgICAgICAgIH1cbiAgICAgICAgfSkubmFtZTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG5cbmZ1bmN0aW9uIGlzVmFsaWRVUkwodXJsKSB7XG4gIHJldHVybiB1cmwgPT09IHNhbml0aXplVXJsKHVybCk7XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlVXJsKHZhbGlkYXRpb24sIHZhbHVlLCBsYWJlbCkge1xuICBpZiAodmFsdWUgIT09IG51bGwgJiYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycgfHwgIWlzVmFsaWRVUkwodmFsdWUpKSkge1xuICAgIHJldHVybiBgJHtsYWJlbH0gaXMgbm90IGEgdmFsaWQgVVJMYDtcbiAgfVxuICBpZiAodmFsaWRhdGlvbiAhPT0gbnVsbCAmJiB2YWxpZGF0aW9uICE9PSB2b2lkIDAgJiYgdmFsaWRhdGlvbi5pc1JlcXVpcmVkICYmIHZhbHVlID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGAke2xhYmVsfSBpcyByZXF1aXJlZGA7XG4gIH1cbn1cblxuZnVuY3Rpb24gdXJsKHtcbiAgbGFiZWwsXG4gIGRlZmF1bHRWYWx1ZSxcbiAgdmFsaWRhdGlvbixcbiAgZGVzY3JpcHRpb25cbn0pIHtcbiAgcmV0dXJuIGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlKHtcbiAgICBsYWJlbCxcbiAgICBJbnB1dChwcm9wcykge1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9qc3goVXJsRmllbGRJbnB1dCwge1xuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgdmFsaWRhdGlvbjogdmFsaWRhdGlvbixcbiAgICAgICAgLi4ucHJvcHNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZSB8fCBudWxsO1xuICAgIH0sXG4gICAgcGFyc2UodmFsdWUpIHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWUgPT09ICcnID8gbnVsbCA6IHZhbHVlO1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSB2YWxpZGF0ZVVybCh2YWxpZGF0aW9uLCB2YWx1ZSwgbGFiZWwpO1xuICAgICAgaWYgKG1lc3NhZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IobWVzc2FnZSk7XG4gICAgICB9XG4gICAgICBhc3NlcnRSZXF1aXJlZCh2YWx1ZSwgdmFsaWRhdGlvbiwgbGFiZWwpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKHZhbHVlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogdmFsdWUgPT09IG51bGwgPyB1bmRlZmluZWQgOiB2YWx1ZVxuICAgICAgfTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBpZ25vcmVkKCkge1xuICByZXR1cm4ge1xuICAgIGtpbmQ6ICdmb3JtJyxcbiAgICBJbnB1dCgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHVuZGVmaW5lZFxuICAgICAgfTtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZVxuICAgICAgfTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIGxhYmVsOiAnSWdub3JlZCcsXG4gICAgcmVhZGVyOiB7XG4gICAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuXG52YXIgaW5kZXggPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgYXJyYXk6IGFycmF5LFxuICBibG9ja3M6IGJsb2NrcyxcbiAgY2hlY2tib3g6IGNoZWNrYm94LFxuICBjaGlsZDogY2hpbGQsXG4gIGNsb3VkSW1hZ2U6IGNsb3VkSW1hZ2UsXG4gIGNvbmRpdGlvbmFsOiBjb25kaXRpb25hbCxcbiAgZGF0ZTogZGF0ZSxcbiAgZGF0ZXRpbWU6IGRhdGV0aW1lLFxuICBkb2N1bWVudDogZG9jdW1lbnQsXG4gIGVtcHR5OiBlbXB0eSxcbiAgZW1wdHlEb2N1bWVudDogZW1wdHlEb2N1bWVudCxcbiAgZW1wdHlDb250ZW50OiBlbXB0eUNvbnRlbnQsXG4gIGZpbGU6IGZpbGUsXG4gIGltYWdlOiBpbWFnZSxcbiAgaW50ZWdlcjogaW50ZWdlcixcbiAgbXVsdGlSZWxhdGlvbnNoaXA6IG11bHRpUmVsYXRpb25zaGlwLFxuICBtdWx0aXNlbGVjdDogbXVsdGlzZWxlY3QsXG4gIG51bWJlcjogbnVtYmVyLFxuICBvYmplY3Q6IG9iamVjdCxcbiAgcGF0aFJlZmVyZW5jZTogcGF0aFJlZmVyZW5jZSxcbiAgcmVsYXRpb25zaGlwOiByZWxhdGlvbnNoaXAsXG4gIHNlbGVjdDogc2VsZWN0LFxuICBzbHVnOiBzbHVnLFxuICB0ZXh0OiB0ZXh0LFxuICB1cmw6IHVybCxcbiAgaWdub3JlZDogaWdub3JlZCxcbiAgbWR4OiBtZHgsXG4gIG1hcmtkb2M6IG1hcmtkb2Ncbn0pO1xuXG5mdW5jdGlvbiBCbG9ja1dyYXBwZXIoKSB7fVxuZnVuY3Rpb24gTm90RWRpdGFibGUoKSB7fVxuZnVuY3Rpb24gVG9vbGJhclNlcGFyYXRvcigpIHt9XG5cbmV4cG9ydCB7IEJsb2NrV3JhcHBlciwgTm90RWRpdGFibGUsIFRvb2xiYXJTZXBhcmF0b3IsIGNvbGxlY3Rpb24sIGNvbmZpZywgaW5kZXggYXMgZmllbGRzLCBzaW5nbGV0b24gfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@keystatic/core/dist/keystatic-core.node.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@keystatic/next/dist/keystatic-next-ui-app.js":
/*!********************************************************************!*\
  !*** ./node_modules/@keystatic/next/dist/keystatic-next-ui-app.js ***!
  \********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   makePage: () => (/* binding */ makePage)\n/* harmony export */ });\n/* harmony import */ var _keystatic_core_ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @keystatic/core/ui */ \"(ssr)/./node_modules/@keystatic/core/dist/keystatic-core-ui.node.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n\n\n\nfunction makePage(config) {\n  return function Page() {\n    return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_keystatic_core_ui__WEBPACK_IMPORTED_MODULE_0__.Keystatic, {\n      config: config,\n      appSlug: appSlug\n    });\n  };\n}\nconst appSlug = {\n  envName: 'NEXT_PUBLIC_KEYSTATIC_GITHUB_APP_SLUG',\n  value: process.env.NEXT_PUBLIC_KEYSTATIC_GITHUB_APP_SLUG\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9uZXh0L2Rpc3Qva2V5c3RhdGljLW5leHQtdWktYXBwLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUErQztBQUNQOztBQUV4QztBQUNBO0FBQ0Esd0JBQXdCLHNEQUFHLENBQUMseURBQVM7QUFDckM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRW9CIiwic291cmNlcyI6WyIvVXNlcnMvamFtZXMvRG93bmxvYWRzL25ldy1rZXlzdGF0aWMtcHJvamVjdC9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9uZXh0L2Rpc3Qva2V5c3RhdGljLW5leHQtdWktYXBwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEtleXN0YXRpYyB9IGZyb20gJ0BrZXlzdGF0aWMvY29yZS91aSc7XG5pbXBvcnQgeyBqc3ggfSBmcm9tICdyZWFjdC9qc3gtcnVudGltZSc7XG5cbmZ1bmN0aW9uIG1ha2VQYWdlKGNvbmZpZykge1xuICByZXR1cm4gZnVuY3Rpb24gUGFnZSgpIHtcbiAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChLZXlzdGF0aWMsIHtcbiAgICAgIGNvbmZpZzogY29uZmlnLFxuICAgICAgYXBwU2x1ZzogYXBwU2x1Z1xuICAgIH0pO1xuICB9O1xufVxuY29uc3QgYXBwU2x1ZyA9IHtcbiAgZW52TmFtZTogJ05FWFRfUFVCTElDX0tFWVNUQVRJQ19HSVRIVUJfQVBQX1NMVUcnLFxuICB2YWx1ZTogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfS0VZU1RBVElDX0dJVEhVQl9BUFBfU0xVR1xufTtcblxuZXhwb3J0IHsgbWFrZVBhZ2UgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@keystatic/next/dist/keystatic-next-ui-app.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@keystatic/core/dist/api-c5c73b52.node.react-server.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/api-c5c73b52.node.react-server.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ component)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-jsx-runtime.js\");\n/* harmony import */ var _index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-ca270311.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/index-ca270311.node.react-server.js\");\n/* harmony import */ var emery__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! emery */ \"(rsc)/./node_modules/emery/dist/emery.esm.js\");\n/* harmony import */ var _braintree_sanitize_url__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @braintree/sanitize-url */ \"(rsc)/./node_modules/@braintree/sanitize-url/dist/index.js\");\n\n\n\n\n\n// this is written like this rather than ArrayField<ComponentSchema> to avoid TypeScript erroring about circularity\nfunction component(options) {\n  return options;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3QvYXBpLWM1YzczYjUyLm5vZGUucmVhY3Qtc2VydmVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTJCO0FBQ29CO0FBQ2hDO0FBQ2tCOztBQUVqQztBQUNBO0FBQ0E7QUFDQTs7QUFFMEIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYW1lcy9Eb3dubG9hZHMvbmV3LWtleXN0YXRpYy1wcm9qZWN0L25vZGVfbW9kdWxlcy9Aa2V5c3RhdGljL2NvcmUvZGlzdC9hcGktYzVjNzNiNTIubm9kZS5yZWFjdC1zZXJ2ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdyZWFjdC9qc3gtcnVudGltZSc7XG5pbXBvcnQgJy4vaW5kZXgtY2EyNzAzMTEubm9kZS5yZWFjdC1zZXJ2ZXIuanMnO1xuaW1wb3J0ICdlbWVyeSc7XG5pbXBvcnQgJ0BicmFpbnRyZWUvc2FuaXRpemUtdXJsJztcblxuLy8gdGhpcyBpcyB3cml0dGVuIGxpa2UgdGhpcyByYXRoZXIgdGhhbiBBcnJheUZpZWxkPENvbXBvbmVudFNjaGVtYT4gdG8gYXZvaWQgVHlwZVNjcmlwdCBlcnJvcmluZyBhYm91dCBjaXJjdWxhcml0eVxuZnVuY3Rpb24gY29tcG9uZW50KG9wdGlvbnMpIHtcbiAgcmV0dXJuIG9wdGlvbnM7XG59XG5cbmV4cG9ydCB7IGNvbXBvbmVudCBhcyBjIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@keystatic/core/dist/api-c5c73b52.node.react-server.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@keystatic/core/dist/generic-4797a755.node.react-server.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/generic-4797a755.node.react-server.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("var react__WEBPACK_IMPORTED_MODULE_6___namespace_cache;\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ cache),\n/* harmony export */   c: () => (/* binding */ collectionReader),\n/* harmony export */   s: () => (/* binding */ singletonReader)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-jsx-runtime.js\");\n/* harmony import */ var _index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-ca270311.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/index-ca270311.node.react-server.js\");\n/* harmony import */ var emery__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! emery */ \"(rsc)/./node_modules/emery/dist/emery.esm.js\");\n/* harmony import */ var _braintree_sanitize_url__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @braintree/sanitize-url */ \"(rsc)/./node_modules/@braintree/sanitize-url/dist/index.js\");\n/* harmony import */ var _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./index-10ea50e2.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/index-10ea50e2.node.react-server.js\");\n/* harmony import */ var js_yaml__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! js-yaml */ \"(rsc)/./node_modules/js-yaml/dist/js-yaml.mjs\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react.js\");\n\n\n\n\n\n\n\n\nconst getInitialPropsValue = _getInitialPropsValue;\nfunction _getInitialPropsValue(schema) {\n  switch (schema.kind) {\n    case 'form':\n      return schema.defaultValue();\n    case 'child':\n      return schema.options.kind === 'block' ? [{\n        type: 'paragraph',\n        children: [{\n          text: ''\n        }]\n      }] : null;\n    case 'conditional':\n      {\n        const defaultValue = schema.discriminant.defaultValue();\n        return {\n          discriminant: defaultValue,\n          value: getInitialPropsValue(schema.values[defaultValue.toString()])\n        };\n      }\n    case 'object':\n      {\n        const obj = {};\n        for (const key of Object.keys(schema.fields)) {\n          obj[key] = getInitialPropsValue(schema.fields[key]);\n        }\n        return obj;\n      }\n    case 'array':\n      {\n        return [];\n      }\n  }\n  (0,emery__WEBPACK_IMPORTED_MODULE_2__.assertNever)(schema);\n}\n\nfunction validateArrayLength(schema, val, path) {\n  var _schema$validation, _schema$validation2;\n  if (((_schema$validation = schema.validation) === null || _schema$validation === void 0 || (_schema$validation = _schema$validation.length) === null || _schema$validation === void 0 ? void 0 : _schema$validation.min) !== undefined && val.length < schema.validation.length.min) {\n    return new PropValidationError(new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_4__.F(`Must have at least ${schema.validation.length.min} element${schema.validation.length.min === 1 ? '' : 's'}`), path, schema);\n  }\n  if (((_schema$validation2 = schema.validation) === null || _schema$validation2 === void 0 || (_schema$validation2 = _schema$validation2.length) === null || _schema$validation2 === void 0 ? void 0 : _schema$validation2.max) !== undefined && val.length > schema.validation.length.max) {\n    return new PropValidationError(new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_4__.F(`Must have at most ${schema.validation.length.max} element${schema.validation.length.max === 1 ? '' : 's'}}`), path, schema);\n  }\n}\n\nclass PropValidationError extends Error {\n  constructor(cause, path, schema) {\n    super(`field error at ${path.join('.')}`, {\n      cause\n    });\n    this.path = path;\n    this.schema = schema;\n    this.cause = cause;\n  }\n}\nfunction toFormFieldStoredValue(val) {\n  if (val === null) {\n    return undefined;\n  }\n  return val;\n}\nconst isArray = Array.isArray;\nfunction parseProps(schema, _value, path, pathWithArrayFieldSlugs, parseFormField, /** This should be true for the reader and false elsewhere */\nvalidateArrayFieldLength) {\n  let value = toFormFieldStoredValue(_value);\n  if (schema.kind === 'form') {\n    try {\n      return parseFormField(schema, value, path, pathWithArrayFieldSlugs);\n    } catch (err) {\n      throw new PropValidationError(err, path, schema);\n    }\n  }\n  if (schema.kind === 'child') {\n    return null;\n  }\n  if (schema.kind === 'conditional') {\n    if (value === undefined) {\n      return getInitialPropsValue(schema);\n    }\n    try {\n      if (typeof value !== 'object' || value === null || isArray(value) || value instanceof Date) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_4__.F('Must be an object');\n      }\n      for (const key of Object.keys(value)) {\n        if (key !== 'discriminant' && key !== 'value') {\n          throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_4__.F(`Must only contain keys \"discriminant\" and \"value\", not \"${key}\"`);\n        }\n      }\n    } catch (err) {\n      throw new PropValidationError(err, path, schema);\n    }\n    const parsedDiscriminant = parseProps(schema.discriminant, value.discriminant, path.concat('discriminant'), pathWithArrayFieldSlugs.concat('discriminant'), parseFormField, validateArrayFieldLength);\n    return {\n      discriminant: parsedDiscriminant,\n      value: parseProps(schema.values[parsedDiscriminant], value.value, path.concat('value'), pathWithArrayFieldSlugs.concat('value'), parseFormField, validateArrayFieldLength)\n    };\n  }\n  if (schema.kind === 'object') {\n    if (value === undefined) {\n      value = {};\n    }\n    try {\n      if (typeof value !== 'object' || value === null || isArray(value) || value instanceof Date) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_4__.F('Must be an object');\n      }\n      const allowedKeysSet = new Set(Object.keys(schema.fields));\n      for (const key of Object.keys(value)) {\n        if (!allowedKeysSet.has(key)) {\n          throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_4__.F(`Key on object value \"${key}\" is not allowed`);\n        }\n      }\n    } catch (err) {\n      throw new PropValidationError(err, path, schema);\n    }\n    const val = {};\n    const errors = [];\n    for (const key of Object.keys(schema.fields)) {\n      let individualVal = value[key];\n      try {\n        const propVal = parseProps(schema.fields[key], individualVal, path.concat(key), pathWithArrayFieldSlugs.concat(key), parseFormField, validateArrayFieldLength);\n        val[key] = propVal;\n      } catch (err) {\n        errors.push(err);\n      }\n    }\n    if (errors.length) {\n      throw new AggregateError(errors);\n    }\n    return val;\n  }\n  if (schema.kind === 'array') {\n    if (value === undefined) {\n      return [];\n    }\n    try {\n      if (!isArray(value)) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_4__.F('Must be an array');\n      }\n    } catch (err) {\n      throw new PropValidationError(err, path, schema);\n    }\n    const errors = [];\n    try {\n      if (validateArrayFieldLength) {\n        const error = validateArrayLength(schema, value, path);\n        if (error !== undefined) {\n          errors.push(error);\n        }\n      }\n      return value.map((innerVal, i) => {\n        try {\n          let slug = i.toString();\n          if (schema.slugField && typeof innerVal === 'object' && innerVal !== null && !isArray(innerVal) && !(innerVal instanceof Date)) {\n            if (schema.element.kind !== 'object') {\n              throw new Error('slugField on array fields requires the an object field element');\n            }\n            const slugField = schema.element.fields[schema.slugField];\n            if (!slugField) {\n              throw new Error(`slugField \"${schema.slugField}\" does not exist on object field`);\n            }\n            if (slugField.kind !== 'form') {\n              throw new Error(`slugField \"${schema.slugField}\" is not a form field`);\n            }\n            if (slugField.formKind !== 'slug') {\n              throw new Error(`slugField \"${schema.slugField}\" is not a slug field`);\n            }\n            let parsedSlugFieldValue;\n            try {\n              parsedSlugFieldValue = slugField.parse(toFormFieldStoredValue(innerVal[schema.slugField]), undefined);\n            } catch (err) {\n              throw new AggregateError([err]);\n            }\n            slug = slugField.serializeWithSlug(parsedSlugFieldValue).slug;\n          }\n          return parseProps(schema.element, innerVal, path.concat(i), pathWithArrayFieldSlugs.concat(slug), parseFormField, validateArrayFieldLength);\n        } catch (err) {\n          errors.push(err);\n        }\n      });\n    } finally {\n      if (errors.length) {\n        throw new AggregateError(errors);\n      }\n    }\n  }\n  (0,emery__WEBPACK_IMPORTED_MODULE_2__.assertNever)(schema);\n}\n\nconst textDecoder = new TextDecoder();\nconst textEncoder = new TextEncoder();\nfunction splitFrontmatter(data) {\n  const str = textDecoder.decode(data);\n  const match = str.match(/^---(?:\\r?\\n([^]*?))?\\r?\\n---\\r?\\n?/);\n  if (match) {\n    var _match$;\n    const encoded = textEncoder.encode(match[0]);\n    return {\n      frontmatter: (_match$ = match[1]) !== null && _match$ !== void 0 ? _match$ : '',\n      content: data.slice(encoded.byteLength)\n    };\n  }\n  return null;\n}\nfunction loadDataFile(data, formatInfo, requireFrontmatter = false) {\n  const parse = formatInfo.data === 'json' ? JSON.parse : js_yaml__WEBPACK_IMPORTED_MODULE_5__.load;\n  if (!formatInfo.contentField) {\n    const dataFile = textDecoder.decode(data);\n    return {\n      loaded: parse(dataFile)\n    };\n  }\n  const res = splitFrontmatter(data);\n  if (requireFrontmatter && !res) {\n    throw new Error('Frontmatter not found');\n  }\n  return {\n    loaded: res === null ? {} : parse(res.frontmatter),\n    extraFakeFile: {\n      path: `${formatInfo.contentField.path.join('/')}${formatInfo.contentField.contentExtension}`,\n      contents: res === null ? data : res.content\n    }\n  };\n}\n\nfunction cache$1(func) {\n  return func;\n}\n\n// we conditionally using it since it's not actually in stable react releases yet\n// (though it should be unnecessary since this file is only imported in react-server environments anyway)\n// it's a function because some tools try to be smart with accessing things on namespace imports\n// and error at build time if you try to read an export that doesn't exist on a namespace object\nfunction getCache(react) {\n  var _react$cache;\n  return (_react$cache = react.cache) !== null && _react$cache !== void 0 ? _react$cache : cache$1;\n}\nconst cache = getCache(/*#__PURE__*/ (react__WEBPACK_IMPORTED_MODULE_6___namespace_cache || (react__WEBPACK_IMPORTED_MODULE_6___namespace_cache = __webpack_require__.t(react__WEBPACK_IMPORTED_MODULE_6__, 2))));\n\nfunction flattenErrors(error) {\n  if (error instanceof AggregateError) {\n    return error.errors.flatMap(flattenErrors);\n  }\n  return [error];\n}\nfunction formatFormDataError(error) {\n  const flatErrors = flattenErrors(error);\n  return flatErrors.map(error => {\n    if (error instanceof PropValidationError) {\n      const path = error.path.join('.');\n      return `${path}: ${error.cause instanceof _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_4__.F ? error.cause.message : `Unexpected error: ${error.cause}`}`;\n    }\n    return `Unexpected error: ${error}`;\n  }).join('\\n');\n}\n\nasync function getAllEntries(parent, fsReader) {\n  return (await Promise.all((await fsReader.readdir(parent)).map(async dirent => {\n    const name = `${parent}${dirent.name}`;\n    const entry = {\n      entry: dirent,\n      name\n    };\n    if (dirent.kind === 'directory') {\n      return [entry, ...(await getAllEntries(`${name}/`, fsReader))];\n    }\n    return entry;\n  }))).flat();\n}\nconst listCollection = cache(async function listCollection(collectionPath, glob, formatInfo, extension, fsReader) {\n  const entries = glob === '*' ? (await fsReader.readdir(collectionPath)).map(entry => ({\n    entry,\n    name: entry.name\n  })) : (await getAllEntries(`${collectionPath}/`, fsReader)).map(x => ({\n    entry: x.entry,\n    name: x.name.slice(collectionPath.length + 1)\n  }));\n  return (await Promise.all(entries.map(async x => {\n    if (formatInfo.dataLocation === 'index') {\n      if (x.entry.kind !== 'directory') return [];\n      if (!(await fsReader.fileExists((0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.j)(`${collectionPath}/${x.name}`, formatInfo)))) {\n        return [];\n      }\n      return [x.name];\n    } else {\n      if (x.entry.kind !== 'file' || !x.name.endsWith(extension)) {\n        return [];\n      }\n      return [x.name.slice(0, -extension.length)];\n    }\n  }))).flat();\n});\nfunction collectionReader(collection, config, fsReader) {\n  const formatInfo = (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.l)(config, collection);\n  const collectionPath = (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.c)(config, collection);\n  const collectionConfig = config.collections[collection];\n  const schema = (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.o)(collectionConfig.schema);\n  const glob = (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.n)(config, collection);\n  const extension = (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.p)(formatInfo);\n  const read = (slug, ...args) => {\n    var _args$;\n    return readItem(schema, formatInfo, (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.q)(config, collection, slug), (_args$ = args[0]) === null || _args$ === void 0 ? void 0 : _args$.resolveLinkedFiles, `\"${slug}\" in collection \"${collection}\"`, fsReader, slug, collectionConfig.slugField, glob);\n  };\n  const list = () => listCollection(collectionPath, glob, formatInfo, extension, fsReader);\n  return {\n    read,\n    readOrThrow: async (...args) => {\n      const entry = await read(...args);\n      if (entry === null) {\n        throw new Error(`Entry \"${args[0]}\" not found in collection \"${collection}\"`);\n      }\n      return entry;\n    },\n    // TODO: this could drop the fs.stat call that list does for each item\n    // since we just immediately read it\n    all: async (...args) => {\n      const slugs = await list();\n      return (await Promise.all(slugs.map(async slug => {\n        const entry = await read(slug, args[0]);\n        if (entry === null) return [];\n        return [{\n          slug,\n          entry\n        }];\n      }))).flat();\n    },\n    list\n  };\n}\nconst readItem = cache(async function readItem(rootSchema, formatInfo, itemDir, resolveLinkedFiles, debugReference, fsReader, ...slugInfo) {\n  if (typeof slugInfo[0] === 'string') {\n    if (slugInfo[0].includes('\\\\')) return null;\n    const split = slugInfo[0].split('/');\n    if (slugInfo[2] === '*' && split.length !== 1) return null;\n    if (split.includes('..') || split.includes('.')) return null;\n  }\n  const dataFile = await fsReader.readFile((0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.j)(itemDir, formatInfo));\n  if (dataFile === null) return null;\n  const {\n    loaded,\n    extraFakeFile\n  } = loadDataFile(dataFile, formatInfo);\n  const contentFieldPathsToEagerlyResolve = resolveLinkedFiles ? [] : undefined;\n  let validated;\n  try {\n    validated = parseProps(rootSchema, loaded, [], [], (schema, value, path, pathWithArrayFieldSlugs) => {\n      if (schema.formKind === 'asset' || schema.formKind === 'assets') {\n        return schema.reader.parse(value);\n      }\n      if (schema.formKind === 'content') {\n        contentFieldPathsToEagerlyResolve === null || contentFieldPathsToEagerlyResolve === void 0 || contentFieldPathsToEagerlyResolve.push(path);\n        return async () => {\n          let content;\n          const filename = pathWithArrayFieldSlugs.join('/') + schema.contentExtension;\n          if (filename === (extraFakeFile === null || extraFakeFile === void 0 ? void 0 : extraFakeFile.path)) {\n            content = extraFakeFile.contents;\n          } else {\n            var _await$fsReader$readF;\n            content = (_await$fsReader$readF = await fsReader.readFile(`${itemDir}/${filename}`)) !== null && _await$fsReader$readF !== void 0 ? _await$fsReader$readF : undefined;\n          }\n          return schema.reader.parse(value, {\n            content\n          });\n        };\n      }\n      if (path.length === 1 && slugInfo[0] !== undefined) {\n        const [slug, slugField, glob] = slugInfo;\n        if (path[0] === slugField) {\n          if (schema.formKind !== 'slug') {\n            throw new Error(`Slug field ${slugInfo[1]} is not a slug field`);\n          }\n          return schema.reader.parseWithSlug(value, {\n            slug,\n            glob\n          });\n        }\n      }\n      return schema.reader.parse(value);\n    }, true);\n    if (contentFieldPathsToEagerlyResolve !== null && contentFieldPathsToEagerlyResolve !== void 0 && contentFieldPathsToEagerlyResolve.length) {\n      await Promise.all(contentFieldPathsToEagerlyResolve.map(async path => {\n        const parentValue = (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.k)(validated, path.slice(0, -1));\n        const keyOnParent = path[path.length - 1];\n        const originalValue = parentValue[keyOnParent];\n        parentValue[keyOnParent] = await originalValue();\n      }));\n    }\n  } catch (err) {\n    const formatted = formatFormDataError(err);\n    throw new Error(`Invalid data for ${debugReference}:\\n${formatted}`);\n  }\n  return validated;\n});\nfunction singletonReader(singleton, config, fsReader) {\n  const formatInfo = (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.e)(config, singleton);\n  const singletonPath = (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.h)(config, singleton);\n  const schema = (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.o)(config.singletons[singleton].schema);\n  const read = (...args) => {\n    var _args$2;\n    return readItem(schema, formatInfo, singletonPath, (_args$2 = args[0]) === null || _args$2 === void 0 ? void 0 : _args$2.resolveLinkedFiles, `singleton \"${singleton}\"`, fsReader, undefined);\n  };\n  return {\n    read,\n    readOrThrow: async (...opts) => {\n      const entry = await read(...opts);\n      if (entry === null) {\n        throw new Error(`Singleton \"${singleton}\" not found`);\n      }\n      return entry;\n    }\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3QvZ2VuZXJpYy00Nzk3YTc1NS5ub2RlLnJlYWN0LXNlcnZlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUEyQjtBQUNxUjtBQUM1UTtBQUNIO0FBQzJDO0FBQzdDO0FBQ0E7O0FBRS9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLGtEQUFXO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLG1FQUFjLHVCQUF1Qiw4QkFBOEIsU0FBUyw4Q0FBOEM7QUFDaks7QUFDQTtBQUNBLHVDQUF1QyxtRUFBYyxzQkFBc0IsOEJBQThCLFNBQVMsK0NBQStDO0FBQ2pLO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDRCQUE0QixlQUFlO0FBQzNDO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUVBQWM7QUFDaEM7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLG1FQUFjLDREQUE0RCxJQUFJO0FBQ2xHO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixtRUFBYztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFv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O0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsYUFBYTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDRCQUE0Qix1RUFBa0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsSUFBSTtBQUNKO0FBQ0Esd0NBQXdDLGVBQWUsS0FBSyxVQUFVO0FBQ3RFO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxxQkFBcUIsdUVBQWtCO0FBQ3ZDLHdCQUF3Qix1RUFBZ0I7QUFDeEMsaUJBQWlCLHVFQUFNO0FBQ3ZCO0FBQ0E7QUFDQSwrSkFBK0osVUFBVTtBQUN6SztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsVUFBVTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVtRSIsInNvdXJjZXMiOlsiL1VzZXJzL2phbWVzL0Rvd25sb2Fkcy9uZXcta2V5c3RhdGljLXByb2plY3Qvbm9kZV9tb2R1bGVzL0BrZXlzdGF0aWMvY29yZS9kaXN0L2dlbmVyaWMtNDc5N2E3NTUubm9kZS5yZWFjdC1zZXJ2ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdyZWFjdC9qc3gtcnVudGltZSc7XG5pbXBvcnQgeyBqIGFzIGdldEVudHJ5RGF0YUZpbGVwYXRoLCBrIGFzIGdldFZhbHVlQXRQcm9wUGF0aCwgbCBhcyBnZXRDb2xsZWN0aW9uRm9ybWF0LCBjIGFzIGdldENvbGxlY3Rpb25QYXRoLCBvIGFzIG9iamVjdCwgbiBhcyBnZXRTbHVnR2xvYkZvckNvbGxlY3Rpb24sIHAgYXMgZ2V0RGF0YUZpbGVFeHRlbnNpb24sIGUgYXMgZ2V0U2luZ2xldG9uRm9ybWF0LCBoIGFzIGdldFNpbmdsZXRvblBhdGgsIHEgYXMgZ2V0Q29sbGVjdGlvbkl0ZW1QYXRoIH0gZnJvbSAnLi9pbmRleC1jYTI3MDMxMS5ub2RlLnJlYWN0LXNlcnZlci5qcyc7XG5pbXBvcnQgeyBhc3NlcnROZXZlciB9IGZyb20gJ2VtZXJ5JztcbmltcG9ydCAnQGJyYWludHJlZS9zYW5pdGl6ZS11cmwnO1xuaW1wb3J0IHsgRiBhcyBGaWVsZERhdGFFcnJvciB9IGZyb20gJy4vaW5kZXgtMTBlYTUwZTIubm9kZS5yZWFjdC1zZXJ2ZXIuanMnO1xuaW1wb3J0IHsgbG9hZCB9IGZyb20gJ2pzLXlhbWwnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5jb25zdCBnZXRJbml0aWFsUHJvcHNWYWx1ZSA9IF9nZXRJbml0aWFsUHJvcHNWYWx1ZTtcbmZ1bmN0aW9uIF9nZXRJbml0aWFsUHJvcHNWYWx1ZShzY2hlbWEpIHtcbiAgc3dpdGNoIChzY2hlbWEua2luZCkge1xuICAgIGNhc2UgJ2Zvcm0nOlxuICAgICAgcmV0dXJuIHNjaGVtYS5kZWZhdWx0VmFsdWUoKTtcbiAgICBjYXNlICdjaGlsZCc6XG4gICAgICByZXR1cm4gc2NoZW1hLm9wdGlvbnMua2luZCA9PT0gJ2Jsb2NrJyA/IFt7XG4gICAgICAgIHR5cGU6ICdwYXJhZ3JhcGgnLFxuICAgICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgICB0ZXh0OiAnJ1xuICAgICAgICB9XVxuICAgICAgfV0gOiBudWxsO1xuICAgIGNhc2UgJ2NvbmRpdGlvbmFsJzpcbiAgICAgIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdFZhbHVlID0gc2NoZW1hLmRpc2NyaW1pbmFudC5kZWZhdWx0VmFsdWUoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkaXNjcmltaW5hbnQ6IGRlZmF1bHRWYWx1ZSxcbiAgICAgICAgICB2YWx1ZTogZ2V0SW5pdGlhbFByb3BzVmFsdWUoc2NoZW1hLnZhbHVlc1tkZWZhdWx0VmFsdWUudG9TdHJpbmcoKV0pXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgIHtcbiAgICAgICAgY29uc3Qgb2JqID0ge307XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHNjaGVtYS5maWVsZHMpKSB7XG4gICAgICAgICAgb2JqW2tleV0gPSBnZXRJbml0aWFsUHJvcHNWYWx1ZShzY2hlbWEuZmllbGRzW2tleV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9XG4gICAgY2FzZSAnYXJyYXknOlxuICAgICAge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gIH1cbiAgYXNzZXJ0TmV2ZXIoc2NoZW1hKTtcbn1cblxuZnVuY3Rpb24gdmFsaWRhdGVBcnJheUxlbmd0aChzY2hlbWEsIHZhbCwgcGF0aCkge1xuICB2YXIgX3NjaGVtYSR2YWxpZGF0aW9uLCBfc2NoZW1hJHZhbGlkYXRpb24yO1xuICBpZiAoKChfc2NoZW1hJHZhbGlkYXRpb24gPSBzY2hlbWEudmFsaWRhdGlvbikgPT09IG51bGwgfHwgX3NjaGVtYSR2YWxpZGF0aW9uID09PSB2b2lkIDAgfHwgKF9zY2hlbWEkdmFsaWRhdGlvbiA9IF9zY2hlbWEkdmFsaWRhdGlvbi5sZW5ndGgpID09PSBudWxsIHx8IF9zY2hlbWEkdmFsaWRhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3NjaGVtYSR2YWxpZGF0aW9uLm1pbikgIT09IHVuZGVmaW5lZCAmJiB2YWwubGVuZ3RoIDwgc2NoZW1hLnZhbGlkYXRpb24ubGVuZ3RoLm1pbikge1xuICAgIHJldHVybiBuZXcgUHJvcFZhbGlkYXRpb25FcnJvcihuZXcgRmllbGREYXRhRXJyb3IoYE11c3QgaGF2ZSBhdCBsZWFzdCAke3NjaGVtYS52YWxpZGF0aW9uLmxlbmd0aC5taW59IGVsZW1lbnQke3NjaGVtYS52YWxpZGF0aW9uLmxlbmd0aC5taW4gPT09IDEgPyAnJyA6ICdzJ31gKSwgcGF0aCwgc2NoZW1hKTtcbiAgfVxuICBpZiAoKChfc2NoZW1hJHZhbGlkYXRpb24yID0gc2NoZW1hLnZhbGlkYXRpb24pID09PSBudWxsIHx8IF9zY2hlbWEkdmFsaWRhdGlvbjIgPT09IHZvaWQgMCB8fCAoX3NjaGVtYSR2YWxpZGF0aW9uMiA9IF9zY2hlbWEkdmFsaWRhdGlvbjIubGVuZ3RoKSA9PT0gbnVsbCB8fCBfc2NoZW1hJHZhbGlkYXRpb24yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfc2NoZW1hJHZhbGlkYXRpb24yLm1heCkgIT09IHVuZGVmaW5lZCAmJiB2YWwubGVuZ3RoID4gc2NoZW1hLnZhbGlkYXRpb24ubGVuZ3RoLm1heCkge1xuICAgIHJldHVybiBuZXcgUHJvcFZhbGlkYXRpb25FcnJvcihuZXcgRmllbGREYXRhRXJyb3IoYE11c3QgaGF2ZSBhdCBtb3N0ICR7c2NoZW1hLnZhbGlkYXRpb24ubGVuZ3RoLm1heH0gZWxlbWVudCR7c2NoZW1hLnZhbGlkYXRpb24ubGVuZ3RoLm1heCA9PT0gMSA/ICcnIDogJ3MnfX1gKSwgcGF0aCwgc2NoZW1hKTtcbiAgfVxufVxuXG5jbGFzcyBQcm9wVmFsaWRhdGlvbkVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihjYXVzZSwgcGF0aCwgc2NoZW1hKSB7XG4gICAgc3VwZXIoYGZpZWxkIGVycm9yIGF0ICR7cGF0aC5qb2luKCcuJyl9YCwge1xuICAgICAgY2F1c2VcbiAgICB9KTtcbiAgICB0aGlzLnBhdGggPSBwYXRoO1xuICAgIHRoaXMuc2NoZW1hID0gc2NoZW1hO1xuICAgIHRoaXMuY2F1c2UgPSBjYXVzZTtcbiAgfVxufVxuZnVuY3Rpb24gdG9Gb3JtRmllbGRTdG9yZWRWYWx1ZSh2YWwpIHtcbiAgaWYgKHZhbCA9PT0gbnVsbCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgcmV0dXJuIHZhbDtcbn1cbmNvbnN0IGlzQXJyYXkgPSBBcnJheS5pc0FycmF5O1xuZnVuY3Rpb24gcGFyc2VQcm9wcyhzY2hlbWEsIF92YWx1ZSwgcGF0aCwgcGF0aFdpdGhBcnJheUZpZWxkU2x1Z3MsIHBhcnNlRm9ybUZpZWxkLCAvKiogVGhpcyBzaG91bGQgYmUgdHJ1ZSBmb3IgdGhlIHJlYWRlciBhbmQgZmFsc2UgZWxzZXdoZXJlICovXG52YWxpZGF0ZUFycmF5RmllbGRMZW5ndGgpIHtcbiAgbGV0IHZhbHVlID0gdG9Gb3JtRmllbGRTdG9yZWRWYWx1ZShfdmFsdWUpO1xuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdmb3JtJykge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gcGFyc2VGb3JtRmllbGQoc2NoZW1hLCB2YWx1ZSwgcGF0aCwgcGF0aFdpdGhBcnJheUZpZWxkU2x1Z3MpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhyb3cgbmV3IFByb3BWYWxpZGF0aW9uRXJyb3IoZXJyLCBwYXRoLCBzY2hlbWEpO1xuICAgIH1cbiAgfVxuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdjaGlsZCcpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdjb25kaXRpb25hbCcpIHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGdldEluaXRpYWxQcm9wc1ZhbHVlKHNjaGVtYSk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnb2JqZWN0JyB8fCB2YWx1ZSA9PT0gbnVsbCB8fCBpc0FycmF5KHZhbHVlKSB8fCB2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGFuIG9iamVjdCcpO1xuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXModmFsdWUpKSB7XG4gICAgICAgIGlmIChrZXkgIT09ICdkaXNjcmltaW5hbnQnICYmIGtleSAhPT0gJ3ZhbHVlJykge1xuICAgICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcihgTXVzdCBvbmx5IGNvbnRhaW4ga2V5cyBcImRpc2NyaW1pbmFudFwiIGFuZCBcInZhbHVlXCIsIG5vdCBcIiR7a2V5fVwiYCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRocm93IG5ldyBQcm9wVmFsaWRhdGlvbkVycm9yKGVyciwgcGF0aCwgc2NoZW1hKTtcbiAgICB9XG4gICAgY29uc3QgcGFyc2VkRGlzY3JpbWluYW50ID0gcGFyc2VQcm9wcyhzY2hlbWEuZGlzY3JpbWluYW50LCB2YWx1ZS5kaXNjcmltaW5hbnQsIHBhdGguY29uY2F0KCdkaXNjcmltaW5hbnQnKSwgcGF0aFdpdGhBcnJheUZpZWxkU2x1Z3MuY29uY2F0KCdkaXNjcmltaW5hbnQnKSwgcGFyc2VGb3JtRmllbGQsIHZhbGlkYXRlQXJyYXlGaWVsZExlbmd0aCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRpc2NyaW1pbmFudDogcGFyc2VkRGlzY3JpbWluYW50LFxuICAgICAgdmFsdWU6IHBhcnNlUHJvcHMoc2NoZW1hLnZhbHVlc1twYXJzZWREaXNjcmltaW5hbnRdLCB2YWx1ZS52YWx1ZSwgcGF0aC5jb25jYXQoJ3ZhbHVlJyksIHBhdGhXaXRoQXJyYXlGaWVsZFNsdWdzLmNvbmNhdCgndmFsdWUnKSwgcGFyc2VGb3JtRmllbGQsIHZhbGlkYXRlQXJyYXlGaWVsZExlbmd0aClcbiAgICB9O1xuICB9XG4gIGlmIChzY2hlbWEua2luZCA9PT0gJ29iamVjdCcpIHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdmFsdWUgPSB7fTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdvYmplY3QnIHx8IHZhbHVlID09PSBudWxsIHx8IGlzQXJyYXkodmFsdWUpIHx8IHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYW4gb2JqZWN0Jyk7XG4gICAgICB9XG4gICAgICBjb25zdCBhbGxvd2VkS2V5c1NldCA9IG5ldyBTZXQoT2JqZWN0LmtleXMoc2NoZW1hLmZpZWxkcykpO1xuICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXModmFsdWUpKSB7XG4gICAgICAgIGlmICghYWxsb3dlZEtleXNTZXQuaGFzKGtleSkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoYEtleSBvbiBvYmplY3QgdmFsdWUgXCIke2tleX1cIiBpcyBub3QgYWxsb3dlZGApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICB0aHJvdyBuZXcgUHJvcFZhbGlkYXRpb25FcnJvcihlcnIsIHBhdGgsIHNjaGVtYSk7XG4gICAgfVxuICAgIGNvbnN0IHZhbCA9IHt9O1xuICAgIGNvbnN0IGVycm9ycyA9IFtdO1xuICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHNjaGVtYS5maWVsZHMpKSB7XG4gICAgICBsZXQgaW5kaXZpZHVhbFZhbCA9IHZhbHVlW2tleV07XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwcm9wVmFsID0gcGFyc2VQcm9wcyhzY2hlbWEuZmllbGRzW2tleV0sIGluZGl2aWR1YWxWYWwsIHBhdGguY29uY2F0KGtleSksIHBhdGhXaXRoQXJyYXlGaWVsZFNsdWdzLmNvbmNhdChrZXkpLCBwYXJzZUZvcm1GaWVsZCwgdmFsaWRhdGVBcnJheUZpZWxkTGVuZ3RoKTtcbiAgICAgICAgdmFsW2tleV0gPSBwcm9wVmFsO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGVycm9ycy5wdXNoKGVycik7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChlcnJvcnMubGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgQWdncmVnYXRlRXJyb3IoZXJyb3JzKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbDtcbiAgfVxuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdhcnJheScpIHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgaWYgKCFpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYW4gYXJyYXknKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRocm93IG5ldyBQcm9wVmFsaWRhdGlvbkVycm9yKGVyciwgcGF0aCwgc2NoZW1hKTtcbiAgICB9XG4gICAgY29uc3QgZXJyb3JzID0gW107XG4gICAgdHJ5IHtcbiAgICAgIGlmICh2YWxpZGF0ZUFycmF5RmllbGRMZW5ndGgpIHtcbiAgICAgICAgY29uc3QgZXJyb3IgPSB2YWxpZGF0ZUFycmF5TGVuZ3RoKHNjaGVtYSwgdmFsdWUsIHBhdGgpO1xuICAgICAgICBpZiAoZXJyb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGVycm9ycy5wdXNoKGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlLm1hcCgoaW5uZXJWYWwsIGkpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBsZXQgc2x1ZyA9IGkudG9TdHJpbmcoKTtcbiAgICAgICAgICBpZiAoc2NoZW1hLnNsdWdGaWVsZCAmJiB0eXBlb2YgaW5uZXJWYWwgPT09ICdvYmplY3QnICYmIGlubmVyVmFsICE9PSBudWxsICYmICFpc0FycmF5KGlubmVyVmFsKSAmJiAhKGlubmVyVmFsIGluc3RhbmNlb2YgRGF0ZSkpIHtcbiAgICAgICAgICAgIGlmIChzY2hlbWEuZWxlbWVudC5raW5kICE9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3NsdWdGaWVsZCBvbiBhcnJheSBmaWVsZHMgcmVxdWlyZXMgdGhlIGFuIG9iamVjdCBmaWVsZCBlbGVtZW50Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBzbHVnRmllbGQgPSBzY2hlbWEuZWxlbWVudC5maWVsZHNbc2NoZW1hLnNsdWdGaWVsZF07XG4gICAgICAgICAgICBpZiAoIXNsdWdGaWVsZCkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHNsdWdGaWVsZCBcIiR7c2NoZW1hLnNsdWdGaWVsZH1cIiBkb2VzIG5vdCBleGlzdCBvbiBvYmplY3QgZmllbGRgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzbHVnRmllbGQua2luZCAhPT0gJ2Zvcm0nKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgc2x1Z0ZpZWxkIFwiJHtzY2hlbWEuc2x1Z0ZpZWxkfVwiIGlzIG5vdCBhIGZvcm0gZmllbGRgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzbHVnRmllbGQuZm9ybUtpbmQgIT09ICdzbHVnJykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHNsdWdGaWVsZCBcIiR7c2NoZW1hLnNsdWdGaWVsZH1cIiBpcyBub3QgYSBzbHVnIGZpZWxkYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgcGFyc2VkU2x1Z0ZpZWxkVmFsdWU7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBwYXJzZWRTbHVnRmllbGRWYWx1ZSA9IHNsdWdGaWVsZC5wYXJzZSh0b0Zvcm1GaWVsZFN0b3JlZFZhbHVlKGlubmVyVmFsW3NjaGVtYS5zbHVnRmllbGRdKSwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQWdncmVnYXRlRXJyb3IoW2Vycl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2x1ZyA9IHNsdWdGaWVsZC5zZXJpYWxpemVXaXRoU2x1ZyhwYXJzZWRTbHVnRmllbGRWYWx1ZSkuc2x1ZztcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHBhcnNlUHJvcHMoc2NoZW1hLmVsZW1lbnQsIGlubmVyVmFsLCBwYXRoLmNvbmNhdChpKSwgcGF0aFdpdGhBcnJheUZpZWxkU2x1Z3MuY29uY2F0KHNsdWcpLCBwYXJzZUZvcm1GaWVsZCwgdmFsaWRhdGVBcnJheUZpZWxkTGVuZ3RoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgZXJyb3JzLnB1c2goZXJyKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGlmIChlcnJvcnMubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBBZ2dyZWdhdGVFcnJvcihlcnJvcnMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBhc3NlcnROZXZlcihzY2hlbWEpO1xufVxuXG5jb25zdCB0ZXh0RGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuY29uc3QgdGV4dEVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbmZ1bmN0aW9uIHNwbGl0RnJvbnRtYXR0ZXIoZGF0YSkge1xuICBjb25zdCBzdHIgPSB0ZXh0RGVjb2Rlci5kZWNvZGUoZGF0YSk7XG4gIGNvbnN0IG1hdGNoID0gc3RyLm1hdGNoKC9eLS0tKD86XFxyP1xcbihbXl0qPykpP1xccj9cXG4tLS1cXHI/XFxuPy8pO1xuICBpZiAobWF0Y2gpIHtcbiAgICB2YXIgX21hdGNoJDtcbiAgICBjb25zdCBlbmNvZGVkID0gdGV4dEVuY29kZXIuZW5jb2RlKG1hdGNoWzBdKTtcbiAgICByZXR1cm4ge1xuICAgICAgZnJvbnRtYXR0ZXI6IChfbWF0Y2gkID0gbWF0Y2hbMV0pICE9PSBudWxsICYmIF9tYXRjaCQgIT09IHZvaWQgMCA/IF9tYXRjaCQgOiAnJyxcbiAgICAgIGNvbnRlbnQ6IGRhdGEuc2xpY2UoZW5jb2RlZC5ieXRlTGVuZ3RoKVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5mdW5jdGlvbiBsb2FkRGF0YUZpbGUoZGF0YSwgZm9ybWF0SW5mbywgcmVxdWlyZUZyb250bWF0dGVyID0gZmFsc2UpIHtcbiAgY29uc3QgcGFyc2UgPSBmb3JtYXRJbmZvLmRhdGEgPT09ICdqc29uJyA/IEpTT04ucGFyc2UgOiBsb2FkO1xuICBpZiAoIWZvcm1hdEluZm8uY29udGVudEZpZWxkKSB7XG4gICAgY29uc3QgZGF0YUZpbGUgPSB0ZXh0RGVjb2Rlci5kZWNvZGUoZGF0YSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxvYWRlZDogcGFyc2UoZGF0YUZpbGUpXG4gICAgfTtcbiAgfVxuICBjb25zdCByZXMgPSBzcGxpdEZyb250bWF0dGVyKGRhdGEpO1xuICBpZiAocmVxdWlyZUZyb250bWF0dGVyICYmICFyZXMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Zyb250bWF0dGVyIG5vdCBmb3VuZCcpO1xuICB9XG4gIHJldHVybiB7XG4gICAgbG9hZGVkOiByZXMgPT09IG51bGwgPyB7fSA6IHBhcnNlKHJlcy5mcm9udG1hdHRlciksXG4gICAgZXh0cmFGYWtlRmlsZToge1xuICAgICAgcGF0aDogYCR7Zm9ybWF0SW5mby5jb250ZW50RmllbGQucGF0aC5qb2luKCcvJyl9JHtmb3JtYXRJbmZvLmNvbnRlbnRGaWVsZC5jb250ZW50RXh0ZW5zaW9ufWAsXG4gICAgICBjb250ZW50czogcmVzID09PSBudWxsID8gZGF0YSA6IHJlcy5jb250ZW50XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBjYWNoZSQxKGZ1bmMpIHtcbiAgcmV0dXJuIGZ1bmM7XG59XG5cbi8vIHdlIGNvbmRpdGlvbmFsbHkgdXNpbmcgaXQgc2luY2UgaXQncyBub3QgYWN0dWFsbHkgaW4gc3RhYmxlIHJlYWN0IHJlbGVhc2VzIHlldFxuLy8gKHRob3VnaCBpdCBzaG91bGQgYmUgdW5uZWNlc3Nhcnkgc2luY2UgdGhpcyBmaWxlIGlzIG9ubHkgaW1wb3J0ZWQgaW4gcmVhY3Qtc2VydmVyIGVudmlyb25tZW50cyBhbnl3YXkpXG4vLyBpdCdzIGEgZnVuY3Rpb24gYmVjYXVzZSBzb21lIHRvb2xzIHRyeSB0byBiZSBzbWFydCB3aXRoIGFjY2Vzc2luZyB0aGluZ3Mgb24gbmFtZXNwYWNlIGltcG9ydHNcbi8vIGFuZCBlcnJvciBhdCBidWlsZCB0aW1lIGlmIHlvdSB0cnkgdG8gcmVhZCBhbiBleHBvcnQgdGhhdCBkb2Vzbid0IGV4aXN0IG9uIGEgbmFtZXNwYWNlIG9iamVjdFxuZnVuY3Rpb24gZ2V0Q2FjaGUocmVhY3QpIHtcbiAgdmFyIF9yZWFjdCRjYWNoZTtcbiAgcmV0dXJuIChfcmVhY3QkY2FjaGUgPSByZWFjdC5jYWNoZSkgIT09IG51bGwgJiYgX3JlYWN0JGNhY2hlICE9PSB2b2lkIDAgPyBfcmVhY3QkY2FjaGUgOiBjYWNoZSQxO1xufVxuY29uc3QgY2FjaGUgPSBnZXRDYWNoZShSZWFjdCk7XG5cbmZ1bmN0aW9uIGZsYXR0ZW5FcnJvcnMoZXJyb3IpIHtcbiAgaWYgKGVycm9yIGluc3RhbmNlb2YgQWdncmVnYXRlRXJyb3IpIHtcbiAgICByZXR1cm4gZXJyb3IuZXJyb3JzLmZsYXRNYXAoZmxhdHRlbkVycm9ycyk7XG4gIH1cbiAgcmV0dXJuIFtlcnJvcl07XG59XG5mdW5jdGlvbiBmb3JtYXRGb3JtRGF0YUVycm9yKGVycm9yKSB7XG4gIGNvbnN0IGZsYXRFcnJvcnMgPSBmbGF0dGVuRXJyb3JzKGVycm9yKTtcbiAgcmV0dXJuIGZsYXRFcnJvcnMubWFwKGVycm9yID0+IHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQcm9wVmFsaWRhdGlvbkVycm9yKSB7XG4gICAgICBjb25zdCBwYXRoID0gZXJyb3IucGF0aC5qb2luKCcuJyk7XG4gICAgICByZXR1cm4gYCR7cGF0aH06ICR7ZXJyb3IuY2F1c2UgaW5zdGFuY2VvZiBGaWVsZERhdGFFcnJvciA/IGVycm9yLmNhdXNlLm1lc3NhZ2UgOiBgVW5leHBlY3RlZCBlcnJvcjogJHtlcnJvci5jYXVzZX1gfWA7XG4gICAgfVxuICAgIHJldHVybiBgVW5leHBlY3RlZCBlcnJvcjogJHtlcnJvcn1gO1xuICB9KS5qb2luKCdcXG4nKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0QWxsRW50cmllcyhwYXJlbnQsIGZzUmVhZGVyKSB7XG4gIHJldHVybiAoYXdhaXQgUHJvbWlzZS5hbGwoKGF3YWl0IGZzUmVhZGVyLnJlYWRkaXIocGFyZW50KSkubWFwKGFzeW5jIGRpcmVudCA9PiB7XG4gICAgY29uc3QgbmFtZSA9IGAke3BhcmVudH0ke2RpcmVudC5uYW1lfWA7XG4gICAgY29uc3QgZW50cnkgPSB7XG4gICAgICBlbnRyeTogZGlyZW50LFxuICAgICAgbmFtZVxuICAgIH07XG4gICAgaWYgKGRpcmVudC5raW5kID09PSAnZGlyZWN0b3J5Jykge1xuICAgICAgcmV0dXJuIFtlbnRyeSwgLi4uKGF3YWl0IGdldEFsbEVudHJpZXMoYCR7bmFtZX0vYCwgZnNSZWFkZXIpKV07XG4gICAgfVxuICAgIHJldHVybiBlbnRyeTtcbiAgfSkpKS5mbGF0KCk7XG59XG5jb25zdCBsaXN0Q29sbGVjdGlvbiA9IGNhY2hlKGFzeW5jIGZ1bmN0aW9uIGxpc3RDb2xsZWN0aW9uKGNvbGxlY3Rpb25QYXRoLCBnbG9iLCBmb3JtYXRJbmZvLCBleHRlbnNpb24sIGZzUmVhZGVyKSB7XG4gIGNvbnN0IGVudHJpZXMgPSBnbG9iID09PSAnKicgPyAoYXdhaXQgZnNSZWFkZXIucmVhZGRpcihjb2xsZWN0aW9uUGF0aCkpLm1hcChlbnRyeSA9PiAoe1xuICAgIGVudHJ5LFxuICAgIG5hbWU6IGVudHJ5Lm5hbWVcbiAgfSkpIDogKGF3YWl0IGdldEFsbEVudHJpZXMoYCR7Y29sbGVjdGlvblBhdGh9L2AsIGZzUmVhZGVyKSkubWFwKHggPT4gKHtcbiAgICBlbnRyeTogeC5lbnRyeSxcbiAgICBuYW1lOiB4Lm5hbWUuc2xpY2UoY29sbGVjdGlvblBhdGgubGVuZ3RoICsgMSlcbiAgfSkpO1xuICByZXR1cm4gKGF3YWl0IFByb21pc2UuYWxsKGVudHJpZXMubWFwKGFzeW5jIHggPT4ge1xuICAgIGlmIChmb3JtYXRJbmZvLmRhdGFMb2NhdGlvbiA9PT0gJ2luZGV4Jykge1xuICAgICAgaWYgKHguZW50cnkua2luZCAhPT0gJ2RpcmVjdG9yeScpIHJldHVybiBbXTtcbiAgICAgIGlmICghKGF3YWl0IGZzUmVhZGVyLmZpbGVFeGlzdHMoZ2V0RW50cnlEYXRhRmlsZXBhdGgoYCR7Y29sbGVjdGlvblBhdGh9LyR7eC5uYW1lfWAsIGZvcm1hdEluZm8pKSkpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFt4Lm5hbWVdO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoeC5lbnRyeS5raW5kICE9PSAnZmlsZScgfHwgIXgubmFtZS5lbmRzV2l0aChleHRlbnNpb24pKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBbeC5uYW1lLnNsaWNlKDAsIC1leHRlbnNpb24ubGVuZ3RoKV07XG4gICAgfVxuICB9KSkpLmZsYXQoKTtcbn0pO1xuZnVuY3Rpb24gY29sbGVjdGlvblJlYWRlcihjb2xsZWN0aW9uLCBjb25maWcsIGZzUmVhZGVyKSB7XG4gIGNvbnN0IGZvcm1hdEluZm8gPSBnZXRDb2xsZWN0aW9uRm9ybWF0KGNvbmZpZywgY29sbGVjdGlvbik7XG4gIGNvbnN0IGNvbGxlY3Rpb25QYXRoID0gZ2V0Q29sbGVjdGlvblBhdGgoY29uZmlnLCBjb2xsZWN0aW9uKTtcbiAgY29uc3QgY29sbGVjdGlvbkNvbmZpZyA9IGNvbmZpZy5jb2xsZWN0aW9uc1tjb2xsZWN0aW9uXTtcbiAgY29uc3Qgc2NoZW1hID0gb2JqZWN0KGNvbGxlY3Rpb25Db25maWcuc2NoZW1hKTtcbiAgY29uc3QgZ2xvYiA9IGdldFNsdWdHbG9iRm9yQ29sbGVjdGlvbihjb25maWcsIGNvbGxlY3Rpb24pO1xuICBjb25zdCBleHRlbnNpb24gPSBnZXREYXRhRmlsZUV4dGVuc2lvbihmb3JtYXRJbmZvKTtcbiAgY29uc3QgcmVhZCA9IChzbHVnLCAuLi5hcmdzKSA9PiB7XG4gICAgdmFyIF9hcmdzJDtcbiAgICByZXR1cm4gcmVhZEl0ZW0oc2NoZW1hLCBmb3JtYXRJbmZvLCBnZXRDb2xsZWN0aW9uSXRlbVBhdGgoY29uZmlnLCBjb2xsZWN0aW9uLCBzbHVnKSwgKF9hcmdzJCA9IGFyZ3NbMF0pID09PSBudWxsIHx8IF9hcmdzJCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FyZ3MkLnJlc29sdmVMaW5rZWRGaWxlcywgYFwiJHtzbHVnfVwiIGluIGNvbGxlY3Rpb24gXCIke2NvbGxlY3Rpb259XCJgLCBmc1JlYWRlciwgc2x1ZywgY29sbGVjdGlvbkNvbmZpZy5zbHVnRmllbGQsIGdsb2IpO1xuICB9O1xuICBjb25zdCBsaXN0ID0gKCkgPT4gbGlzdENvbGxlY3Rpb24oY29sbGVjdGlvblBhdGgsIGdsb2IsIGZvcm1hdEluZm8sIGV4dGVuc2lvbiwgZnNSZWFkZXIpO1xuICByZXR1cm4ge1xuICAgIHJlYWQsXG4gICAgcmVhZE9yVGhyb3c6IGFzeW5jICguLi5hcmdzKSA9PiB7XG4gICAgICBjb25zdCBlbnRyeSA9IGF3YWl0IHJlYWQoLi4uYXJncyk7XG4gICAgICBpZiAoZW50cnkgPT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFbnRyeSBcIiR7YXJnc1swXX1cIiBub3QgZm91bmQgaW4gY29sbGVjdGlvbiBcIiR7Y29sbGVjdGlvbn1cImApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGVudHJ5O1xuICAgIH0sXG4gICAgLy8gVE9ETzogdGhpcyBjb3VsZCBkcm9wIHRoZSBmcy5zdGF0IGNhbGwgdGhhdCBsaXN0IGRvZXMgZm9yIGVhY2ggaXRlbVxuICAgIC8vIHNpbmNlIHdlIGp1c3QgaW1tZWRpYXRlbHkgcmVhZCBpdFxuICAgIGFsbDogYXN5bmMgKC4uLmFyZ3MpID0+IHtcbiAgICAgIGNvbnN0IHNsdWdzID0gYXdhaXQgbGlzdCgpO1xuICAgICAgcmV0dXJuIChhd2FpdCBQcm9taXNlLmFsbChzbHVncy5tYXAoYXN5bmMgc2x1ZyA9PiB7XG4gICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgcmVhZChzbHVnLCBhcmdzWzBdKTtcbiAgICAgICAgaWYgKGVudHJ5ID09PSBudWxsKSByZXR1cm4gW107XG4gICAgICAgIHJldHVybiBbe1xuICAgICAgICAgIHNsdWcsXG4gICAgICAgICAgZW50cnlcbiAgICAgICAgfV07XG4gICAgICB9KSkpLmZsYXQoKTtcbiAgICB9LFxuICAgIGxpc3RcbiAgfTtcbn1cbmNvbnN0IHJlYWRJdGVtID0gY2FjaGUoYXN5bmMgZnVuY3Rpb24gcmVhZEl0ZW0ocm9vdFNjaGVtYSwgZm9ybWF0SW5mbywgaXRlbURpciwgcmVzb2x2ZUxpbmtlZEZpbGVzLCBkZWJ1Z1JlZmVyZW5jZSwgZnNSZWFkZXIsIC4uLnNsdWdJbmZvKSB7XG4gIGlmICh0eXBlb2Ygc2x1Z0luZm9bMF0gPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKHNsdWdJbmZvWzBdLmluY2x1ZGVzKCdcXFxcJykpIHJldHVybiBudWxsO1xuICAgIGNvbnN0IHNwbGl0ID0gc2x1Z0luZm9bMF0uc3BsaXQoJy8nKTtcbiAgICBpZiAoc2x1Z0luZm9bMl0gPT09ICcqJyAmJiBzcGxpdC5sZW5ndGggIT09IDEpIHJldHVybiBudWxsO1xuICAgIGlmIChzcGxpdC5pbmNsdWRlcygnLi4nKSB8fCBzcGxpdC5pbmNsdWRlcygnLicpKSByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBkYXRhRmlsZSA9IGF3YWl0IGZzUmVhZGVyLnJlYWRGaWxlKGdldEVudHJ5RGF0YUZpbGVwYXRoKGl0ZW1EaXIsIGZvcm1hdEluZm8pKTtcbiAgaWYgKGRhdGFGaWxlID09PSBudWxsKSByZXR1cm4gbnVsbDtcbiAgY29uc3Qge1xuICAgIGxvYWRlZCxcbiAgICBleHRyYUZha2VGaWxlXG4gIH0gPSBsb2FkRGF0YUZpbGUoZGF0YUZpbGUsIGZvcm1hdEluZm8pO1xuICBjb25zdCBjb250ZW50RmllbGRQYXRoc1RvRWFnZXJseVJlc29sdmUgPSByZXNvbHZlTGlua2VkRmlsZXMgPyBbXSA6IHVuZGVmaW5lZDtcbiAgbGV0IHZhbGlkYXRlZDtcbiAgdHJ5IHtcbiAgICB2YWxpZGF0ZWQgPSBwYXJzZVByb3BzKHJvb3RTY2hlbWEsIGxvYWRlZCwgW10sIFtdLCAoc2NoZW1hLCB2YWx1ZSwgcGF0aCwgcGF0aFdpdGhBcnJheUZpZWxkU2x1Z3MpID0+IHtcbiAgICAgIGlmIChzY2hlbWEuZm9ybUtpbmQgPT09ICdhc3NldCcgfHwgc2NoZW1hLmZvcm1LaW5kID09PSAnYXNzZXRzJykge1xuICAgICAgICByZXR1cm4gc2NoZW1hLnJlYWRlci5wYXJzZSh2YWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAoc2NoZW1hLmZvcm1LaW5kID09PSAnY29udGVudCcpIHtcbiAgICAgICAgY29udGVudEZpZWxkUGF0aHNUb0VhZ2VybHlSZXNvbHZlID09PSBudWxsIHx8IGNvbnRlbnRGaWVsZFBhdGhzVG9FYWdlcmx5UmVzb2x2ZSA9PT0gdm9pZCAwIHx8IGNvbnRlbnRGaWVsZFBhdGhzVG9FYWdlcmx5UmVzb2x2ZS5wdXNoKHBhdGgpO1xuICAgICAgICByZXR1cm4gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGxldCBjb250ZW50O1xuICAgICAgICAgIGNvbnN0IGZpbGVuYW1lID0gcGF0aFdpdGhBcnJheUZpZWxkU2x1Z3Muam9pbignLycpICsgc2NoZW1hLmNvbnRlbnRFeHRlbnNpb247XG4gICAgICAgICAgaWYgKGZpbGVuYW1lID09PSAoZXh0cmFGYWtlRmlsZSA9PT0gbnVsbCB8fCBleHRyYUZha2VGaWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBleHRyYUZha2VGaWxlLnBhdGgpKSB7XG4gICAgICAgICAgICBjb250ZW50ID0gZXh0cmFGYWtlRmlsZS5jb250ZW50cztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIF9hd2FpdCRmc1JlYWRlciRyZWFkRjtcbiAgICAgICAgICAgIGNvbnRlbnQgPSAoX2F3YWl0JGZzUmVhZGVyJHJlYWRGID0gYXdhaXQgZnNSZWFkZXIucmVhZEZpbGUoYCR7aXRlbURpcn0vJHtmaWxlbmFtZX1gKSkgIT09IG51bGwgJiYgX2F3YWl0JGZzUmVhZGVyJHJlYWRGICE9PSB2b2lkIDAgPyBfYXdhaXQkZnNSZWFkZXIkcmVhZEYgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBzY2hlbWEucmVhZGVyLnBhcnNlKHZhbHVlLCB7XG4gICAgICAgICAgICBjb250ZW50XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpZiAocGF0aC5sZW5ndGggPT09IDEgJiYgc2x1Z0luZm9bMF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb25zdCBbc2x1Zywgc2x1Z0ZpZWxkLCBnbG9iXSA9IHNsdWdJbmZvO1xuICAgICAgICBpZiAocGF0aFswXSA9PT0gc2x1Z0ZpZWxkKSB7XG4gICAgICAgICAgaWYgKHNjaGVtYS5mb3JtS2luZCAhPT0gJ3NsdWcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNsdWcgZmllbGQgJHtzbHVnSW5mb1sxXX0gaXMgbm90IGEgc2x1ZyBmaWVsZGApO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gc2NoZW1hLnJlYWRlci5wYXJzZVdpdGhTbHVnKHZhbHVlLCB7XG4gICAgICAgICAgICBzbHVnLFxuICAgICAgICAgICAgZ2xvYlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gc2NoZW1hLnJlYWRlci5wYXJzZSh2YWx1ZSk7XG4gICAgfSwgdHJ1ZSk7XG4gICAgaWYgKGNvbnRlbnRGaWVsZFBhdGhzVG9FYWdlcmx5UmVzb2x2ZSAhPT0gbnVsbCAmJiBjb250ZW50RmllbGRQYXRoc1RvRWFnZXJseVJlc29sdmUgIT09IHZvaWQgMCAmJiBjb250ZW50RmllbGRQYXRoc1RvRWFnZXJseVJlc29sdmUubGVuZ3RoKSB7XG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChjb250ZW50RmllbGRQYXRoc1RvRWFnZXJseVJlc29sdmUubWFwKGFzeW5jIHBhdGggPT4ge1xuICAgICAgICBjb25zdCBwYXJlbnRWYWx1ZSA9IGdldFZhbHVlQXRQcm9wUGF0aCh2YWxpZGF0ZWQsIHBhdGguc2xpY2UoMCwgLTEpKTtcbiAgICAgICAgY29uc3Qga2V5T25QYXJlbnQgPSBwYXRoW3BhdGgubGVuZ3RoIC0gMV07XG4gICAgICAgIGNvbnN0IG9yaWdpbmFsVmFsdWUgPSBwYXJlbnRWYWx1ZVtrZXlPblBhcmVudF07XG4gICAgICAgIHBhcmVudFZhbHVlW2tleU9uUGFyZW50XSA9IGF3YWl0IG9yaWdpbmFsVmFsdWUoKTtcbiAgICAgIH0pKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdEZvcm1EYXRhRXJyb3IoZXJyKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgZGF0YSBmb3IgJHtkZWJ1Z1JlZmVyZW5jZX06XFxuJHtmb3JtYXR0ZWR9YCk7XG4gIH1cbiAgcmV0dXJuIHZhbGlkYXRlZDtcbn0pO1xuZnVuY3Rpb24gc2luZ2xldG9uUmVhZGVyKHNpbmdsZXRvbiwgY29uZmlnLCBmc1JlYWRlcikge1xuICBjb25zdCBmb3JtYXRJbmZvID0gZ2V0U2luZ2xldG9uRm9ybWF0KGNvbmZpZywgc2luZ2xldG9uKTtcbiAgY29uc3Qgc2luZ2xldG9uUGF0aCA9IGdldFNpbmdsZXRvblBhdGgoY29uZmlnLCBzaW5nbGV0b24pO1xuICBjb25zdCBzY2hlbWEgPSBvYmplY3QoY29uZmlnLnNpbmdsZXRvbnNbc2luZ2xldG9uXS5zY2hlbWEpO1xuICBjb25zdCByZWFkID0gKC4uLmFyZ3MpID0+IHtcbiAgICB2YXIgX2FyZ3MkMjtcbiAgICByZXR1cm4gcmVhZEl0ZW0oc2NoZW1hLCBmb3JtYXRJbmZvLCBzaW5nbGV0b25QYXRoLCAoX2FyZ3MkMiA9IGFyZ3NbMF0pID09PSBudWxsIHx8IF9hcmdzJDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcmdzJDIucmVzb2x2ZUxpbmtlZEZpbGVzLCBgc2luZ2xldG9uIFwiJHtzaW5nbGV0b259XCJgLCBmc1JlYWRlciwgdW5kZWZpbmVkKTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICByZWFkLFxuICAgIHJlYWRPclRocm93OiBhc3luYyAoLi4ub3B0cykgPT4ge1xuICAgICAgY29uc3QgZW50cnkgPSBhd2FpdCByZWFkKC4uLm9wdHMpO1xuICAgICAgaWYgKGVudHJ5ID09PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgU2luZ2xldG9uIFwiJHtzaW5nbGV0b259XCIgbm90IGZvdW5kYCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZW50cnk7XG4gICAgfVxuICB9O1xufVxuXG5leHBvcnQgeyBjYWNoZSBhcyBhLCBjb2xsZWN0aW9uUmVhZGVyIGFzIGMsIHNpbmdsZXRvblJlYWRlciBhcyBzIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@keystatic/core/dist/generic-4797a755.node.react-server.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@keystatic/core/dist/index-10ea50e2.node.react-server.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/index-10ea50e2.node.react-server.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   B: () => (/* binding */ BlocksFieldInput),\n/* harmony export */   C: () => (/* binding */ CheckboxFieldInput),\n/* harmony export */   D: () => (/* binding */ DateFieldInput),\n/* harmony export */   F: () => (/* binding */ FieldDataError),\n/* harmony export */   I: () => (/* binding */ ImageFieldInput),\n/* harmony export */   M: () => (/* binding */ MultiRelationshipInput),\n/* harmony export */   N: () => (/* binding */ NumberFieldInput),\n/* harmony export */   P: () => (/* binding */ PathReferenceInput),\n/* harmony export */   R: () => (/* binding */ RelationshipInput),\n/* harmony export */   S: () => (/* binding */ SelectFieldInput),\n/* harmony export */   U: () => (/* binding */ UrlFieldInput),\n/* harmony export */   a: () => (/* binding */ CloudImageFieldInput),\n/* harmony export */   b: () => (/* binding */ basicFormFieldWithSimpleReaderParse),\n/* harmony export */   c: () => (/* binding */ assertRequired),\n/* harmony export */   d: () => (/* binding */ DatetimeFieldInput),\n/* harmony export */   e: () => (/* binding */ FileFieldInput),\n/* harmony export */   f: () => (/* binding */ MultiselectFieldInput),\n/* harmony export */   g: () => (/* binding */ SlugFieldInput),\n/* harmony export */   h: () => (/* binding */ DocumentFieldInput),\n/* harmony export */   i: () => (/* binding */ serializeMarkdoc),\n/* harmony export */   j: () => (/* binding */ getDefaultValue),\n/* harmony export */   k: () => (/* binding */ serializeFromEditorState),\n/* harmony export */   l: () => (/* binding */ prosemirrorToYXmlFragment),\n/* harmony export */   m: () => (/* binding */ createEditorStateFromYJS),\n/* harmony export */   n: () => (/* binding */ normalizeDocumentFieldChildren),\n/* harmony export */   o: () => (/* binding */ parseToEditorStateMDX),\n/* harmony export */   p: () => (/* binding */ parseToEditorState),\n/* harmony export */   q: () => (/* binding */ serializeFromEditorStateMDX),\n/* harmony export */   r: () => (/* binding */ createEditorSchema),\n/* harmony export */   s: () => (/* binding */ slugify),\n/* harmony export */   t: () => (/* binding */ text),\n/* harmony export */   u: () => (/* binding */ IntegerFieldInput),\n/* harmony export */   v: () => (/* binding */ validateText)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-jsx-runtime.js\");\n\n\nclass FieldDataError extends Error {\n  constructor(message) {\n    super(message);\n    this.name = 'FieldDataError';\n  }\n}\n\nfunction assertRequired(value, validation, label) {\n  if (value === null && validation !== null && validation !== void 0 && validation.isRequired) {\n    throw new FieldDataError(`${label} is required`);\n  }\n}\nfunction basicFormFieldWithSimpleReaderParse(config) {\n  return {\n    kind: 'form',\n    Input: config.Input,\n    defaultValue: config.defaultValue,\n    parse: config.parse,\n    serialize: config.serialize,\n    validate: config.validate,\n    reader: {\n      parse(value) {\n        return config.validate(config.parse(value));\n      }\n    },\n    label: config.label\n  };\n}\n\n// this is used in react-server environments to avoid bundling UI when the reader API is used\n// if you added a new field and get an error that there's missing a missing export here,\n// you probably just need to add another empty export here\n\nfunction empty() {\n  throw new Error(\"unexpected call to function that shouldn't be called in React server component environment\");\n}\nlet SlugFieldInput = empty,\n  TextFieldInput = empty,\n  UrlFieldInput = empty,\n  SelectFieldInput = empty,\n  RelationshipInput = empty,\n  PathReferenceInput = empty,\n  MultiselectFieldInput = empty,\n  MultiRelationshipInput = empty,\n  IntegerFieldInput = empty,\n  NumberFieldInput = empty,\n  ImageFieldInput = empty,\n  FileFieldInput = empty,\n  DatetimeFieldInput = empty,\n  DateFieldInput = empty,\n  CloudImageFieldInput = empty,\n  BlocksFieldInput = empty,\n  DocumentFieldInput = empty,\n  CheckboxFieldInput = empty,\n  createEditorSchema = empty,\n  getDefaultValue = empty,\n  parseToEditorState = empty,\n  serializeFromEditorState = empty,\n  parseToEditorStateMDX = empty,\n  serializeFromEditorStateMDX = empty,\n  createEditorStateFromYJS = empty,\n  prosemirrorToYXmlFragment = empty,\n  normalizeDocumentFieldChildren = empty,\n  slugify = empty,\n  serializeMarkdoc = empty;\n\nfunction validateText(val, min, max, fieldLabel, slugInfo, pattern) {\n  if (val.length < min) {\n    if (min === 1) {\n      return `${fieldLabel} must not be empty`;\n    } else {\n      return `${fieldLabel} must be at least ${min} characters long`;\n    }\n  }\n  if (val.length > max) {\n    return `${fieldLabel} must be no longer than ${max} characters`;\n  }\n  if (pattern && !pattern.regex.test(val)) {\n    return pattern.message || `${fieldLabel} must match the pattern ${pattern.regex}`;\n  }\n  if (slugInfo) {\n    if (val === '') {\n      return `${fieldLabel} must not be empty`;\n    }\n    if (val === '..') {\n      return `${fieldLabel} must not be ..`;\n    }\n    if (val === '.') {\n      return `${fieldLabel} must not be .`;\n    }\n    if (slugInfo.glob === '**') {\n      const split = val.split('/');\n      if (split.some(s => s === '..')) {\n        return `${fieldLabel} must not contain ..`;\n      }\n      if (split.some(s => s === '.')) {\n        return `${fieldLabel} must not be .`;\n      }\n    }\n    if ((slugInfo.glob === '*' ? /[\\\\/]/ : /[\\\\]/).test(val)) {\n      return `${fieldLabel} must not contain slashes`;\n    }\n    if (/^\\s|\\s$/.test(val)) {\n      return `${fieldLabel} must not start or end with spaces`;\n    }\n    if (slugInfo.slugs.has(val)) {\n      return `${fieldLabel} must be unique`;\n    }\n  }\n}\n\nfunction parseAsNormalField(value) {\n  if (value === undefined) {\n    return '';\n  }\n  if (typeof value !== 'string') {\n    throw new FieldDataError('Must be a string');\n  }\n  return value;\n}\nconst emptySet = new Set();\nfunction text({\n  label,\n  defaultValue = '',\n  validation: {\n    length: {\n      max = Infinity,\n      min = 0\n    } = {},\n    pattern,\n    isRequired\n  } = {},\n  description,\n  multiline = false\n}) {\n  min = Math.max(isRequired ? 1 : 0, min);\n  function validate(value, slugField) {\n    const message = validateText(value, min, max, label, slugField, pattern);\n    if (message !== undefined) {\n      throw new FieldDataError(message);\n    }\n    return value;\n  }\n  return {\n    kind: 'form',\n    formKind: 'slug',\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(TextFieldInput, {\n        label: label,\n        description: description,\n        min: min,\n        max: max,\n        multiline: multiline,\n        pattern: pattern,\n        ...props\n      });\n    },\n    defaultValue() {\n      return typeof defaultValue === 'string' ? defaultValue : defaultValue();\n    },\n    parse(value, args) {\n      if ((args === null || args === void 0 ? void 0 : args.slug) !== undefined) {\n        return args.slug;\n      }\n      return parseAsNormalField(value);\n    },\n    serialize(value) {\n      return {\n        value: value === '' ? undefined : value\n      };\n    },\n    serializeWithSlug(value) {\n      return {\n        slug: value,\n        value: undefined\n      };\n    },\n    reader: {\n      parse(value) {\n        const parsed = parseAsNormalField(value);\n        return validate(parsed, undefined);\n      },\n      parseWithSlug(_value, args) {\n        validate(parseAsNormalField(args.slug), {\n          glob: args.glob,\n          slugs: emptySet\n        });\n        return null;\n      }\n    },\n    validate(value, args) {\n      return validate(value, args === null || args === void 0 ? void 0 : args.slugField);\n    }\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3QvaW5kZXgtMTBlYTUwZTIubm9kZS5yZWFjdC1zZXJ2ZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF3Qzs7QUFFeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnQ0FBZ0MsT0FBTztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsWUFBWTtBQUM1QixNQUFNO0FBQ04sZ0JBQWdCLFlBQVksbUJBQW1CLEtBQUs7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsY0FBYyxZQUFZLHlCQUF5QixLQUFLO0FBQ3hEO0FBQ0E7QUFDQSxpQ0FBaUMsWUFBWSx5QkFBeUIsY0FBYztBQUNwRjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsWUFBWTtBQUM1QjtBQUNBO0FBQ0EsZ0JBQWdCLFlBQVk7QUFDNUI7QUFDQTtBQUNBLGdCQUFnQixZQUFZO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVk7QUFDOUI7QUFDQTtBQUNBLGtCQUFrQixZQUFZO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixZQUFZO0FBQzVCO0FBQ0E7QUFDQSxnQkFBZ0IsWUFBWTtBQUM1QjtBQUNBO0FBQ0EsZ0JBQWdCLFlBQVk7QUFDNUI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLElBQUk7QUFDVjtBQUNBO0FBQ0EsSUFBSSxJQUFJO0FBQ1I7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixzREFBRztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVnMEIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYW1lcy9Eb3dubG9hZHMvbmV3LWtleXN0YXRpYy1wcm9qZWN0L25vZGVfbW9kdWxlcy9Aa2V5c3RhdGljL2NvcmUvZGlzdC9pbmRleC0xMGVhNTBlMi5ub2RlLnJlYWN0LXNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBqc3ggfSBmcm9tICdyZWFjdC9qc3gtcnVudGltZSc7XG5cbmNsYXNzIEZpZWxkRGF0YUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5uYW1lID0gJ0ZpZWxkRGF0YUVycm9yJztcbiAgfVxufVxuXG5mdW5jdGlvbiBhc3NlcnRSZXF1aXJlZCh2YWx1ZSwgdmFsaWRhdGlvbiwgbGFiZWwpIHtcbiAgaWYgKHZhbHVlID09PSBudWxsICYmIHZhbGlkYXRpb24gIT09IG51bGwgJiYgdmFsaWRhdGlvbiAhPT0gdm9pZCAwICYmIHZhbGlkYXRpb24uaXNSZXF1aXJlZCkge1xuICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcihgJHtsYWJlbH0gaXMgcmVxdWlyZWRgKTtcbiAgfVxufVxuZnVuY3Rpb24gYmFzaWNGb3JtRmllbGRXaXRoU2ltcGxlUmVhZGVyUGFyc2UoY29uZmlnKSB7XG4gIHJldHVybiB7XG4gICAga2luZDogJ2Zvcm0nLFxuICAgIElucHV0OiBjb25maWcuSW5wdXQsXG4gICAgZGVmYXVsdFZhbHVlOiBjb25maWcuZGVmYXVsdFZhbHVlLFxuICAgIHBhcnNlOiBjb25maWcucGFyc2UsXG4gICAgc2VyaWFsaXplOiBjb25maWcuc2VyaWFsaXplLFxuICAgIHZhbGlkYXRlOiBjb25maWcudmFsaWRhdGUsXG4gICAgcmVhZGVyOiB7XG4gICAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gY29uZmlnLnZhbGlkYXRlKGNvbmZpZy5wYXJzZSh2YWx1ZSkpO1xuICAgICAgfVxuICAgIH0sXG4gICAgbGFiZWw6IGNvbmZpZy5sYWJlbFxuICB9O1xufVxuXG4vLyB0aGlzIGlzIHVzZWQgaW4gcmVhY3Qtc2VydmVyIGVudmlyb25tZW50cyB0byBhdm9pZCBidW5kbGluZyBVSSB3aGVuIHRoZSByZWFkZXIgQVBJIGlzIHVzZWRcbi8vIGlmIHlvdSBhZGRlZCBhIG5ldyBmaWVsZCBhbmQgZ2V0IGFuIGVycm9yIHRoYXQgdGhlcmUncyBtaXNzaW5nIGEgbWlzc2luZyBleHBvcnQgaGVyZSxcbi8vIHlvdSBwcm9iYWJseSBqdXN0IG5lZWQgdG8gYWRkIGFub3RoZXIgZW1wdHkgZXhwb3J0IGhlcmVcblxuZnVuY3Rpb24gZW1wdHkoKSB7XG4gIHRocm93IG5ldyBFcnJvcihcInVuZXhwZWN0ZWQgY2FsbCB0byBmdW5jdGlvbiB0aGF0IHNob3VsZG4ndCBiZSBjYWxsZWQgaW4gUmVhY3Qgc2VydmVyIGNvbXBvbmVudCBlbnZpcm9ubWVudFwiKTtcbn1cbmxldCBTbHVnRmllbGRJbnB1dCA9IGVtcHR5LFxuICBUZXh0RmllbGRJbnB1dCA9IGVtcHR5LFxuICBVcmxGaWVsZElucHV0ID0gZW1wdHksXG4gIFNlbGVjdEZpZWxkSW5wdXQgPSBlbXB0eSxcbiAgUmVsYXRpb25zaGlwSW5wdXQgPSBlbXB0eSxcbiAgUGF0aFJlZmVyZW5jZUlucHV0ID0gZW1wdHksXG4gIE11bHRpc2VsZWN0RmllbGRJbnB1dCA9IGVtcHR5LFxuICBNdWx0aVJlbGF0aW9uc2hpcElucHV0ID0gZW1wdHksXG4gIEludGVnZXJGaWVsZElucHV0ID0gZW1wdHksXG4gIE51bWJlckZpZWxkSW5wdXQgPSBlbXB0eSxcbiAgSW1hZ2VGaWVsZElucHV0ID0gZW1wdHksXG4gIEZpbGVGaWVsZElucHV0ID0gZW1wdHksXG4gIERhdGV0aW1lRmllbGRJbnB1dCA9IGVtcHR5LFxuICBEYXRlRmllbGRJbnB1dCA9IGVtcHR5LFxuICBDbG91ZEltYWdlRmllbGRJbnB1dCA9IGVtcHR5LFxuICBCbG9ja3NGaWVsZElucHV0ID0gZW1wdHksXG4gIERvY3VtZW50RmllbGRJbnB1dCA9IGVtcHR5LFxuICBDaGVja2JveEZpZWxkSW5wdXQgPSBlbXB0eSxcbiAgY3JlYXRlRWRpdG9yU2NoZW1hID0gZW1wdHksXG4gIGdldERlZmF1bHRWYWx1ZSA9IGVtcHR5LFxuICBwYXJzZVRvRWRpdG9yU3RhdGUgPSBlbXB0eSxcbiAgc2VyaWFsaXplRnJvbUVkaXRvclN0YXRlID0gZW1wdHksXG4gIHBhcnNlVG9FZGl0b3JTdGF0ZU1EWCA9IGVtcHR5LFxuICBzZXJpYWxpemVGcm9tRWRpdG9yU3RhdGVNRFggPSBlbXB0eSxcbiAgY3JlYXRlRWRpdG9yU3RhdGVGcm9tWUpTID0gZW1wdHksXG4gIHByb3NlbWlycm9yVG9ZWG1sRnJhZ21lbnQgPSBlbXB0eSxcbiAgbm9ybWFsaXplRG9jdW1lbnRGaWVsZENoaWxkcmVuID0gZW1wdHksXG4gIHNsdWdpZnkgPSBlbXB0eSxcbiAgc2VyaWFsaXplTWFya2RvYyA9IGVtcHR5O1xuXG5mdW5jdGlvbiB2YWxpZGF0ZVRleHQodmFsLCBtaW4sIG1heCwgZmllbGRMYWJlbCwgc2x1Z0luZm8sIHBhdHRlcm4pIHtcbiAgaWYgKHZhbC5sZW5ndGggPCBtaW4pIHtcbiAgICBpZiAobWluID09PSAxKSB7XG4gICAgICByZXR1cm4gYCR7ZmllbGRMYWJlbH0gbXVzdCBub3QgYmUgZW1wdHlgO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYCR7ZmllbGRMYWJlbH0gbXVzdCBiZSBhdCBsZWFzdCAke21pbn0gY2hhcmFjdGVycyBsb25nYDtcbiAgICB9XG4gIH1cbiAgaWYgKHZhbC5sZW5ndGggPiBtYXgpIHtcbiAgICByZXR1cm4gYCR7ZmllbGRMYWJlbH0gbXVzdCBiZSBubyBsb25nZXIgdGhhbiAke21heH0gY2hhcmFjdGVyc2A7XG4gIH1cbiAgaWYgKHBhdHRlcm4gJiYgIXBhdHRlcm4ucmVnZXgudGVzdCh2YWwpKSB7XG4gICAgcmV0dXJuIHBhdHRlcm4ubWVzc2FnZSB8fCBgJHtmaWVsZExhYmVsfSBtdXN0IG1hdGNoIHRoZSBwYXR0ZXJuICR7cGF0dGVybi5yZWdleH1gO1xuICB9XG4gIGlmIChzbHVnSW5mbykge1xuICAgIGlmICh2YWwgPT09ICcnKSB7XG4gICAgICByZXR1cm4gYCR7ZmllbGRMYWJlbH0gbXVzdCBub3QgYmUgZW1wdHlgO1xuICAgIH1cbiAgICBpZiAodmFsID09PSAnLi4nKSB7XG4gICAgICByZXR1cm4gYCR7ZmllbGRMYWJlbH0gbXVzdCBub3QgYmUgLi5gO1xuICAgIH1cbiAgICBpZiAodmFsID09PSAnLicpIHtcbiAgICAgIHJldHVybiBgJHtmaWVsZExhYmVsfSBtdXN0IG5vdCBiZSAuYDtcbiAgICB9XG4gICAgaWYgKHNsdWdJbmZvLmdsb2IgPT09ICcqKicpIHtcbiAgICAgIGNvbnN0IHNwbGl0ID0gdmFsLnNwbGl0KCcvJyk7XG4gICAgICBpZiAoc3BsaXQuc29tZShzID0+IHMgPT09ICcuLicpKSB7XG4gICAgICAgIHJldHVybiBgJHtmaWVsZExhYmVsfSBtdXN0IG5vdCBjb250YWluIC4uYDtcbiAgICAgIH1cbiAgICAgIGlmIChzcGxpdC5zb21lKHMgPT4gcyA9PT0gJy4nKSkge1xuICAgICAgICByZXR1cm4gYCR7ZmllbGRMYWJlbH0gbXVzdCBub3QgYmUgLmA7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICgoc2x1Z0luZm8uZ2xvYiA9PT0gJyonID8gL1tcXFxcL10vIDogL1tcXFxcXS8pLnRlc3QodmFsKSkge1xuICAgICAgcmV0dXJuIGAke2ZpZWxkTGFiZWx9IG11c3Qgbm90IGNvbnRhaW4gc2xhc2hlc2A7XG4gICAgfVxuICAgIGlmICgvXlxcc3xcXHMkLy50ZXN0KHZhbCkpIHtcbiAgICAgIHJldHVybiBgJHtmaWVsZExhYmVsfSBtdXN0IG5vdCBzdGFydCBvciBlbmQgd2l0aCBzcGFjZXNgO1xuICAgIH1cbiAgICBpZiAoc2x1Z0luZm8uc2x1Z3MuaGFzKHZhbCkpIHtcbiAgICAgIHJldHVybiBgJHtmaWVsZExhYmVsfSBtdXN0IGJlIHVuaXF1ZWA7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHBhcnNlQXNOb3JtYWxGaWVsZCh2YWx1ZSkge1xuICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiAnJztcbiAgfVxuICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHN0cmluZycpO1xuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cbmNvbnN0IGVtcHR5U2V0ID0gbmV3IFNldCgpO1xuZnVuY3Rpb24gdGV4dCh7XG4gIGxhYmVsLFxuICBkZWZhdWx0VmFsdWUgPSAnJyxcbiAgdmFsaWRhdGlvbjoge1xuICAgIGxlbmd0aDoge1xuICAgICAgbWF4ID0gSW5maW5pdHksXG4gICAgICBtaW4gPSAwXG4gICAgfSA9IHt9LFxuICAgIHBhdHRlcm4sXG4gICAgaXNSZXF1aXJlZFxuICB9ID0ge30sXG4gIGRlc2NyaXB0aW9uLFxuICBtdWx0aWxpbmUgPSBmYWxzZVxufSkge1xuICBtaW4gPSBNYXRoLm1heChpc1JlcXVpcmVkID8gMSA6IDAsIG1pbik7XG4gIGZ1bmN0aW9uIHZhbGlkYXRlKHZhbHVlLCBzbHVnRmllbGQpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gdmFsaWRhdGVUZXh0KHZhbHVlLCBtaW4sIG1heCwgbGFiZWwsIHNsdWdGaWVsZCwgcGF0dGVybik7XG4gICAgaWYgKG1lc3NhZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKG1lc3NhZ2UpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgZm9ybUtpbmQ6ICdzbHVnJyxcbiAgICBsYWJlbCxcbiAgICBJbnB1dChwcm9wcykge1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9qc3goVGV4dEZpZWxkSW5wdXQsIHtcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIG1pbjogbWluLFxuICAgICAgICBtYXg6IG1heCxcbiAgICAgICAgbXVsdGlsaW5lOiBtdWx0aWxpbmUsXG4gICAgICAgIHBhdHRlcm46IHBhdHRlcm4sXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgZGVmYXVsdFZhbHVlID09PSAnc3RyaW5nJyA/IGRlZmF1bHRWYWx1ZSA6IGRlZmF1bHRWYWx1ZSgpO1xuICAgIH0sXG4gICAgcGFyc2UodmFsdWUsIGFyZ3MpIHtcbiAgICAgIGlmICgoYXJncyA9PT0gbnVsbCB8fCBhcmdzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhcmdzLnNsdWcpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGFyZ3Muc2x1ZztcbiAgICAgIH1cbiAgICAgIHJldHVybiBwYXJzZUFzTm9ybWFsRmllbGQodmFsdWUpO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKHZhbHVlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogdmFsdWUgPT09ICcnID8gdW5kZWZpbmVkIDogdmFsdWVcbiAgICAgIH07XG4gICAgfSxcbiAgICBzZXJpYWxpemVXaXRoU2x1Zyh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc2x1ZzogdmFsdWUsXG4gICAgICAgIHZhbHVlOiB1bmRlZmluZWRcbiAgICAgIH07XG4gICAgfSxcbiAgICByZWFkZXI6IHtcbiAgICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHBhcnNlZCA9IHBhcnNlQXNOb3JtYWxGaWVsZCh2YWx1ZSk7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZShwYXJzZWQsIHVuZGVmaW5lZCk7XG4gICAgICB9LFxuICAgICAgcGFyc2VXaXRoU2x1ZyhfdmFsdWUsIGFyZ3MpIHtcbiAgICAgICAgdmFsaWRhdGUocGFyc2VBc05vcm1hbEZpZWxkKGFyZ3Muc2x1ZyksIHtcbiAgICAgICAgICBnbG9iOiBhcmdzLmdsb2IsXG4gICAgICAgICAgc2x1Z3M6IGVtcHR5U2V0XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlLCBhcmdzKSB7XG4gICAgICByZXR1cm4gdmFsaWRhdGUodmFsdWUsIGFyZ3MgPT09IG51bGwgfHwgYXJncyA9PT0gdm9pZCAwID8gdm9pZCAwIDogYXJncy5zbHVnRmllbGQpO1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IHsgQmxvY2tzRmllbGRJbnB1dCBhcyBCLCBDaGVja2JveEZpZWxkSW5wdXQgYXMgQywgRGF0ZUZpZWxkSW5wdXQgYXMgRCwgRmllbGREYXRhRXJyb3IgYXMgRiwgSW1hZ2VGaWVsZElucHV0IGFzIEksIE11bHRpUmVsYXRpb25zaGlwSW5wdXQgYXMgTSwgTnVtYmVyRmllbGRJbnB1dCBhcyBOLCBQYXRoUmVmZXJlbmNlSW5wdXQgYXMgUCwgUmVsYXRpb25zaGlwSW5wdXQgYXMgUiwgU2VsZWN0RmllbGRJbnB1dCBhcyBTLCBVcmxGaWVsZElucHV0IGFzIFUsIENsb3VkSW1hZ2VGaWVsZElucHV0IGFzIGEsIGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlIGFzIGIsIGFzc2VydFJlcXVpcmVkIGFzIGMsIERhdGV0aW1lRmllbGRJbnB1dCBhcyBkLCBGaWxlRmllbGRJbnB1dCBhcyBlLCBNdWx0aXNlbGVjdEZpZWxkSW5wdXQgYXMgZiwgU2x1Z0ZpZWxkSW5wdXQgYXMgZywgRG9jdW1lbnRGaWVsZElucHV0IGFzIGgsIHNlcmlhbGl6ZU1hcmtkb2MgYXMgaSwgZ2V0RGVmYXVsdFZhbHVlIGFzIGosIHNlcmlhbGl6ZUZyb21FZGl0b3JTdGF0ZSBhcyBrLCBwcm9zZW1pcnJvclRvWVhtbEZyYWdtZW50IGFzIGwsIGNyZWF0ZUVkaXRvclN0YXRlRnJvbVlKUyBhcyBtLCBub3JtYWxpemVEb2N1bWVudEZpZWxkQ2hpbGRyZW4gYXMgbiwgcGFyc2VUb0VkaXRvclN0YXRlTURYIGFzIG8sIHBhcnNlVG9FZGl0b3JTdGF0ZSBhcyBwLCBzZXJpYWxpemVGcm9tRWRpdG9yU3RhdGVNRFggYXMgcSwgY3JlYXRlRWRpdG9yU2NoZW1hIGFzIHIsIHNsdWdpZnkgYXMgcywgdGV4dCBhcyB0LCBJbnRlZ2VyRmllbGRJbnB1dCBhcyB1LCB2YWxpZGF0ZVRleHQgYXMgdiB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@keystatic/core/dist/index-10ea50e2.node.react-server.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@keystatic/core/dist/index-9722793d.node.react-server.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/index-9722793d.node.react-server.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   i: () => (/* binding */ integer)\n/* harmony export */ });\n/* harmony import */ var _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-10ea50e2.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/index-10ea50e2.node.react-server.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react/jsx-runtime */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-jsx-runtime.js\");\n\n\n\nfunction validateInteger(validation, value, label) {\n  if (value !== null && (typeof value !== 'number' || !Number.isInteger(value))) {\n    return `${label} must be a whole number`;\n  }\n  if (validation !== null && validation !== void 0 && validation.isRequired && value === null) {\n    return `${label} is required`;\n  }\n  if (value !== null) {\n    if ((validation === null || validation === void 0 ? void 0 : validation.min) !== undefined && value < validation.min) {\n      return `${label} must be at least ${validation.min}`;\n    }\n    if ((validation === null || validation === void 0 ? void 0 : validation.max) !== undefined && value > validation.max) {\n      return `${label} must be at most ${validation.max}`;\n    }\n  }\n}\n\nfunction integer({\n  label,\n  defaultValue,\n  validation,\n  description\n}) {\n  return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_0__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_0__.u, {\n        label: label,\n        description: description,\n        validation: validation,\n        ...props\n      });\n    },\n    defaultValue() {\n      return defaultValue !== null && defaultValue !== void 0 ? defaultValue : null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value === 'number') {\n        return value;\n      }\n      throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_0__.F('Must be a number');\n    },\n    validate(value) {\n      const message = validateInteger(validation, value, label);\n      if (message !== undefined) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_0__.F(message);\n      }\n      (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_0__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value) {\n      return {\n        value: value === null ? undefined : value\n      };\n    }\n  });\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3QvaW5kZXgtOTcyMjc5M2Qubm9kZS5yZWFjdC1zZXJ2ZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW1LO0FBQzNIOztBQUV4QztBQUNBO0FBQ0EsY0FBYyxPQUFPO0FBQ3JCO0FBQ0E7QUFDQSxjQUFjLE9BQU87QUFDckI7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLE9BQU8sbUJBQW1CLGVBQWU7QUFDekQ7QUFDQTtBQUNBLGdCQUFnQixPQUFPLGtCQUFrQixlQUFlO0FBQ3hEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELFNBQVMsdUVBQW1DO0FBQzVDO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQUcsQ0FBQyxtRUFBaUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsbUVBQWM7QUFDOUIsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixtRUFBYztBQUNoQztBQUNBLE1BQU0sdUVBQWM7QUFDcEI7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFd0IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYW1lcy9Eb3dubG9hZHMvbmV3LWtleXN0YXRpYy1wcm9qZWN0L25vZGVfbW9kdWxlcy9Aa2V5c3RhdGljL2NvcmUvZGlzdC9pbmRleC05NzIyNzkzZC5ub2RlLnJlYWN0LXNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBiIGFzIGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlLCB1IGFzIEludGVnZXJGaWVsZElucHV0LCBGIGFzIEZpZWxkRGF0YUVycm9yLCBjIGFzIGFzc2VydFJlcXVpcmVkIH0gZnJvbSAnLi9pbmRleC0xMGVhNTBlMi5ub2RlLnJlYWN0LXNlcnZlci5qcyc7XG5pbXBvcnQgeyBqc3ggfSBmcm9tICdyZWFjdC9qc3gtcnVudGltZSc7XG5cbmZ1bmN0aW9uIHZhbGlkYXRlSW50ZWdlcih2YWxpZGF0aW9uLCB2YWx1ZSwgbGFiZWwpIHtcbiAgaWYgKHZhbHVlICE9PSBudWxsICYmICh0eXBlb2YgdmFsdWUgIT09ICdudW1iZXInIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKHZhbHVlKSkpIHtcbiAgICByZXR1cm4gYCR7bGFiZWx9IG11c3QgYmUgYSB3aG9sZSBudW1iZXJgO1xuICB9XG4gIGlmICh2YWxpZGF0aW9uICE9PSBudWxsICYmIHZhbGlkYXRpb24gIT09IHZvaWQgMCAmJiB2YWxpZGF0aW9uLmlzUmVxdWlyZWQgJiYgdmFsdWUgPT09IG51bGwpIHtcbiAgICByZXR1cm4gYCR7bGFiZWx9IGlzIHJlcXVpcmVkYDtcbiAgfVxuICBpZiAodmFsdWUgIT09IG51bGwpIHtcbiAgICBpZiAoKHZhbGlkYXRpb24gPT09IG51bGwgfHwgdmFsaWRhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogdmFsaWRhdGlvbi5taW4pICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgPCB2YWxpZGF0aW9uLm1pbikge1xuICAgICAgcmV0dXJuIGAke2xhYmVsfSBtdXN0IGJlIGF0IGxlYXN0ICR7dmFsaWRhdGlvbi5taW59YDtcbiAgICB9XG4gICAgaWYgKCh2YWxpZGF0aW9uID09PSBudWxsIHx8IHZhbGlkYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbGlkYXRpb24ubWF4KSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlID4gdmFsaWRhdGlvbi5tYXgpIHtcbiAgICAgIHJldHVybiBgJHtsYWJlbH0gbXVzdCBiZSBhdCBtb3N0ICR7dmFsaWRhdGlvbi5tYXh9YDtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaW50ZWdlcih7XG4gIGxhYmVsLFxuICBkZWZhdWx0VmFsdWUsXG4gIHZhbGlkYXRpb24sXG4gIGRlc2NyaXB0aW9uXG59KSB7XG4gIHJldHVybiBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KEludGVnZXJGaWVsZElucHV0LCB7XG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICB2YWxpZGF0aW9uOiB2YWxpZGF0aW9uLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gZGVmYXVsdFZhbHVlICE9PSBudWxsICYmIGRlZmF1bHRWYWx1ZSAhPT0gdm9pZCAwID8gZGVmYXVsdFZhbHVlIDogbnVsbDtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIG51bWJlcicpO1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSB2YWxpZGF0ZUludGVnZXIodmFsaWRhdGlvbiwgdmFsdWUsIGxhYmVsKTtcbiAgICAgIGlmIChtZXNzYWdlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKG1lc3NhZ2UpO1xuICAgICAgfVxuICAgICAgYXNzZXJ0UmVxdWlyZWQodmFsdWUsIHZhbGlkYXRpb24sIGxhYmVsKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHZhbHVlID09PSBudWxsID8gdW5kZWZpbmVkIDogdmFsdWVcbiAgICAgIH07XG4gICAgfVxuICB9KTtcbn1cblxuZXhwb3J0IHsgaW50ZWdlciBhcyBpIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@keystatic/core/dist/index-9722793d.node.react-server.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@keystatic/core/dist/index-ca270311.node.react-server.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/index-ca270311.node.react-server.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ markdoc),\n/* harmony export */   b: () => (/* binding */ getDirectoriesForTreeKey),\n/* harmony export */   c: () => (/* binding */ getCollectionPath),\n/* harmony export */   d: () => (/* binding */ document),\n/* harmony export */   e: () => (/* binding */ getSingletonFormat),\n/* harmony export */   f: () => (/* binding */ fixPath),\n/* harmony export */   g: () => (/* binding */ getSrcPrefix),\n/* harmony export */   h: () => (/* binding */ getSingletonPath),\n/* harmony export */   i: () => (/* binding */ blobSha),\n/* harmony export */   j: () => (/* binding */ getEntryDataFilepath),\n/* harmony export */   k: () => (/* binding */ getValueAtPropPath),\n/* harmony export */   l: () => (/* binding */ getCollectionFormat),\n/* harmony export */   m: () => (/* binding */ mdx),\n/* harmony export */   n: () => (/* binding */ getSlugGlobForCollection),\n/* harmony export */   o: () => (/* binding */ object),\n/* harmony export */   p: () => (/* binding */ getDataFileExtension),\n/* harmony export */   q: () => (/* binding */ getCollectionItemPath),\n/* harmony export */   r: () => (/* binding */ getTreeNodeAtPath),\n/* harmony export */   t: () => (/* binding */ treeEntriesToTreeNodes),\n/* harmony export */   u: () => (/* binding */ updateTreeWithChanges)\n/* harmony export */ });\n/* harmony import */ var _markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @markdoc/markdoc/dist/index.mjs */ \"(rsc)/./node_modules/@markdoc/markdoc/dist/index.mjs\");\n/* harmony import */ var emery_assertions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! emery/assertions */ \"(rsc)/./node_modules/emery/assertions/dist/emery-assertions.esm.js\");\n/* harmony import */ var emery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! emery */ \"(rsc)/./node_modules/emery/dist/emery.esm.js\");\n/* harmony import */ var _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./index-10ea50e2.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/index-10ea50e2.node.react-server.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react/jsx-runtime */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-jsx-runtime.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! crypto */ \"crypto\");\n\n\n\n\n\n\n\nfunction object(fields, opts) {\n  return {\n    ...opts,\n    kind: 'object',\n    fields\n  };\n}\n\nfunction getValueAtPropPath(value, inputPath) {\n  const path = [...inputPath];\n  while (path.length) {\n    const key = path.shift();\n    value = value[key];\n  }\n  return value;\n}\nfunction transformProps(schema, value, visitors, path = []) {\n  if (schema.kind === 'form' || schema.kind === 'child') {\n    if (visitors[schema.kind]) {\n      return visitors[schema.kind](schema, value, path);\n    }\n    return value;\n  }\n  if (schema.kind === 'object') {\n    const val = Object.fromEntries(Object.entries(schema.fields).map(([key, val]) => {\n      return [key, transformProps(val, value[key], visitors, [...path, key])];\n    }));\n    if (visitors.object) {\n      return visitors[schema.kind](schema, val, path);\n    }\n    return val;\n  }\n  if (schema.kind === 'array') {\n    const val = value.map((val, idx) => transformProps(schema.element, val, visitors, path.concat(idx)));\n    if (visitors.array) {\n      return visitors[schema.kind](schema, val, path);\n    }\n    return val;\n  }\n  if (schema.kind === 'conditional') {\n    const discriminant = transformProps(schema.discriminant, value.discriminant, visitors, path.concat('discriminant'));\n    const conditionalVal = transformProps(schema.values[discriminant.toString()], value.value, visitors, path.concat('value'));\n    const val = {\n      discriminant,\n      value: conditionalVal\n    };\n    if (visitors.conditional) {\n      return visitors[schema.kind](schema, val, path);\n    }\n    return val;\n  }\n  (0,emery_assertions__WEBPACK_IMPORTED_MODULE_0__.assertNever)(schema);\n}\n\n// a v important note\n// marks in the markdown ast/html are represented quite differently to how they are in slate\n// if you had the markdown **something https://keystonejs.com something**\n// the bold node is the parent of the link node\n// but in slate, marks are only represented on text nodes\n\nconst currentlyActiveMarks = new Set();\nconst currentlyDisabledMarks = new Set();\nlet currentLink = null;\nfunction addMarkToChildren(mark, cb) {\n  const wasPreviouslyActive = currentlyActiveMarks.has(mark);\n  currentlyActiveMarks.add(mark);\n  try {\n    return cb();\n  } finally {\n    if (!wasPreviouslyActive) {\n      currentlyActiveMarks.delete(mark);\n    }\n  }\n}\nfunction setLinkForChildren(href, cb) {\n  // we'll only use the outer link\n  if (currentLink !== null) {\n    return cb();\n  }\n  currentLink = href;\n  try {\n    return cb();\n  } finally {\n    currentLink = null;\n  }\n}\n\n/**\n * This type is more strict than `Element & { type: 'link'; }` because `children`\n * is constrained to only contain Text nodes. This can't be assumed generally around the editor\n * (because of potentially future inline components or nested links(which are normalized away but the editor needs to not break if it happens))\n * but where this type is used, we're only going to allow links to contain Text and that's important\n * so that we know a block will never be inside an inline because Slate gets unhappy when that happens\n * (really the link inline should probably be a mark rather than an inline,\n * non-void inlines are probably always bad but that would imply changing the document\n * structure which would be such unnecessary breakage)\n */\n\nfunction getInlineNodes(text) {\n  const node = {\n    text\n  };\n  for (const mark of currentlyActiveMarks) {\n    if (!currentlyDisabledMarks.has(mark)) {\n      node[mark] = true;\n    }\n  }\n  if (currentLink !== null) {\n    return [{\n      text: ''\n    }, {\n      type: 'link',\n      href: currentLink,\n      children: [node]\n    }, {\n      text: ''\n    }];\n  }\n  return [node];\n}\n\nclass VariableChildFields extends Error {\n  constructor() {\n    super('There are a variable number of child fields');\n  }\n}\nfunction findSingleChildField(schema) {\n  try {\n    const result = _findConstantChildFields(schema, [], new Set());\n    if (result.length === 1) {\n      return result[0];\n    }\n    return;\n  } catch (err) {\n    if (err instanceof VariableChildFields) {\n      return;\n    }\n    throw err;\n  }\n}\nfunction _findConstantChildFields(schema, path, seenSchemas) {\n  if (seenSchemas.has(schema)) {\n    return [];\n  }\n  seenSchemas.add(schema);\n  switch (schema.kind) {\n    case 'form':\n      return [];\n    case 'child':\n      return [{\n        relativePath: path,\n        options: schema.options,\n        kind: 'child'\n      }];\n    case 'conditional':\n      {\n        if (couldContainChildField(schema)) {\n          throw new VariableChildFields();\n        }\n        return [];\n      }\n    case 'array':\n      {\n        if (schema.asChildTag) {\n          const child = _findConstantChildFields(schema.element, [], seenSchemas);\n          if (child.length > 1) {\n            return [];\n          }\n          return [{\n            kind: 'array',\n            asChildTag: schema.asChildTag,\n            field: schema,\n            relativePath: path,\n            child: child[0]\n          }];\n        }\n        if (couldContainChildField(schema)) {\n          throw new VariableChildFields();\n        }\n        return [];\n      }\n    case 'object':\n      {\n        const paths = [];\n        for (const [key, value] of Object.entries(schema.fields)) {\n          paths.push(..._findConstantChildFields(value, path.concat(key), seenSchemas));\n        }\n        return paths;\n      }\n  }\n}\nfunction couldContainChildField(schema, seen = new Set()) {\n  if (seen.has(schema)) {\n    return false;\n  }\n  seen.add(schema);\n  switch (schema.kind) {\n    case 'form':\n      return false;\n    case 'child':\n      return true;\n    case 'conditional':\n      return Object.values(schema.values).some(value => couldContainChildField(value, seen));\n    case 'object':\n      return Object.keys(schema.fields).some(key => couldContainChildField(schema.fields[key], seen));\n    case 'array':\n      return couldContainChildField(schema.element, seen);\n  }\n}\n\nfunction inlineNodeFromMarkdoc(node) {\n  if (node.type === 'inline') {\n    return inlineChildrenFromMarkdoc(node.children);\n  }\n  if (node.type === 'link') {\n    return setLinkForChildren(node.attributes.href, () => inlineChildrenFromMarkdoc(node.children));\n  }\n  if (node.type === 'text') {\n    return getInlineNodes(node.attributes.content);\n  }\n  if (node.type === 'strong') {\n    return addMarkToChildren('bold', () => inlineChildrenFromMarkdoc(node.children));\n  }\n  if (node.type === 'code') {\n    return addMarkToChildren('code', () => getInlineNodes(node.attributes.content));\n  }\n  if (node.type === 'em') {\n    return addMarkToChildren('italic', () => inlineChildrenFromMarkdoc(node.children));\n  }\n  if (node.type === 's') {\n    return addMarkToChildren('strikethrough', () => inlineChildrenFromMarkdoc(node.children));\n  }\n  if (node.type === 'tag') {\n    if (node.tag === 'u') {\n      return addMarkToChildren('underline', () => inlineChildrenFromMarkdoc(node.children));\n    }\n    if (node.tag === 'kbd') {\n      return addMarkToChildren('keyboard', () => inlineChildrenFromMarkdoc(node.children));\n    }\n    if (node.tag === 'sub') {\n      return addMarkToChildren('subscript', () => inlineChildrenFromMarkdoc(node.children));\n    }\n    if (node.tag === 'sup') {\n      return addMarkToChildren('superscript', () => inlineChildrenFromMarkdoc(node.children));\n    }\n  }\n  if (node.type === 'softbreak') {\n    return getInlineNodes(' ');\n  }\n  if (node.type === 'hardbreak') {\n    return getInlineNodes('\\n');\n  }\n  if (node.tag === 'component-inline-prop' && Array.isArray(node.attributes.propPath) && node.attributes.propPath.every(x => typeof x === 'string' || typeof x === 'number')) {\n    return {\n      type: 'component-inline-prop',\n      children: inlineFromMarkdoc(node.children),\n      propPath: node.attributes.propPath\n    };\n  }\n  throw new Error(`Unknown inline node type: ${node.type}`);\n}\nfunction inlineChildrenFromMarkdoc(nodes) {\n  return nodes.flatMap(inlineNodeFromMarkdoc);\n}\nfunction inlineFromMarkdoc(nodes) {\n  const transformedNodes = nodes.flatMap(inlineNodeFromMarkdoc);\n  const nextNodes = [];\n  let lastNode;\n  for (const [idx, node] of transformedNodes.entries()) {\n    var _lastNode;\n    if (node.type === undefined && node.text === '' && ((_lastNode = lastNode) === null || _lastNode === void 0 ? void 0 : _lastNode.type) === undefined && idx !== transformedNodes.length - 1) {\n      continue;\n    }\n    nextNodes.push(node);\n    lastNode = node;\n  }\n  if (!nextNodes.length) {\n    nextNodes.push({\n      text: ''\n    });\n  }\n  return nextNodes;\n}\nfunction fromMarkdoc(node, componentBlocks) {\n  const nodes = node.children.flatMap(x => fromMarkdocNode(x, componentBlocks));\n  if (nodes.length === 0) {\n    return [{\n      type: 'paragraph',\n      children: [{\n        text: ''\n      }]\n    }];\n  }\n  if (nodes[nodes.length - 1].type !== 'paragraph') {\n    nodes.push({\n      type: 'paragraph',\n      children: [{\n        text: ''\n      }]\n    });\n  }\n  return nodes;\n}\nfunction fromMarkdocNode(node, componentBlocks) {\n  if (node.type === 'blockquote') {\n    return {\n      type: 'blockquote',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'fence') {\n    const {\n      language,\n      content,\n      ...rest\n    } = node.attributes;\n    return {\n      type: 'code',\n      children: [{\n        text: content.replace(/\\n$/, '')\n      }],\n      ...(typeof language === 'string' ? {\n        language\n      } : {}),\n      ...rest\n    };\n  }\n  if (node.type === 'heading') {\n    return {\n      ...node.attributes,\n      level: node.attributes.level,\n      type: 'heading',\n      children: inlineFromMarkdoc(node.children)\n    };\n  }\n  if (node.type === 'list') {\n    return {\n      type: node.attributes.ordered ? 'ordered-list' : 'unordered-list',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'item') {\n    var _node$children$;\n    const children = [{\n      type: 'list-item-content',\n      children: node.children.length ? inlineFromMarkdoc([node.children[0]]) : [{\n        text: ''\n      }]\n    }];\n    if (((_node$children$ = node.children[1]) === null || _node$children$ === void 0 ? void 0 : _node$children$.type) === 'list') {\n      const list = node.children[1];\n      children.push({\n        type: list.attributes.ordered ? 'ordered-list' : 'unordered-list',\n        children: list.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n      });\n    }\n    return {\n      type: 'list-item',\n      children\n    };\n  }\n  if (node.type === 'paragraph') {\n    if (node.children.length === 1 && node.children[0].type === 'inline' && node.children[0].children.length === 1 && node.children[0].children[0].type === 'image') {\n      var _image$attributes$tit;\n      const image = node.children[0].children[0];\n      return {\n        type: 'image',\n        src: decodeURI(image.attributes.src),\n        alt: image.attributes.alt,\n        title: (_image$attributes$tit = image.attributes.title) !== null && _image$attributes$tit !== void 0 ? _image$attributes$tit : '',\n        children: [{\n          text: ''\n        }]\n      };\n    }\n    const children = inlineFromMarkdoc(node.children);\n    if (children.length === 1 && children[0].type === 'component-inline-prop') {\n      return children[0];\n    }\n    return {\n      type: 'paragraph',\n      children,\n      textAlign: node.attributes.textAlign\n    };\n  }\n  if (node.type === 'hr') {\n    return {\n      type: 'divider',\n      children: [{\n        text: ''\n      }]\n    };\n  }\n  if (node.type === 'table') {\n    return {\n      type: 'table',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'tbody') {\n    return {\n      type: 'table-body',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'thead') {\n    if (!node.children.length) return [];\n    return {\n      type: 'table-head',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'tr') {\n    return {\n      type: 'table-row',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'td') {\n    return {\n      type: 'table-cell',\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'th') {\n    return {\n      type: 'table-cell',\n      header: true,\n      children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n    };\n  }\n  if (node.type === 'tag') {\n    if (node.tag === 'table') {\n      return fromMarkdocNode(node.children[0], componentBlocks);\n    }\n    if (node.tag === 'layout') {\n      return {\n        type: 'layout',\n        layout: node.attributes.layout,\n        children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n      };\n    }\n    if (node.tag === 'layout-area') {\n      return {\n        type: 'layout-area',\n        children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n      };\n    }\n    if (node.tag === 'component-block') {\n      return {\n        type: 'component-block',\n        component: node.attributes.component,\n        props: node.attributes.props,\n        children: node.children.length === 0 ? [{\n          type: 'component-inline-prop',\n          children: [{\n            text: ''\n          }]\n        }] : node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n      };\n    }\n    if (node.tag === 'component-block-prop' && Array.isArray(node.attributes.propPath) && node.attributes.propPath.every(x => typeof x === 'string' || typeof x === 'number')) {\n      return {\n        type: 'component-block-prop',\n        children: node.children.flatMap(x => fromMarkdocNode(x, componentBlocks)),\n        propPath: node.attributes.propPath\n      };\n    }\n    if (node.tag) {\n      const componentBlock = componentBlocks[node.tag];\n      if (componentBlock) {\n        const singleChildField = findSingleChildField({\n          kind: 'object',\n          fields: componentBlock.schema\n        });\n        if (singleChildField) {\n          const newAttributes = JSON.parse(JSON.stringify(node.attributes));\n          const children = [];\n          toChildrenAndProps(node.children, children, newAttributes, singleChildField, [], componentBlocks);\n          return {\n            type: 'component-block',\n            component: node.tag,\n            props: newAttributes,\n            children\n          };\n        }\n        return {\n          type: 'component-block',\n          component: node.tag,\n          props: node.attributes,\n          children: node.children.length === 0 ? [{\n            type: 'component-inline-prop',\n            children: [{\n              text: ''\n            }]\n          }] : node.children.flatMap(x => fromMarkdocNode(x, componentBlocks))\n        };\n      }\n    }\n    throw new Error(`Unknown tag: ${node.tag}`);\n  }\n  return inlineNodeFromMarkdoc(node);\n}\nfunction toChildrenAndProps(fromMarkdoc, resultingChildren, value, singleChildField, parentPropPath, componentBlocks) {\n  if (singleChildField.kind === 'child') {\n    const children = fromMarkdoc.flatMap(x => fromMarkdocNode(x, componentBlocks));\n    resultingChildren.push({\n      type: `component-${singleChildField.options.kind}-prop`,\n      propPath: [...parentPropPath, ...singleChildField.relativePath],\n      children\n    });\n  }\n  if (singleChildField.kind === 'array') {\n    const arr = [];\n    for (let [idx, child] of fromMarkdoc.entries()) {\n      if (child.type === 'paragraph') {\n        child = child.children[0].children[0];\n      }\n      if (child.type !== 'tag') {\n        throw new Error(`expected tag ${singleChildField.asChildTag}, found type: ${child.type}`);\n      }\n      if (child.tag !== singleChildField.asChildTag) {\n        throw new Error(`expected tag ${singleChildField.asChildTag}, found tag: ${child.tag}`);\n      }\n      const attributes = JSON.parse(JSON.stringify(child.attributes));\n      if (singleChildField.child) {\n        toChildrenAndProps(child.children, resultingChildren, attributes, singleChildField.child, [...parentPropPath, ...singleChildField.relativePath, idx], componentBlocks);\n      }\n      arr.push(attributes);\n    }\n    const key = singleChildField.relativePath[singleChildField.relativePath.length - 1];\n    const parent = getValueAtPropPath(value, singleChildField.relativePath.slice(0, -1));\n    parent[key] = arr;\n  }\n}\n\n// these are intentionally more restrictive than the types allowed by strong and weak maps\n\nconst emptyCacheNode = Symbol('emptyCacheNode');\n\n// weak keys should always come before strong keys in the arguments though that cannot be enforced with types\nfunction memoize(func) {\n  const cacheNode = {\n    value: emptyCacheNode,\n    strong: undefined,\n    weak: undefined\n  };\n  return (...args) => {\n    let currentCacheNode = cacheNode;\n    for (const arg of args) {\n      if (typeof arg === 'string' || typeof arg === 'number') {\n        if (currentCacheNode.strong === undefined) {\n          currentCacheNode.strong = new Map();\n        }\n        if (!currentCacheNode.strong.has(arg)) {\n          currentCacheNode.strong.set(arg, {\n            value: emptyCacheNode,\n            strong: undefined,\n            weak: undefined\n          });\n        }\n        currentCacheNode = currentCacheNode.strong.get(arg);\n        continue;\n      }\n      if (typeof arg === 'object') {\n        if (currentCacheNode.weak === undefined) {\n          currentCacheNode.weak = new WeakMap();\n        }\n        if (!currentCacheNode.weak.has(arg)) {\n          currentCacheNode.weak.set(arg, {\n            value: emptyCacheNode,\n            strong: undefined,\n            weak: undefined\n          });\n        }\n        currentCacheNode = currentCacheNode.weak.get(arg);\n        continue;\n      }\n    }\n    if (currentCacheNode.value !== emptyCacheNode) {\n      return currentCacheNode.value;\n    }\n    const result = func(...args);\n    currentCacheNode.value = result;\n    return result;\n  };\n}\n\nfunction fixPath(path) {\n  return path.replace(/^\\.?\\/+/, '').replace(/\\/*$/, '');\n}\nconst collectionPath = /\\/\\*\\*?(?:$|\\/)/;\nfunction getConfiguredCollectionPath(config, collection) {\n  var _collectionConfig$pat;\n  const collectionConfig = config.collections[collection];\n  const path = (_collectionConfig$pat = collectionConfig.path) !== null && _collectionConfig$pat !== void 0 ? _collectionConfig$pat : `${collection}/*/`;\n  if (!collectionPath.test(path)) {\n    throw new Error(`Collection path must end with /* or /** or include /*/ or /**/ but ${collection} has ${path}`);\n  }\n  return path;\n}\nfunction getCollectionPath(config, collection) {\n  const configuredPath = getConfiguredCollectionPath(config, collection);\n  const path = fixPath(configuredPath.replace(/\\*\\*?.*$/, ''));\n  return path;\n}\nfunction getCollectionFormat(config, collection) {\n  return getFormatInfo(config, 'collections', collection);\n}\nfunction getSingletonFormat(config, singleton) {\n  return getFormatInfo(config, 'singletons', singleton);\n}\nfunction getCollectionItemPath(config, collection, slug) {\n  const basePath = getCollectionPath(config, collection);\n  const suffix = getCollectionItemSlugSuffix(config, collection);\n  return `${basePath}/${slug}${suffix}`;\n}\nfunction getEntryDataFilepath(dir, formatInfo) {\n  return `${dir}${formatInfo.dataLocation === 'index' ? '/index' : ''}${getDataFileExtension(formatInfo)}`;\n}\nfunction getSlugGlobForCollection(config, collection) {\n  const collectionPath = getConfiguredCollectionPath(config, collection);\n  return collectionPath.includes('**') ? '**' : '*';\n}\nfunction getCollectionItemSlugSuffix(config, collection) {\n  const configuredPath = getConfiguredCollectionPath(config, collection);\n  const path = fixPath(configuredPath.replace(/^[^*]+\\*\\*?/, ''));\n  return path ? `/${path}` : '';\n}\nfunction getSingletonPath(config, singleton) {\n  var _singleton$path, _singleton$path2;\n  if ((_singleton$path = config.singletons[singleton].path) !== null && _singleton$path !== void 0 && _singleton$path.includes('*')) {\n    throw new Error(`Singleton paths cannot include * but ${singleton} has ${config.singletons[singleton].path}`);\n  }\n  return fixPath((_singleton$path2 = config.singletons[singleton].path) !== null && _singleton$path2 !== void 0 ? _singleton$path2 : singleton);\n}\nfunction getDataFileExtension(formatInfo) {\n  return formatInfo.contentField ? formatInfo.contentField.contentExtension : '.' + formatInfo.data;\n}\nconst getFormatInfo = memoize(_getFormatInfo);\nfunction _getFormatInfo(config, type, key) {\n  var _collectionOrSingleto, _format$data;\n  const collectionOrSingleton = type === 'collections' ? config.collections[key] : config.singletons[key];\n  const path = type === 'collections' ? getConfiguredCollectionPath(config, key) : (_collectionOrSingleto = collectionOrSingleton.path) !== null && _collectionOrSingleto !== void 0 ? _collectionOrSingleto : `${key}/`;\n  const dataLocation = path.endsWith('/') ? 'index' : 'outer';\n  const {\n    schema,\n    format = 'yaml'\n  } = collectionOrSingleton;\n  if (typeof format === 'string') {\n    return {\n      dataLocation,\n      contentField: undefined,\n      data: format\n    };\n  }\n  let contentField;\n  if (format.contentField) {\n    let field = {\n      kind: 'object',\n      fields: schema\n    };\n    let path = Array.isArray(format.contentField) ? format.contentField : [format.contentField];\n    let contentExtension;\n    try {\n      contentExtension = getContentExtension(path, field, () => JSON.stringify(format.contentField));\n    } catch (err) {\n      if (err instanceof ContentFieldLocationError) {\n        throw new Error(`${err.message} (${type}.${key})`);\n      }\n      throw err;\n    }\n    contentField = {\n      path,\n      contentExtension\n    };\n  }\n  return {\n    data: (_format$data = format.data) !== null && _format$data !== void 0 ? _format$data : 'yaml',\n    contentField,\n    dataLocation\n  };\n}\nclass ContentFieldLocationError extends Error {\n  constructor(message) {\n    super(message);\n  }\n}\nfunction getContentExtension(path, schema, debugName) {\n  if (path.length === 0) {\n    if (schema.kind !== 'form' || schema.formKind !== 'content') {\n      throw new ContentFieldLocationError(`Content field for ${debugName()} is not a content field`);\n    }\n    return schema.contentExtension;\n  }\n  if (schema.kind === 'object') {\n    const field = schema.fields[path[0]];\n    if (!field) {\n      throw new ContentFieldLocationError(`Field ${debugName()} specified in contentField does not exist`);\n    }\n    return getContentExtension(path.slice(1), field, debugName);\n  }\n  if (schema.kind === 'conditional') {\n    if (path[0] !== 'value') {\n      throw new ContentFieldLocationError(`Conditional fields referenced in a contentField path must only reference the value field (${debugName()})`);\n    }\n    let contentExtension;\n    const innerPath = path.slice(1);\n    for (const value of Object.values(schema.values)) {\n      const foundContentExtension = getContentExtension(innerPath, value, debugName);\n      if (!contentExtension) {\n        contentExtension = foundContentExtension;\n        continue;\n      }\n      if (contentExtension !== foundContentExtension) {\n        throw new ContentFieldLocationError(`contentField ${debugName()} has conflicting content extensions`);\n      }\n    }\n    if (!contentExtension) {\n      throw new ContentFieldLocationError(`contentField ${debugName()} does not point to a content field`);\n    }\n    return contentExtension;\n  }\n  throw new ContentFieldLocationError(`Path specified in contentField ${debugName()} does not point to a content field`);\n}\n\nfunction getSrcPrefix(publicPath, slug) {\n  return typeof publicPath === 'string' ? `${publicPath.replace(/\\/*$/, '')}/${slug === undefined ? '' : slug + '/'}` : '';\n}\n\nfunction deserializeFiles(nodes, componentBlocks, files, otherFiles, mode, documentFeatures, slug) {\n  return nodes.map(node => {\n    if (node.type === 'component-block') {\n      const componentBlock = componentBlocks[node.component];\n      if (!componentBlock) return node;\n      const schema = object(componentBlock.schema);\n      return {\n        ...node,\n        props: deserializeProps(schema, node.props, files, otherFiles, mode, slug)\n      };\n    }\n    if (node.type === 'image' && typeof node.src === 'string' && mode === 'edit') {\n      var _ref;\n      const prefix = getSrcPrefixForImageBlock(documentFeatures, slug);\n      const filename = node.src.slice(prefix.length);\n      const content = (_ref = typeof documentFeatures.images === 'object' && typeof documentFeatures.images.directory === 'string' ? otherFiles.get(fixPath(documentFeatures.images.directory)) : files) === null || _ref === void 0 ? void 0 : _ref.get(filename);\n      if (!content) {\n        return {\n          type: 'paragraph',\n          children: [{\n            text: `Missing image ${filename}`\n          }]\n        };\n      }\n      return {\n        type: 'image',\n        src: {\n          filename,\n          content\n        },\n        alt: node.alt,\n        title: node.title,\n        children: [{\n          text: ''\n        }]\n      };\n    }\n    if (typeof node.type === 'string') {\n      const children = deserializeFiles(node.children, componentBlocks, files, otherFiles, mode, documentFeatures, slug);\n      return {\n        ...node,\n        children\n      };\n    }\n    return node;\n  });\n}\nfunction deserializeProps(schema, value, files, otherFiles, mode, slug) {\n  return transformProps(schema, value, {\n    form: (schema, value) => {\n      if (schema.formKind === 'asset') {\n        var _otherFiles$get;\n        if (mode === 'read') {\n          return schema.reader.parse(value);\n        }\n        const filename = schema.filename(value, {\n          slug,\n          suggestedFilenamePrefix: undefined\n        });\n        return schema.parse(value, {\n          asset: filename ? schema.directory ? (_otherFiles$get = otherFiles.get(schema.directory)) === null || _otherFiles$get === void 0 ? void 0 : _otherFiles$get.get(filename) : files.get(filename) : undefined,\n          slug\n        });\n      }\n      if (schema.formKind === 'content' || schema.formKind === 'assets') {\n        throw new Error('Not implemented');\n      }\n      if (mode === 'read') {\n        return schema.reader.parse(value);\n      }\n      return schema.parse(value, undefined);\n    }\n  });\n}\nfunction getSrcPrefixForImageBlock(documentFeatures, slug) {\n  return getSrcPrefix(typeof documentFeatures.images === 'object' ? documentFeatures.images.publicPath : undefined, slug);\n}\n\nasync function sha1(content) {\n  return (0,crypto__WEBPACK_IMPORTED_MODULE_4__.createHash)('sha1').update(content).digest('hex');\n}\n\nconst textEncoder$1 = new TextEncoder();\nconst blobShaCache = new WeakMap();\nasync function blobSha(contents) {\n  const cached = blobShaCache.get(contents);\n  if (cached !== undefined) return cached;\n  const blobPrefix = textEncoder$1.encode('blob ' + contents.length + '\\0');\n  const array = new Uint8Array(blobPrefix.byteLength + contents.byteLength);\n  array.set(blobPrefix, 0);\n  array.set(contents, blobPrefix.byteLength);\n  const digestPromise = sha1(array);\n  blobShaCache.set(contents, digestPromise);\n  digestPromise.then(digest => blobShaCache.set(contents, digest));\n  return digestPromise;\n}\nfunction getTreeNodeAtPath(root, path) {\n  const parts = path.split('/');\n  let node = root.get(parts[0]);\n  for (const part of parts.slice(1)) {\n    if (!node) return undefined;\n    if (!node.children) return undefined;\n    node = node.children.get(part);\n  }\n  return node;\n}\nfunction getNodeAtPath(tree, path) {\n  if (path === '') return tree;\n  let node = tree;\n  for (const part of path.split('/')) {\n    if (!node.has(part)) {\n      node.set(part, new Map());\n    }\n    const innerNode = node.get(part);\n    (0,emery__WEBPACK_IMPORTED_MODULE_1__.assert)(innerNode instanceof Map, 'expected tree');\n    node = innerNode;\n  }\n  return node;\n}\nfunction getFilename(path) {\n  return path.replace(/.*\\//, '');\n}\nfunction getDirname(path) {\n  if (!path.includes('/')) return '';\n  return path.replace(/\\/[^/]+$/, '');\n}\nfunction toTreeChanges(changes) {\n  const changesRoot = new Map();\n  for (const deletion of changes.deletions) {\n    const parentTree = getNodeAtPath(changesRoot, getDirname(deletion));\n    parentTree.set(getFilename(deletion), 'delete');\n  }\n  for (const addition of changes.additions) {\n    const parentTree = getNodeAtPath(changesRoot, getDirname(addition.path));\n    parentTree.set(getFilename(addition.path), addition.contents);\n  }\n  return changesRoot;\n}\nconst SPACE_CHAR_CODE = 32;\nconst space = new Uint8Array([SPACE_CHAR_CODE]);\nconst nullchar = new Uint8Array([0]);\nconst tree = textEncoder$1.encode('tree ');\n\n// based on https://github.com/isomorphic-git/isomorphic-git/blob/c09dfa20ffe0ab9e6602e0fa172d72ba8994e443/src/models/GitTree.js#L108-L122\nfunction treeSha(children) {\n  const entries = [...children].map(([name, node]) => ({\n    name,\n    sha: node.entry.sha,\n    mode: node.entry.mode\n  }));\n  entries.sort((a, b) => {\n    const aName = a.mode === '040000' ? a.name + '/' : a.name;\n    const bName = b.mode === '040000' ? b.name + '/' : b.name;\n    return aName === bName ? 0 : aName < bName ? -1 : 1;\n  });\n  const treeObject = entries.flatMap(entry => {\n    const mode = textEncoder$1.encode(entry.mode.replace(/^0/, ''));\n    const name = textEncoder$1.encode(entry.name);\n    const sha = hexToBytes(entry.sha);\n    return [mode, space, name, nullchar, sha];\n  });\n  return sha1(concatBytes([tree, textEncoder$1.encode(treeObject.reduce((sum, val) => sum + val.byteLength, 0).toString()), nullchar, ...treeObject]));\n}\nfunction concatBytes(byteArrays) {\n  const totalLength = byteArrays.reduce((sum, arr) => sum + arr.byteLength, 0);\n  const result = new Uint8Array(totalLength);\n  let offset = 0;\n  for (const arr of byteArrays) {\n    result.set(arr, offset);\n    offset += arr.byteLength;\n  }\n  return result;\n}\nfunction hexToBytes(str) {\n  const bytes = new Uint8Array(str.length / 2);\n  for (var i = 0; i < bytes.byteLength; i += 1) {\n    const start = i * 2;\n    bytes[i] = parseInt(str.slice(start, start + 2), 16);\n  }\n  return bytes;\n}\nasync function createTreeNodeEntry(path, children) {\n  const sha = await treeSha(children);\n  return {\n    path,\n    mode: '040000',\n    type: 'tree',\n    sha\n  };\n}\nasync function createBlobNodeEntry(path, contents) {\n  const sha = 'sha' in contents ? contents.sha : await blobSha(contents);\n  return {\n    path,\n    mode: '100644',\n    type: 'blob',\n    sha\n  };\n}\nasync function updateTreeWithChanges(tree, changes) {\n  var _await$updateTree;\n  const newTree = (_await$updateTree = await updateTree(tree, toTreeChanges(changes), [])) !== null && _await$updateTree !== void 0 ? _await$updateTree : new Map();\n  return {\n    entries: treeToEntries(newTree),\n    sha: await treeSha(newTree !== null && newTree !== void 0 ? newTree : new Map())\n  };\n}\nfunction treeToEntries(tree) {\n  return [...tree.values()].flatMap(x => x.children ? [x.entry, ...treeToEntries(x.children)] : [x.entry]);\n}\nasync function updateTree(tree, changedTree, path) {\n  const newTree = new Map(tree);\n  for (const [key, value] of changedTree) {\n    if (value === 'delete') {\n      newTree.delete(key);\n    }\n    if (value instanceof Map) {\n      var _newTree$get$children, _newTree$get;\n      const existingChildren = (_newTree$get$children = (_newTree$get = newTree.get(key)) === null || _newTree$get === void 0 ? void 0 : _newTree$get.children) !== null && _newTree$get$children !== void 0 ? _newTree$get$children : new Map();\n      const children = await updateTree(existingChildren, value, path.concat(key));\n      if (children === undefined) {\n        newTree.delete(key);\n        continue;\n      }\n      const entry = await createTreeNodeEntry(path.concat(key).join('/'), children);\n      newTree.set(key, {\n        entry,\n        children\n      });\n    }\n    if (value instanceof Uint8Array || typeof value === 'object' && 'sha' in value) {\n      const entry = await createBlobNodeEntry(path.concat(key).join('/'), value);\n      newTree.set(key, {\n        entry\n      });\n    }\n  }\n  if (newTree.size === 0) {\n    return undefined;\n  }\n  return newTree;\n}\nfunction treeEntriesToTreeNodes(entries) {\n  const root = new Map();\n  const getChildrenAtPath = parts => {\n    var _node;\n    if (parts.length === 0) {\n      return root;\n    }\n    let node = root.get(parts[0]);\n    for (const part of parts.slice(1)) {\n      if (!node) return undefined;\n      if (!node.children) return undefined;\n      node = node.children.get(part);\n    }\n    return (_node = node) === null || _node === void 0 ? void 0 : _node.children;\n  };\n  for (const entry of entries) {\n    const split = entry.path.split('/');\n    const children = getChildrenAtPath(split.slice(0, -1));\n    if (children) {\n      children.set(split[split.length - 1], {\n        entry,\n        children: entry.type === 'tree' ? new Map() : undefined\n      });\n    }\n  }\n  return root;\n}\n\nfunction collectDirectoriesUsedInSchemaInner(schema, directories, seenSchemas) {\n  if (seenSchemas.has(schema)) {\n    return;\n  }\n  seenSchemas.add(schema);\n  if (schema.kind === 'array') {\n    return collectDirectoriesUsedInSchemaInner(schema.element, directories, seenSchemas);\n  }\n  if (schema.kind === 'child') {\n    return;\n  }\n  if (schema.kind === 'form') {\n    if (schema.formKind === 'asset' && schema.directory !== undefined) {\n      directories.add(fixPath(schema.directory));\n    }\n    if ((schema.formKind === 'content' || schema.formKind === 'assets') && schema.directories !== undefined) {\n      for (const directory of schema.directories) {\n        directories.add(fixPath(directory));\n      }\n    }\n    return;\n  }\n  if (schema.kind === 'object') {\n    for (const field of Object.values(schema.fields)) {\n      collectDirectoriesUsedInSchemaInner(field, directories, seenSchemas);\n    }\n    return;\n  }\n  if (schema.kind === 'conditional') {\n    for (const innerSchema of Object.values(schema.values)) {\n      collectDirectoriesUsedInSchemaInner(innerSchema, directories, seenSchemas);\n    }\n    return;\n  }\n  (0,emery__WEBPACK_IMPORTED_MODULE_1__.assertNever)(schema);\n}\nfunction collectDirectoriesUsedInSchema(schema) {\n  const directories = new Set();\n  collectDirectoriesUsedInSchemaInner(schema, directories, new Set());\n  return directories;\n}\nfunction getDirectoriesForTreeKey(schema, directory, slug, format) {\n  const directories = [fixPath(directory)];\n  if (format.dataLocation === 'outer') {\n    directories.push(fixPath(directory) + getDataFileExtension(format));\n  }\n  const toAdd = slug === undefined ? '' : `/${slug}`;\n  for (const directory of collectDirectoriesUsedInSchema(schema)) {\n    directories.push(directory + toAdd);\n  }\n  return directories;\n}\n\nconst textDecoder$1 = new TextDecoder();\nconst defaultAltField$1 = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.t)({\n  label: 'Alt text',\n  description: 'This text will be used by screen readers and search engines.'\n});\nconst emptyTitleField$1 = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.b)({\n  Input() {\n    return null;\n  },\n  defaultValue() {\n    return '';\n  },\n  parse(value) {\n    if (value === undefined) return '';\n    if (typeof value !== 'string') {\n      throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be string');\n    }\n    return value;\n  },\n  validate(value) {\n    return value;\n  },\n  serialize(value) {\n    return {\n      value\n    };\n  },\n  label: 'Title'\n});\nfunction normaliseDocumentFeatures(config) {\n  var _config$formatting, _formatting$alignment, _formatting$alignment2, _formatting$blockType, _formatting$inlineMar, _formatting$inlineMar2, _formatting$inlineMar3, _formatting$inlineMar4, _formatting$inlineMar5, _formatting$inlineMar6, _formatting$inlineMar7, _formatting$inlineMar8, _formatting$listTypes, _formatting$listTypes2, _imagesConfig$schema$, _imagesConfig$schema, _imagesConfig$schema$2, _imagesConfig$schema2;\n  const formatting = config.formatting === true ? {\n    // alignment: true, // not supported natively in markdown\n    blockTypes: true,\n    headingLevels: true,\n    inlineMarks: true,\n    listTypes: true,\n    softBreaks: true\n  } : (_config$formatting = config.formatting) !== null && _config$formatting !== void 0 ? _config$formatting : {};\n  const imagesConfig = config.images === true ? {} : config.images;\n  return {\n    formatting: {\n      alignment: formatting.alignment === true ? {\n        center: true,\n        end: true\n      } : {\n        center: !!((_formatting$alignment = formatting.alignment) !== null && _formatting$alignment !== void 0 && _formatting$alignment.center),\n        end: !!((_formatting$alignment2 = formatting.alignment) !== null && _formatting$alignment2 !== void 0 && _formatting$alignment2.end)\n      },\n      blockTypes: (formatting === null || formatting === void 0 ? void 0 : formatting.blockTypes) === true ? {\n        blockquote: true,\n        code: {\n          schema: object({})\n        }\n      } : {\n        blockquote: !!((_formatting$blockType = formatting.blockTypes) !== null && _formatting$blockType !== void 0 && _formatting$blockType.blockquote),\n        code: (_formatting$blockType2 => {\n          if (((_formatting$blockType2 = formatting.blockTypes) === null || _formatting$blockType2 === void 0 ? void 0 : _formatting$blockType2.code) === undefined) {\n            return false;\n          }\n          if (formatting.blockTypes.code === true || !formatting.blockTypes.code.schema) {\n            return {\n              schema: object({})\n            };\n          }\n          for (const key of ['type', 'children', 'language']) {\n            if (key in formatting.blockTypes.code.schema) {\n              throw new Error(`\"${key}\" cannot be a key in the schema for code blocks`);\n            }\n          }\n          return {\n            schema: object(formatting.blockTypes.code.schema)\n          };\n        })()\n      },\n      headings: (_obj$schema => {\n        const opt = formatting === null || formatting === void 0 ? void 0 : formatting.headingLevels;\n        const obj = typeof opt === 'object' && 'levels' in opt ? opt : {\n          levels: opt,\n          schema: undefined\n        };\n        if (obj.schema) {\n          for (const key of ['type', 'children', 'level', 'textAlign']) {\n            if (key in obj.schema) {\n              throw new Error(`\"${key}\" cannot be a key in the schema for headings`);\n            }\n          }\n        }\n        return {\n          levels: [...new Set(obj.levels === true ? [1, 2, 3, 4, 5, 6] : obj.levels)],\n          schema: object((_obj$schema = obj.schema) !== null && _obj$schema !== void 0 ? _obj$schema : {})\n        };\n      })(),\n      inlineMarks: formatting.inlineMarks === true ? {\n        bold: true,\n        code: true,\n        italic: true,\n        keyboard: false,\n        // not supported natively in markdown\n        strikethrough: true,\n        subscript: false,\n        // not supported natively in markdown\n        superscript: false,\n        // not supported natively in markdown\n        underline: false // not supported natively in markdown\n      } : {\n        bold: !!((_formatting$inlineMar = formatting.inlineMarks) !== null && _formatting$inlineMar !== void 0 && _formatting$inlineMar.bold),\n        code: !!((_formatting$inlineMar2 = formatting.inlineMarks) !== null && _formatting$inlineMar2 !== void 0 && _formatting$inlineMar2.code),\n        italic: !!((_formatting$inlineMar3 = formatting.inlineMarks) !== null && _formatting$inlineMar3 !== void 0 && _formatting$inlineMar3.italic),\n        strikethrough: !!((_formatting$inlineMar4 = formatting.inlineMarks) !== null && _formatting$inlineMar4 !== void 0 && _formatting$inlineMar4.strikethrough),\n        underline: !!((_formatting$inlineMar5 = formatting.inlineMarks) !== null && _formatting$inlineMar5 !== void 0 && _formatting$inlineMar5.underline),\n        keyboard: !!((_formatting$inlineMar6 = formatting.inlineMarks) !== null && _formatting$inlineMar6 !== void 0 && _formatting$inlineMar6.keyboard),\n        subscript: !!((_formatting$inlineMar7 = formatting.inlineMarks) !== null && _formatting$inlineMar7 !== void 0 && _formatting$inlineMar7.subscript),\n        superscript: !!((_formatting$inlineMar8 = formatting.inlineMarks) !== null && _formatting$inlineMar8 !== void 0 && _formatting$inlineMar8.superscript)\n      },\n      listTypes: formatting.listTypes === true ? {\n        ordered: true,\n        unordered: true\n      } : {\n        ordered: !!((_formatting$listTypes = formatting.listTypes) !== null && _formatting$listTypes !== void 0 && _formatting$listTypes.ordered),\n        unordered: !!((_formatting$listTypes2 = formatting.listTypes) !== null && _formatting$listTypes2 !== void 0 && _formatting$listTypes2.unordered)\n      },\n      softBreaks: !!formatting.softBreaks\n    },\n    links: !!config.links,\n    layouts: [...new Set((config.layouts || []).map(x => JSON.stringify(x)))].map(x => JSON.parse(x)),\n    dividers: !!config.dividers,\n    images: imagesConfig === undefined ? false : {\n      ...imagesConfig,\n      schema: {\n        alt: (_imagesConfig$schema$ = (_imagesConfig$schema = imagesConfig.schema) === null || _imagesConfig$schema === void 0 ? void 0 : _imagesConfig$schema.alt) !== null && _imagesConfig$schema$ !== void 0 ? _imagesConfig$schema$ : defaultAltField$1,\n        title: (_imagesConfig$schema$2 = (_imagesConfig$schema2 = imagesConfig.schema) === null || _imagesConfig$schema2 === void 0 ? void 0 : _imagesConfig$schema2.title) !== null && _imagesConfig$schema$2 !== void 0 ? _imagesConfig$schema$2 : emptyTitleField$1\n      }\n    },\n    tables: !!config.tables\n  };\n}\n\n/**\n * @deprecated `fields.markdoc` has superseded this field. `fields.mdx` is also available if you prefer MDX.\n */\nfunction document({\n  label,\n  componentBlocks = {},\n  description,\n  ...documentFeaturesConfig\n}) {\n  const documentFeatures = normaliseDocumentFeatures(documentFeaturesConfig);\n  return {\n    kind: 'form',\n    formKind: 'content',\n    defaultValue() {\n      return [{\n        type: 'paragraph',\n        children: [{\n          text: ''\n        }]\n      }];\n    },\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.h, {\n        componentBlocks: componentBlocks,\n        description: description,\n        label: label,\n        documentFeatures: documentFeatures,\n        ...props\n      });\n    },\n    parse(_, data) {\n      const markdoc = textDecoder$1.decode(data.content);\n      fromMarkdoc((0,_markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.parse)(markdoc), componentBlocks);\n      return deserializeFiles((0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.n)(), componentBlocks, data.other, data.external, 'edit', documentFeatures, data.slug);\n    },\n    contentExtension: '.mdoc',\n    validate(value) {\n      return value;\n    },\n    directories: [...collectDirectoriesUsedInSchema(object(Object.fromEntries(Object.entries(componentBlocks).map(([name, block]) => [name, object(block.schema)])))), ...(typeof documentFeatures.images === 'object' && typeof documentFeatures.images.directory === 'string' ? [fixPath(documentFeatures.images.directory)] : [])],\n    serialize(value, opts) {\n      return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.i)();\n    },\n    reader: {\n      parse(value, data) {\n        const markdoc = textDecoder$1.decode(data.content);\n        const document = fromMarkdoc((0,_markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.parse)(markdoc), componentBlocks);\n        return deserializeFiles(document, componentBlocks, new Map(), new Map(), 'read', documentFeatures, undefined);\n      }\n    }\n  };\n}\n\nconst defaultAltField = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.t)({\n  label: 'Alt text',\n  description: 'This text will be used by screen readers and search engines.'\n});\nconst emptyTitleField = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.b)({\n  Input() {\n    return null;\n  },\n  defaultValue() {\n    return '';\n  },\n  parse(value) {\n    if (value === undefined) return '';\n    if (typeof value !== 'string') {\n      throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be string');\n    }\n    return value;\n  },\n  validate(value) {\n    return value;\n  },\n  serialize(value) {\n    return {\n      value\n    };\n  },\n  label: 'Title'\n});\nfunction editorOptionsToConfig(options) {\n  var _options$bold, _options$italic, _options$strikethroug, _options$code, _options$blockquote, _options$orderedList, _options$unorderedLis, _options$table, _options$link, _options$divider;\n  return {\n    bold: (_options$bold = options.bold) !== null && _options$bold !== void 0 ? _options$bold : true,\n    italic: (_options$italic = options.italic) !== null && _options$italic !== void 0 ? _options$italic : true,\n    strikethrough: (_options$strikethroug = options.strikethrough) !== null && _options$strikethroug !== void 0 ? _options$strikethroug : true,\n    code: (_options$code = options.code) !== null && _options$code !== void 0 ? _options$code : true,\n    heading: (() => {\n      let levels = [];\n      let levelsOpt = typeof options.heading === 'object' && !Array.isArray(options.heading) ? options.heading.levels : options.heading;\n      if (levelsOpt === true || levelsOpt === undefined) {\n        levels = [1, 2, 3, 4, 5, 6];\n      }\n      if (Array.isArray(levelsOpt)) {\n        levels = levelsOpt;\n      }\n      return {\n        levels,\n        schema: options.heading && typeof options.heading === 'object' && 'schema' in options.heading ? options.heading.schema : {}\n      };\n    })(),\n    blockquote: (_options$blockquote = options.blockquote) !== null && _options$blockquote !== void 0 ? _options$blockquote : true,\n    orderedList: (_options$orderedList = options.orderedList) !== null && _options$orderedList !== void 0 ? _options$orderedList : true,\n    unorderedList: (_options$unorderedLis = options.unorderedList) !== null && _options$unorderedLis !== void 0 ? _options$unorderedLis : true,\n    table: (_options$table = options.table) !== null && _options$table !== void 0 ? _options$table : true,\n    link: (_options$link = options.link) !== null && _options$link !== void 0 ? _options$link : true,\n    image: options.image !== false ? ((_opts$transformFilena, _opts$schema$alt, _opts$schema, _opts$schema$title, _opts$schema2) => {\n      const opts = options.image === true ? undefined : options.image;\n      return {\n        directory: opts === null || opts === void 0 ? void 0 : opts.directory,\n        publicPath: opts === null || opts === void 0 ? void 0 : opts.publicPath,\n        transformFilename: (_opts$transformFilena = opts === null || opts === void 0 ? void 0 : opts.transformFilename) !== null && _opts$transformFilena !== void 0 ? _opts$transformFilena : x => x,\n        schema: {\n          alt: (_opts$schema$alt = opts === null || opts === void 0 || (_opts$schema = opts.schema) === null || _opts$schema === void 0 ? void 0 : _opts$schema.alt) !== null && _opts$schema$alt !== void 0 ? _opts$schema$alt : defaultAltField,\n          title: (_opts$schema$title = opts === null || opts === void 0 || (_opts$schema2 = opts.schema) === null || _opts$schema2 === void 0 ? void 0 : _opts$schema2.title) !== null && _opts$schema$title !== void 0 ? _opts$schema$title : emptyTitleField\n        }\n      };\n    })() : undefined,\n    divider: (_options$divider = options.divider) !== null && _options$divider !== void 0 ? _options$divider : true,\n    codeBlock: options.codeBlock === false ? undefined : {\n      schema: typeof options.codeBlock === 'object' ? options.codeBlock.schema : {}\n    }\n  };\n}\n\nfunction getTypeForField(field) {\n  if (field.kind === 'object' || field.kind === 'conditional') {\n    return {\n      type: Object,\n      required: true\n    };\n  }\n  if (field.kind === 'array') {\n    return {\n      type: Array,\n      required: true\n    };\n  }\n  if (field.kind === 'child') {\n    return {};\n  }\n  if (field.formKind === undefined) {\n    if (typeof field.defaultValue === 'string' && 'options' in field && Array.isArray(field.options) && field.options.every(val => typeof val === 'object' && val !== null && 'value' in val && typeof val.value === 'string')) {\n      return {\n        type: String,\n        matches: field.options.map(x => x.value),\n        required: true\n      };\n    }\n    if (typeof field.defaultValue === 'string') {\n      let required = false;\n      try {\n        field.parse('');\n      } catch {\n        required = true;\n      }\n      return {\n        type: String,\n        required\n      };\n    }\n    try {\n      field.parse(1);\n      return {\n        type: Number\n      };\n    } catch {}\n    if (typeof field.defaultValue === 'boolean') {\n      return {\n        type: Boolean,\n        required: true\n      };\n    }\n    return {};\n  }\n  if (field.formKind === 'slug') {\n    let required = false;\n    try {\n      field.parse('', undefined);\n    } catch {\n      required = true;\n    }\n    return {\n      type: String,\n      required\n    };\n  }\n  if (field.formKind === 'asset') {\n    let required = false;\n    try {\n      field.validate(null);\n    } catch {\n      required = true;\n    }\n    return {\n      type: String,\n      required\n    };\n  }\n  return {};\n}\nfunction fieldsToMarkdocAttributes(fields) {\n  return Object.fromEntries(Object.entries(fields).map(([name, field]) => {\n    const schema = getTypeForField(field);\n    return [name, schema];\n  }));\n}\nfunction createMarkdocConfig(opts) {\n  const editorConfig = editorOptionsToConfig(opts.options || {});\n  const config = {\n    nodes: {\n      ..._markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.nodes\n    },\n    tags: {}\n  };\n  if (editorConfig.heading.levels.length) {\n    config.nodes.heading = {\n      ..._markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.nodes.heading,\n      attributes: {\n        ..._markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.nodes.heading.attributes,\n        ...fieldsToMarkdocAttributes(editorConfig.heading.schema)\n      }\n    };\n  } else {\n    config.nodes.heading = undefined;\n  }\n  if (!editorConfig.blockquote) {\n    config.nodes.blockquote = undefined;\n  }\n  if (editorConfig.codeBlock) {\n    config.nodes.fence = {\n      ..._markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.nodes.fence,\n      attributes: {\n        ..._markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.nodes.fence.attributes,\n        ...fieldsToMarkdocAttributes(editorConfig.codeBlock.schema)\n      }\n    };\n  } else {\n    config.nodes.fence = undefined;\n  }\n  if (!editorConfig.orderedList && !editorConfig.unorderedList) {\n    config.nodes.list = undefined;\n  }\n  if (!editorConfig.bold) {\n    config.nodes.strong = undefined;\n  }\n  if (!editorConfig.italic) {\n    config.nodes.em = undefined;\n  }\n  if (!editorConfig.strikethrough) {\n    config.nodes.s = undefined;\n  }\n  if (!editorConfig.link) {\n    config.nodes.link = undefined;\n  }\n  if (!editorConfig.image) {\n    config.nodes.image = undefined;\n  }\n  if (!editorConfig.divider) {\n    config.nodes.hr = undefined;\n  }\n  if (!editorConfig.table) {\n    config.nodes.table = undefined;\n  }\n  for (const [name, component] of Object.entries(opts.components || {})) {\n    var _opts$render;\n    const isEmpty = component.kind === 'block' || component.kind === 'inline';\n    config.tags[name] = {\n      render: (_opts$render = opts.render) === null || _opts$render === void 0 || (_opts$render = _opts$render.tags) === null || _opts$render === void 0 ? void 0 : _opts$render[name],\n      children: isEmpty ? [] : undefined,\n      selfClosing: isEmpty,\n      attributes: fieldsToMarkdocAttributes(component.schema),\n      description: 'description' in component ? component.description : undefined,\n      inline: component.kind === 'inline' || component.kind === 'mark'\n    };\n  }\n  for (const [name, render] of Object.entries(((_opts$render2 = opts.render) === null || _opts$render2 === void 0 ? void 0 : _opts$render2.nodes) || {})) {\n    var _opts$render2;\n    const nodeSchema = config.nodes[name];\n    if (nodeSchema) {\n      nodeSchema.render = render;\n    }\n  }\n  return config;\n}\n\nconst textDecoder = new TextDecoder();\nconst textEncoder = new TextEncoder();\nfunction getDirectoriesForEditorField(components, config) {\n  return [...collectDirectoriesUsedInSchema(object(Object.fromEntries(Object.entries(components).map(([name, component]) => [name, object(component.schema)])))), ...(typeof config.image === 'object' && typeof config.image.directory === 'string' ? [fixPath(config.image.directory)] : [])];\n}\nfunction markdoc({\n  label,\n  description,\n  options = {},\n  components = {},\n  extension = 'mdoc'\n}) {\n  let schema;\n  const config = editorOptionsToConfig(options);\n  let getSchema = () => {\n    if (!schema) {\n      schema = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.r)();\n    }\n    return schema;\n  };\n  return {\n    kind: 'form',\n    formKind: 'content',\n    defaultValue() {\n      return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.j)(getSchema());\n    },\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.h, {\n        description: description,\n        label: label,\n        ...props\n      });\n    },\n    parse: (_, {\n      content,\n      other,\n      external,\n      slug\n    }) => {\n      const text = textDecoder.decode(content);\n      return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.p)(text, getSchema());\n    },\n    contentExtension: `.${extension}`,\n    validate(value) {\n      return value;\n    },\n    directories: getDirectoriesForEditorField(components, config),\n    serialize(value, {\n      slug\n    }) {\n      const out = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.k)();\n      return {\n        content: textEncoder.encode(out.content),\n        external: out.external,\n        other: out.other,\n        value: undefined\n      };\n    },\n    reader: {\n      parse: (_, {\n        content\n      }) => {\n        const text = textDecoder.decode(content);\n        return {\n          node: (0,_markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.parse)(text)\n        };\n      }\n    },\n    collaboration: {\n      toYjs(value) {\n        return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.l)(value.doc);\n      },\n      fromYjs(yjsValue, awareness) {\n        return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.m)(getSchema());\n      }\n    }\n  };\n}\nmarkdoc.createMarkdocConfig = createMarkdocConfig;\nmarkdoc.inline = function inlineMarkdoc({\n  label,\n  description,\n  options = {},\n  components = {}\n}) {\n  let schema;\n  const config = editorOptionsToConfig(options);\n  let getSchema = () => {\n    if (!schema) {\n      schema = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.r)();\n    }\n    return schema;\n  };\n  return {\n    kind: 'form',\n    formKind: 'assets',\n    defaultValue() {\n      return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.j)(getSchema());\n    },\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.h, {\n        description: description,\n        label: label,\n        ...props\n      });\n    },\n    parse: (value, {\n      other,\n      external,\n      slug\n    }) => {\n      if (value === undefined) {\n        value = '';\n      }\n      if (typeof value !== 'string') {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be a string');\n      }\n      return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.p)(value, getSchema());\n    },\n    validate(value) {\n      return value;\n    },\n    directories: getDirectoriesForEditorField(components, config),\n    serialize(value, {\n      slug\n    }) {\n      const out = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.k)();\n      return {\n        external: out.external,\n        other: out.other,\n        value: out.content\n      };\n    },\n    reader: {\n      parse: value => {\n        if (value === undefined) {\n          value = '';\n        }\n        if (typeof value !== 'string') {\n          throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be a string');\n        }\n        return {\n          node: (0,_markdoc_markdoc_dist_index_mjs__WEBPACK_IMPORTED_MODULE_5__.parse)(value)\n        };\n      }\n    },\n    collaboration: {\n      toYjs(value) {\n        return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.l)(value.doc);\n      },\n      fromYjs(yjsValue, awareness) {\n        return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.m)(getSchema());\n      }\n    }\n  };\n};\nfunction mdx({\n  label,\n  description,\n  options = {},\n  components = {},\n  extension = 'mdx'\n}) {\n  let schema;\n  const config = editorOptionsToConfig(options);\n  let getSchema = () => {\n    if (!schema) {\n      schema = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.r)();\n    }\n    return schema;\n  };\n  return {\n    kind: 'form',\n    formKind: 'content',\n    defaultValue() {\n      return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.j)(getSchema());\n    },\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.h, {\n        description: description,\n        label: label,\n        ...props\n      });\n    },\n    parse: (_, {\n      content,\n      other,\n      external,\n      slug\n    }) => {\n      const text = textDecoder.decode(content);\n      return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.o)(text, getSchema());\n    },\n    contentExtension: `.${extension}`,\n    validate(value) {\n      return value;\n    },\n    directories: getDirectoriesForEditorField(components, config),\n    serialize(value, {\n      slug\n    }) {\n      const out = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.q)();\n      return {\n        content: textEncoder.encode(out.content),\n        external: out.external,\n        other: out.other,\n        value: undefined\n      };\n    },\n    reader: {\n      parse: (_, {\n        content\n      }) => {\n        const text = textDecoder.decode(content);\n        return text;\n      }\n    },\n    collaboration: {\n      toYjs(value) {\n        return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.l)(value.doc);\n      },\n      fromYjs(yjsValue, awareness) {\n        return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.m)(getSchema());\n      }\n    }\n  };\n}\nmdx.inline = function mdx({\n  label,\n  description,\n  options = {},\n  components = {}\n}) {\n  let schema;\n  const config = editorOptionsToConfig(options);\n  let getSchema = () => {\n    if (!schema) {\n      schema = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.r)();\n    }\n    return schema;\n  };\n  return {\n    kind: 'form',\n    formKind: 'assets',\n    defaultValue() {\n      return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.j)(getSchema());\n    },\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.h, {\n        description: description,\n        label: label,\n        ...props\n      });\n    },\n    parse: (value, {\n      other,\n      external,\n      slug\n    }) => {\n      if (value === undefined) {\n        value = '';\n      }\n      if (typeof value !== 'string') {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be a string');\n      }\n      return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.o)(value, getSchema());\n    },\n    validate(value) {\n      return value;\n    },\n    directories: getDirectoriesForEditorField(components, config),\n    serialize(value, {\n      slug\n    }) {\n      const out = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.q)();\n      return {\n        external: out.external,\n        other: out.other,\n        value: out.content\n      };\n    },\n    reader: {\n      parse: value => {\n        if (value === undefined) {\n          value = '';\n        }\n        if (typeof value !== 'string') {\n          throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.F('Must be a string');\n        }\n        return value;\n      }\n    },\n    collaboration: {\n      toYjs(value) {\n        return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.l)(value.doc);\n      },\n      fromYjs(yjsValue, awareness) {\n        return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.m)(getSchema());\n      }\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3QvaW5kZXgtY2EyNzAzMTEubm9kZS5yZWFjdC1zZXJ2ZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Q7QUFDaEI7QUFDYztBQUM2WDtBQUNsWjtBQUNKOztBQUVwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSw2REFBVztBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw4Q0FBOEMsZUFBZTtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLFVBQVU7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxRQUFRLElBQUk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFNBQVM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsOEJBQThCO0FBQ3ZEO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3Qyw0QkFBNEIsZ0JBQWdCLFdBQVc7QUFDL0Y7QUFDQTtBQUNBLHdDQUF3Qyw0QkFBNEIsZUFBZSxVQUFVO0FBQzdGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlJQUF5SSxXQUFXO0FBQ3BKO0FBQ0EsMEZBQTBGLFlBQVksTUFBTSxLQUFLO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLFNBQVMsR0FBRyxLQUFLLEVBQUUsT0FBTztBQUN0QztBQUNBO0FBQ0EsWUFBWSxJQUFJLEVBQUUsb0RBQW9ELEVBQUUsaUNBQWlDO0FBQ3pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsS0FBSztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RCxXQUFXLE1BQU0sa0NBQWtDO0FBQy9HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa05BQWtOLElBQUk7QUFDdE47QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLDJCQUEyQixhQUFhLEdBQUcsS0FBSyxHQUFHLElBQUk7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsYUFBYTtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsYUFBYTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUlBQXVJLFlBQVk7QUFDbko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQsYUFBYTtBQUN6RTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsYUFBYTtBQUN2RTtBQUNBO0FBQ0E7QUFDQSx3RUFBd0UsYUFBYTtBQUNyRjs7QUFFQTtBQUNBLDZDQUE2QywrQkFBK0IsR0FBRyxxQ0FBcUM7QUFDcEg7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxTQUFTO0FBQzVDLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVMsa0RBQVU7QUFDbkI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksNkNBQU07QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixzQkFBc0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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Q0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQkFBa0IsdUVBQTJCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLG1FQUFjO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsZUFBZSx1RUFBeUI7QUFDeEMsT0FBTztBQUNQO0FBQ0EsZUFBZSx1RUFBd0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7O0FBRXljIiwic291cmNlcyI6WyIvVXNlcnMvamFtZXMvRG93bmxvYWRzL25ldy1rZXlzdGF0aWMtcHJvamVjdC9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3QvaW5kZXgtY2EyNzAzMTEubm9kZS5yZWFjdC1zZXJ2ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcGFyc2UsIG5vZGVzIH0gZnJvbSAnQG1hcmtkb2MvbWFya2RvYy9kaXN0L2luZGV4Lm1qcyc7XG5pbXBvcnQgeyBhc3NlcnROZXZlciB9IGZyb20gJ2VtZXJ5L2Fzc2VydGlvbnMnO1xuaW1wb3J0IHsgYXNzZXJ0LCBhc3NlcnROZXZlciBhcyBhc3NlcnROZXZlciQxIH0gZnJvbSAnZW1lcnknO1xuaW1wb3J0IHsgYiBhcyBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSwgdCBhcyB0ZXh0LCBGIGFzIEZpZWxkRGF0YUVycm9yLCBoIGFzIERvY3VtZW50RmllbGRJbnB1dCwgbiBhcyBub3JtYWxpemVEb2N1bWVudEZpZWxkQ2hpbGRyZW4sIGkgYXMgc2VyaWFsaXplTWFya2RvYywgaiBhcyBnZXREZWZhdWx0VmFsdWUsIHAgYXMgcGFyc2VUb0VkaXRvclN0YXRlLCBrIGFzIHNlcmlhbGl6ZUZyb21FZGl0b3JTdGF0ZSwgbCBhcyBwcm9zZW1pcnJvclRvWVhtbEZyYWdtZW50LCBtIGFzIGNyZWF0ZUVkaXRvclN0YXRlRnJvbVlKUywgbyBhcyBwYXJzZVRvRWRpdG9yU3RhdGVNRFgsIHEgYXMgc2VyaWFsaXplRnJvbUVkaXRvclN0YXRlTURYLCByIGFzIGNyZWF0ZUVkaXRvclNjaGVtYSB9IGZyb20gJy4vaW5kZXgtMTBlYTUwZTIubm9kZS5yZWFjdC1zZXJ2ZXIuanMnO1xuaW1wb3J0IHsganN4IH0gZnJvbSAncmVhY3QvanN4LXJ1bnRpbWUnO1xuaW1wb3J0IHsgY3JlYXRlSGFzaCB9IGZyb20gJ2NyeXB0byc7XG5cbmZ1bmN0aW9uIG9iamVjdChmaWVsZHMsIG9wdHMpIHtcbiAgcmV0dXJuIHtcbiAgICAuLi5vcHRzLFxuICAgIGtpbmQ6ICdvYmplY3QnLFxuICAgIGZpZWxkc1xuICB9O1xufVxuXG5mdW5jdGlvbiBnZXRWYWx1ZUF0UHJvcFBhdGgodmFsdWUsIGlucHV0UGF0aCkge1xuICBjb25zdCBwYXRoID0gWy4uLmlucHV0UGF0aF07XG4gIHdoaWxlIChwYXRoLmxlbmd0aCkge1xuICAgIGNvbnN0IGtleSA9IHBhdGguc2hpZnQoKTtcbiAgICB2YWx1ZSA9IHZhbHVlW2tleV07XG4gIH1cbiAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gdHJhbnNmb3JtUHJvcHMoc2NoZW1hLCB2YWx1ZSwgdmlzaXRvcnMsIHBhdGggPSBbXSkge1xuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdmb3JtJyB8fCBzY2hlbWEua2luZCA9PT0gJ2NoaWxkJykge1xuICAgIGlmICh2aXNpdG9yc1tzY2hlbWEua2luZF0pIHtcbiAgICAgIHJldHVybiB2aXNpdG9yc1tzY2hlbWEua2luZF0oc2NoZW1hLCB2YWx1ZSwgcGF0aCk7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdvYmplY3QnKSB7XG4gICAgY29uc3QgdmFsID0gT2JqZWN0LmZyb21FbnRyaWVzKE9iamVjdC5lbnRyaWVzKHNjaGVtYS5maWVsZHMpLm1hcCgoW2tleSwgdmFsXSkgPT4ge1xuICAgICAgcmV0dXJuIFtrZXksIHRyYW5zZm9ybVByb3BzKHZhbCwgdmFsdWVba2V5XSwgdmlzaXRvcnMsIFsuLi5wYXRoLCBrZXldKV07XG4gICAgfSkpO1xuICAgIGlmICh2aXNpdG9ycy5vYmplY3QpIHtcbiAgICAgIHJldHVybiB2aXNpdG9yc1tzY2hlbWEua2luZF0oc2NoZW1hLCB2YWwsIHBhdGgpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsO1xuICB9XG4gIGlmIChzY2hlbWEua2luZCA9PT0gJ2FycmF5Jykge1xuICAgIGNvbnN0IHZhbCA9IHZhbHVlLm1hcCgodmFsLCBpZHgpID0+IHRyYW5zZm9ybVByb3BzKHNjaGVtYS5lbGVtZW50LCB2YWwsIHZpc2l0b3JzLCBwYXRoLmNvbmNhdChpZHgpKSk7XG4gICAgaWYgKHZpc2l0b3JzLmFycmF5KSB7XG4gICAgICByZXR1cm4gdmlzaXRvcnNbc2NoZW1hLmtpbmRdKHNjaGVtYSwgdmFsLCBwYXRoKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbDtcbiAgfVxuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdjb25kaXRpb25hbCcpIHtcbiAgICBjb25zdCBkaXNjcmltaW5hbnQgPSB0cmFuc2Zvcm1Qcm9wcyhzY2hlbWEuZGlzY3JpbWluYW50LCB2YWx1ZS5kaXNjcmltaW5hbnQsIHZpc2l0b3JzLCBwYXRoLmNvbmNhdCgnZGlzY3JpbWluYW50JykpO1xuICAgIGNvbnN0IGNvbmRpdGlvbmFsVmFsID0gdHJhbnNmb3JtUHJvcHMoc2NoZW1hLnZhbHVlc1tkaXNjcmltaW5hbnQudG9TdHJpbmcoKV0sIHZhbHVlLnZhbHVlLCB2aXNpdG9ycywgcGF0aC5jb25jYXQoJ3ZhbHVlJykpO1xuICAgIGNvbnN0IHZhbCA9IHtcbiAgICAgIGRpc2NyaW1pbmFudCxcbiAgICAgIHZhbHVlOiBjb25kaXRpb25hbFZhbFxuICAgIH07XG4gICAgaWYgKHZpc2l0b3JzLmNvbmRpdGlvbmFsKSB7XG4gICAgICByZXR1cm4gdmlzaXRvcnNbc2NoZW1hLmtpbmRdKHNjaGVtYSwgdmFsLCBwYXRoKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbDtcbiAgfVxuICBhc3NlcnROZXZlcihzY2hlbWEpO1xufVxuXG4vLyBhIHYgaW1wb3J0YW50IG5vdGVcbi8vIG1hcmtzIGluIHRoZSBtYXJrZG93biBhc3QvaHRtbCBhcmUgcmVwcmVzZW50ZWQgcXVpdGUgZGlmZmVyZW50bHkgdG8gaG93IHRoZXkgYXJlIGluIHNsYXRlXG4vLyBpZiB5b3UgaGFkIHRoZSBtYXJrZG93biAqKnNvbWV0aGluZyBodHRwczovL2tleXN0b25lanMuY29tIHNvbWV0aGluZyoqXG4vLyB0aGUgYm9sZCBub2RlIGlzIHRoZSBwYXJlbnQgb2YgdGhlIGxpbmsgbm9kZVxuLy8gYnV0IGluIHNsYXRlLCBtYXJrcyBhcmUgb25seSByZXByZXNlbnRlZCBvbiB0ZXh0IG5vZGVzXG5cbmNvbnN0IGN1cnJlbnRseUFjdGl2ZU1hcmtzID0gbmV3IFNldCgpO1xuY29uc3QgY3VycmVudGx5RGlzYWJsZWRNYXJrcyA9IG5ldyBTZXQoKTtcbmxldCBjdXJyZW50TGluayA9IG51bGw7XG5mdW5jdGlvbiBhZGRNYXJrVG9DaGlsZHJlbihtYXJrLCBjYikge1xuICBjb25zdCB3YXNQcmV2aW91c2x5QWN0aXZlID0gY3VycmVudGx5QWN0aXZlTWFya3MuaGFzKG1hcmspO1xuICBjdXJyZW50bHlBY3RpdmVNYXJrcy5hZGQobWFyayk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGNiKCk7XG4gIH0gZmluYWxseSB7XG4gICAgaWYgKCF3YXNQcmV2aW91c2x5QWN0aXZlKSB7XG4gICAgICBjdXJyZW50bHlBY3RpdmVNYXJrcy5kZWxldGUobWFyayk7XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBzZXRMaW5rRm9yQ2hpbGRyZW4oaHJlZiwgY2IpIHtcbiAgLy8gd2UnbGwgb25seSB1c2UgdGhlIG91dGVyIGxpbmtcbiAgaWYgKGN1cnJlbnRMaW5rICE9PSBudWxsKSB7XG4gICAgcmV0dXJuIGNiKCk7XG4gIH1cbiAgY3VycmVudExpbmsgPSBocmVmO1xuICB0cnkge1xuICAgIHJldHVybiBjYigpO1xuICB9IGZpbmFsbHkge1xuICAgIGN1cnJlbnRMaW5rID0gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgdHlwZSBpcyBtb3JlIHN0cmljdCB0aGFuIGBFbGVtZW50ICYgeyB0eXBlOiAnbGluayc7IH1gIGJlY2F1c2UgYGNoaWxkcmVuYFxuICogaXMgY29uc3RyYWluZWQgdG8gb25seSBjb250YWluIFRleHQgbm9kZXMuIFRoaXMgY2FuJ3QgYmUgYXNzdW1lZCBnZW5lcmFsbHkgYXJvdW5kIHRoZSBlZGl0b3JcbiAqIChiZWNhdXNlIG9mIHBvdGVudGlhbGx5IGZ1dHVyZSBpbmxpbmUgY29tcG9uZW50cyBvciBuZXN0ZWQgbGlua3Mod2hpY2ggYXJlIG5vcm1hbGl6ZWQgYXdheSBidXQgdGhlIGVkaXRvciBuZWVkcyB0byBub3QgYnJlYWsgaWYgaXQgaGFwcGVucykpXG4gKiBidXQgd2hlcmUgdGhpcyB0eXBlIGlzIHVzZWQsIHdlJ3JlIG9ubHkgZ29pbmcgdG8gYWxsb3cgbGlua3MgdG8gY29udGFpbiBUZXh0IGFuZCB0aGF0J3MgaW1wb3J0YW50XG4gKiBzbyB0aGF0IHdlIGtub3cgYSBibG9jayB3aWxsIG5ldmVyIGJlIGluc2lkZSBhbiBpbmxpbmUgYmVjYXVzZSBTbGF0ZSBnZXRzIHVuaGFwcHkgd2hlbiB0aGF0IGhhcHBlbnNcbiAqIChyZWFsbHkgdGhlIGxpbmsgaW5saW5lIHNob3VsZCBwcm9iYWJseSBiZSBhIG1hcmsgcmF0aGVyIHRoYW4gYW4gaW5saW5lLFxuICogbm9uLXZvaWQgaW5saW5lcyBhcmUgcHJvYmFibHkgYWx3YXlzIGJhZCBidXQgdGhhdCB3b3VsZCBpbXBseSBjaGFuZ2luZyB0aGUgZG9jdW1lbnRcbiAqIHN0cnVjdHVyZSB3aGljaCB3b3VsZCBiZSBzdWNoIHVubmVjZXNzYXJ5IGJyZWFrYWdlKVxuICovXG5cbmZ1bmN0aW9uIGdldElubGluZU5vZGVzKHRleHQpIHtcbiAgY29uc3Qgbm9kZSA9IHtcbiAgICB0ZXh0XG4gIH07XG4gIGZvciAoY29uc3QgbWFyayBvZiBjdXJyZW50bHlBY3RpdmVNYXJrcykge1xuICAgIGlmICghY3VycmVudGx5RGlzYWJsZWRNYXJrcy5oYXMobWFyaykpIHtcbiAgICAgIG5vZGVbbWFya10gPSB0cnVlO1xuICAgIH1cbiAgfVxuICBpZiAoY3VycmVudExpbmsgIT09IG51bGwpIHtcbiAgICByZXR1cm4gW3tcbiAgICAgIHRleHQ6ICcnXG4gICAgfSwge1xuICAgICAgdHlwZTogJ2xpbmsnLFxuICAgICAgaHJlZjogY3VycmVudExpbmssXG4gICAgICBjaGlsZHJlbjogW25vZGVdXG4gICAgfSwge1xuICAgICAgdGV4dDogJydcbiAgICB9XTtcbiAgfVxuICByZXR1cm4gW25vZGVdO1xufVxuXG5jbGFzcyBWYXJpYWJsZUNoaWxkRmllbGRzIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcignVGhlcmUgYXJlIGEgdmFyaWFibGUgbnVtYmVyIG9mIGNoaWxkIGZpZWxkcycpO1xuICB9XG59XG5mdW5jdGlvbiBmaW5kU2luZ2xlQ2hpbGRGaWVsZChzY2hlbWEpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBfZmluZENvbnN0YW50Q2hpbGRGaWVsZHMoc2NoZW1hLCBbXSwgbmV3IFNldCgpKTtcbiAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgcmV0dXJuIHJlc3VsdFswXTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBpZiAoZXJyIGluc3RhbmNlb2YgVmFyaWFibGVDaGlsZEZpZWxkcykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aHJvdyBlcnI7XG4gIH1cbn1cbmZ1bmN0aW9uIF9maW5kQ29uc3RhbnRDaGlsZEZpZWxkcyhzY2hlbWEsIHBhdGgsIHNlZW5TY2hlbWFzKSB7XG4gIGlmIChzZWVuU2NoZW1hcy5oYXMoc2NoZW1hKSkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBzZWVuU2NoZW1hcy5hZGQoc2NoZW1hKTtcbiAgc3dpdGNoIChzY2hlbWEua2luZCkge1xuICAgIGNhc2UgJ2Zvcm0nOlxuICAgICAgcmV0dXJuIFtdO1xuICAgIGNhc2UgJ2NoaWxkJzpcbiAgICAgIHJldHVybiBbe1xuICAgICAgICByZWxhdGl2ZVBhdGg6IHBhdGgsXG4gICAgICAgIG9wdGlvbnM6IHNjaGVtYS5vcHRpb25zLFxuICAgICAgICBraW5kOiAnY2hpbGQnXG4gICAgICB9XTtcbiAgICBjYXNlICdjb25kaXRpb25hbCc6XG4gICAgICB7XG4gICAgICAgIGlmIChjb3VsZENvbnRhaW5DaGlsZEZpZWxkKHNjaGVtYSkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVmFyaWFibGVDaGlsZEZpZWxkcygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICBjYXNlICdhcnJheSc6XG4gICAgICB7XG4gICAgICAgIGlmIChzY2hlbWEuYXNDaGlsZFRhZykge1xuICAgICAgICAgIGNvbnN0IGNoaWxkID0gX2ZpbmRDb25zdGFudENoaWxkRmllbGRzKHNjaGVtYS5lbGVtZW50LCBbXSwgc2VlblNjaGVtYXMpO1xuICAgICAgICAgIGlmIChjaGlsZC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBbe1xuICAgICAgICAgICAga2luZDogJ2FycmF5JyxcbiAgICAgICAgICAgIGFzQ2hpbGRUYWc6IHNjaGVtYS5hc0NoaWxkVGFnLFxuICAgICAgICAgICAgZmllbGQ6IHNjaGVtYSxcbiAgICAgICAgICAgIHJlbGF0aXZlUGF0aDogcGF0aCxcbiAgICAgICAgICAgIGNoaWxkOiBjaGlsZFswXVxuICAgICAgICAgIH1dO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb3VsZENvbnRhaW5DaGlsZEZpZWxkKHNjaGVtYSkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVmFyaWFibGVDaGlsZEZpZWxkcygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICBjYXNlICdvYmplY3QnOlxuICAgICAge1xuICAgICAgICBjb25zdCBwYXRocyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhzY2hlbWEuZmllbGRzKSkge1xuICAgICAgICAgIHBhdGhzLnB1c2goLi4uX2ZpbmRDb25zdGFudENoaWxkRmllbGRzKHZhbHVlLCBwYXRoLmNvbmNhdChrZXkpLCBzZWVuU2NoZW1hcykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXRocztcbiAgICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gY291bGRDb250YWluQ2hpbGRGaWVsZChzY2hlbWEsIHNlZW4gPSBuZXcgU2V0KCkpIHtcbiAgaWYgKHNlZW4uaGFzKHNjaGVtYSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgc2Vlbi5hZGQoc2NoZW1hKTtcbiAgc3dpdGNoIChzY2hlbWEua2luZCkge1xuICAgIGNhc2UgJ2Zvcm0nOlxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGNhc2UgJ2NoaWxkJzpcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIGNhc2UgJ2NvbmRpdGlvbmFsJzpcbiAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHNjaGVtYS52YWx1ZXMpLnNvbWUodmFsdWUgPT4gY291bGRDb250YWluQ2hpbGRGaWVsZCh2YWx1ZSwgc2VlbikpO1xuICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICByZXR1cm4gT2JqZWN0LmtleXMoc2NoZW1hLmZpZWxkcykuc29tZShrZXkgPT4gY291bGRDb250YWluQ2hpbGRGaWVsZChzY2hlbWEuZmllbGRzW2tleV0sIHNlZW4pKTtcbiAgICBjYXNlICdhcnJheSc6XG4gICAgICByZXR1cm4gY291bGRDb250YWluQ2hpbGRGaWVsZChzY2hlbWEuZWxlbWVudCwgc2Vlbik7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5saW5lTm9kZUZyb21NYXJrZG9jKG5vZGUpIHtcbiAgaWYgKG5vZGUudHlwZSA9PT0gJ2lubGluZScpIHtcbiAgICByZXR1cm4gaW5saW5lQ2hpbGRyZW5Gcm9tTWFya2RvYyhub2RlLmNoaWxkcmVuKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAnbGluaycpIHtcbiAgICByZXR1cm4gc2V0TGlua0ZvckNoaWxkcmVuKG5vZGUuYXR0cmlidXRlcy5ocmVmLCAoKSA9PiBpbmxpbmVDaGlsZHJlbkZyb21NYXJrZG9jKG5vZGUuY2hpbGRyZW4pKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAndGV4dCcpIHtcbiAgICByZXR1cm4gZ2V0SW5saW5lTm9kZXMobm9kZS5hdHRyaWJ1dGVzLmNvbnRlbnQpO1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICdzdHJvbmcnKSB7XG4gICAgcmV0dXJuIGFkZE1hcmtUb0NoaWxkcmVuKCdib2xkJywgKCkgPT4gaW5saW5lQ2hpbGRyZW5Gcm9tTWFya2RvYyhub2RlLmNoaWxkcmVuKSk7XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ2NvZGUnKSB7XG4gICAgcmV0dXJuIGFkZE1hcmtUb0NoaWxkcmVuKCdjb2RlJywgKCkgPT4gZ2V0SW5saW5lTm9kZXMobm9kZS5hdHRyaWJ1dGVzLmNvbnRlbnQpKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAnZW0nKSB7XG4gICAgcmV0dXJuIGFkZE1hcmtUb0NoaWxkcmVuKCdpdGFsaWMnLCAoKSA9PiBpbmxpbmVDaGlsZHJlbkZyb21NYXJrZG9jKG5vZGUuY2hpbGRyZW4pKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAncycpIHtcbiAgICByZXR1cm4gYWRkTWFya1RvQ2hpbGRyZW4oJ3N0cmlrZXRocm91Z2gnLCAoKSA9PiBpbmxpbmVDaGlsZHJlbkZyb21NYXJrZG9jKG5vZGUuY2hpbGRyZW4pKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAndGFnJykge1xuICAgIGlmIChub2RlLnRhZyA9PT0gJ3UnKSB7XG4gICAgICByZXR1cm4gYWRkTWFya1RvQ2hpbGRyZW4oJ3VuZGVybGluZScsICgpID0+IGlubGluZUNoaWxkcmVuRnJvbU1hcmtkb2Mobm9kZS5jaGlsZHJlbikpO1xuICAgIH1cbiAgICBpZiAobm9kZS50YWcgPT09ICdrYmQnKSB7XG4gICAgICByZXR1cm4gYWRkTWFya1RvQ2hpbGRyZW4oJ2tleWJvYXJkJywgKCkgPT4gaW5saW5lQ2hpbGRyZW5Gcm9tTWFya2RvYyhub2RlLmNoaWxkcmVuKSk7XG4gICAgfVxuICAgIGlmIChub2RlLnRhZyA9PT0gJ3N1YicpIHtcbiAgICAgIHJldHVybiBhZGRNYXJrVG9DaGlsZHJlbignc3Vic2NyaXB0JywgKCkgPT4gaW5saW5lQ2hpbGRyZW5Gcm9tTWFya2RvYyhub2RlLmNoaWxkcmVuKSk7XG4gICAgfVxuICAgIGlmIChub2RlLnRhZyA9PT0gJ3N1cCcpIHtcbiAgICAgIHJldHVybiBhZGRNYXJrVG9DaGlsZHJlbignc3VwZXJzY3JpcHQnLCAoKSA9PiBpbmxpbmVDaGlsZHJlbkZyb21NYXJrZG9jKG5vZGUuY2hpbGRyZW4pKTtcbiAgICB9XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ3NvZnRicmVhaycpIHtcbiAgICByZXR1cm4gZ2V0SW5saW5lTm9kZXMoJyAnKTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAnaGFyZGJyZWFrJykge1xuICAgIHJldHVybiBnZXRJbmxpbmVOb2RlcygnXFxuJyk7XG4gIH1cbiAgaWYgKG5vZGUudGFnID09PSAnY29tcG9uZW50LWlubGluZS1wcm9wJyAmJiBBcnJheS5pc0FycmF5KG5vZGUuYXR0cmlidXRlcy5wcm9wUGF0aCkgJiYgbm9kZS5hdHRyaWJ1dGVzLnByb3BQYXRoLmV2ZXJ5KHggPT4gdHlwZW9mIHggPT09ICdzdHJpbmcnIHx8IHR5cGVvZiB4ID09PSAnbnVtYmVyJykpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ2NvbXBvbmVudC1pbmxpbmUtcHJvcCcsXG4gICAgICBjaGlsZHJlbjogaW5saW5lRnJvbU1hcmtkb2Mobm9kZS5jaGlsZHJlbiksXG4gICAgICBwcm9wUGF0aDogbm9kZS5hdHRyaWJ1dGVzLnByb3BQYXRoXG4gICAgfTtcbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gaW5saW5lIG5vZGUgdHlwZTogJHtub2RlLnR5cGV9YCk7XG59XG5mdW5jdGlvbiBpbmxpbmVDaGlsZHJlbkZyb21NYXJrZG9jKG5vZGVzKSB7XG4gIHJldHVybiBub2Rlcy5mbGF0TWFwKGlubGluZU5vZGVGcm9tTWFya2RvYyk7XG59XG5mdW5jdGlvbiBpbmxpbmVGcm9tTWFya2RvYyhub2Rlcykge1xuICBjb25zdCB0cmFuc2Zvcm1lZE5vZGVzID0gbm9kZXMuZmxhdE1hcChpbmxpbmVOb2RlRnJvbU1hcmtkb2MpO1xuICBjb25zdCBuZXh0Tm9kZXMgPSBbXTtcbiAgbGV0IGxhc3ROb2RlO1xuICBmb3IgKGNvbnN0IFtpZHgsIG5vZGVdIG9mIHRyYW5zZm9ybWVkTm9kZXMuZW50cmllcygpKSB7XG4gICAgdmFyIF9sYXN0Tm9kZTtcbiAgICBpZiAobm9kZS50eXBlID09PSB1bmRlZmluZWQgJiYgbm9kZS50ZXh0ID09PSAnJyAmJiAoKF9sYXN0Tm9kZSA9IGxhc3ROb2RlKSA9PT0gbnVsbCB8fCBfbGFzdE5vZGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9sYXN0Tm9kZS50eXBlKSA9PT0gdW5kZWZpbmVkICYmIGlkeCAhPT0gdHJhbnNmb3JtZWROb2Rlcy5sZW5ndGggLSAxKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgbmV4dE5vZGVzLnB1c2gobm9kZSk7XG4gICAgbGFzdE5vZGUgPSBub2RlO1xuICB9XG4gIGlmICghbmV4dE5vZGVzLmxlbmd0aCkge1xuICAgIG5leHROb2Rlcy5wdXNoKHtcbiAgICAgIHRleHQ6ICcnXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIG5leHROb2Rlcztcbn1cbmZ1bmN0aW9uIGZyb21NYXJrZG9jKG5vZGUsIGNvbXBvbmVudEJsb2Nrcykge1xuICBjb25zdCBub2RlcyA9IG5vZGUuY2hpbGRyZW4uZmxhdE1hcCh4ID0+IGZyb21NYXJrZG9jTm9kZSh4LCBjb21wb25lbnRCbG9ja3MpKTtcbiAgaWYgKG5vZGVzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBbe1xuICAgICAgdHlwZTogJ3BhcmFncmFwaCcsXG4gICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgdGV4dDogJydcbiAgICAgIH1dXG4gICAgfV07XG4gIH1cbiAgaWYgKG5vZGVzW25vZGVzLmxlbmd0aCAtIDFdLnR5cGUgIT09ICdwYXJhZ3JhcGgnKSB7XG4gICAgbm9kZXMucHVzaCh7XG4gICAgICB0eXBlOiAncGFyYWdyYXBoJyxcbiAgICAgIGNoaWxkcmVuOiBbe1xuICAgICAgICB0ZXh0OiAnJ1xuICAgICAgfV1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gbm9kZXM7XG59XG5mdW5jdGlvbiBmcm9tTWFya2RvY05vZGUobm9kZSwgY29tcG9uZW50QmxvY2tzKSB7XG4gIGlmIChub2RlLnR5cGUgPT09ICdibG9ja3F1b3RlJykge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnYmxvY2txdW90ZScsXG4gICAgICBjaGlsZHJlbjogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpXG4gICAgfTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAnZmVuY2UnKSB7XG4gICAgY29uc3Qge1xuICAgICAgbGFuZ3VhZ2UsXG4gICAgICBjb250ZW50LFxuICAgICAgLi4ucmVzdFxuICAgIH0gPSBub2RlLmF0dHJpYnV0ZXM7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdjb2RlJyxcbiAgICAgIGNoaWxkcmVuOiBbe1xuICAgICAgICB0ZXh0OiBjb250ZW50LnJlcGxhY2UoL1xcbiQvLCAnJylcbiAgICAgIH1dLFxuICAgICAgLi4uKHR5cGVvZiBsYW5ndWFnZSA9PT0gJ3N0cmluZycgPyB7XG4gICAgICAgIGxhbmd1YWdlXG4gICAgICB9IDoge30pLFxuICAgICAgLi4ucmVzdFxuICAgIH07XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ2hlYWRpbmcnKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm5vZGUuYXR0cmlidXRlcyxcbiAgICAgIGxldmVsOiBub2RlLmF0dHJpYnV0ZXMubGV2ZWwsXG4gICAgICB0eXBlOiAnaGVhZGluZycsXG4gICAgICBjaGlsZHJlbjogaW5saW5lRnJvbU1hcmtkb2Mobm9kZS5jaGlsZHJlbilcbiAgICB9O1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICdsaXN0Jykge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBub2RlLmF0dHJpYnV0ZXMub3JkZXJlZCA/ICdvcmRlcmVkLWxpc3QnIDogJ3Vub3JkZXJlZC1saXN0JyxcbiAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmZsYXRNYXAoeCA9PiBmcm9tTWFya2RvY05vZGUoeCwgY29tcG9uZW50QmxvY2tzKSlcbiAgICB9O1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICdpdGVtJykge1xuICAgIHZhciBfbm9kZSRjaGlsZHJlbiQ7XG4gICAgY29uc3QgY2hpbGRyZW4gPSBbe1xuICAgICAgdHlwZTogJ2xpc3QtaXRlbS1jb250ZW50JyxcbiAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmxlbmd0aCA/IGlubGluZUZyb21NYXJrZG9jKFtub2RlLmNoaWxkcmVuWzBdXSkgOiBbe1xuICAgICAgICB0ZXh0OiAnJ1xuICAgICAgfV1cbiAgICB9XTtcbiAgICBpZiAoKChfbm9kZSRjaGlsZHJlbiQgPSBub2RlLmNoaWxkcmVuWzFdKSA9PT0gbnVsbCB8fCBfbm9kZSRjaGlsZHJlbiQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ub2RlJGNoaWxkcmVuJC50eXBlKSA9PT0gJ2xpc3QnKSB7XG4gICAgICBjb25zdCBsaXN0ID0gbm9kZS5jaGlsZHJlblsxXTtcbiAgICAgIGNoaWxkcmVuLnB1c2goe1xuICAgICAgICB0eXBlOiBsaXN0LmF0dHJpYnV0ZXMub3JkZXJlZCA/ICdvcmRlcmVkLWxpc3QnIDogJ3Vub3JkZXJlZC1saXN0JyxcbiAgICAgICAgY2hpbGRyZW46IGxpc3QuY2hpbGRyZW4uZmxhdE1hcCh4ID0+IGZyb21NYXJrZG9jTm9kZSh4LCBjb21wb25lbnRCbG9ja3MpKVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnbGlzdC1pdGVtJyxcbiAgICAgIGNoaWxkcmVuXG4gICAgfTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAncGFyYWdyYXBoJykge1xuICAgIGlmIChub2RlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMSAmJiBub2RlLmNoaWxkcmVuWzBdLnR5cGUgPT09ICdpbmxpbmUnICYmIG5vZGUuY2hpbGRyZW5bMF0uY2hpbGRyZW4ubGVuZ3RoID09PSAxICYmIG5vZGUuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0udHlwZSA9PT0gJ2ltYWdlJykge1xuICAgICAgdmFyIF9pbWFnZSRhdHRyaWJ1dGVzJHRpdDtcbiAgICAgIGNvbnN0IGltYWdlID0gbm9kZS5jaGlsZHJlblswXS5jaGlsZHJlblswXTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdpbWFnZScsXG4gICAgICAgIHNyYzogZGVjb2RlVVJJKGltYWdlLmF0dHJpYnV0ZXMuc3JjKSxcbiAgICAgICAgYWx0OiBpbWFnZS5hdHRyaWJ1dGVzLmFsdCxcbiAgICAgICAgdGl0bGU6IChfaW1hZ2UkYXR0cmlidXRlcyR0aXQgPSBpbWFnZS5hdHRyaWJ1dGVzLnRpdGxlKSAhPT0gbnVsbCAmJiBfaW1hZ2UkYXR0cmlidXRlcyR0aXQgIT09IHZvaWQgMCA/IF9pbWFnZSRhdHRyaWJ1dGVzJHRpdCA6ICcnLFxuICAgICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgICB0ZXh0OiAnJ1xuICAgICAgICB9XVxuICAgICAgfTtcbiAgICB9XG4gICAgY29uc3QgY2hpbGRyZW4gPSBpbmxpbmVGcm9tTWFya2RvYyhub2RlLmNoaWxkcmVuKTtcbiAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID09PSAxICYmIGNoaWxkcmVuWzBdLnR5cGUgPT09ICdjb21wb25lbnQtaW5saW5lLXByb3AnKSB7XG4gICAgICByZXR1cm4gY2hpbGRyZW5bMF07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAncGFyYWdyYXBoJyxcbiAgICAgIGNoaWxkcmVuLFxuICAgICAgdGV4dEFsaWduOiBub2RlLmF0dHJpYnV0ZXMudGV4dEFsaWduXG4gICAgfTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAnaHInKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdkaXZpZGVyJyxcbiAgICAgIGNoaWxkcmVuOiBbe1xuICAgICAgICB0ZXh0OiAnJ1xuICAgICAgfV1cbiAgICB9O1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICd0YWJsZScpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ3RhYmxlJyxcbiAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmZsYXRNYXAoeCA9PiBmcm9tTWFya2RvY05vZGUoeCwgY29tcG9uZW50QmxvY2tzKSlcbiAgICB9O1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICd0Ym9keScpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ3RhYmxlLWJvZHknLFxuICAgICAgY2hpbGRyZW46IG5vZGUuY2hpbGRyZW4uZmxhdE1hcCh4ID0+IGZyb21NYXJrZG9jTm9kZSh4LCBjb21wb25lbnRCbG9ja3MpKVxuICAgIH07XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ3RoZWFkJykge1xuICAgIGlmICghbm9kZS5jaGlsZHJlbi5sZW5ndGgpIHJldHVybiBbXTtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ3RhYmxlLWhlYWQnLFxuICAgICAgY2hpbGRyZW46IG5vZGUuY2hpbGRyZW4uZmxhdE1hcCh4ID0+IGZyb21NYXJrZG9jTm9kZSh4LCBjb21wb25lbnRCbG9ja3MpKVxuICAgIH07XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ3RyJykge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAndGFibGUtcm93JyxcbiAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmZsYXRNYXAoeCA9PiBmcm9tTWFya2RvY05vZGUoeCwgY29tcG9uZW50QmxvY2tzKSlcbiAgICB9O1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09ICd0ZCcpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ3RhYmxlLWNlbGwnLFxuICAgICAgY2hpbGRyZW46IG5vZGUuY2hpbGRyZW4uZmxhdE1hcCh4ID0+IGZyb21NYXJrZG9jTm9kZSh4LCBjb21wb25lbnRCbG9ja3MpKVxuICAgIH07XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gJ3RoJykge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAndGFibGUtY2VsbCcsXG4gICAgICBoZWFkZXI6IHRydWUsXG4gICAgICBjaGlsZHJlbjogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpXG4gICAgfTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSAndGFnJykge1xuICAgIGlmIChub2RlLnRhZyA9PT0gJ3RhYmxlJykge1xuICAgICAgcmV0dXJuIGZyb21NYXJrZG9jTm9kZShub2RlLmNoaWxkcmVuWzBdLCBjb21wb25lbnRCbG9ja3MpO1xuICAgIH1cbiAgICBpZiAobm9kZS50YWcgPT09ICdsYXlvdXQnKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnbGF5b3V0JyxcbiAgICAgICAgbGF5b3V0OiBub2RlLmF0dHJpYnV0ZXMubGF5b3V0LFxuICAgICAgICBjaGlsZHJlbjogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpXG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAobm9kZS50YWcgPT09ICdsYXlvdXQtYXJlYScpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdsYXlvdXQtYXJlYScsXG4gICAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmZsYXRNYXAoeCA9PiBmcm9tTWFya2RvY05vZGUoeCwgY29tcG9uZW50QmxvY2tzKSlcbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChub2RlLnRhZyA9PT0gJ2NvbXBvbmVudC1ibG9jaycpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdjb21wb25lbnQtYmxvY2snLFxuICAgICAgICBjb21wb25lbnQ6IG5vZGUuYXR0cmlidXRlcy5jb21wb25lbnQsXG4gICAgICAgIHByb3BzOiBub2RlLmF0dHJpYnV0ZXMucHJvcHMsXG4gICAgICAgIGNoaWxkcmVuOiBub2RlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCA/IFt7XG4gICAgICAgICAgdHlwZTogJ2NvbXBvbmVudC1pbmxpbmUtcHJvcCcsXG4gICAgICAgICAgY2hpbGRyZW46IFt7XG4gICAgICAgICAgICB0ZXh0OiAnJ1xuICAgICAgICAgIH1dXG4gICAgICAgIH1dIDogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpXG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAobm9kZS50YWcgPT09ICdjb21wb25lbnQtYmxvY2stcHJvcCcgJiYgQXJyYXkuaXNBcnJheShub2RlLmF0dHJpYnV0ZXMucHJvcFBhdGgpICYmIG5vZGUuYXR0cmlidXRlcy5wcm9wUGF0aC5ldmVyeSh4ID0+IHR5cGVvZiB4ID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgeCA9PT0gJ251bWJlcicpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnY29tcG9uZW50LWJsb2NrLXByb3AnLFxuICAgICAgICBjaGlsZHJlbjogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpLFxuICAgICAgICBwcm9wUGF0aDogbm9kZS5hdHRyaWJ1dGVzLnByb3BQYXRoXG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAobm9kZS50YWcpIHtcbiAgICAgIGNvbnN0IGNvbXBvbmVudEJsb2NrID0gY29tcG9uZW50QmxvY2tzW25vZGUudGFnXTtcbiAgICAgIGlmIChjb21wb25lbnRCbG9jaykge1xuICAgICAgICBjb25zdCBzaW5nbGVDaGlsZEZpZWxkID0gZmluZFNpbmdsZUNoaWxkRmllbGQoe1xuICAgICAgICAgIGtpbmQ6ICdvYmplY3QnLFxuICAgICAgICAgIGZpZWxkczogY29tcG9uZW50QmxvY2suc2NoZW1hXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoc2luZ2xlQ2hpbGRGaWVsZCkge1xuICAgICAgICAgIGNvbnN0IG5ld0F0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG5vZGUuYXR0cmlidXRlcykpO1xuICAgICAgICAgIGNvbnN0IGNoaWxkcmVuID0gW107XG4gICAgICAgICAgdG9DaGlsZHJlbkFuZFByb3BzKG5vZGUuY2hpbGRyZW4sIGNoaWxkcmVuLCBuZXdBdHRyaWJ1dGVzLCBzaW5nbGVDaGlsZEZpZWxkLCBbXSwgY29tcG9uZW50QmxvY2tzKTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ2NvbXBvbmVudC1ibG9jaycsXG4gICAgICAgICAgICBjb21wb25lbnQ6IG5vZGUudGFnLFxuICAgICAgICAgICAgcHJvcHM6IG5ld0F0dHJpYnV0ZXMsXG4gICAgICAgICAgICBjaGlsZHJlblxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiAnY29tcG9uZW50LWJsb2NrJyxcbiAgICAgICAgICBjb21wb25lbnQ6IG5vZGUudGFnLFxuICAgICAgICAgIHByb3BzOiBub2RlLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgY2hpbGRyZW46IG5vZGUuY2hpbGRyZW4ubGVuZ3RoID09PSAwID8gW3tcbiAgICAgICAgICAgIHR5cGU6ICdjb21wb25lbnQtaW5saW5lLXByb3AnLFxuICAgICAgICAgICAgY2hpbGRyZW46IFt7XG4gICAgICAgICAgICAgIHRleHQ6ICcnXG4gICAgICAgICAgICB9XVxuICAgICAgICAgIH1dIDogbm9kZS5jaGlsZHJlbi5mbGF0TWFwKHggPT4gZnJvbU1hcmtkb2NOb2RlKHgsIGNvbXBvbmVudEJsb2NrcykpXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biB0YWc6ICR7bm9kZS50YWd9YCk7XG4gIH1cbiAgcmV0dXJuIGlubGluZU5vZGVGcm9tTWFya2RvYyhub2RlKTtcbn1cbmZ1bmN0aW9uIHRvQ2hpbGRyZW5BbmRQcm9wcyhmcm9tTWFya2RvYywgcmVzdWx0aW5nQ2hpbGRyZW4sIHZhbHVlLCBzaW5nbGVDaGlsZEZpZWxkLCBwYXJlbnRQcm9wUGF0aCwgY29tcG9uZW50QmxvY2tzKSB7XG4gIGlmIChzaW5nbGVDaGlsZEZpZWxkLmtpbmQgPT09ICdjaGlsZCcpIHtcbiAgICBjb25zdCBjaGlsZHJlbiA9IGZyb21NYXJrZG9jLmZsYXRNYXAoeCA9PiBmcm9tTWFya2RvY05vZGUoeCwgY29tcG9uZW50QmxvY2tzKSk7XG4gICAgcmVzdWx0aW5nQ2hpbGRyZW4ucHVzaCh7XG4gICAgICB0eXBlOiBgY29tcG9uZW50LSR7c2luZ2xlQ2hpbGRGaWVsZC5vcHRpb25zLmtpbmR9LXByb3BgLFxuICAgICAgcHJvcFBhdGg6IFsuLi5wYXJlbnRQcm9wUGF0aCwgLi4uc2luZ2xlQ2hpbGRGaWVsZC5yZWxhdGl2ZVBhdGhdLFxuICAgICAgY2hpbGRyZW5cbiAgICB9KTtcbiAgfVxuICBpZiAoc2luZ2xlQ2hpbGRGaWVsZC5raW5kID09PSAnYXJyYXknKSB7XG4gICAgY29uc3QgYXJyID0gW107XG4gICAgZm9yIChsZXQgW2lkeCwgY2hpbGRdIG9mIGZyb21NYXJrZG9jLmVudHJpZXMoKSkge1xuICAgICAgaWYgKGNoaWxkLnR5cGUgPT09ICdwYXJhZ3JhcGgnKSB7XG4gICAgICAgIGNoaWxkID0gY2hpbGQuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF07XG4gICAgICB9XG4gICAgICBpZiAoY2hpbGQudHlwZSAhPT0gJ3RhZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBleHBlY3RlZCB0YWcgJHtzaW5nbGVDaGlsZEZpZWxkLmFzQ2hpbGRUYWd9LCBmb3VuZCB0eXBlOiAke2NoaWxkLnR5cGV9YCk7XG4gICAgICB9XG4gICAgICBpZiAoY2hpbGQudGFnICE9PSBzaW5nbGVDaGlsZEZpZWxkLmFzQ2hpbGRUYWcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBleHBlY3RlZCB0YWcgJHtzaW5nbGVDaGlsZEZpZWxkLmFzQ2hpbGRUYWd9LCBmb3VuZCB0YWc6ICR7Y2hpbGQudGFnfWApO1xuICAgICAgfVxuICAgICAgY29uc3QgYXR0cmlidXRlcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY2hpbGQuYXR0cmlidXRlcykpO1xuICAgICAgaWYgKHNpbmdsZUNoaWxkRmllbGQuY2hpbGQpIHtcbiAgICAgICAgdG9DaGlsZHJlbkFuZFByb3BzKGNoaWxkLmNoaWxkcmVuLCByZXN1bHRpbmdDaGlsZHJlbiwgYXR0cmlidXRlcywgc2luZ2xlQ2hpbGRGaWVsZC5jaGlsZCwgWy4uLnBhcmVudFByb3BQYXRoLCAuLi5zaW5nbGVDaGlsZEZpZWxkLnJlbGF0aXZlUGF0aCwgaWR4XSwgY29tcG9uZW50QmxvY2tzKTtcbiAgICAgIH1cbiAgICAgIGFyci5wdXNoKGF0dHJpYnV0ZXMpO1xuICAgIH1cbiAgICBjb25zdCBrZXkgPSBzaW5nbGVDaGlsZEZpZWxkLnJlbGF0aXZlUGF0aFtzaW5nbGVDaGlsZEZpZWxkLnJlbGF0aXZlUGF0aC5sZW5ndGggLSAxXTtcbiAgICBjb25zdCBwYXJlbnQgPSBnZXRWYWx1ZUF0UHJvcFBhdGgodmFsdWUsIHNpbmdsZUNoaWxkRmllbGQucmVsYXRpdmVQYXRoLnNsaWNlKDAsIC0xKSk7XG4gICAgcGFyZW50W2tleV0gPSBhcnI7XG4gIH1cbn1cblxuLy8gdGhlc2UgYXJlIGludGVudGlvbmFsbHkgbW9yZSByZXN0cmljdGl2ZSB0aGFuIHRoZSB0eXBlcyBhbGxvd2VkIGJ5IHN0cm9uZyBhbmQgd2VhayBtYXBzXG5cbmNvbnN0IGVtcHR5Q2FjaGVOb2RlID0gU3ltYm9sKCdlbXB0eUNhY2hlTm9kZScpO1xuXG4vLyB3ZWFrIGtleXMgc2hvdWxkIGFsd2F5cyBjb21lIGJlZm9yZSBzdHJvbmcga2V5cyBpbiB0aGUgYXJndW1lbnRzIHRob3VnaCB0aGF0IGNhbm5vdCBiZSBlbmZvcmNlZCB3aXRoIHR5cGVzXG5mdW5jdGlvbiBtZW1vaXplKGZ1bmMpIHtcbiAgY29uc3QgY2FjaGVOb2RlID0ge1xuICAgIHZhbHVlOiBlbXB0eUNhY2hlTm9kZSxcbiAgICBzdHJvbmc6IHVuZGVmaW5lZCxcbiAgICB3ZWFrOiB1bmRlZmluZWRcbiAgfTtcbiAgcmV0dXJuICguLi5hcmdzKSA9PiB7XG4gICAgbGV0IGN1cnJlbnRDYWNoZU5vZGUgPSBjYWNoZU5vZGU7XG4gICAgZm9yIChjb25zdCBhcmcgb2YgYXJncykge1xuICAgICAgaWYgKHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBhcmcgPT09ICdudW1iZXInKSB7XG4gICAgICAgIGlmIChjdXJyZW50Q2FjaGVOb2RlLnN0cm9uZyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgY3VycmVudENhY2hlTm9kZS5zdHJvbmcgPSBuZXcgTWFwKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFjdXJyZW50Q2FjaGVOb2RlLnN0cm9uZy5oYXMoYXJnKSkge1xuICAgICAgICAgIGN1cnJlbnRDYWNoZU5vZGUuc3Ryb25nLnNldChhcmcsIHtcbiAgICAgICAgICAgIHZhbHVlOiBlbXB0eUNhY2hlTm9kZSxcbiAgICAgICAgICAgIHN0cm9uZzogdW5kZWZpbmVkLFxuICAgICAgICAgICAgd2VhazogdW5kZWZpbmVkXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY3VycmVudENhY2hlTm9kZSA9IGN1cnJlbnRDYWNoZU5vZGUuc3Ryb25nLmdldChhcmcpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgYXJnID09PSAnb2JqZWN0Jykge1xuICAgICAgICBpZiAoY3VycmVudENhY2hlTm9kZS53ZWFrID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBjdXJyZW50Q2FjaGVOb2RlLndlYWsgPSBuZXcgV2Vha01hcCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY3VycmVudENhY2hlTm9kZS53ZWFrLmhhcyhhcmcpKSB7XG4gICAgICAgICAgY3VycmVudENhY2hlTm9kZS53ZWFrLnNldChhcmcsIHtcbiAgICAgICAgICAgIHZhbHVlOiBlbXB0eUNhY2hlTm9kZSxcbiAgICAgICAgICAgIHN0cm9uZzogdW5kZWZpbmVkLFxuICAgICAgICAgICAgd2VhazogdW5kZWZpbmVkXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY3VycmVudENhY2hlTm9kZSA9IGN1cnJlbnRDYWNoZU5vZGUud2Vhay5nZXQoYXJnKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjdXJyZW50Q2FjaGVOb2RlLnZhbHVlICE9PSBlbXB0eUNhY2hlTm9kZSkge1xuICAgICAgcmV0dXJuIGN1cnJlbnRDYWNoZU5vZGUudmFsdWU7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IGZ1bmMoLi4uYXJncyk7XG4gICAgY3VycmVudENhY2hlTm9kZS52YWx1ZSA9IHJlc3VsdDtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xufVxuXG5mdW5jdGlvbiBmaXhQYXRoKHBhdGgpIHtcbiAgcmV0dXJuIHBhdGgucmVwbGFjZSgvXlxcLj9cXC8rLywgJycpLnJlcGxhY2UoL1xcLyokLywgJycpO1xufVxuY29uc3QgY29sbGVjdGlvblBhdGggPSAvXFwvXFwqXFwqPyg/OiR8XFwvKS87XG5mdW5jdGlvbiBnZXRDb25maWd1cmVkQ29sbGVjdGlvblBhdGgoY29uZmlnLCBjb2xsZWN0aW9uKSB7XG4gIHZhciBfY29sbGVjdGlvbkNvbmZpZyRwYXQ7XG4gIGNvbnN0IGNvbGxlY3Rpb25Db25maWcgPSBjb25maWcuY29sbGVjdGlvbnNbY29sbGVjdGlvbl07XG4gIGNvbnN0IHBhdGggPSAoX2NvbGxlY3Rpb25Db25maWckcGF0ID0gY29sbGVjdGlvbkNvbmZpZy5wYXRoKSAhPT0gbnVsbCAmJiBfY29sbGVjdGlvbkNvbmZpZyRwYXQgIT09IHZvaWQgMCA/IF9jb2xsZWN0aW9uQ29uZmlnJHBhdCA6IGAke2NvbGxlY3Rpb259LyovYDtcbiAgaWYgKCFjb2xsZWN0aW9uUGF0aC50ZXN0KHBhdGgpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBDb2xsZWN0aW9uIHBhdGggbXVzdCBlbmQgd2l0aCAvKiBvciAvKiogb3IgaW5jbHVkZSAvKi8gb3IgLyoqLyBidXQgJHtjb2xsZWN0aW9ufSBoYXMgJHtwYXRofWApO1xuICB9XG4gIHJldHVybiBwYXRoO1xufVxuZnVuY3Rpb24gZ2V0Q29sbGVjdGlvblBhdGgoY29uZmlnLCBjb2xsZWN0aW9uKSB7XG4gIGNvbnN0IGNvbmZpZ3VyZWRQYXRoID0gZ2V0Q29uZmlndXJlZENvbGxlY3Rpb25QYXRoKGNvbmZpZywgY29sbGVjdGlvbik7XG4gIGNvbnN0IHBhdGggPSBmaXhQYXRoKGNvbmZpZ3VyZWRQYXRoLnJlcGxhY2UoL1xcKlxcKj8uKiQvLCAnJykpO1xuICByZXR1cm4gcGF0aDtcbn1cbmZ1bmN0aW9uIGdldENvbGxlY3Rpb25Gb3JtYXQoY29uZmlnLCBjb2xsZWN0aW9uKSB7XG4gIHJldHVybiBnZXRGb3JtYXRJbmZvKGNvbmZpZywgJ2NvbGxlY3Rpb25zJywgY29sbGVjdGlvbik7XG59XG5mdW5jdGlvbiBnZXRTaW5nbGV0b25Gb3JtYXQoY29uZmlnLCBzaW5nbGV0b24pIHtcbiAgcmV0dXJuIGdldEZvcm1hdEluZm8oY29uZmlnLCAnc2luZ2xldG9ucycsIHNpbmdsZXRvbik7XG59XG5mdW5jdGlvbiBnZXRDb2xsZWN0aW9uSXRlbVBhdGgoY29uZmlnLCBjb2xsZWN0aW9uLCBzbHVnKSB7XG4gIGNvbnN0IGJhc2VQYXRoID0gZ2V0Q29sbGVjdGlvblBhdGgoY29uZmlnLCBjb2xsZWN0aW9uKTtcbiAgY29uc3Qgc3VmZml4ID0gZ2V0Q29sbGVjdGlvbkl0ZW1TbHVnU3VmZml4KGNvbmZpZywgY29sbGVjdGlvbik7XG4gIHJldHVybiBgJHtiYXNlUGF0aH0vJHtzbHVnfSR7c3VmZml4fWA7XG59XG5mdW5jdGlvbiBnZXRFbnRyeURhdGFGaWxlcGF0aChkaXIsIGZvcm1hdEluZm8pIHtcbiAgcmV0dXJuIGAke2Rpcn0ke2Zvcm1hdEluZm8uZGF0YUxvY2F0aW9uID09PSAnaW5kZXgnID8gJy9pbmRleCcgOiAnJ30ke2dldERhdGFGaWxlRXh0ZW5zaW9uKGZvcm1hdEluZm8pfWA7XG59XG5mdW5jdGlvbiBnZXRTbHVnR2xvYkZvckNvbGxlY3Rpb24oY29uZmlnLCBjb2xsZWN0aW9uKSB7XG4gIGNvbnN0IGNvbGxlY3Rpb25QYXRoID0gZ2V0Q29uZmlndXJlZENvbGxlY3Rpb25QYXRoKGNvbmZpZywgY29sbGVjdGlvbik7XG4gIHJldHVybiBjb2xsZWN0aW9uUGF0aC5pbmNsdWRlcygnKionKSA/ICcqKicgOiAnKic7XG59XG5mdW5jdGlvbiBnZXRDb2xsZWN0aW9uSXRlbVNsdWdTdWZmaXgoY29uZmlnLCBjb2xsZWN0aW9uKSB7XG4gIGNvbnN0IGNvbmZpZ3VyZWRQYXRoID0gZ2V0Q29uZmlndXJlZENvbGxlY3Rpb25QYXRoKGNvbmZpZywgY29sbGVjdGlvbik7XG4gIGNvbnN0IHBhdGggPSBmaXhQYXRoKGNvbmZpZ3VyZWRQYXRoLnJlcGxhY2UoL15bXipdK1xcKlxcKj8vLCAnJykpO1xuICByZXR1cm4gcGF0aCA/IGAvJHtwYXRofWAgOiAnJztcbn1cbmZ1bmN0aW9uIGdldFNpbmdsZXRvblBhdGgoY29uZmlnLCBzaW5nbGV0b24pIHtcbiAgdmFyIF9zaW5nbGV0b24kcGF0aCwgX3NpbmdsZXRvbiRwYXRoMjtcbiAgaWYgKChfc2luZ2xldG9uJHBhdGggPSBjb25maWcuc2luZ2xldG9uc1tzaW5nbGV0b25dLnBhdGgpICE9PSBudWxsICYmIF9zaW5nbGV0b24kcGF0aCAhPT0gdm9pZCAwICYmIF9zaW5nbGV0b24kcGF0aC5pbmNsdWRlcygnKicpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBTaW5nbGV0b24gcGF0aHMgY2Fubm90IGluY2x1ZGUgKiBidXQgJHtzaW5nbGV0b259IGhhcyAke2NvbmZpZy5zaW5nbGV0b25zW3NpbmdsZXRvbl0ucGF0aH1gKTtcbiAgfVxuICByZXR1cm4gZml4UGF0aCgoX3NpbmdsZXRvbiRwYXRoMiA9IGNvbmZpZy5zaW5nbGV0b25zW3NpbmdsZXRvbl0ucGF0aCkgIT09IG51bGwgJiYgX3NpbmdsZXRvbiRwYXRoMiAhPT0gdm9pZCAwID8gX3NpbmdsZXRvbiRwYXRoMiA6IHNpbmdsZXRvbik7XG59XG5mdW5jdGlvbiBnZXREYXRhRmlsZUV4dGVuc2lvbihmb3JtYXRJbmZvKSB7XG4gIHJldHVybiBmb3JtYXRJbmZvLmNvbnRlbnRGaWVsZCA/IGZvcm1hdEluZm8uY29udGVudEZpZWxkLmNvbnRlbnRFeHRlbnNpb24gOiAnLicgKyBmb3JtYXRJbmZvLmRhdGE7XG59XG5jb25zdCBnZXRGb3JtYXRJbmZvID0gbWVtb2l6ZShfZ2V0Rm9ybWF0SW5mbyk7XG5mdW5jdGlvbiBfZ2V0Rm9ybWF0SW5mbyhjb25maWcsIHR5cGUsIGtleSkge1xuICB2YXIgX2NvbGxlY3Rpb25PclNpbmdsZXRvLCBfZm9ybWF0JGRhdGE7XG4gIGNvbnN0IGNvbGxlY3Rpb25PclNpbmdsZXRvbiA9IHR5cGUgPT09ICdjb2xsZWN0aW9ucycgPyBjb25maWcuY29sbGVjdGlvbnNba2V5XSA6IGNvbmZpZy5zaW5nbGV0b25zW2tleV07XG4gIGNvbnN0IHBhdGggPSB0eXBlID09PSAnY29sbGVjdGlvbnMnID8gZ2V0Q29uZmlndXJlZENvbGxlY3Rpb25QYXRoKGNvbmZpZywga2V5KSA6IChfY29sbGVjdGlvbk9yU2luZ2xldG8gPSBjb2xsZWN0aW9uT3JTaW5nbGV0b24ucGF0aCkgIT09IG51bGwgJiYgX2NvbGxlY3Rpb25PclNpbmdsZXRvICE9PSB2b2lkIDAgPyBfY29sbGVjdGlvbk9yU2luZ2xldG8gOiBgJHtrZXl9L2A7XG4gIGNvbnN0IGRhdGFMb2NhdGlvbiA9IHBhdGguZW5kc1dpdGgoJy8nKSA/ICdpbmRleCcgOiAnb3V0ZXInO1xuICBjb25zdCB7XG4gICAgc2NoZW1hLFxuICAgIGZvcm1hdCA9ICd5YW1sJ1xuICB9ID0gY29sbGVjdGlvbk9yU2luZ2xldG9uO1xuICBpZiAodHlwZW9mIGZvcm1hdCA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZGF0YUxvY2F0aW9uLFxuICAgICAgY29udGVudEZpZWxkOiB1bmRlZmluZWQsXG4gICAgICBkYXRhOiBmb3JtYXRcbiAgICB9O1xuICB9XG4gIGxldCBjb250ZW50RmllbGQ7XG4gIGlmIChmb3JtYXQuY29udGVudEZpZWxkKSB7XG4gICAgbGV0IGZpZWxkID0ge1xuICAgICAga2luZDogJ29iamVjdCcsXG4gICAgICBmaWVsZHM6IHNjaGVtYVxuICAgIH07XG4gICAgbGV0IHBhdGggPSBBcnJheS5pc0FycmF5KGZvcm1hdC5jb250ZW50RmllbGQpID8gZm9ybWF0LmNvbnRlbnRGaWVsZCA6IFtmb3JtYXQuY29udGVudEZpZWxkXTtcbiAgICBsZXQgY29udGVudEV4dGVuc2lvbjtcbiAgICB0cnkge1xuICAgICAgY29udGVudEV4dGVuc2lvbiA9IGdldENvbnRlbnRFeHRlbnNpb24ocGF0aCwgZmllbGQsICgpID0+IEpTT04uc3RyaW5naWZ5KGZvcm1hdC5jb250ZW50RmllbGQpKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBDb250ZW50RmllbGRMb2NhdGlvbkVycm9yKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtlcnIubWVzc2FnZX0gKCR7dHlwZX0uJHtrZXl9KWApO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICBjb250ZW50RmllbGQgPSB7XG4gICAgICBwYXRoLFxuICAgICAgY29udGVudEV4dGVuc2lvblxuICAgIH07XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBkYXRhOiAoX2Zvcm1hdCRkYXRhID0gZm9ybWF0LmRhdGEpICE9PSBudWxsICYmIF9mb3JtYXQkZGF0YSAhPT0gdm9pZCAwID8gX2Zvcm1hdCRkYXRhIDogJ3lhbWwnLFxuICAgIGNvbnRlbnRGaWVsZCxcbiAgICBkYXRhTG9jYXRpb25cbiAgfTtcbn1cbmNsYXNzIENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgfVxufVxuZnVuY3Rpb24gZ2V0Q29udGVudEV4dGVuc2lvbihwYXRoLCBzY2hlbWEsIGRlYnVnTmFtZSkge1xuICBpZiAocGF0aC5sZW5ndGggPT09IDApIHtcbiAgICBpZiAoc2NoZW1hLmtpbmQgIT09ICdmb3JtJyB8fCBzY2hlbWEuZm9ybUtpbmQgIT09ICdjb250ZW50Jykge1xuICAgICAgdGhyb3cgbmV3IENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IoYENvbnRlbnQgZmllbGQgZm9yICR7ZGVidWdOYW1lKCl9IGlzIG5vdCBhIGNvbnRlbnQgZmllbGRgKTtcbiAgICB9XG4gICAgcmV0dXJuIHNjaGVtYS5jb250ZW50RXh0ZW5zaW9uO1xuICB9XG4gIGlmIChzY2hlbWEua2luZCA9PT0gJ29iamVjdCcpIHtcbiAgICBjb25zdCBmaWVsZCA9IHNjaGVtYS5maWVsZHNbcGF0aFswXV07XG4gICAgaWYgKCFmaWVsZCkge1xuICAgICAgdGhyb3cgbmV3IENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IoYEZpZWxkICR7ZGVidWdOYW1lKCl9IHNwZWNpZmllZCBpbiBjb250ZW50RmllbGQgZG9lcyBub3QgZXhpc3RgKTtcbiAgICB9XG4gICAgcmV0dXJuIGdldENvbnRlbnRFeHRlbnNpb24ocGF0aC5zbGljZSgxKSwgZmllbGQsIGRlYnVnTmFtZSk7XG4gIH1cbiAgaWYgKHNjaGVtYS5raW5kID09PSAnY29uZGl0aW9uYWwnKSB7XG4gICAgaWYgKHBhdGhbMF0gIT09ICd2YWx1ZScpIHtcbiAgICAgIHRocm93IG5ldyBDb250ZW50RmllbGRMb2NhdGlvbkVycm9yKGBDb25kaXRpb25hbCBmaWVsZHMgcmVmZXJlbmNlZCBpbiBhIGNvbnRlbnRGaWVsZCBwYXRoIG11c3Qgb25seSByZWZlcmVuY2UgdGhlIHZhbHVlIGZpZWxkICgke2RlYnVnTmFtZSgpfSlgKTtcbiAgICB9XG4gICAgbGV0IGNvbnRlbnRFeHRlbnNpb247XG4gICAgY29uc3QgaW5uZXJQYXRoID0gcGF0aC5zbGljZSgxKTtcbiAgICBmb3IgKGNvbnN0IHZhbHVlIG9mIE9iamVjdC52YWx1ZXMoc2NoZW1hLnZhbHVlcykpIHtcbiAgICAgIGNvbnN0IGZvdW5kQ29udGVudEV4dGVuc2lvbiA9IGdldENvbnRlbnRFeHRlbnNpb24oaW5uZXJQYXRoLCB2YWx1ZSwgZGVidWdOYW1lKTtcbiAgICAgIGlmICghY29udGVudEV4dGVuc2lvbikge1xuICAgICAgICBjb250ZW50RXh0ZW5zaW9uID0gZm91bmRDb250ZW50RXh0ZW5zaW9uO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmIChjb250ZW50RXh0ZW5zaW9uICE9PSBmb3VuZENvbnRlbnRFeHRlbnNpb24pIHtcbiAgICAgICAgdGhyb3cgbmV3IENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IoYGNvbnRlbnRGaWVsZCAke2RlYnVnTmFtZSgpfSBoYXMgY29uZmxpY3RpbmcgY29udGVudCBleHRlbnNpb25zYCk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghY29udGVudEV4dGVuc2lvbikge1xuICAgICAgdGhyb3cgbmV3IENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IoYGNvbnRlbnRGaWVsZCAke2RlYnVnTmFtZSgpfSBkb2VzIG5vdCBwb2ludCB0byBhIGNvbnRlbnQgZmllbGRgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbnRlbnRFeHRlbnNpb247XG4gIH1cbiAgdGhyb3cgbmV3IENvbnRlbnRGaWVsZExvY2F0aW9uRXJyb3IoYFBhdGggc3BlY2lmaWVkIGluIGNvbnRlbnRGaWVsZCAke2RlYnVnTmFtZSgpfSBkb2VzIG5vdCBwb2ludCB0byBhIGNvbnRlbnQgZmllbGRgKTtcbn1cblxuZnVuY3Rpb24gZ2V0U3JjUHJlZml4KHB1YmxpY1BhdGgsIHNsdWcpIHtcbiAgcmV0dXJuIHR5cGVvZiBwdWJsaWNQYXRoID09PSAnc3RyaW5nJyA/IGAke3B1YmxpY1BhdGgucmVwbGFjZSgvXFwvKiQvLCAnJyl9LyR7c2x1ZyA9PT0gdW5kZWZpbmVkID8gJycgOiBzbHVnICsgJy8nfWAgOiAnJztcbn1cblxuZnVuY3Rpb24gZGVzZXJpYWxpemVGaWxlcyhub2RlcywgY29tcG9uZW50QmxvY2tzLCBmaWxlcywgb3RoZXJGaWxlcywgbW9kZSwgZG9jdW1lbnRGZWF0dXJlcywgc2x1Zykge1xuICByZXR1cm4gbm9kZXMubWFwKG5vZGUgPT4ge1xuICAgIGlmIChub2RlLnR5cGUgPT09ICdjb21wb25lbnQtYmxvY2snKSB7XG4gICAgICBjb25zdCBjb21wb25lbnRCbG9jayA9IGNvbXBvbmVudEJsb2Nrc1tub2RlLmNvbXBvbmVudF07XG4gICAgICBpZiAoIWNvbXBvbmVudEJsb2NrKSByZXR1cm4gbm9kZTtcbiAgICAgIGNvbnN0IHNjaGVtYSA9IG9iamVjdChjb21wb25lbnRCbG9jay5zY2hlbWEpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4ubm9kZSxcbiAgICAgICAgcHJvcHM6IGRlc2VyaWFsaXplUHJvcHMoc2NoZW1hLCBub2RlLnByb3BzLCBmaWxlcywgb3RoZXJGaWxlcywgbW9kZSwgc2x1ZylcbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChub2RlLnR5cGUgPT09ICdpbWFnZScgJiYgdHlwZW9mIG5vZGUuc3JjID09PSAnc3RyaW5nJyAmJiBtb2RlID09PSAnZWRpdCcpIHtcbiAgICAgIHZhciBfcmVmO1xuICAgICAgY29uc3QgcHJlZml4ID0gZ2V0U3JjUHJlZml4Rm9ySW1hZ2VCbG9jayhkb2N1bWVudEZlYXR1cmVzLCBzbHVnKTtcbiAgICAgIGNvbnN0IGZpbGVuYW1lID0gbm9kZS5zcmMuc2xpY2UocHJlZml4Lmxlbmd0aCk7XG4gICAgICBjb25zdCBjb250ZW50ID0gKF9yZWYgPSB0eXBlb2YgZG9jdW1lbnRGZWF0dXJlcy5pbWFnZXMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBkb2N1bWVudEZlYXR1cmVzLmltYWdlcy5kaXJlY3RvcnkgPT09ICdzdHJpbmcnID8gb3RoZXJGaWxlcy5nZXQoZml4UGF0aChkb2N1bWVudEZlYXR1cmVzLmltYWdlcy5kaXJlY3RvcnkpKSA6IGZpbGVzKSA9PT0gbnVsbCB8fCBfcmVmID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcmVmLmdldChmaWxlbmFtZSk7XG4gICAgICBpZiAoIWNvbnRlbnQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiAncGFyYWdyYXBoJyxcbiAgICAgICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgICAgIHRleHQ6IGBNaXNzaW5nIGltYWdlICR7ZmlsZW5hbWV9YFxuICAgICAgICAgIH1dXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnaW1hZ2UnLFxuICAgICAgICBzcmM6IHtcbiAgICAgICAgICBmaWxlbmFtZSxcbiAgICAgICAgICBjb250ZW50XG4gICAgICAgIH0sXG4gICAgICAgIGFsdDogbm9kZS5hbHQsXG4gICAgICAgIHRpdGxlOiBub2RlLnRpdGxlLFxuICAgICAgICBjaGlsZHJlbjogW3tcbiAgICAgICAgICB0ZXh0OiAnJ1xuICAgICAgICB9XVxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBub2RlLnR5cGUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBjb25zdCBjaGlsZHJlbiA9IGRlc2VyaWFsaXplRmlsZXMobm9kZS5jaGlsZHJlbiwgY29tcG9uZW50QmxvY2tzLCBmaWxlcywgb3RoZXJGaWxlcywgbW9kZSwgZG9jdW1lbnRGZWF0dXJlcywgc2x1Zyk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5ub2RlLFxuICAgICAgICBjaGlsZHJlblxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIG5vZGU7XG4gIH0pO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVQcm9wcyhzY2hlbWEsIHZhbHVlLCBmaWxlcywgb3RoZXJGaWxlcywgbW9kZSwgc2x1Zykge1xuICByZXR1cm4gdHJhbnNmb3JtUHJvcHMoc2NoZW1hLCB2YWx1ZSwge1xuICAgIGZvcm06IChzY2hlbWEsIHZhbHVlKSA9PiB7XG4gICAgICBpZiAoc2NoZW1hLmZvcm1LaW5kID09PSAnYXNzZXQnKSB7XG4gICAgICAgIHZhciBfb3RoZXJGaWxlcyRnZXQ7XG4gICAgICAgIGlmIChtb2RlID09PSAncmVhZCcpIHtcbiAgICAgICAgICByZXR1cm4gc2NoZW1hLnJlYWRlci5wYXJzZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBzY2hlbWEuZmlsZW5hbWUodmFsdWUsIHtcbiAgICAgICAgICBzbHVnLFxuICAgICAgICAgIHN1Z2dlc3RlZEZpbGVuYW1lUHJlZml4OiB1bmRlZmluZWRcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzY2hlbWEucGFyc2UodmFsdWUsIHtcbiAgICAgICAgICBhc3NldDogZmlsZW5hbWUgPyBzY2hlbWEuZGlyZWN0b3J5ID8gKF9vdGhlckZpbGVzJGdldCA9IG90aGVyRmlsZXMuZ2V0KHNjaGVtYS5kaXJlY3RvcnkpKSA9PT0gbnVsbCB8fCBfb3RoZXJGaWxlcyRnZXQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9vdGhlckZpbGVzJGdldC5nZXQoZmlsZW5hbWUpIDogZmlsZXMuZ2V0KGZpbGVuYW1lKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICBzbHVnXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHNjaGVtYS5mb3JtS2luZCA9PT0gJ2NvbnRlbnQnIHx8IHNjaGVtYS5mb3JtS2luZCA9PT0gJ2Fzc2V0cycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOb3QgaW1wbGVtZW50ZWQnKTtcbiAgICAgIH1cbiAgICAgIGlmIChtb2RlID09PSAncmVhZCcpIHtcbiAgICAgICAgcmV0dXJuIHNjaGVtYS5yZWFkZXIucGFyc2UodmFsdWUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNjaGVtYS5wYXJzZSh2YWx1ZSwgdW5kZWZpbmVkKTtcbiAgICB9XG4gIH0pO1xufVxuZnVuY3Rpb24gZ2V0U3JjUHJlZml4Rm9ySW1hZ2VCbG9jayhkb2N1bWVudEZlYXR1cmVzLCBzbHVnKSB7XG4gIHJldHVybiBnZXRTcmNQcmVmaXgodHlwZW9mIGRvY3VtZW50RmVhdHVyZXMuaW1hZ2VzID09PSAnb2JqZWN0JyA/IGRvY3VtZW50RmVhdHVyZXMuaW1hZ2VzLnB1YmxpY1BhdGggOiB1bmRlZmluZWQsIHNsdWcpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBzaGExKGNvbnRlbnQpIHtcbiAgcmV0dXJuIGNyZWF0ZUhhc2goJ3NoYTEnKS51cGRhdGUoY29udGVudCkuZGlnZXN0KCdoZXgnKTtcbn1cblxuY29uc3QgdGV4dEVuY29kZXIkMSA9IG5ldyBUZXh0RW5jb2RlcigpO1xuY29uc3QgYmxvYlNoYUNhY2hlID0gbmV3IFdlYWtNYXAoKTtcbmFzeW5jIGZ1bmN0aW9uIGJsb2JTaGEoY29udGVudHMpIHtcbiAgY29uc3QgY2FjaGVkID0gYmxvYlNoYUNhY2hlLmdldChjb250ZW50cyk7XG4gIGlmIChjYWNoZWQgIT09IHVuZGVmaW5lZCkgcmV0dXJuIGNhY2hlZDtcbiAgY29uc3QgYmxvYlByZWZpeCA9IHRleHRFbmNvZGVyJDEuZW5jb2RlKCdibG9iICcgKyBjb250ZW50cy5sZW5ndGggKyAnXFwwJyk7XG4gIGNvbnN0IGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYmxvYlByZWZpeC5ieXRlTGVuZ3RoICsgY29udGVudHMuYnl0ZUxlbmd0aCk7XG4gIGFycmF5LnNldChibG9iUHJlZml4LCAwKTtcbiAgYXJyYXkuc2V0KGNvbnRlbnRzLCBibG9iUHJlZml4LmJ5dGVMZW5ndGgpO1xuICBjb25zdCBkaWdlc3RQcm9taXNlID0gc2hhMShhcnJheSk7XG4gIGJsb2JTaGFDYWNoZS5zZXQoY29udGVudHMsIGRpZ2VzdFByb21pc2UpO1xuICBkaWdlc3RQcm9taXNlLnRoZW4oZGlnZXN0ID0+IGJsb2JTaGFDYWNoZS5zZXQoY29udGVudHMsIGRpZ2VzdCkpO1xuICByZXR1cm4gZGlnZXN0UHJvbWlzZTtcbn1cbmZ1bmN0aW9uIGdldFRyZWVOb2RlQXRQYXRoKHJvb3QsIHBhdGgpIHtcbiAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XG4gIGxldCBub2RlID0gcm9vdC5nZXQocGFydHNbMF0pO1xuICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMuc2xpY2UoMSkpIHtcbiAgICBpZiAoIW5vZGUpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgaWYgKCFub2RlLmNoaWxkcmVuKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIG5vZGUgPSBub2RlLmNoaWxkcmVuLmdldChwYXJ0KTtcbiAgfVxuICByZXR1cm4gbm9kZTtcbn1cbmZ1bmN0aW9uIGdldE5vZGVBdFBhdGgodHJlZSwgcGF0aCkge1xuICBpZiAocGF0aCA9PT0gJycpIHJldHVybiB0cmVlO1xuICBsZXQgbm9kZSA9IHRyZWU7XG4gIGZvciAoY29uc3QgcGFydCBvZiBwYXRoLnNwbGl0KCcvJykpIHtcbiAgICBpZiAoIW5vZGUuaGFzKHBhcnQpKSB7XG4gICAgICBub2RlLnNldChwYXJ0LCBuZXcgTWFwKCkpO1xuICAgIH1cbiAgICBjb25zdCBpbm5lck5vZGUgPSBub2RlLmdldChwYXJ0KTtcbiAgICBhc3NlcnQoaW5uZXJOb2RlIGluc3RhbmNlb2YgTWFwLCAnZXhwZWN0ZWQgdHJlZScpO1xuICAgIG5vZGUgPSBpbm5lck5vZGU7XG4gIH1cbiAgcmV0dXJuIG5vZGU7XG59XG5mdW5jdGlvbiBnZXRGaWxlbmFtZShwYXRoKSB7XG4gIHJldHVybiBwYXRoLnJlcGxhY2UoLy4qXFwvLywgJycpO1xufVxuZnVuY3Rpb24gZ2V0RGlybmFtZShwYXRoKSB7XG4gIGlmICghcGF0aC5pbmNsdWRlcygnLycpKSByZXR1cm4gJyc7XG4gIHJldHVybiBwYXRoLnJlcGxhY2UoL1xcL1teL10rJC8sICcnKTtcbn1cbmZ1bmN0aW9uIHRvVHJlZUNoYW5nZXMoY2hhbmdlcykge1xuICBjb25zdCBjaGFuZ2VzUm9vdCA9IG5ldyBNYXAoKTtcbiAgZm9yIChjb25zdCBkZWxldGlvbiBvZiBjaGFuZ2VzLmRlbGV0aW9ucykge1xuICAgIGNvbnN0IHBhcmVudFRyZWUgPSBnZXROb2RlQXRQYXRoKGNoYW5nZXNSb290LCBnZXREaXJuYW1lKGRlbGV0aW9uKSk7XG4gICAgcGFyZW50VHJlZS5zZXQoZ2V0RmlsZW5hbWUoZGVsZXRpb24pLCAnZGVsZXRlJyk7XG4gIH1cbiAgZm9yIChjb25zdCBhZGRpdGlvbiBvZiBjaGFuZ2VzLmFkZGl0aW9ucykge1xuICAgIGNvbnN0IHBhcmVudFRyZWUgPSBnZXROb2RlQXRQYXRoKGNoYW5nZXNSb290LCBnZXREaXJuYW1lKGFkZGl0aW9uLnBhdGgpKTtcbiAgICBwYXJlbnRUcmVlLnNldChnZXRGaWxlbmFtZShhZGRpdGlvbi5wYXRoKSwgYWRkaXRpb24uY29udGVudHMpO1xuICB9XG4gIHJldHVybiBjaGFuZ2VzUm9vdDtcbn1cbmNvbnN0IFNQQUNFX0NIQVJfQ09ERSA9IDMyO1xuY29uc3Qgc3BhY2UgPSBuZXcgVWludDhBcnJheShbU1BBQ0VfQ0hBUl9DT0RFXSk7XG5jb25zdCBudWxsY2hhciA9IG5ldyBVaW50OEFycmF5KFswXSk7XG5jb25zdCB0cmVlID0gdGV4dEVuY29kZXIkMS5lbmNvZGUoJ3RyZWUgJyk7XG5cbi8vIGJhc2VkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS9pc29tb3JwaGljLWdpdC9pc29tb3JwaGljLWdpdC9ibG9iL2MwOWRmYTIwZmZlMGFiOWU2NjAyZTBmYTE3MmQ3MmJhODk5NGU0NDMvc3JjL21vZGVscy9HaXRUcmVlLmpzI0wxMDgtTDEyMlxuZnVuY3Rpb24gdHJlZVNoYShjaGlsZHJlbikge1xuICBjb25zdCBlbnRyaWVzID0gWy4uLmNoaWxkcmVuXS5tYXAoKFtuYW1lLCBub2RlXSkgPT4gKHtcbiAgICBuYW1lLFxuICAgIHNoYTogbm9kZS5lbnRyeS5zaGEsXG4gICAgbW9kZTogbm9kZS5lbnRyeS5tb2RlXG4gIH0pKTtcbiAgZW50cmllcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgY29uc3QgYU5hbWUgPSBhLm1vZGUgPT09ICcwNDAwMDAnID8gYS5uYW1lICsgJy8nIDogYS5uYW1lO1xuICAgIGNvbnN0IGJOYW1lID0gYi5tb2RlID09PSAnMDQwMDAwJyA/IGIubmFtZSArICcvJyA6IGIubmFtZTtcbiAgICByZXR1cm4gYU5hbWUgPT09IGJOYW1lID8gMCA6IGFOYW1lIDwgYk5hbWUgPyAtMSA6IDE7XG4gIH0pO1xuICBjb25zdCB0cmVlT2JqZWN0ID0gZW50cmllcy5mbGF0TWFwKGVudHJ5ID0+IHtcbiAgICBjb25zdCBtb2RlID0gdGV4dEVuY29kZXIkMS5lbmNvZGUoZW50cnkubW9kZS5yZXBsYWNlKC9eMC8sICcnKSk7XG4gICAgY29uc3QgbmFtZSA9IHRleHRFbmNvZGVyJDEuZW5jb2RlKGVudHJ5Lm5hbWUpO1xuICAgIGNvbnN0IHNoYSA9IGhleFRvQnl0ZXMoZW50cnkuc2hhKTtcbiAgICByZXR1cm4gW21vZGUsIHNwYWNlLCBuYW1lLCBudWxsY2hhciwgc2hhXTtcbiAgfSk7XG4gIHJldHVybiBzaGExKGNvbmNhdEJ5dGVzKFt0cmVlLCB0ZXh0RW5jb2RlciQxLmVuY29kZSh0cmVlT2JqZWN0LnJlZHVjZSgoc3VtLCB2YWwpID0+IHN1bSArIHZhbC5ieXRlTGVuZ3RoLCAwKS50b1N0cmluZygpKSwgbnVsbGNoYXIsIC4uLnRyZWVPYmplY3RdKSk7XG59XG5mdW5jdGlvbiBjb25jYXRCeXRlcyhieXRlQXJyYXlzKSB7XG4gIGNvbnN0IHRvdGFsTGVuZ3RoID0gYnl0ZUFycmF5cy5yZWR1Y2UoKHN1bSwgYXJyKSA9PiBzdW0gKyBhcnIuYnl0ZUxlbmd0aCwgMCk7XG4gIGNvbnN0IHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KHRvdGFsTGVuZ3RoKTtcbiAgbGV0IG9mZnNldCA9IDA7XG4gIGZvciAoY29uc3QgYXJyIG9mIGJ5dGVBcnJheXMpIHtcbiAgICByZXN1bHQuc2V0KGFyciwgb2Zmc2V0KTtcbiAgICBvZmZzZXQgKz0gYXJyLmJ5dGVMZW5ndGg7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGhleFRvQnl0ZXMoc3RyKSB7XG4gIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoc3RyLmxlbmd0aCAvIDIpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzLmJ5dGVMZW5ndGg7IGkgKz0gMSkge1xuICAgIGNvbnN0IHN0YXJ0ID0gaSAqIDI7XG4gICAgYnl0ZXNbaV0gPSBwYXJzZUludChzdHIuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgMiksIDE2KTtcbiAgfVxuICByZXR1cm4gYnl0ZXM7XG59XG5hc3luYyBmdW5jdGlvbiBjcmVhdGVUcmVlTm9kZUVudHJ5KHBhdGgsIGNoaWxkcmVuKSB7XG4gIGNvbnN0IHNoYSA9IGF3YWl0IHRyZWVTaGEoY2hpbGRyZW4pO1xuICByZXR1cm4ge1xuICAgIHBhdGgsXG4gICAgbW9kZTogJzA0MDAwMCcsXG4gICAgdHlwZTogJ3RyZWUnLFxuICAgIHNoYVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlQmxvYk5vZGVFbnRyeShwYXRoLCBjb250ZW50cykge1xuICBjb25zdCBzaGEgPSAnc2hhJyBpbiBjb250ZW50cyA/IGNvbnRlbnRzLnNoYSA6IGF3YWl0IGJsb2JTaGEoY29udGVudHMpO1xuICByZXR1cm4ge1xuICAgIHBhdGgsXG4gICAgbW9kZTogJzEwMDY0NCcsXG4gICAgdHlwZTogJ2Jsb2InLFxuICAgIHNoYVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlVHJlZVdpdGhDaGFuZ2VzKHRyZWUsIGNoYW5nZXMpIHtcbiAgdmFyIF9hd2FpdCR1cGRhdGVUcmVlO1xuICBjb25zdCBuZXdUcmVlID0gKF9hd2FpdCR1cGRhdGVUcmVlID0gYXdhaXQgdXBkYXRlVHJlZSh0cmVlLCB0b1RyZWVDaGFuZ2VzKGNoYW5nZXMpLCBbXSkpICE9PSBudWxsICYmIF9hd2FpdCR1cGRhdGVUcmVlICE9PSB2b2lkIDAgPyBfYXdhaXQkdXBkYXRlVHJlZSA6IG5ldyBNYXAoKTtcbiAgcmV0dXJuIHtcbiAgICBlbnRyaWVzOiB0cmVlVG9FbnRyaWVzKG5ld1RyZWUpLFxuICAgIHNoYTogYXdhaXQgdHJlZVNoYShuZXdUcmVlICE9PSBudWxsICYmIG5ld1RyZWUgIT09IHZvaWQgMCA/IG5ld1RyZWUgOiBuZXcgTWFwKCkpXG4gIH07XG59XG5mdW5jdGlvbiB0cmVlVG9FbnRyaWVzKHRyZWUpIHtcbiAgcmV0dXJuIFsuLi50cmVlLnZhbHVlcygpXS5mbGF0TWFwKHggPT4geC5jaGlsZHJlbiA/IFt4LmVudHJ5LCAuLi50cmVlVG9FbnRyaWVzKHguY2hpbGRyZW4pXSA6IFt4LmVudHJ5XSk7XG59XG5hc3luYyBmdW5jdGlvbiB1cGRhdGVUcmVlKHRyZWUsIGNoYW5nZWRUcmVlLCBwYXRoKSB7XG4gIGNvbnN0IG5ld1RyZWUgPSBuZXcgTWFwKHRyZWUpO1xuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBjaGFuZ2VkVHJlZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gJ2RlbGV0ZScpIHtcbiAgICAgIG5ld1RyZWUuZGVsZXRlKGtleSk7XG4gICAgfVxuICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE1hcCkge1xuICAgICAgdmFyIF9uZXdUcmVlJGdldCRjaGlsZHJlbiwgX25ld1RyZWUkZ2V0O1xuICAgICAgY29uc3QgZXhpc3RpbmdDaGlsZHJlbiA9IChfbmV3VHJlZSRnZXQkY2hpbGRyZW4gPSAoX25ld1RyZWUkZ2V0ID0gbmV3VHJlZS5nZXQoa2V5KSkgPT09IG51bGwgfHwgX25ld1RyZWUkZ2V0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbmV3VHJlZSRnZXQuY2hpbGRyZW4pICE9PSBudWxsICYmIF9uZXdUcmVlJGdldCRjaGlsZHJlbiAhPT0gdm9pZCAwID8gX25ld1RyZWUkZ2V0JGNoaWxkcmVuIDogbmV3IE1hcCgpO1xuICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB1cGRhdGVUcmVlKGV4aXN0aW5nQ2hpbGRyZW4sIHZhbHVlLCBwYXRoLmNvbmNhdChrZXkpKTtcbiAgICAgIGlmIChjaGlsZHJlbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG5ld1RyZWUuZGVsZXRlKGtleSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgZW50cnkgPSBhd2FpdCBjcmVhdGVUcmVlTm9kZUVudHJ5KHBhdGguY29uY2F0KGtleSkuam9pbignLycpLCBjaGlsZHJlbik7XG4gICAgICBuZXdUcmVlLnNldChrZXksIHtcbiAgICAgICAgZW50cnksXG4gICAgICAgIGNoaWxkcmVuXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSB8fCB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmICdzaGEnIGluIHZhbHVlKSB7XG4gICAgICBjb25zdCBlbnRyeSA9IGF3YWl0IGNyZWF0ZUJsb2JOb2RlRW50cnkocGF0aC5jb25jYXQoa2V5KS5qb2luKCcvJyksIHZhbHVlKTtcbiAgICAgIG5ld1RyZWUuc2V0KGtleSwge1xuICAgICAgICBlbnRyeVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGlmIChuZXdUcmVlLnNpemUgPT09IDApIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIHJldHVybiBuZXdUcmVlO1xufVxuZnVuY3Rpb24gdHJlZUVudHJpZXNUb1RyZWVOb2RlcyhlbnRyaWVzKSB7XG4gIGNvbnN0IHJvb3QgPSBuZXcgTWFwKCk7XG4gIGNvbnN0IGdldENoaWxkcmVuQXRQYXRoID0gcGFydHMgPT4ge1xuICAgIHZhciBfbm9kZTtcbiAgICBpZiAocGFydHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gcm9vdDtcbiAgICB9XG4gICAgbGV0IG5vZGUgPSByb290LmdldChwYXJ0c1swXSk7XG4gICAgZm9yIChjb25zdCBwYXJ0IG9mIHBhcnRzLnNsaWNlKDEpKSB7XG4gICAgICBpZiAoIW5vZGUpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICBpZiAoIW5vZGUuY2hpbGRyZW4pIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICBub2RlID0gbm9kZS5jaGlsZHJlbi5nZXQocGFydCk7XG4gICAgfVxuICAgIHJldHVybiAoX25vZGUgPSBub2RlKSA9PT0gbnVsbCB8fCBfbm9kZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX25vZGUuY2hpbGRyZW47XG4gIH07XG4gIGZvciAoY29uc3QgZW50cnkgb2YgZW50cmllcykge1xuICAgIGNvbnN0IHNwbGl0ID0gZW50cnkucGF0aC5zcGxpdCgnLycpO1xuICAgIGNvbnN0IGNoaWxkcmVuID0gZ2V0Q2hpbGRyZW5BdFBhdGgoc3BsaXQuc2xpY2UoMCwgLTEpKTtcbiAgICBpZiAoY2hpbGRyZW4pIHtcbiAgICAgIGNoaWxkcmVuLnNldChzcGxpdFtzcGxpdC5sZW5ndGggLSAxXSwge1xuICAgICAgICBlbnRyeSxcbiAgICAgICAgY2hpbGRyZW46IGVudHJ5LnR5cGUgPT09ICd0cmVlJyA/IG5ldyBNYXAoKSA6IHVuZGVmaW5lZFxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIHJldHVybiByb290O1xufVxuXG5mdW5jdGlvbiBjb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWFJbm5lcihzY2hlbWEsIGRpcmVjdG9yaWVzLCBzZWVuU2NoZW1hcykge1xuICBpZiAoc2VlblNjaGVtYXMuaGFzKHNjaGVtYSkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgc2VlblNjaGVtYXMuYWRkKHNjaGVtYSk7XG4gIGlmIChzY2hlbWEua2luZCA9PT0gJ2FycmF5Jykge1xuICAgIHJldHVybiBjb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWFJbm5lcihzY2hlbWEuZWxlbWVudCwgZGlyZWN0b3JpZXMsIHNlZW5TY2hlbWFzKTtcbiAgfVxuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdjaGlsZCcpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKHNjaGVtYS5raW5kID09PSAnZm9ybScpIHtcbiAgICBpZiAoc2NoZW1hLmZvcm1LaW5kID09PSAnYXNzZXQnICYmIHNjaGVtYS5kaXJlY3RvcnkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZGlyZWN0b3JpZXMuYWRkKGZpeFBhdGgoc2NoZW1hLmRpcmVjdG9yeSkpO1xuICAgIH1cbiAgICBpZiAoKHNjaGVtYS5mb3JtS2luZCA9PT0gJ2NvbnRlbnQnIHx8IHNjaGVtYS5mb3JtS2luZCA9PT0gJ2Fzc2V0cycpICYmIHNjaGVtYS5kaXJlY3RvcmllcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBmb3IgKGNvbnN0IGRpcmVjdG9yeSBvZiBzY2hlbWEuZGlyZWN0b3JpZXMpIHtcbiAgICAgICAgZGlyZWN0b3JpZXMuYWRkKGZpeFBhdGgoZGlyZWN0b3J5KSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybjtcbiAgfVxuICBpZiAoc2NoZW1hLmtpbmQgPT09ICdvYmplY3QnKSB7XG4gICAgZm9yIChjb25zdCBmaWVsZCBvZiBPYmplY3QudmFsdWVzKHNjaGVtYS5maWVsZHMpKSB7XG4gICAgICBjb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWFJbm5lcihmaWVsZCwgZGlyZWN0b3JpZXMsIHNlZW5TY2hlbWFzKTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChzY2hlbWEua2luZCA9PT0gJ2NvbmRpdGlvbmFsJykge1xuICAgIGZvciAoY29uc3QgaW5uZXJTY2hlbWEgb2YgT2JqZWN0LnZhbHVlcyhzY2hlbWEudmFsdWVzKSkge1xuICAgICAgY29sbGVjdERpcmVjdG9yaWVzVXNlZEluU2NoZW1hSW5uZXIoaW5uZXJTY2hlbWEsIGRpcmVjdG9yaWVzLCBzZWVuU2NoZW1hcyk7XG4gICAgfVxuICAgIHJldHVybjtcbiAgfVxuICBhc3NlcnROZXZlciQxKHNjaGVtYSk7XG59XG5mdW5jdGlvbiBjb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWEoc2NoZW1hKSB7XG4gIGNvbnN0IGRpcmVjdG9yaWVzID0gbmV3IFNldCgpO1xuICBjb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWFJbm5lcihzY2hlbWEsIGRpcmVjdG9yaWVzLCBuZXcgU2V0KCkpO1xuICByZXR1cm4gZGlyZWN0b3JpZXM7XG59XG5mdW5jdGlvbiBnZXREaXJlY3Rvcmllc0ZvclRyZWVLZXkoc2NoZW1hLCBkaXJlY3RvcnksIHNsdWcsIGZvcm1hdCkge1xuICBjb25zdCBkaXJlY3RvcmllcyA9IFtmaXhQYXRoKGRpcmVjdG9yeSldO1xuICBpZiAoZm9ybWF0LmRhdGFMb2NhdGlvbiA9PT0gJ291dGVyJykge1xuICAgIGRpcmVjdG9yaWVzLnB1c2goZml4UGF0aChkaXJlY3RvcnkpICsgZ2V0RGF0YUZpbGVFeHRlbnNpb24oZm9ybWF0KSk7XG4gIH1cbiAgY29uc3QgdG9BZGQgPSBzbHVnID09PSB1bmRlZmluZWQgPyAnJyA6IGAvJHtzbHVnfWA7XG4gIGZvciAoY29uc3QgZGlyZWN0b3J5IG9mIGNvbGxlY3REaXJlY3Rvcmllc1VzZWRJblNjaGVtYShzY2hlbWEpKSB7XG4gICAgZGlyZWN0b3JpZXMucHVzaChkaXJlY3RvcnkgKyB0b0FkZCk7XG4gIH1cbiAgcmV0dXJuIGRpcmVjdG9yaWVzO1xufVxuXG5jb25zdCB0ZXh0RGVjb2RlciQxID0gbmV3IFRleHREZWNvZGVyKCk7XG5jb25zdCBkZWZhdWx0QWx0RmllbGQkMSA9IHRleHQoe1xuICBsYWJlbDogJ0FsdCB0ZXh0JyxcbiAgZGVzY3JpcHRpb246ICdUaGlzIHRleHQgd2lsbCBiZSB1c2VkIGJ5IHNjcmVlbiByZWFkZXJzIGFuZCBzZWFyY2ggZW5naW5lcy4nXG59KTtcbmNvbnN0IGVtcHR5VGl0bGVGaWVsZCQxID0gYmFzaWNGb3JtRmllbGRXaXRoU2ltcGxlUmVhZGVyUGFyc2Uoe1xuICBJbnB1dCgpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfSxcbiAgZGVmYXVsdFZhbHVlKCkge1xuICAgIHJldHVybiAnJztcbiAgfSxcbiAgcGFyc2UodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuICcnO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgc3RyaW5nJyk7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfSxcbiAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH0sXG4gIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgIHJldHVybiB7XG4gICAgICB2YWx1ZVxuICAgIH07XG4gIH0sXG4gIGxhYmVsOiAnVGl0bGUnXG59KTtcbmZ1bmN0aW9uIG5vcm1hbGlzZURvY3VtZW50RmVhdHVyZXMoY29uZmlnKSB7XG4gIHZhciBfY29uZmlnJGZvcm1hdHRpbmcsIF9mb3JtYXR0aW5nJGFsaWdubWVudCwgX2Zvcm1hdHRpbmckYWxpZ25tZW50MiwgX2Zvcm1hdHRpbmckYmxvY2tUeXBlLCBfZm9ybWF0dGluZyRpbmxpbmVNYXIsIF9mb3JtYXR0aW5nJGlubGluZU1hcjIsIF9mb3JtYXR0aW5nJGlubGluZU1hcjMsIF9mb3JtYXR0aW5nJGlubGluZU1hcjQsIF9mb3JtYXR0aW5nJGlubGluZU1hcjUsIF9mb3JtYXR0aW5nJGlubGluZU1hcjYsIF9mb3JtYXR0aW5nJGlubGluZU1hcjcsIF9mb3JtYXR0aW5nJGlubGluZU1hcjgsIF9mb3JtYXR0aW5nJGxpc3RUeXBlcywgX2Zvcm1hdHRpbmckbGlzdFR5cGVzMiwgX2ltYWdlc0NvbmZpZyRzY2hlbWEkLCBfaW1hZ2VzQ29uZmlnJHNjaGVtYSwgX2ltYWdlc0NvbmZpZyRzY2hlbWEkMiwgX2ltYWdlc0NvbmZpZyRzY2hlbWEyO1xuICBjb25zdCBmb3JtYXR0aW5nID0gY29uZmlnLmZvcm1hdHRpbmcgPT09IHRydWUgPyB7XG4gICAgLy8gYWxpZ25tZW50OiB0cnVlLCAvLyBub3Qgc3VwcG9ydGVkIG5hdGl2ZWx5IGluIG1hcmtkb3duXG4gICAgYmxvY2tUeXBlczogdHJ1ZSxcbiAgICBoZWFkaW5nTGV2ZWxzOiB0cnVlLFxuICAgIGlubGluZU1hcmtzOiB0cnVlLFxuICAgIGxpc3RUeXBlczogdHJ1ZSxcbiAgICBzb2Z0QnJlYWtzOiB0cnVlXG4gIH0gOiAoX2NvbmZpZyRmb3JtYXR0aW5nID0gY29uZmlnLmZvcm1hdHRpbmcpICE9PSBudWxsICYmIF9jb25maWckZm9ybWF0dGluZyAhPT0gdm9pZCAwID8gX2NvbmZpZyRmb3JtYXR0aW5nIDoge307XG4gIGNvbnN0IGltYWdlc0NvbmZpZyA9IGNvbmZpZy5pbWFnZXMgPT09IHRydWUgPyB7fSA6IGNvbmZpZy5pbWFnZXM7XG4gIHJldHVybiB7XG4gICAgZm9ybWF0dGluZzoge1xuICAgICAgYWxpZ25tZW50OiBmb3JtYXR0aW5nLmFsaWdubWVudCA9PT0gdHJ1ZSA/IHtcbiAgICAgICAgY2VudGVyOiB0cnVlLFxuICAgICAgICBlbmQ6IHRydWVcbiAgICAgIH0gOiB7XG4gICAgICAgIGNlbnRlcjogISEoKF9mb3JtYXR0aW5nJGFsaWdubWVudCA9IGZvcm1hdHRpbmcuYWxpZ25tZW50KSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRhbGlnbm1lbnQgIT09IHZvaWQgMCAmJiBfZm9ybWF0dGluZyRhbGlnbm1lbnQuY2VudGVyKSxcbiAgICAgICAgZW5kOiAhISgoX2Zvcm1hdHRpbmckYWxpZ25tZW50MiA9IGZvcm1hdHRpbmcuYWxpZ25tZW50KSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRhbGlnbm1lbnQyICE9PSB2b2lkIDAgJiYgX2Zvcm1hdHRpbmckYWxpZ25tZW50Mi5lbmQpXG4gICAgICB9LFxuICAgICAgYmxvY2tUeXBlczogKGZvcm1hdHRpbmcgPT09IG51bGwgfHwgZm9ybWF0dGluZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogZm9ybWF0dGluZy5ibG9ja1R5cGVzKSA9PT0gdHJ1ZSA/IHtcbiAgICAgICAgYmxvY2txdW90ZTogdHJ1ZSxcbiAgICAgICAgY29kZToge1xuICAgICAgICAgIHNjaGVtYTogb2JqZWN0KHt9KVxuICAgICAgICB9XG4gICAgICB9IDoge1xuICAgICAgICBibG9ja3F1b3RlOiAhISgoX2Zvcm1hdHRpbmckYmxvY2tUeXBlID0gZm9ybWF0dGluZy5ibG9ja1R5cGVzKSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRibG9ja1R5cGUgIT09IHZvaWQgMCAmJiBfZm9ybWF0dGluZyRibG9ja1R5cGUuYmxvY2txdW90ZSksXG4gICAgICAgIGNvZGU6IChfZm9ybWF0dGluZyRibG9ja1R5cGUyID0+IHtcbiAgICAgICAgICBpZiAoKChfZm9ybWF0dGluZyRibG9ja1R5cGUyID0gZm9ybWF0dGluZy5ibG9ja1R5cGVzKSA9PT0gbnVsbCB8fCBfZm9ybWF0dGluZyRibG9ja1R5cGUyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZm9ybWF0dGluZyRibG9ja1R5cGUyLmNvZGUpID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZvcm1hdHRpbmcuYmxvY2tUeXBlcy5jb2RlID09PSB0cnVlIHx8ICFmb3JtYXR0aW5nLmJsb2NrVHlwZXMuY29kZS5zY2hlbWEpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHNjaGVtYTogb2JqZWN0KHt9KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgWyd0eXBlJywgJ2NoaWxkcmVuJywgJ2xhbmd1YWdlJ10pIHtcbiAgICAgICAgICAgIGlmIChrZXkgaW4gZm9ybWF0dGluZy5ibG9ja1R5cGVzLmNvZGUuc2NoZW1hKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgXCIke2tleX1cIiBjYW5ub3QgYmUgYSBrZXkgaW4gdGhlIHNjaGVtYSBmb3IgY29kZSBibG9ja3NgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNjaGVtYTogb2JqZWN0KGZvcm1hdHRpbmcuYmxvY2tUeXBlcy5jb2RlLnNjaGVtYSlcbiAgICAgICAgICB9O1xuICAgICAgICB9KSgpXG4gICAgICB9LFxuICAgICAgaGVhZGluZ3M6IChfb2JqJHNjaGVtYSA9PiB7XG4gICAgICAgIGNvbnN0IG9wdCA9IGZvcm1hdHRpbmcgPT09IG51bGwgfHwgZm9ybWF0dGluZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogZm9ybWF0dGluZy5oZWFkaW5nTGV2ZWxzO1xuICAgICAgICBjb25zdCBvYmogPSB0eXBlb2Ygb3B0ID09PSAnb2JqZWN0JyAmJiAnbGV2ZWxzJyBpbiBvcHQgPyBvcHQgOiB7XG4gICAgICAgICAgbGV2ZWxzOiBvcHQsXG4gICAgICAgICAgc2NoZW1hOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG9iai5zY2hlbWEpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBbJ3R5cGUnLCAnY2hpbGRyZW4nLCAnbGV2ZWwnLCAndGV4dEFsaWduJ10pIHtcbiAgICAgICAgICAgIGlmIChrZXkgaW4gb2JqLnNjaGVtYSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFwiJHtrZXl9XCIgY2Fubm90IGJlIGEga2V5IGluIHRoZSBzY2hlbWEgZm9yIGhlYWRpbmdzYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbGV2ZWxzOiBbLi4ubmV3IFNldChvYmoubGV2ZWxzID09PSB0cnVlID8gWzEsIDIsIDMsIDQsIDUsIDZdIDogb2JqLmxldmVscyldLFxuICAgICAgICAgIHNjaGVtYTogb2JqZWN0KChfb2JqJHNjaGVtYSA9IG9iai5zY2hlbWEpICE9PSBudWxsICYmIF9vYmokc2NoZW1hICE9PSB2b2lkIDAgPyBfb2JqJHNjaGVtYSA6IHt9KVxuICAgICAgICB9O1xuICAgICAgfSkoKSxcbiAgICAgIGlubGluZU1hcmtzOiBmb3JtYXR0aW5nLmlubGluZU1hcmtzID09PSB0cnVlID8ge1xuICAgICAgICBib2xkOiB0cnVlLFxuICAgICAgICBjb2RlOiB0cnVlLFxuICAgICAgICBpdGFsaWM6IHRydWUsXG4gICAgICAgIGtleWJvYXJkOiBmYWxzZSxcbiAgICAgICAgLy8gbm90IHN1cHBvcnRlZCBuYXRpdmVseSBpbiBtYXJrZG93blxuICAgICAgICBzdHJpa2V0aHJvdWdoOiB0cnVlLFxuICAgICAgICBzdWJzY3JpcHQ6IGZhbHNlLFxuICAgICAgICAvLyBub3Qgc3VwcG9ydGVkIG5hdGl2ZWx5IGluIG1hcmtkb3duXG4gICAgICAgIHN1cGVyc2NyaXB0OiBmYWxzZSxcbiAgICAgICAgLy8gbm90IHN1cHBvcnRlZCBuYXRpdmVseSBpbiBtYXJrZG93blxuICAgICAgICB1bmRlcmxpbmU6IGZhbHNlIC8vIG5vdCBzdXBwb3J0ZWQgbmF0aXZlbHkgaW4gbWFya2Rvd25cbiAgICAgIH0gOiB7XG4gICAgICAgIGJvbGQ6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXIgPSBmb3JtYXR0aW5nLmlubGluZU1hcmtzKSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRpbmxpbmVNYXIgIT09IHZvaWQgMCAmJiBfZm9ybWF0dGluZyRpbmxpbmVNYXIuYm9sZCksXG4gICAgICAgIGNvZGU6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXIyID0gZm9ybWF0dGluZy5pbmxpbmVNYXJrcykgIT09IG51bGwgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyMiAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjIuY29kZSksXG4gICAgICAgIGl0YWxpYzogISEoKF9mb3JtYXR0aW5nJGlubGluZU1hcjMgPSBmb3JtYXR0aW5nLmlubGluZU1hcmtzKSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRpbmxpbmVNYXIzICE9PSB2b2lkIDAgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyMy5pdGFsaWMpLFxuICAgICAgICBzdHJpa2V0aHJvdWdoOiAhISgoX2Zvcm1hdHRpbmckaW5saW5lTWFyNCA9IGZvcm1hdHRpbmcuaW5saW5lTWFya3MpICE9PSBudWxsICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjQgIT09IHZvaWQgMCAmJiBfZm9ybWF0dGluZyRpbmxpbmVNYXI0LnN0cmlrZXRocm91Z2gpLFxuICAgICAgICB1bmRlcmxpbmU6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXI1ID0gZm9ybWF0dGluZy5pbmxpbmVNYXJrcykgIT09IG51bGwgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyNSAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjUudW5kZXJsaW5lKSxcbiAgICAgICAga2V5Ym9hcmQ6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXI2ID0gZm9ybWF0dGluZy5pbmxpbmVNYXJrcykgIT09IG51bGwgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyNiAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjYua2V5Ym9hcmQpLFxuICAgICAgICBzdWJzY3JpcHQ6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXI3ID0gZm9ybWF0dGluZy5pbmxpbmVNYXJrcykgIT09IG51bGwgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyNyAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjcuc3Vic2NyaXB0KSxcbiAgICAgICAgc3VwZXJzY3JpcHQ6ICEhKChfZm9ybWF0dGluZyRpbmxpbmVNYXI4ID0gZm9ybWF0dGluZy5pbmxpbmVNYXJrcykgIT09IG51bGwgJiYgX2Zvcm1hdHRpbmckaW5saW5lTWFyOCAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGlubGluZU1hcjguc3VwZXJzY3JpcHQpXG4gICAgICB9LFxuICAgICAgbGlzdFR5cGVzOiBmb3JtYXR0aW5nLmxpc3RUeXBlcyA9PT0gdHJ1ZSA/IHtcbiAgICAgICAgb3JkZXJlZDogdHJ1ZSxcbiAgICAgICAgdW5vcmRlcmVkOiB0cnVlXG4gICAgICB9IDoge1xuICAgICAgICBvcmRlcmVkOiAhISgoX2Zvcm1hdHRpbmckbGlzdFR5cGVzID0gZm9ybWF0dGluZy5saXN0VHlwZXMpICE9PSBudWxsICYmIF9mb3JtYXR0aW5nJGxpc3RUeXBlcyAhPT0gdm9pZCAwICYmIF9mb3JtYXR0aW5nJGxpc3RUeXBlcy5vcmRlcmVkKSxcbiAgICAgICAgdW5vcmRlcmVkOiAhISgoX2Zvcm1hdHRpbmckbGlzdFR5cGVzMiA9IGZvcm1hdHRpbmcubGlzdFR5cGVzKSAhPT0gbnVsbCAmJiBfZm9ybWF0dGluZyRsaXN0VHlwZXMyICE9PSB2b2lkIDAgJiYgX2Zvcm1hdHRpbmckbGlzdFR5cGVzMi51bm9yZGVyZWQpXG4gICAgICB9LFxuICAgICAgc29mdEJyZWFrczogISFmb3JtYXR0aW5nLnNvZnRCcmVha3NcbiAgICB9LFxuICAgIGxpbmtzOiAhIWNvbmZpZy5saW5rcyxcbiAgICBsYXlvdXRzOiBbLi4ubmV3IFNldCgoY29uZmlnLmxheW91dHMgfHwgW10pLm1hcCh4ID0+IEpTT04uc3RyaW5naWZ5KHgpKSldLm1hcCh4ID0+IEpTT04ucGFyc2UoeCkpLFxuICAgIGRpdmlkZXJzOiAhIWNvbmZpZy5kaXZpZGVycyxcbiAgICBpbWFnZXM6IGltYWdlc0NvbmZpZyA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiB7XG4gICAgICAuLi5pbWFnZXNDb25maWcsXG4gICAgICBzY2hlbWE6IHtcbiAgICAgICAgYWx0OiAoX2ltYWdlc0NvbmZpZyRzY2hlbWEkID0gKF9pbWFnZXNDb25maWckc2NoZW1hID0gaW1hZ2VzQ29uZmlnLnNjaGVtYSkgPT09IG51bGwgfHwgX2ltYWdlc0NvbmZpZyRzY2hlbWEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9pbWFnZXNDb25maWckc2NoZW1hLmFsdCkgIT09IG51bGwgJiYgX2ltYWdlc0NvbmZpZyRzY2hlbWEkICE9PSB2b2lkIDAgPyBfaW1hZ2VzQ29uZmlnJHNjaGVtYSQgOiBkZWZhdWx0QWx0RmllbGQkMSxcbiAgICAgICAgdGl0bGU6IChfaW1hZ2VzQ29uZmlnJHNjaGVtYSQyID0gKF9pbWFnZXNDb25maWckc2NoZW1hMiA9IGltYWdlc0NvbmZpZy5zY2hlbWEpID09PSBudWxsIHx8IF9pbWFnZXNDb25maWckc2NoZW1hMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2ltYWdlc0NvbmZpZyRzY2hlbWEyLnRpdGxlKSAhPT0gbnVsbCAmJiBfaW1hZ2VzQ29uZmlnJHNjaGVtYSQyICE9PSB2b2lkIDAgPyBfaW1hZ2VzQ29uZmlnJHNjaGVtYSQyIDogZW1wdHlUaXRsZUZpZWxkJDFcbiAgICAgIH1cbiAgICB9LFxuICAgIHRhYmxlczogISFjb25maWcudGFibGVzXG4gIH07XG59XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgYGZpZWxkcy5tYXJrZG9jYCBoYXMgc3VwZXJzZWRlZCB0aGlzIGZpZWxkLiBgZmllbGRzLm1keGAgaXMgYWxzbyBhdmFpbGFibGUgaWYgeW91IHByZWZlciBNRFguXG4gKi9cbmZ1bmN0aW9uIGRvY3VtZW50KHtcbiAgbGFiZWwsXG4gIGNvbXBvbmVudEJsb2NrcyA9IHt9LFxuICBkZXNjcmlwdGlvbixcbiAgLi4uZG9jdW1lbnRGZWF0dXJlc0NvbmZpZ1xufSkge1xuICBjb25zdCBkb2N1bWVudEZlYXR1cmVzID0gbm9ybWFsaXNlRG9jdW1lbnRGZWF0dXJlcyhkb2N1bWVudEZlYXR1cmVzQ29uZmlnKTtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgZm9ybUtpbmQ6ICdjb250ZW50JyxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gW3tcbiAgICAgICAgdHlwZTogJ3BhcmFncmFwaCcsXG4gICAgICAgIGNoaWxkcmVuOiBbe1xuICAgICAgICAgIHRleHQ6ICcnXG4gICAgICAgIH1dXG4gICAgICB9XTtcbiAgICB9LFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChEb2N1bWVudEZpZWxkSW5wdXQsIHtcbiAgICAgICAgY29tcG9uZW50QmxvY2tzOiBjb21wb25lbnRCbG9ja3MsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBkb2N1bWVudEZlYXR1cmVzOiBkb2N1bWVudEZlYXR1cmVzLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBwYXJzZShfLCBkYXRhKSB7XG4gICAgICBjb25zdCBtYXJrZG9jID0gdGV4dERlY29kZXIkMS5kZWNvZGUoZGF0YS5jb250ZW50KTtcbiAgICAgIGZyb21NYXJrZG9jKHBhcnNlKG1hcmtkb2MpLCBjb21wb25lbnRCbG9ja3MpO1xuICAgICAgcmV0dXJuIGRlc2VyaWFsaXplRmlsZXMobm9ybWFsaXplRG9jdW1lbnRGaWVsZENoaWxkcmVuKCksIGNvbXBvbmVudEJsb2NrcywgZGF0YS5vdGhlciwgZGF0YS5leHRlcm5hbCwgJ2VkaXQnLCBkb2N1bWVudEZlYXR1cmVzLCBkYXRhLnNsdWcpO1xuICAgIH0sXG4gICAgY29udGVudEV4dGVuc2lvbjogJy5tZG9jJyxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgZGlyZWN0b3JpZXM6IFsuLi5jb2xsZWN0RGlyZWN0b3JpZXNVc2VkSW5TY2hlbWEob2JqZWN0KE9iamVjdC5mcm9tRW50cmllcyhPYmplY3QuZW50cmllcyhjb21wb25lbnRCbG9ja3MpLm1hcCgoW25hbWUsIGJsb2NrXSkgPT4gW25hbWUsIG9iamVjdChibG9jay5zY2hlbWEpXSkpKSksIC4uLih0eXBlb2YgZG9jdW1lbnRGZWF0dXJlcy5pbWFnZXMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBkb2N1bWVudEZlYXR1cmVzLmltYWdlcy5kaXJlY3RvcnkgPT09ICdzdHJpbmcnID8gW2ZpeFBhdGgoZG9jdW1lbnRGZWF0dXJlcy5pbWFnZXMuZGlyZWN0b3J5KV0gOiBbXSldLFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSwgb3B0cykge1xuICAgICAgcmV0dXJuIHNlcmlhbGl6ZU1hcmtkb2MoKTtcbiAgICB9LFxuICAgIHJlYWRlcjoge1xuICAgICAgcGFyc2UodmFsdWUsIGRhdGEpIHtcbiAgICAgICAgY29uc3QgbWFya2RvYyA9IHRleHREZWNvZGVyJDEuZGVjb2RlKGRhdGEuY29udGVudCk7XG4gICAgICAgIGNvbnN0IGRvY3VtZW50ID0gZnJvbU1hcmtkb2MocGFyc2UobWFya2RvYyksIGNvbXBvbmVudEJsb2Nrcyk7XG4gICAgICAgIHJldHVybiBkZXNlcmlhbGl6ZUZpbGVzKGRvY3VtZW50LCBjb21wb25lbnRCbG9ja3MsIG5ldyBNYXAoKSwgbmV3IE1hcCgpLCAncmVhZCcsIGRvY3VtZW50RmVhdHVyZXMsIHVuZGVmaW5lZCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuXG5jb25zdCBkZWZhdWx0QWx0RmllbGQgPSB0ZXh0KHtcbiAgbGFiZWw6ICdBbHQgdGV4dCcsXG4gIGRlc2NyaXB0aW9uOiAnVGhpcyB0ZXh0IHdpbGwgYmUgdXNlZCBieSBzY3JlZW4gcmVhZGVycyBhbmQgc2VhcmNoIGVuZ2luZXMuJ1xufSk7XG5jb25zdCBlbXB0eVRpdGxlRmllbGQgPSBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gIElucHV0KCkge1xuICAgIHJldHVybiBudWxsO1xuICB9LFxuICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgcmV0dXJuICcnO1xuICB9LFxuICBwYXJzZSh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gJyc7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBzdHJpbmcnKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9LFxuICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfSxcbiAgc2VyaWFsaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbHVlXG4gICAgfTtcbiAgfSxcbiAgbGFiZWw6ICdUaXRsZSdcbn0pO1xuZnVuY3Rpb24gZWRpdG9yT3B0aW9uc1RvQ29uZmlnKG9wdGlvbnMpIHtcbiAgdmFyIF9vcHRpb25zJGJvbGQsIF9vcHRpb25zJGl0YWxpYywgX29wdGlvbnMkc3RyaWtldGhyb3VnLCBfb3B0aW9ucyRjb2RlLCBfb3B0aW9ucyRibG9ja3F1b3RlLCBfb3B0aW9ucyRvcmRlcmVkTGlzdCwgX29wdGlvbnMkdW5vcmRlcmVkTGlzLCBfb3B0aW9ucyR0YWJsZSwgX29wdGlvbnMkbGluaywgX29wdGlvbnMkZGl2aWRlcjtcbiAgcmV0dXJuIHtcbiAgICBib2xkOiAoX29wdGlvbnMkYm9sZCA9IG9wdGlvbnMuYm9sZCkgIT09IG51bGwgJiYgX29wdGlvbnMkYm9sZCAhPT0gdm9pZCAwID8gX29wdGlvbnMkYm9sZCA6IHRydWUsXG4gICAgaXRhbGljOiAoX29wdGlvbnMkaXRhbGljID0gb3B0aW9ucy5pdGFsaWMpICE9PSBudWxsICYmIF9vcHRpb25zJGl0YWxpYyAhPT0gdm9pZCAwID8gX29wdGlvbnMkaXRhbGljIDogdHJ1ZSxcbiAgICBzdHJpa2V0aHJvdWdoOiAoX29wdGlvbnMkc3RyaWtldGhyb3VnID0gb3B0aW9ucy5zdHJpa2V0aHJvdWdoKSAhPT0gbnVsbCAmJiBfb3B0aW9ucyRzdHJpa2V0aHJvdWcgIT09IHZvaWQgMCA/IF9vcHRpb25zJHN0cmlrZXRocm91ZyA6IHRydWUsXG4gICAgY29kZTogKF9vcHRpb25zJGNvZGUgPSBvcHRpb25zLmNvZGUpICE9PSBudWxsICYmIF9vcHRpb25zJGNvZGUgIT09IHZvaWQgMCA/IF9vcHRpb25zJGNvZGUgOiB0cnVlLFxuICAgIGhlYWRpbmc6ICgoKSA9PiB7XG4gICAgICBsZXQgbGV2ZWxzID0gW107XG4gICAgICBsZXQgbGV2ZWxzT3B0ID0gdHlwZW9mIG9wdGlvbnMuaGVhZGluZyA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkob3B0aW9ucy5oZWFkaW5nKSA/IG9wdGlvbnMuaGVhZGluZy5sZXZlbHMgOiBvcHRpb25zLmhlYWRpbmc7XG4gICAgICBpZiAobGV2ZWxzT3B0ID09PSB0cnVlIHx8IGxldmVsc09wdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGxldmVscyA9IFsxLCAyLCAzLCA0LCA1LCA2XTtcbiAgICAgIH1cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGxldmVsc09wdCkpIHtcbiAgICAgICAgbGV2ZWxzID0gbGV2ZWxzT3B0O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbGV2ZWxzLFxuICAgICAgICBzY2hlbWE6IG9wdGlvbnMuaGVhZGluZyAmJiB0eXBlb2Ygb3B0aW9ucy5oZWFkaW5nID09PSAnb2JqZWN0JyAmJiAnc2NoZW1hJyBpbiBvcHRpb25zLmhlYWRpbmcgPyBvcHRpb25zLmhlYWRpbmcuc2NoZW1hIDoge31cbiAgICAgIH07XG4gICAgfSkoKSxcbiAgICBibG9ja3F1b3RlOiAoX29wdGlvbnMkYmxvY2txdW90ZSA9IG9wdGlvbnMuYmxvY2txdW90ZSkgIT09IG51bGwgJiYgX29wdGlvbnMkYmxvY2txdW90ZSAhPT0gdm9pZCAwID8gX29wdGlvbnMkYmxvY2txdW90ZSA6IHRydWUsXG4gICAgb3JkZXJlZExpc3Q6IChfb3B0aW9ucyRvcmRlcmVkTGlzdCA9IG9wdGlvbnMub3JkZXJlZExpc3QpICE9PSBudWxsICYmIF9vcHRpb25zJG9yZGVyZWRMaXN0ICE9PSB2b2lkIDAgPyBfb3B0aW9ucyRvcmRlcmVkTGlzdCA6IHRydWUsXG4gICAgdW5vcmRlcmVkTGlzdDogKF9vcHRpb25zJHVub3JkZXJlZExpcyA9IG9wdGlvbnMudW5vcmRlcmVkTGlzdCkgIT09IG51bGwgJiYgX29wdGlvbnMkdW5vcmRlcmVkTGlzICE9PSB2b2lkIDAgPyBfb3B0aW9ucyR1bm9yZGVyZWRMaXMgOiB0cnVlLFxuICAgIHRhYmxlOiAoX29wdGlvbnMkdGFibGUgPSBvcHRpb25zLnRhYmxlKSAhPT0gbnVsbCAmJiBfb3B0aW9ucyR0YWJsZSAhPT0gdm9pZCAwID8gX29wdGlvbnMkdGFibGUgOiB0cnVlLFxuICAgIGxpbms6IChfb3B0aW9ucyRsaW5rID0gb3B0aW9ucy5saW5rKSAhPT0gbnVsbCAmJiBfb3B0aW9ucyRsaW5rICE9PSB2b2lkIDAgPyBfb3B0aW9ucyRsaW5rIDogdHJ1ZSxcbiAgICBpbWFnZTogb3B0aW9ucy5pbWFnZSAhPT0gZmFsc2UgPyAoKF9vcHRzJHRyYW5zZm9ybUZpbGVuYSwgX29wdHMkc2NoZW1hJGFsdCwgX29wdHMkc2NoZW1hLCBfb3B0cyRzY2hlbWEkdGl0bGUsIF9vcHRzJHNjaGVtYTIpID0+IHtcbiAgICAgIGNvbnN0IG9wdHMgPSBvcHRpb25zLmltYWdlID09PSB0cnVlID8gdW5kZWZpbmVkIDogb3B0aW9ucy5pbWFnZTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRpcmVjdG9yeTogb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLmRpcmVjdG9yeSxcbiAgICAgICAgcHVibGljUGF0aDogb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLnB1YmxpY1BhdGgsXG4gICAgICAgIHRyYW5zZm9ybUZpbGVuYW1lOiAoX29wdHMkdHJhbnNmb3JtRmlsZW5hID0gb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLnRyYW5zZm9ybUZpbGVuYW1lKSAhPT0gbnVsbCAmJiBfb3B0cyR0cmFuc2Zvcm1GaWxlbmEgIT09IHZvaWQgMCA/IF9vcHRzJHRyYW5zZm9ybUZpbGVuYSA6IHggPT4geCxcbiAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgYWx0OiAoX29wdHMkc2NoZW1hJGFsdCA9IG9wdHMgPT09IG51bGwgfHwgb3B0cyA9PT0gdm9pZCAwIHx8IChfb3B0cyRzY2hlbWEgPSBvcHRzLnNjaGVtYSkgPT09IG51bGwgfHwgX29wdHMkc2NoZW1hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3B0cyRzY2hlbWEuYWx0KSAhPT0gbnVsbCAmJiBfb3B0cyRzY2hlbWEkYWx0ICE9PSB2b2lkIDAgPyBfb3B0cyRzY2hlbWEkYWx0IDogZGVmYXVsdEFsdEZpZWxkLFxuICAgICAgICAgIHRpdGxlOiAoX29wdHMkc2NoZW1hJHRpdGxlID0gb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgfHwgKF9vcHRzJHNjaGVtYTIgPSBvcHRzLnNjaGVtYSkgPT09IG51bGwgfHwgX29wdHMkc2NoZW1hMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX29wdHMkc2NoZW1hMi50aXRsZSkgIT09IG51bGwgJiYgX29wdHMkc2NoZW1hJHRpdGxlICE9PSB2b2lkIDAgPyBfb3B0cyRzY2hlbWEkdGl0bGUgOiBlbXB0eVRpdGxlRmllbGRcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KSgpIDogdW5kZWZpbmVkLFxuICAgIGRpdmlkZXI6IChfb3B0aW9ucyRkaXZpZGVyID0gb3B0aW9ucy5kaXZpZGVyKSAhPT0gbnVsbCAmJiBfb3B0aW9ucyRkaXZpZGVyICE9PSB2b2lkIDAgPyBfb3B0aW9ucyRkaXZpZGVyIDogdHJ1ZSxcbiAgICBjb2RlQmxvY2s6IG9wdGlvbnMuY29kZUJsb2NrID09PSBmYWxzZSA/IHVuZGVmaW5lZCA6IHtcbiAgICAgIHNjaGVtYTogdHlwZW9mIG9wdGlvbnMuY29kZUJsb2NrID09PSAnb2JqZWN0JyA/IG9wdGlvbnMuY29kZUJsb2NrLnNjaGVtYSA6IHt9XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBnZXRUeXBlRm9yRmllbGQoZmllbGQpIHtcbiAgaWYgKGZpZWxkLmtpbmQgPT09ICdvYmplY3QnIHx8IGZpZWxkLmtpbmQgPT09ICdjb25kaXRpb25hbCcpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogT2JqZWN0LFxuICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICB9O1xuICB9XG4gIGlmIChmaWVsZC5raW5kID09PSAnYXJyYXknKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IEFycmF5LFxuICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICB9O1xuICB9XG4gIGlmIChmaWVsZC5raW5kID09PSAnY2hpbGQnKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG4gIGlmIChmaWVsZC5mb3JtS2luZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHR5cGVvZiBmaWVsZC5kZWZhdWx0VmFsdWUgPT09ICdzdHJpbmcnICYmICdvcHRpb25zJyBpbiBmaWVsZCAmJiBBcnJheS5pc0FycmF5KGZpZWxkLm9wdGlvbnMpICYmIGZpZWxkLm9wdGlvbnMuZXZlcnkodmFsID0+IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnICYmIHZhbCAhPT0gbnVsbCAmJiAndmFsdWUnIGluIHZhbCAmJiB0eXBlb2YgdmFsLnZhbHVlID09PSAnc3RyaW5nJykpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgbWF0Y2hlczogZmllbGQub3B0aW9ucy5tYXAoeCA9PiB4LnZhbHVlKSxcbiAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgIH07XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZmllbGQuZGVmYXVsdFZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgbGV0IHJlcXVpcmVkID0gZmFsc2U7XG4gICAgICB0cnkge1xuICAgICAgICBmaWVsZC5wYXJzZSgnJyk7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgcmVxdWlyZWQgPSB0cnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgICByZXF1aXJlZFxuICAgICAgfTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGZpZWxkLnBhcnNlKDEpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogTnVtYmVyXG4gICAgICB9O1xuICAgIH0gY2F0Y2gge31cbiAgICBpZiAodHlwZW9mIGZpZWxkLmRlZmF1bHRWYWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBCb29sZWFuLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHt9O1xuICB9XG4gIGlmIChmaWVsZC5mb3JtS2luZCA9PT0gJ3NsdWcnKSB7XG4gICAgbGV0IHJlcXVpcmVkID0gZmFsc2U7XG4gICAgdHJ5IHtcbiAgICAgIGZpZWxkLnBhcnNlKCcnLCB1bmRlZmluZWQpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWRcbiAgICB9O1xuICB9XG4gIGlmIChmaWVsZC5mb3JtS2luZCA9PT0gJ2Fzc2V0Jykge1xuICAgIGxldCByZXF1aXJlZCA9IGZhbHNlO1xuICAgIHRyeSB7XG4gICAgICBmaWVsZC52YWxpZGF0ZShudWxsKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJlcXVpcmVkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkXG4gICAgfTtcbiAgfVxuICByZXR1cm4ge307XG59XG5mdW5jdGlvbiBmaWVsZHNUb01hcmtkb2NBdHRyaWJ1dGVzKGZpZWxkcykge1xuICByZXR1cm4gT2JqZWN0LmZyb21FbnRyaWVzKE9iamVjdC5lbnRyaWVzKGZpZWxkcykubWFwKChbbmFtZSwgZmllbGRdKSA9PiB7XG4gICAgY29uc3Qgc2NoZW1hID0gZ2V0VHlwZUZvckZpZWxkKGZpZWxkKTtcbiAgICByZXR1cm4gW25hbWUsIHNjaGVtYV07XG4gIH0pKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZU1hcmtkb2NDb25maWcob3B0cykge1xuICBjb25zdCBlZGl0b3JDb25maWcgPSBlZGl0b3JPcHRpb25zVG9Db25maWcob3B0cy5vcHRpb25zIHx8IHt9KTtcbiAgY29uc3QgY29uZmlnID0ge1xuICAgIG5vZGVzOiB7XG4gICAgICAuLi5ub2Rlc1xuICAgIH0sXG4gICAgdGFnczoge31cbiAgfTtcbiAgaWYgKGVkaXRvckNvbmZpZy5oZWFkaW5nLmxldmVscy5sZW5ndGgpIHtcbiAgICBjb25maWcubm9kZXMuaGVhZGluZyA9IHtcbiAgICAgIC4uLm5vZGVzLmhlYWRpbmcsXG4gICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgIC4uLm5vZGVzLmhlYWRpbmcuYXR0cmlidXRlcyxcbiAgICAgICAgLi4uZmllbGRzVG9NYXJrZG9jQXR0cmlidXRlcyhlZGl0b3JDb25maWcuaGVhZGluZy5zY2hlbWEpXG4gICAgICB9XG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBjb25maWcubm9kZXMuaGVhZGluZyA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5ibG9ja3F1b3RlKSB7XG4gICAgY29uZmlnLm5vZGVzLmJsb2NrcXVvdGUgPSB1bmRlZmluZWQ7XG4gIH1cbiAgaWYgKGVkaXRvckNvbmZpZy5jb2RlQmxvY2spIHtcbiAgICBjb25maWcubm9kZXMuZmVuY2UgPSB7XG4gICAgICAuLi5ub2Rlcy5mZW5jZSxcbiAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgLi4ubm9kZXMuZmVuY2UuYXR0cmlidXRlcyxcbiAgICAgICAgLi4uZmllbGRzVG9NYXJrZG9jQXR0cmlidXRlcyhlZGl0b3JDb25maWcuY29kZUJsb2NrLnNjaGVtYSlcbiAgICAgIH1cbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGNvbmZpZy5ub2Rlcy5mZW5jZSA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5vcmRlcmVkTGlzdCAmJiAhZWRpdG9yQ29uZmlnLnVub3JkZXJlZExpc3QpIHtcbiAgICBjb25maWcubm9kZXMubGlzdCA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5ib2xkKSB7XG4gICAgY29uZmlnLm5vZGVzLnN0cm9uZyA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5pdGFsaWMpIHtcbiAgICBjb25maWcubm9kZXMuZW0gPSB1bmRlZmluZWQ7XG4gIH1cbiAgaWYgKCFlZGl0b3JDb25maWcuc3RyaWtldGhyb3VnaCkge1xuICAgIGNvbmZpZy5ub2Rlcy5zID0gdW5kZWZpbmVkO1xuICB9XG4gIGlmICghZWRpdG9yQ29uZmlnLmxpbmspIHtcbiAgICBjb25maWcubm9kZXMubGluayA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5pbWFnZSkge1xuICAgIGNvbmZpZy5ub2Rlcy5pbWFnZSA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoIWVkaXRvckNvbmZpZy5kaXZpZGVyKSB7XG4gICAgY29uZmlnLm5vZGVzLmhyID0gdW5kZWZpbmVkO1xuICB9XG4gIGlmICghZWRpdG9yQ29uZmlnLnRhYmxlKSB7XG4gICAgY29uZmlnLm5vZGVzLnRhYmxlID0gdW5kZWZpbmVkO1xuICB9XG4gIGZvciAoY29uc3QgW25hbWUsIGNvbXBvbmVudF0gb2YgT2JqZWN0LmVudHJpZXMob3B0cy5jb21wb25lbnRzIHx8IHt9KSkge1xuICAgIHZhciBfb3B0cyRyZW5kZXI7XG4gICAgY29uc3QgaXNFbXB0eSA9IGNvbXBvbmVudC5raW5kID09PSAnYmxvY2snIHx8IGNvbXBvbmVudC5raW5kID09PSAnaW5saW5lJztcbiAgICBjb25maWcudGFnc1tuYW1lXSA9IHtcbiAgICAgIHJlbmRlcjogKF9vcHRzJHJlbmRlciA9IG9wdHMucmVuZGVyKSA9PT0gbnVsbCB8fCBfb3B0cyRyZW5kZXIgPT09IHZvaWQgMCB8fCAoX29wdHMkcmVuZGVyID0gX29wdHMkcmVuZGVyLnRhZ3MpID09PSBudWxsIHx8IF9vcHRzJHJlbmRlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogX29wdHMkcmVuZGVyW25hbWVdLFxuICAgICAgY2hpbGRyZW46IGlzRW1wdHkgPyBbXSA6IHVuZGVmaW5lZCxcbiAgICAgIHNlbGZDbG9zaW5nOiBpc0VtcHR5LFxuICAgICAgYXR0cmlidXRlczogZmllbGRzVG9NYXJrZG9jQXR0cmlidXRlcyhjb21wb25lbnQuc2NoZW1hKSxcbiAgICAgIGRlc2NyaXB0aW9uOiAnZGVzY3JpcHRpb24nIGluIGNvbXBvbmVudCA/IGNvbXBvbmVudC5kZXNjcmlwdGlvbiA6IHVuZGVmaW5lZCxcbiAgICAgIGlubGluZTogY29tcG9uZW50LmtpbmQgPT09ICdpbmxpbmUnIHx8IGNvbXBvbmVudC5raW5kID09PSAnbWFyaydcbiAgICB9O1xuICB9XG4gIGZvciAoY29uc3QgW25hbWUsIHJlbmRlcl0gb2YgT2JqZWN0LmVudHJpZXMoKChfb3B0cyRyZW5kZXIyID0gb3B0cy5yZW5kZXIpID09PSBudWxsIHx8IF9vcHRzJHJlbmRlcjIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9vcHRzJHJlbmRlcjIubm9kZXMpIHx8IHt9KSkge1xuICAgIHZhciBfb3B0cyRyZW5kZXIyO1xuICAgIGNvbnN0IG5vZGVTY2hlbWEgPSBjb25maWcubm9kZXNbbmFtZV07XG4gICAgaWYgKG5vZGVTY2hlbWEpIHtcbiAgICAgIG5vZGVTY2hlbWEucmVuZGVyID0gcmVuZGVyO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY29uZmlnO1xufVxuXG5jb25zdCB0ZXh0RGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuY29uc3QgdGV4dEVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbmZ1bmN0aW9uIGdldERpcmVjdG9yaWVzRm9yRWRpdG9yRmllbGQoY29tcG9uZW50cywgY29uZmlnKSB7XG4gIHJldHVybiBbLi4uY29sbGVjdERpcmVjdG9yaWVzVXNlZEluU2NoZW1hKG9iamVjdChPYmplY3QuZnJvbUVudHJpZXMoT2JqZWN0LmVudHJpZXMoY29tcG9uZW50cykubWFwKChbbmFtZSwgY29tcG9uZW50XSkgPT4gW25hbWUsIG9iamVjdChjb21wb25lbnQuc2NoZW1hKV0pKSkpLCAuLi4odHlwZW9mIGNvbmZpZy5pbWFnZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIGNvbmZpZy5pbWFnZS5kaXJlY3RvcnkgPT09ICdzdHJpbmcnID8gW2ZpeFBhdGgoY29uZmlnLmltYWdlLmRpcmVjdG9yeSldIDogW10pXTtcbn1cbmZ1bmN0aW9uIG1hcmtkb2Moe1xuICBsYWJlbCxcbiAgZGVzY3JpcHRpb24sXG4gIG9wdGlvbnMgPSB7fSxcbiAgY29tcG9uZW50cyA9IHt9LFxuICBleHRlbnNpb24gPSAnbWRvYydcbn0pIHtcbiAgbGV0IHNjaGVtYTtcbiAgY29uc3QgY29uZmlnID0gZWRpdG9yT3B0aW9uc1RvQ29uZmlnKG9wdGlvbnMpO1xuICBsZXQgZ2V0U2NoZW1hID0gKCkgPT4ge1xuICAgIGlmICghc2NoZW1hKSB7XG4gICAgICBzY2hlbWEgPSBjcmVhdGVFZGl0b3JTY2hlbWEoKTtcbiAgICB9XG4gICAgcmV0dXJuIHNjaGVtYTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgZm9ybUtpbmQ6ICdjb250ZW50JyxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gZ2V0RGVmYXVsdFZhbHVlKGdldFNjaGVtYSgpKTtcbiAgICB9LFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChEb2N1bWVudEZpZWxkSW5wdXQsIHtcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHBhcnNlOiAoXywge1xuICAgICAgY29udGVudCxcbiAgICAgIG90aGVyLFxuICAgICAgZXh0ZXJuYWwsXG4gICAgICBzbHVnXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3QgdGV4dCA9IHRleHREZWNvZGVyLmRlY29kZShjb250ZW50KTtcbiAgICAgIHJldHVybiBwYXJzZVRvRWRpdG9yU3RhdGUodGV4dCwgZ2V0U2NoZW1hKCkpO1xuICAgIH0sXG4gICAgY29udGVudEV4dGVuc2lvbjogYC4ke2V4dGVuc2lvbn1gLFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBkaXJlY3RvcmllczogZ2V0RGlyZWN0b3JpZXNGb3JFZGl0b3JGaWVsZChjb21wb25lbnRzLCBjb25maWcpLFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSwge1xuICAgICAgc2x1Z1xuICAgIH0pIHtcbiAgICAgIGNvbnN0IG91dCA9IHNlcmlhbGl6ZUZyb21FZGl0b3JTdGF0ZSgpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29udGVudDogdGV4dEVuY29kZXIuZW5jb2RlKG91dC5jb250ZW50KSxcbiAgICAgICAgZXh0ZXJuYWw6IG91dC5leHRlcm5hbCxcbiAgICAgICAgb3RoZXI6IG91dC5vdGhlcixcbiAgICAgICAgdmFsdWU6IHVuZGVmaW5lZFxuICAgICAgfTtcbiAgICB9LFxuICAgIHJlYWRlcjoge1xuICAgICAgcGFyc2U6IChfLCB7XG4gICAgICAgIGNvbnRlbnRcbiAgICAgIH0pID0+IHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRleHREZWNvZGVyLmRlY29kZShjb250ZW50KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBub2RlOiBwYXJzZSh0ZXh0KVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0sXG4gICAgY29sbGFib3JhdGlvbjoge1xuICAgICAgdG9ZanModmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHByb3NlbWlycm9yVG9ZWG1sRnJhZ21lbnQodmFsdWUuZG9jKTtcbiAgICAgIH0sXG4gICAgICBmcm9tWWpzKHlqc1ZhbHVlLCBhd2FyZW5lc3MpIHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZUVkaXRvclN0YXRlRnJvbVlKUyhnZXRTY2hlbWEoKSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxubWFya2RvYy5jcmVhdGVNYXJrZG9jQ29uZmlnID0gY3JlYXRlTWFya2RvY0NvbmZpZztcbm1hcmtkb2MuaW5saW5lID0gZnVuY3Rpb24gaW5saW5lTWFya2RvYyh7XG4gIGxhYmVsLFxuICBkZXNjcmlwdGlvbixcbiAgb3B0aW9ucyA9IHt9LFxuICBjb21wb25lbnRzID0ge31cbn0pIHtcbiAgbGV0IHNjaGVtYTtcbiAgY29uc3QgY29uZmlnID0gZWRpdG9yT3B0aW9uc1RvQ29uZmlnKG9wdGlvbnMpO1xuICBsZXQgZ2V0U2NoZW1hID0gKCkgPT4ge1xuICAgIGlmICghc2NoZW1hKSB7XG4gICAgICBzY2hlbWEgPSBjcmVhdGVFZGl0b3JTY2hlbWEoKTtcbiAgICB9XG4gICAgcmV0dXJuIHNjaGVtYTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgZm9ybUtpbmQ6ICdhc3NldHMnLFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBnZXREZWZhdWx0VmFsdWUoZ2V0U2NoZW1hKCkpO1xuICAgIH0sXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KERvY3VtZW50RmllbGRJbnB1dCwge1xuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgLi4ucHJvcHNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcGFyc2U6ICh2YWx1ZSwge1xuICAgICAgb3RoZXIsXG4gICAgICBleHRlcm5hbCxcbiAgICAgIHNsdWdcbiAgICB9KSA9PiB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YWx1ZSA9ICcnO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGFyc2VUb0VkaXRvclN0YXRlKHZhbHVlLCBnZXRTY2hlbWEoKSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgZGlyZWN0b3JpZXM6IGdldERpcmVjdG9yaWVzRm9yRWRpdG9yRmllbGQoY29tcG9uZW50cywgY29uZmlnKSxcbiAgICBzZXJpYWxpemUodmFsdWUsIHtcbiAgICAgIHNsdWdcbiAgICB9KSB7XG4gICAgICBjb25zdCBvdXQgPSBzZXJpYWxpemVGcm9tRWRpdG9yU3RhdGUoKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGV4dGVybmFsOiBvdXQuZXh0ZXJuYWwsXG4gICAgICAgIG90aGVyOiBvdXQub3RoZXIsXG4gICAgICAgIHZhbHVlOiBvdXQuY29udGVudFxuICAgICAgfTtcbiAgICB9LFxuICAgIHJlYWRlcjoge1xuICAgICAgcGFyc2U6IHZhbHVlID0+IHtcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB2YWx1ZSA9ICcnO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBub2RlOiBwYXJzZSh2YWx1ZSlcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGNvbGxhYm9yYXRpb246IHtcbiAgICAgIHRvWWpzKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBwcm9zZW1pcnJvclRvWVhtbEZyYWdtZW50KHZhbHVlLmRvYyk7XG4gICAgICB9LFxuICAgICAgZnJvbVlqcyh5anNWYWx1ZSwgYXdhcmVuZXNzKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVFZGl0b3JTdGF0ZUZyb21ZSlMoZ2V0U2NoZW1hKCkpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn07XG5mdW5jdGlvbiBtZHgoe1xuICBsYWJlbCxcbiAgZGVzY3JpcHRpb24sXG4gIG9wdGlvbnMgPSB7fSxcbiAgY29tcG9uZW50cyA9IHt9LFxuICBleHRlbnNpb24gPSAnbWR4J1xufSkge1xuICBsZXQgc2NoZW1hO1xuICBjb25zdCBjb25maWcgPSBlZGl0b3JPcHRpb25zVG9Db25maWcob3B0aW9ucyk7XG4gIGxldCBnZXRTY2hlbWEgPSAoKSA9PiB7XG4gICAgaWYgKCFzY2hlbWEpIHtcbiAgICAgIHNjaGVtYSA9IGNyZWF0ZUVkaXRvclNjaGVtYSgpO1xuICAgIH1cbiAgICByZXR1cm4gc2NoZW1hO1xuICB9O1xuICByZXR1cm4ge1xuICAgIGtpbmQ6ICdmb3JtJyxcbiAgICBmb3JtS2luZDogJ2NvbnRlbnQnLFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBnZXREZWZhdWx0VmFsdWUoZ2V0U2NoZW1hKCkpO1xuICAgIH0sXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KERvY3VtZW50RmllbGRJbnB1dCwge1xuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgLi4ucHJvcHNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcGFyc2U6IChfLCB7XG4gICAgICBjb250ZW50LFxuICAgICAgb3RoZXIsXG4gICAgICBleHRlcm5hbCxcbiAgICAgIHNsdWdcbiAgICB9KSA9PiB7XG4gICAgICBjb25zdCB0ZXh0ID0gdGV4dERlY29kZXIuZGVjb2RlKGNvbnRlbnQpO1xuICAgICAgcmV0dXJuIHBhcnNlVG9FZGl0b3JTdGF0ZU1EWCh0ZXh0LCBnZXRTY2hlbWEoKSk7XG4gICAgfSxcbiAgICBjb250ZW50RXh0ZW5zaW9uOiBgLiR7ZXh0ZW5zaW9ufWAsXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIGRpcmVjdG9yaWVzOiBnZXREaXJlY3Rvcmllc0ZvckVkaXRvckZpZWxkKGNvbXBvbmVudHMsIGNvbmZpZyksXG4gICAgc2VyaWFsaXplKHZhbHVlLCB7XG4gICAgICBzbHVnXG4gICAgfSkge1xuICAgICAgY29uc3Qgb3V0ID0gc2VyaWFsaXplRnJvbUVkaXRvclN0YXRlTURYKCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb250ZW50OiB0ZXh0RW5jb2Rlci5lbmNvZGUob3V0LmNvbnRlbnQpLFxuICAgICAgICBleHRlcm5hbDogb3V0LmV4dGVybmFsLFxuICAgICAgICBvdGhlcjogb3V0Lm90aGVyLFxuICAgICAgICB2YWx1ZTogdW5kZWZpbmVkXG4gICAgICB9O1xuICAgIH0sXG4gICAgcmVhZGVyOiB7XG4gICAgICBwYXJzZTogKF8sIHtcbiAgICAgICAgY29udGVudFxuICAgICAgfSkgPT4ge1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGV4dERlY29kZXIuZGVjb2RlKGNvbnRlbnQpO1xuICAgICAgICByZXR1cm4gdGV4dDtcbiAgICAgIH1cbiAgICB9LFxuICAgIGNvbGxhYm9yYXRpb246IHtcbiAgICAgIHRvWWpzKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBwcm9zZW1pcnJvclRvWVhtbEZyYWdtZW50KHZhbHVlLmRvYyk7XG4gICAgICB9LFxuICAgICAgZnJvbVlqcyh5anNWYWx1ZSwgYXdhcmVuZXNzKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVFZGl0b3JTdGF0ZUZyb21ZSlMoZ2V0U2NoZW1hKCkpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cbm1keC5pbmxpbmUgPSBmdW5jdGlvbiBtZHgoe1xuICBsYWJlbCxcbiAgZGVzY3JpcHRpb24sXG4gIG9wdGlvbnMgPSB7fSxcbiAgY29tcG9uZW50cyA9IHt9XG59KSB7XG4gIGxldCBzY2hlbWE7XG4gIGNvbnN0IGNvbmZpZyA9IGVkaXRvck9wdGlvbnNUb0NvbmZpZyhvcHRpb25zKTtcbiAgbGV0IGdldFNjaGVtYSA9ICgpID0+IHtcbiAgICBpZiAoIXNjaGVtYSkge1xuICAgICAgc2NoZW1hID0gY3JlYXRlRWRpdG9yU2NoZW1hKCk7XG4gICAgfVxuICAgIHJldHVybiBzY2hlbWE7XG4gIH07XG4gIHJldHVybiB7XG4gICAga2luZDogJ2Zvcm0nLFxuICAgIGZvcm1LaW5kOiAnYXNzZXRzJyxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gZ2V0RGVmYXVsdFZhbHVlKGdldFNjaGVtYSgpKTtcbiAgICB9LFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChEb2N1bWVudEZpZWxkSW5wdXQsIHtcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHBhcnNlOiAodmFsdWUsIHtcbiAgICAgIG90aGVyLFxuICAgICAgZXh0ZXJuYWwsXG4gICAgICBzbHVnXG4gICAgfSkgPT4ge1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHBhcnNlVG9FZGl0b3JTdGF0ZU1EWCh2YWx1ZSwgZ2V0U2NoZW1hKCkpO1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIGRpcmVjdG9yaWVzOiBnZXREaXJlY3Rvcmllc0ZvckVkaXRvckZpZWxkKGNvbXBvbmVudHMsIGNvbmZpZyksXG4gICAgc2VyaWFsaXplKHZhbHVlLCB7XG4gICAgICBzbHVnXG4gICAgfSkge1xuICAgICAgY29uc3Qgb3V0ID0gc2VyaWFsaXplRnJvbUVkaXRvclN0YXRlTURYKCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBleHRlcm5hbDogb3V0LmV4dGVybmFsLFxuICAgICAgICBvdGhlcjogb3V0Lm90aGVyLFxuICAgICAgICB2YWx1ZTogb3V0LmNvbnRlbnRcbiAgICAgIH07XG4gICAgfSxcbiAgICByZWFkZXI6IHtcbiAgICAgIHBhcnNlOiB2YWx1ZSA9PiB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGNvbGxhYm9yYXRpb246IHtcbiAgICAgIHRvWWpzKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBwcm9zZW1pcnJvclRvWVhtbEZyYWdtZW50KHZhbHVlLmRvYyk7XG4gICAgICB9LFxuICAgICAgZnJvbVlqcyh5anNWYWx1ZSwgYXdhcmVuZXNzKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVFZGl0b3JTdGF0ZUZyb21ZSlMoZ2V0U2NoZW1hKCkpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCB7IG1hcmtkb2MgYXMgYSwgZ2V0RGlyZWN0b3JpZXNGb3JUcmVlS2V5IGFzIGIsIGdldENvbGxlY3Rpb25QYXRoIGFzIGMsIGRvY3VtZW50IGFzIGQsIGdldFNpbmdsZXRvbkZvcm1hdCBhcyBlLCBmaXhQYXRoIGFzIGYsIGdldFNyY1ByZWZpeCBhcyBnLCBnZXRTaW5nbGV0b25QYXRoIGFzIGgsIGJsb2JTaGEgYXMgaSwgZ2V0RW50cnlEYXRhRmlsZXBhdGggYXMgaiwgZ2V0VmFsdWVBdFByb3BQYXRoIGFzIGssIGdldENvbGxlY3Rpb25Gb3JtYXQgYXMgbCwgbWR4IGFzIG0sIGdldFNsdWdHbG9iRm9yQ29sbGVjdGlvbiBhcyBuLCBvYmplY3QgYXMgbywgZ2V0RGF0YUZpbGVFeHRlbnNpb24gYXMgcCwgZ2V0Q29sbGVjdGlvbkl0ZW1QYXRoIGFzIHEsIGdldFRyZWVOb2RlQXRQYXRoIGFzIHIsIHRyZWVFbnRyaWVzVG9UcmVlTm9kZXMgYXMgdCwgdXBkYXRlVHJlZVdpdGhDaGFuZ2VzIGFzIHUgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@keystatic/core/dist/index-ca270311.node.react-server.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@keystatic/core/dist/keystatic-core-reader.node.react-server.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/keystatic-core-reader.node.react-server.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createReader: () => (/* binding */ createReader)\n/* harmony export */ });\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:path */ \"node:path\");\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! node:fs/promises */ \"node:fs/promises\");\n/* harmony import */ var _generic_4797a755_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./generic-4797a755.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/generic-4797a755.node.react-server.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react/jsx-runtime */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-jsx-runtime.js\");\n/* harmony import */ var _index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./index-ca270311.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/index-ca270311.node.react-server.js\");\n/* harmony import */ var emery_assertions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! emery/assertions */ \"(rsc)/./node_modules/emery/assertions/dist/emery-assertions.esm.js\");\n/* harmony import */ var emery__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! emery */ \"(rsc)/./node_modules/emery/dist/emery.esm.js\");\n/* harmony import */ var _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./index-10ea50e2.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/index-10ea50e2.node.react-server.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var _braintree_sanitize_url__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @braintree/sanitize-url */ \"(rsc)/./node_modules/@braintree/sanitize-url/dist/index.js\");\n/* harmony import */ var js_yaml__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! js-yaml */ \"(rsc)/./node_modules/js-yaml/dist/js-yaml.mjs\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! react */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction createReader(repoPath, config) {\n  const fs$1 = {\n    async fileExists(path$1) {\n      try {\n        await node_fs_promises__WEBPACK_IMPORTED_MODULE_1__.stat(node_path__WEBPACK_IMPORTED_MODULE_0__.join(repoPath, path$1));\n        return true;\n      } catch (err) {\n        if (err.code === 'ENOENT') return false;\n        throw err;\n      }\n    },\n    async readdir(path$1) {\n      try {\n        const entries = await node_fs_promises__WEBPACK_IMPORTED_MODULE_1__.readdir(node_path__WEBPACK_IMPORTED_MODULE_0__.join(repoPath, path$1), {\n          withFileTypes: true\n        });\n        const filtered = [];\n        for (const entry of entries) {\n          if (entry.isDirectory()) {\n            filtered.push({\n              name: entry.name,\n              kind: 'directory'\n            });\n          }\n          if (entry.isFile()) {\n            filtered.push({\n              name: entry.name,\n              kind: 'file'\n            });\n          }\n        }\n        return filtered;\n      } catch (err) {\n        if (err.code === 'ENOENT') return [];\n        throw err;\n      }\n    },\n    async readFile(path$1) {\n      try {\n        return await node_fs_promises__WEBPACK_IMPORTED_MODULE_1__.readFile(node_path__WEBPACK_IMPORTED_MODULE_0__.join(repoPath, path$1));\n      } catch (err) {\n        if (err.code === 'ENOENT') return null;\n        throw err;\n      }\n    }\n  };\n  return {\n    collections: Object.fromEntries(Object.keys(config.collections || {}).map(key => [key, (0,_generic_4797a755_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.c)(key, config, fs$1)])),\n    singletons: Object.fromEntries(Object.keys(config.singletons || {}).map(key => [key, (0,_generic_4797a755_node_react_server_js__WEBPACK_IMPORTED_MODULE_2__.s)(key, config, fs$1)])),\n    repoPath,\n    config\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3Qva2V5c3RhdGljLWNvcmUtcmVhZGVyLm5vZGUucmVhY3Qtc2VydmVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkI7QUFDSztBQUNvRTtBQUMzRTtBQUNvQjtBQUNOO0FBQ2Y7QUFDWDtBQUNnQztBQUMvQjtBQUNpQjtBQUNoQjtBQUNGOztBQUVmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxrREFBTyxDQUFDLDJDQUFTO0FBQy9CO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsOEJBQThCLHFEQUFVLENBQUMsMkNBQVM7QUFDbEQ7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EscUJBQXFCLHNEQUFXLENBQUMsMkNBQVM7QUFDMUMsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF3RSxtQkFBbUIseUVBQWdCO0FBQzNHLHNFQUFzRSxtQkFBbUIseUVBQWU7QUFDeEc7QUFDQTtBQUNBO0FBQ0E7O0FBRXdCIiwic291cmNlcyI6WyIvVXNlcnMvamFtZXMvRG93bmxvYWRzL25ldy1rZXlzdGF0aWMtcHJvamVjdC9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3Qva2V5c3RhdGljLWNvcmUtcmVhZGVyLm5vZGUucmVhY3Qtc2VydmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ25vZGU6cGF0aCc7XG5pbXBvcnQgZnMgZnJvbSAnbm9kZTpmcy9wcm9taXNlcyc7XG5pbXBvcnQgeyBjIGFzIGNvbGxlY3Rpb25SZWFkZXIsIHMgYXMgc2luZ2xldG9uUmVhZGVyIH0gZnJvbSAnLi9nZW5lcmljLTQ3OTdhNzU1Lm5vZGUucmVhY3Qtc2VydmVyLmpzJztcbmltcG9ydCAncmVhY3QvanN4LXJ1bnRpbWUnO1xuaW1wb3J0ICcuL2luZGV4LWNhMjcwMzExLm5vZGUucmVhY3Qtc2VydmVyLmpzJztcbmltcG9ydCAnQG1hcmtkb2MvbWFya2RvYy9kaXN0L2luZGV4Lm1qcyc7XG5pbXBvcnQgJ2VtZXJ5L2Fzc2VydGlvbnMnO1xuaW1wb3J0ICdlbWVyeSc7XG5pbXBvcnQgJy4vaW5kZXgtMTBlYTUwZTIubm9kZS5yZWFjdC1zZXJ2ZXIuanMnO1xuaW1wb3J0ICdjcnlwdG8nO1xuaW1wb3J0ICdAYnJhaW50cmVlL3Nhbml0aXplLXVybCc7XG5pbXBvcnQgJ2pzLXlhbWwnO1xuaW1wb3J0ICdyZWFjdCc7XG5cbmZ1bmN0aW9uIGNyZWF0ZVJlYWRlcihyZXBvUGF0aCwgY29uZmlnKSB7XG4gIGNvbnN0IGZzJDEgPSB7XG4gICAgYXN5bmMgZmlsZUV4aXN0cyhwYXRoJDEpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGZzLnN0YXQocGF0aC5qb2luKHJlcG9QYXRoLCBwYXRoJDEpKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgaWYgKGVyci5jb2RlID09PSAnRU5PRU5UJykgcmV0dXJuIGZhbHNlO1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG4gICAgfSxcbiAgICBhc3luYyByZWFkZGlyKHBhdGgkMSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZW50cmllcyA9IGF3YWl0IGZzLnJlYWRkaXIocGF0aC5qb2luKHJlcG9QYXRoLCBwYXRoJDEpLCB7XG4gICAgICAgICAgd2l0aEZpbGVUeXBlczogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgZmlsdGVyZWQgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiBlbnRyaWVzKSB7XG4gICAgICAgICAgaWYgKGVudHJ5LmlzRGlyZWN0b3J5KCkpIHtcbiAgICAgICAgICAgIGZpbHRlcmVkLnB1c2goe1xuICAgICAgICAgICAgICBuYW1lOiBlbnRyeS5uYW1lLFxuICAgICAgICAgICAgICBraW5kOiAnZGlyZWN0b3J5J1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChlbnRyeS5pc0ZpbGUoKSkge1xuICAgICAgICAgICAgZmlsdGVyZWQucHVzaCh7XG4gICAgICAgICAgICAgIG5hbWU6IGVudHJ5Lm5hbWUsXG4gICAgICAgICAgICAgIGtpbmQ6ICdmaWxlJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWx0ZXJlZDtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoZXJyLmNvZGUgPT09ICdFTk9FTlQnKSByZXR1cm4gW107XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9LFxuICAgIGFzeW5jIHJlYWRGaWxlKHBhdGgkMSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGZzLnJlYWRGaWxlKHBhdGguam9pbihyZXBvUGF0aCwgcGF0aCQxKSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgaWYgKGVyci5jb2RlID09PSAnRU5PRU5UJykgcmV0dXJuIG51bGw7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIHJldHVybiB7XG4gICAgY29sbGVjdGlvbnM6IE9iamVjdC5mcm9tRW50cmllcyhPYmplY3Qua2V5cyhjb25maWcuY29sbGVjdGlvbnMgfHwge30pLm1hcChrZXkgPT4gW2tleSwgY29sbGVjdGlvblJlYWRlcihrZXksIGNvbmZpZywgZnMkMSldKSksXG4gICAgc2luZ2xldG9uczogT2JqZWN0LmZyb21FbnRyaWVzKE9iamVjdC5rZXlzKGNvbmZpZy5zaW5nbGV0b25zIHx8IHt9KS5tYXAoa2V5ID0+IFtrZXksIHNpbmdsZXRvblJlYWRlcihrZXksIGNvbmZpZywgZnMkMSldKSksXG4gICAgcmVwb1BhdGgsXG4gICAgY29uZmlnXG4gIH07XG59XG5cbmV4cG9ydCB7IGNyZWF0ZVJlYWRlciB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@keystatic/core/dist/keystatic-core-reader.node.react-server.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@keystatic/core/dist/keystatic-core.node.react-server.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@keystatic/core/dist/keystatic-core.node.react-server.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BlockWrapper: () => (/* binding */ BlockWrapper),\n/* harmony export */   NotEditable: () => (/* binding */ NotEditable),\n/* harmony export */   ToolbarSeparator: () => (/* binding */ ToolbarSeparator),\n/* harmony export */   collection: () => (/* binding */ collection),\n/* harmony export */   component: () => (/* reexport safe */ _api_c5c73b52_node_react_server_js__WEBPACK_IMPORTED_MODULE_0__.c),\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   fields: () => (/* binding */ index),\n/* harmony export */   singleton: () => (/* binding */ singleton)\n/* harmony export */ });\n/* harmony import */ var _api_c5c73b52_node_react_server_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./api-c5c73b52.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/api-c5c73b52.node.react-server.js\");\n/* harmony import */ var _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-10ea50e2.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/index-10ea50e2.node.react-server.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react/jsx-runtime */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-jsx-runtime.js\");\n/* harmony import */ var _index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./index-ca270311.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/index-ca270311.node.react-server.js\");\n/* harmony import */ var emery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! emery */ \"(rsc)/./node_modules/emery/dist/emery.esm.js\");\n/* harmony import */ var _braintree_sanitize_url__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @braintree/sanitize-url */ \"(rsc)/./node_modules/@braintree/sanitize-url/dist/index.js\");\n/* harmony import */ var _index_9722793d_node_react_server_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./index-9722793d.node.react-server.js */ \"(rsc)/./node_modules/@keystatic/core/dist/index-9722793d.node.react-server.js\");\n/* harmony import */ var emery_assertions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! emery/assertions */ \"(rsc)/./node_modules/emery/assertions/dist/emery-assertions.esm.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! crypto */ \"crypto\");\n\n\n\n\n\n\n\n\n\n\n\n// Common\n\n// Storage\n// ----------------------------------------------------------------------------\n\n// ============================================================================\n// Functions\n// ============================================================================\n\nfunction config(config) {\n  return config;\n}\nfunction collection(collection) {\n  return collection;\n}\nfunction singleton(collection) {\n  return collection;\n}\n\nfunction array(element, opts) {\n  var _opts$label;\n  return {\n    kind: 'array',\n    element,\n    label: (_opts$label = opts === null || opts === void 0 ? void 0 : opts.label) !== null && _opts$label !== void 0 ? _opts$label : 'Items',\n    description: opts === null || opts === void 0 ? void 0 : opts.description,\n    itemLabel: opts === null || opts === void 0 ? void 0 : opts.itemLabel,\n    asChildTag: opts === null || opts === void 0 ? void 0 : opts.asChildTag,\n    slugField: opts === null || opts === void 0 ? void 0 : opts.slugField,\n    validation: opts === null || opts === void 0 ? void 0 : opts.validation\n  };\n}\n\nfunction select({\n  label,\n  options,\n  defaultValue,\n  description\n}) {\n  const optionValuesSet = new Set(options.map(x => x.value));\n  if (!optionValuesSet.has(defaultValue)) {\n    throw new Error(`A defaultValue of ${defaultValue} was provided to a select field but it does not match the value of one of the options provided`);\n  }\n  const field = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.S, {\n        label: label,\n        options: options,\n        description: description,\n        ...props\n      });\n    },\n    defaultValue() {\n      return defaultValue;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return defaultValue;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      if (!optionValuesSet.has(value)) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a valid option');\n      }\n      return value;\n    },\n    validate(value) {\n      return value;\n    },\n    serialize(value) {\n      return {\n        value\n      };\n    }\n  });\n  return {\n    ...field,\n    options\n  };\n}\n\nfunction blocks(blocks, opts) {\n  const entries = Object.entries(blocks);\n  if (!entries.length) {\n    throw new Error('fields.blocks must have at least one entry');\n  }\n  const select$1 = select({\n    label: 'Kind',\n    defaultValue: entries[0][0],\n    options: Object.entries(blocks).map(([key, {\n      label\n    }]) => ({\n      label,\n      value: key\n    }))\n  });\n  const element = conditional(select$1, Object.fromEntries(entries.map(([key, {\n    schema\n  }]) => [key, schema])));\n  return {\n    ...array(element, {\n      label: opts.label,\n      description: opts.description,\n      validation: opts.validation,\n      itemLabel(props) {\n        const kind = props.discriminant;\n        const block = blocks[kind];\n        if (!block.itemLabel) return block.label;\n        return block.itemLabel(props.value);\n      }\n    }),\n    Input: _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.B\n  };\n}\n\nfunction checkbox({\n  label,\n  defaultValue = false,\n  description\n}) {\n  return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.C, {\n        ...props,\n        label: label,\n        description: description\n      });\n    },\n    defaultValue() {\n      return defaultValue;\n    },\n    parse(value) {\n      if (value === undefined) return defaultValue;\n      if (typeof value !== 'boolean') {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a boolean');\n      }\n      return value;\n    },\n    validate(value) {\n      return value;\n    },\n    serialize(value) {\n      return {\n        value\n      };\n    }\n  });\n}\n\nfunction child(options) {\n  return {\n    kind: 'child',\n    options: options.kind === 'block' ? {\n      ...options,\n      dividers: options.dividers,\n      formatting: options.formatting === 'inherit' ? {\n        blockTypes: 'inherit',\n        headingLevels: 'inherit',\n        inlineMarks: 'inherit',\n        listTypes: 'inherit',\n        alignment: 'inherit',\n        softBreaks: 'inherit'\n      } : options.formatting,\n      links: options.links,\n      images: options.images,\n      tables: options.tables,\n      componentBlocks: options.componentBlocks\n    } : {\n      kind: 'inline',\n      placeholder: options.placeholder,\n      formatting: options.formatting === 'inherit' ? {\n        inlineMarks: 'inherit',\n        softBreaks: 'inherit'\n      } : options.formatting,\n      links: options.links\n    }\n  };\n}\n\nfunction cloudImage({\n  label,\n  description,\n  validation\n}) {\n  return {\n    ...(0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.o)({\n      src: (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.t)({\n        label: 'URL',\n        validation: {\n          length: {\n            min: validation !== null && validation !== void 0 && validation.isRequired ? 1 : 0\n          }\n        }\n      }),\n      alt: (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.t)({\n        label: 'Alt text'\n      }),\n      height: (0,_index_9722793d_node_react_server_js__WEBPACK_IMPORTED_MODULE_6__.i)({\n        label: 'Height'\n      }),\n      width: (0,_index_9722793d_node_react_server_js__WEBPACK_IMPORTED_MODULE_6__.i)({\n        label: 'Width'\n      })\n    }, {\n      label,\n      description\n    }),\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.a, {\n        ...props,\n        isRequired: validation === null || validation === void 0 ? void 0 : validation.isRequired\n      });\n    }\n  };\n}\n\nfunction conditional(discriminant, values) {\n  return {\n    kind: 'conditional',\n    discriminant,\n    values: values\n  };\n}\n\nfunction validateDate(validation, value, label) {\n  if (value !== null && !/^\\d{4}-\\d{2}-\\d{2}$/.test(value)) {\n    return `${label} is not a valid date`;\n  }\n  if (validation !== null && validation !== void 0 && validation.isRequired && value === null) {\n    return `${label} is required`;\n  }\n  if ((validation !== null && validation !== void 0 && validation.min || validation !== null && validation !== void 0 && validation.max) && value !== null) {\n    const date = new Date(value);\n    if ((validation === null || validation === void 0 ? void 0 : validation.min) !== undefined) {\n      const min = new Date(validation.min);\n      if (date < min) {\n        return `${label} must be after ${min.toLocaleDateString()}`;\n      }\n    }\n    if ((validation === null || validation === void 0 ? void 0 : validation.max) !== undefined) {\n      const max = new Date(validation.max);\n      if (date > max) {\n        return `${label} must be no later than ${max.toLocaleDateString()}`;\n      }\n    }\n  }\n}\n\nfunction date({\n  label,\n  defaultValue,\n  validation,\n  description\n}) {\n  return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.D, {\n        validation: validation,\n        label: label,\n        description: description,\n        ...props\n      });\n    },\n    defaultValue() {\n      if (defaultValue === undefined) {\n        return null;\n      }\n      if (typeof defaultValue === 'string') {\n        return defaultValue;\n      }\n      const today = new Date();\n      const year = today.getFullYear();\n      const month = String(today.getMonth() + 1).padStart(2, '0');\n      const day = String(today.getDate()).padStart(2, '0');\n      return `${year}-${month}-${day}`;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (value instanceof Date) {\n        const year = value.getUTCFullYear();\n        const month = String(value.getUTCMonth() + 1).padStart(2, '0');\n        const day = String(value.getUTCDate()).padStart(2, '0');\n        return `${year}-${month}-${day}`;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      return value;\n    },\n    serialize(value) {\n      if (value === null) return {\n        value: undefined\n      };\n      const date = new Date(value);\n      date.toISOString = () => value;\n      date.toString = () => value;\n      return {\n        value: date\n      };\n    },\n    validate(value) {\n      const message = validateDate(validation, value, label);\n      if (message !== undefined) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F(message);\n      }\n      (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    }\n  });\n}\n\nfunction validateDatetime(validation, value, label) {\n  if (value !== null && !/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}$/.test(value)) {\n    return `${label} is not a valid datetime`;\n  }\n  if (validation !== null && validation !== void 0 && validation.isRequired && value === null) {\n    return `${label} is required`;\n  }\n  if ((validation !== null && validation !== void 0 && validation.min || validation !== null && validation !== void 0 && validation.max) && value !== null) {\n    const datetime = new Date(value);\n    if ((validation === null || validation === void 0 ? void 0 : validation.min) !== undefined) {\n      const min = new Date(validation.min);\n      if (datetime < min) {\n        return `${label} must be after ${min.toISOString()}`;\n      }\n    }\n    if ((validation === null || validation === void 0 ? void 0 : validation.max) !== undefined) {\n      const max = new Date(validation.max);\n      if (datetime > max) {\n        return `${label} must be no later than ${max.toISOString()}`;\n      }\n    }\n  }\n}\n\nfunction datetime({\n  label,\n  defaultValue,\n  validation,\n  description\n}) {\n  return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.d, {\n        validation: validation,\n        label: label,\n        description: description,\n        ...props\n      });\n    },\n    defaultValue() {\n      if (defaultValue === undefined) {\n        return null;\n      }\n      if (typeof defaultValue === 'string') {\n        return defaultValue;\n      }\n      if (defaultValue.kind === 'now') {\n        const now = new Date();\n        return new Date(now.getTime() - now.getTimezoneOffset() * 60 * 1000).toISOString().slice(0, -8);\n      }\n      return null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (value instanceof Date) {\n        return value.toISOString().slice(0, -8);\n      }\n      if (typeof value !== 'string') {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string or date');\n      }\n      return value;\n    },\n    serialize(value) {\n      if (value === null) return {\n        value: undefined\n      };\n      const date = new Date(value + 'Z');\n      date.toJSON = () => date.toISOString().slice(0, -8);\n      date.toString = () => date.toISOString().slice(0, -8);\n      return {\n        value: date\n      };\n    },\n    validate(value) {\n      const message = validateDatetime(validation, value, label);\n      if (message !== undefined) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F(message);\n      }\n      (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    }\n  });\n}\n\nfunction empty() {\n  return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    Input() {\n      return null;\n    },\n    defaultValue() {\n      return null;\n    },\n    parse() {\n      return null;\n    },\n    serialize() {\n      return {\n        value: undefined\n      };\n    },\n    validate(value) {\n      return value;\n    },\n    label: 'Empty'\n  });\n}\n\n/**\n * @deprecated `emptyDocument` has been replaced with the `emptyContent` field\n */\nfunction emptyDocument() {\n  return {\n    kind: 'form',\n    formKind: 'content',\n    Input() {\n      return null;\n    },\n    defaultValue() {\n      return null;\n    },\n    parse() {\n      return null;\n    },\n    contentExtension: '.mdoc',\n    serialize() {\n      return {\n        value: undefined,\n        content: new Uint8Array(),\n        external: new Map(),\n        other: new Map()\n      };\n    },\n    validate(value) {\n      return value;\n    },\n    reader: {\n      parse() {\n        return null;\n      }\n    }\n  };\n}\n\nfunction emptyContent(opts) {\n  return {\n    kind: 'form',\n    formKind: 'content',\n    Input() {\n      return null;\n    },\n    defaultValue() {\n      return null;\n    },\n    parse() {\n      return null;\n    },\n    contentExtension: `.${opts.extension}`,\n    serialize() {\n      return {\n        value: undefined,\n        content: new Uint8Array(),\n        external: new Map(),\n        other: new Map()\n      };\n    },\n    validate(value) {\n      return value;\n    },\n    reader: {\n      parse() {\n        return null;\n      }\n    }\n  };\n}\n\nfunction file({\n  label,\n  directory,\n  validation,\n  description,\n  publicPath,\n  transformFilename\n}) {\n  return {\n    kind: 'form',\n    formKind: 'asset',\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.e, {\n        label: label,\n        description: description,\n        validation: validation,\n        transformFilename: transformFilename,\n        ...props\n      });\n    },\n    defaultValue() {\n      return null;\n    },\n    filename(value, args) {\n      if (typeof value === 'string') {\n        return value.slice((0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug).length);\n      }\n      return undefined;\n    },\n    parse(value, args) {\n      var _value$match$, _value$match;\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      if (args.asset === undefined) {\n        return null;\n      }\n      return {\n        data: args.asset,\n        filename: value.slice((0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug).length),\n        extension: (_value$match$ = (_value$match = value.match(/\\.([^.]+$)/)) === null || _value$match === void 0 ? void 0 : _value$match[1]) !== null && _value$match$ !== void 0 ? _value$match$ : ''\n      };\n    },\n    validate(value) {\n      (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value, args) {\n      if (value === null) {\n        return {\n          value: undefined,\n          asset: undefined\n        };\n      }\n      const filename = args.suggestedFilenamePrefix ? args.suggestedFilenamePrefix + '.' + value.extension : value.filename;\n      return {\n        value: `${(0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug)}${filename}`,\n        asset: {\n          filename,\n          content: value.data\n        }\n      };\n    },\n    directory: directory ? (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.f)(directory) : undefined,\n    reader: {\n      parse(value) {\n        if (typeof value !== 'string' && value !== undefined) {\n          throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n        }\n        const val = value === undefined ? null : value;\n        (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.c)(val, validation, label);\n        return val;\n      }\n    }\n  };\n}\n\nfunction image({\n  label,\n  directory,\n  validation,\n  description,\n  publicPath,\n  transformFilename\n}) {\n  return {\n    kind: 'form',\n    formKind: 'asset',\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.I, {\n        label: label,\n        description: description,\n        validation: validation,\n        transformFilename: transformFilename,\n        ...props\n      });\n    },\n    defaultValue() {\n      return null;\n    },\n    filename(value, args) {\n      if (typeof value === 'string') {\n        return value.slice((0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug).length);\n      }\n      return undefined;\n    },\n    parse(value, args) {\n      var _value$match$, _value$match;\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      if (args.asset === undefined) {\n        return null;\n      }\n      return {\n        data: args.asset,\n        filename: value.slice((0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug).length),\n        extension: (_value$match$ = (_value$match = value.match(/\\.([^.]+$)/)) === null || _value$match === void 0 ? void 0 : _value$match[1]) !== null && _value$match$ !== void 0 ? _value$match$ : ''\n      };\n    },\n    validate(value) {\n      (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value, args) {\n      if (value === null) {\n        return {\n          value: undefined,\n          asset: undefined\n        };\n      }\n      const filename = args.suggestedFilenamePrefix ? args.suggestedFilenamePrefix + '.' + value.extension : value.filename;\n      return {\n        value: `${(0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.g)(publicPath, args.slug)}${filename}`,\n        asset: {\n          filename,\n          content: value.data\n        }\n      };\n    },\n    directory: directory ? (0,_index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.f)(directory) : undefined,\n    reader: {\n      parse(value) {\n        if (typeof value !== 'string' && value !== undefined) {\n          throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n        }\n        const val = value === undefined ? null : value;\n        (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.c)(val, validation, label);\n        return val;\n      }\n    }\n  };\n}\n\nfunction pluralize(count, options) {\n  const {\n    singular,\n    plural = singular + 's',\n    inclusive = true\n  } = options;\n  const variant = count === 1 ? singular : plural;\n  return inclusive ? `${count} ${variant}` : variant;\n}\n\nfunction validateMultiRelationshipLength(validation, value) {\n  var _validation$length$mi, _validation$length, _validation$length$ma, _validation$length2;\n  const minLength = (_validation$length$mi = validation === null || validation === void 0 || (_validation$length = validation.length) === null || _validation$length === void 0 ? void 0 : _validation$length.min) !== null && _validation$length$mi !== void 0 ? _validation$length$mi : 0;\n  if (value.length < minLength) {\n    return `Must have at least ${pluralize(minLength, {\n      singular: 'item'\n    })}.`;\n  }\n  const maxLength = (_validation$length$ma = validation === null || validation === void 0 || (_validation$length2 = validation.length) === null || _validation$length2 === void 0 ? void 0 : _validation$length2.max) !== null && _validation$length$ma !== void 0 ? _validation$length$ma : Infinity;\n  if (value.length > maxLength) {\n    return `Must have at most ${pluralize(maxLength, {\n      singular: 'item'\n    })}.`;\n  }\n}\n\nfunction multiRelationship({\n  label,\n  collection,\n  validation,\n  description\n}) {\n  return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.M, {\n        label: label,\n        collection: collection,\n        description: description,\n        validation: validation,\n        ...props\n      });\n    },\n    defaultValue() {\n      return [];\n    },\n    parse(value) {\n      if (value === undefined) {\n        return [];\n      }\n      if (!Array.isArray(value) || !value.every(emery__WEBPACK_IMPORTED_MODULE_4__.isString)) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be an array of strings');\n      }\n      return value;\n    },\n    validate(value) {\n      const error = validateMultiRelationshipLength(validation, value);\n      if (error) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F(error);\n      }\n      return value;\n    },\n    serialize(value) {\n      return {\n        value\n      };\n    }\n  });\n}\n\nfunction multiselect({\n  label,\n  options,\n  defaultValue = [],\n  description\n}) {\n  const valuesToOption = new Map(options.map(x => [x.value, x]));\n  const field = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.f, {\n        label: label,\n        description: description,\n        options: options,\n        ...props\n      });\n    },\n    defaultValue() {\n      return defaultValue;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return [];\n      }\n      if (!Array.isArray(value)) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be an array of options');\n      }\n      if (!value.every(x => typeof x === 'string' && valuesToOption.has(x))) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F(`Must be an array with one of ${options.map(x => x.value).join(', ')}`);\n      }\n      return value;\n    },\n    validate(value) {\n      return value;\n    },\n    serialize(value) {\n      return {\n        value\n      };\n    }\n  });\n  return {\n    ...field,\n    options\n  };\n}\n\nfunction validateNumber(validation, value, step, label) {\n  if (value !== null && typeof value !== 'number') {\n    return `${label} must be a number`;\n  }\n  if (validation !== null && validation !== void 0 && validation.isRequired && value === null) {\n    return `${label} is required`;\n  }\n  if (value !== null) {\n    if ((validation === null || validation === void 0 ? void 0 : validation.min) !== undefined && value < validation.min) {\n      return `${label} must be at least ${validation.min}`;\n    }\n    if ((validation === null || validation === void 0 ? void 0 : validation.max) !== undefined && value > validation.max) {\n      return `${label} must be at most ${validation.max}`;\n    }\n    if (step !== undefined && (validation === null || validation === void 0 ? void 0 : validation.validateStep) !== undefined && !isAtStep(value, step)) {\n      return `${label} must be a multiple of ${step}`;\n    }\n  }\n}\nfunction decimalPlaces(value) {\n  const stringified = value.toString();\n  const indexOfDecimal = stringified.indexOf('.');\n  if (indexOfDecimal === -1) {\n    const indexOfE = stringified.indexOf('e-');\n    return indexOfE === -1 ? 0 : parseInt(stringified.slice(indexOfE + 2));\n  }\n  return stringified.length - indexOfDecimal - 1;\n}\nfunction isAtStep(value, step) {\n  const dc = Math.max(decimalPlaces(step), decimalPlaces(value));\n  const base = Math.pow(10, dc);\n  return value * base % (step * base) === 0;\n}\n\nfunction number({\n  label,\n  defaultValue,\n  step,\n  validation,\n  description\n}) {\n  return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.N, {\n        label: label,\n        description: description,\n        validation: validation,\n        step: step,\n        ...props\n      });\n    },\n    defaultValue() {\n      return defaultValue !== null && defaultValue !== void 0 ? defaultValue : null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value === 'number') {\n        return value;\n      }\n      throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a number');\n    },\n    validate(value) {\n      const message = validateNumber(validation, value, step, label);\n      if (message !== undefined) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F(message);\n      }\n      (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value) {\n      return {\n        value: value === null ? undefined : value\n      };\n    }\n  });\n}\n\nfunction pathReference({\n  label,\n  pattern,\n  validation,\n  description\n}) {\n  return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.P, {\n        label: label,\n        pattern: pattern,\n        description: description,\n        validation: validation,\n        ...props\n      });\n    },\n    defaultValue() {\n      return null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      return value;\n    },\n    validate(value) {\n      (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value) {\n      return {\n        value: value === null ? undefined : value\n      };\n    }\n  });\n}\n\nfunction relationship({\n  label,\n  collection,\n  validation,\n  description\n}) {\n  return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.R, {\n        label: label,\n        collection: collection,\n        description: description,\n        validation: validation,\n        ...props\n      });\n    },\n    defaultValue() {\n      return null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      return value;\n    },\n    validate(value) {\n      (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value) {\n      return {\n        value: value === null ? undefined : value\n      };\n    }\n  });\n}\n\nfunction parseSlugFieldAsNormalField(value) {\n  if (value === undefined) {\n    return {\n      name: '',\n      slug: ''\n    };\n  }\n  if (typeof value !== 'object') {\n    throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be an object');\n  }\n  if (Object.keys(value).length !== 2) {\n    throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Unexpected keys');\n  }\n  if (!('name' in value) || !('slug' in value)) {\n    throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Missing name or slug');\n  }\n  if (typeof value.name !== 'string') {\n    throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('name must be a string');\n  }\n  if (typeof value.slug !== 'string') {\n    throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('slug must be a string');\n  }\n  return {\n    name: value.name,\n    slug: value.slug\n  };\n}\nfunction parseAsSlugField(value, slug) {\n  if (value === undefined) {\n    return {\n      name: '',\n      slug\n    };\n  }\n  if (typeof value !== 'string') {\n    throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n  }\n  return {\n    name: value,\n    slug\n  };\n}\nfunction slug(_args) {\n  var _args$name$validation, _args$name$validation2, _args$name$validation3, _args$name$validation4, _args$name$validation5, _args$slug;\n  const args = {\n    ..._args,\n    name: {\n      ..._args.name,\n      validation: {\n        pattern: (_args$name$validation = _args.name.validation) === null || _args$name$validation === void 0 ? void 0 : _args$name$validation.pattern,\n        length: {\n          min: Math.max((_args$name$validation2 = _args.name.validation) !== null && _args$name$validation2 !== void 0 && _args$name$validation2.isRequired ? 1 : 0, (_args$name$validation3 = (_args$name$validation4 = _args.name.validation) === null || _args$name$validation4 === void 0 || (_args$name$validation4 = _args$name$validation4.length) === null || _args$name$validation4 === void 0 ? void 0 : _args$name$validation4.min) !== null && _args$name$validation3 !== void 0 ? _args$name$validation3 : 0),\n          max: (_args$name$validation5 = _args.name.validation) === null || _args$name$validation5 === void 0 || (_args$name$validation5 = _args$name$validation5.length) === null || _args$name$validation5 === void 0 ? void 0 : _args$name$validation5.max\n        }\n      }\n    }\n  };\n  const naiveGenerateSlug = ((_args$slug = args.slug) === null || _args$slug === void 0 ? void 0 : _args$slug.generate) || _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.s;\n  let _defaultValue;\n  function defaultValue() {\n    if (!_defaultValue) {\n      var _args$name$defaultVal, _args$name$defaultVal2;\n      _defaultValue = {\n        name: (_args$name$defaultVal = args.name.defaultValue) !== null && _args$name$defaultVal !== void 0 ? _args$name$defaultVal : '',\n        slug: naiveGenerateSlug((_args$name$defaultVal2 = args.name.defaultValue) !== null && _args$name$defaultVal2 !== void 0 ? _args$name$defaultVal2 : '')\n      };\n    }\n    return _defaultValue;\n  }\n  function validate(value, {\n    slugField\n  } = {\n    slugField: undefined\n  }) {\n    var _args$name$validation6, _args$name$validation7, _args$name$validation8, _args$name$validation9, _args$name$validation10, _args$slug$validation, _args$slug2, _args$slug$validation2, _args$slug3, _args$slug$label, _args$slug4, _args$slug5;\n    const nameMessage = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.v)(value.name, (_args$name$validation6 = (_args$name$validation7 = args.name.validation) === null || _args$name$validation7 === void 0 || (_args$name$validation7 = _args$name$validation7.length) === null || _args$name$validation7 === void 0 ? void 0 : _args$name$validation7.min) !== null && _args$name$validation6 !== void 0 ? _args$name$validation6 : 0, (_args$name$validation8 = (_args$name$validation9 = args.name.validation) === null || _args$name$validation9 === void 0 || (_args$name$validation9 = _args$name$validation9.length) === null || _args$name$validation9 === void 0 ? void 0 : _args$name$validation9.max) !== null && _args$name$validation8 !== void 0 ? _args$name$validation8 : Infinity, args.name.label, undefined, (_args$name$validation10 = args.name.validation) === null || _args$name$validation10 === void 0 ? void 0 : _args$name$validation10.pattern);\n    if (nameMessage !== undefined) {\n      throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F(nameMessage);\n    }\n    const slugMessage = (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.v)(value.slug, (_args$slug$validation = (_args$slug2 = args.slug) === null || _args$slug2 === void 0 || (_args$slug2 = _args$slug2.validation) === null || _args$slug2 === void 0 || (_args$slug2 = _args$slug2.length) === null || _args$slug2 === void 0 ? void 0 : _args$slug2.min) !== null && _args$slug$validation !== void 0 ? _args$slug$validation : 1, (_args$slug$validation2 = (_args$slug3 = args.slug) === null || _args$slug3 === void 0 || (_args$slug3 = _args$slug3.validation) === null || _args$slug3 === void 0 || (_args$slug3 = _args$slug3.length) === null || _args$slug3 === void 0 ? void 0 : _args$slug3.max) !== null && _args$slug$validation2 !== void 0 ? _args$slug$validation2 : Infinity, (_args$slug$label = (_args$slug4 = args.slug) === null || _args$slug4 === void 0 ? void 0 : _args$slug4.label) !== null && _args$slug$label !== void 0 ? _args$slug$label : 'Slug', slugField ? slugField : {\n      slugs: emptySet,\n      glob: '*'\n    }, (_args$slug5 = args.slug) === null || _args$slug5 === void 0 || (_args$slug5 = _args$slug5.validation) === null || _args$slug5 === void 0 ? void 0 : _args$slug5.pattern);\n    if (slugMessage !== undefined) {\n      throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F(slugMessage);\n    }\n    return value;\n  }\n  const emptySet = new Set();\n  return {\n    kind: 'form',\n    formKind: 'slug',\n    label: args.name.label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.g, {\n        args: args,\n        naiveGenerateSlug: naiveGenerateSlug,\n        defaultValue: defaultValue(),\n        ...props\n      });\n    },\n    defaultValue,\n    parse(value, args) {\n      if ((args === null || args === void 0 ? void 0 : args.slug) !== undefined) {\n        return parseAsSlugField(value, args.slug);\n      }\n      return parseSlugFieldAsNormalField(value);\n    },\n    validate,\n    serialize(value) {\n      return {\n        value\n      };\n    },\n    serializeWithSlug(value) {\n      return {\n        value: value.name,\n        slug: value.slug\n      };\n    },\n    reader: {\n      parse(value) {\n        const parsed = parseSlugFieldAsNormalField(value);\n        return validate(parsed);\n      },\n      parseWithSlug(value, args) {\n        return validate(parseAsSlugField(value, args.slug), {\n          slugField: {\n            glob: args.glob,\n            slugs: emptySet\n          }\n        }).name;\n      }\n    }\n  };\n}\n\nfunction isValidURL(url) {\n  return url === (0,_braintree_sanitize_url__WEBPACK_IMPORTED_MODULE_5__.sanitizeUrl)(url);\n}\n\nfunction validateUrl(validation, value, label) {\n  if (value !== null && (typeof value !== 'string' || !isValidURL(value))) {\n    return `${label} is not a valid URL`;\n  }\n  if (validation !== null && validation !== void 0 && validation.isRequired && value === null) {\n    return `${label} is required`;\n  }\n}\n\nfunction url({\n  label,\n  defaultValue,\n  validation,\n  description\n}) {\n  return (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.b)({\n    label,\n    Input(props) {\n      return /*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.U, {\n        label: label,\n        description: description,\n        validation: validation,\n        ...props\n      });\n    },\n    defaultValue() {\n      return defaultValue || null;\n    },\n    parse(value) {\n      if (value === undefined) {\n        return null;\n      }\n      if (typeof value !== 'string') {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F('Must be a string');\n      }\n      return value === '' ? null : value;\n    },\n    validate(value) {\n      const message = validateUrl(validation, value, label);\n      if (message !== undefined) {\n        throw new _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.F(message);\n      }\n      (0,_index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.c)(value, validation, label);\n      return value;\n    },\n    serialize(value) {\n      return {\n        value: value === null ? undefined : value\n      };\n    }\n  });\n}\n\nfunction ignored() {\n  return {\n    kind: 'form',\n    Input() {\n      return null;\n    },\n    defaultValue() {\n      return {\n        value: undefined\n      };\n    },\n    parse(value) {\n      return {\n        value\n      };\n    },\n    serialize(value) {\n      return value;\n    },\n    validate(value) {\n      return value;\n    },\n    label: 'Ignored',\n    reader: {\n      parse(value) {\n        return value;\n      }\n    }\n  };\n}\n\nvar index = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  array: array,\n  blocks: blocks,\n  checkbox: checkbox,\n  child: child,\n  cloudImage: cloudImage,\n  conditional: conditional,\n  date: date,\n  datetime: datetime,\n  document: _index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.d,\n  empty: empty,\n  emptyDocument: emptyDocument,\n  emptyContent: emptyContent,\n  file: file,\n  image: image,\n  integer: _index_9722793d_node_react_server_js__WEBPACK_IMPORTED_MODULE_6__.i,\n  multiRelationship: multiRelationship,\n  multiselect: multiselect,\n  number: number,\n  object: _index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.o,\n  pathReference: pathReference,\n  relationship: relationship,\n  select: select,\n  slug: slug,\n  text: _index_10ea50e2_node_react_server_js__WEBPACK_IMPORTED_MODULE_1__.t,\n  url: url,\n  ignored: ignored,\n  mdx: _index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.m,\n  markdoc: _index_ca270311_node_react_server_js__WEBPACK_IMPORTED_MODULE_3__.a\n});\n\nfunction BlockWrapper() {}\nfunction NotEditable() {}\nfunction ToolbarSeparator() {}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3Qva2V5c3RhdGljLWNvcmUubm9kZS5yZWFjdC1zZXJ2ZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBcUU7QUFDdWQ7QUFDcGY7QUFDb0c7QUFDM0c7QUFDcUI7QUFDZTtBQUM1QjtBQUNmO0FBQ1Y7O0FBRWhCOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSx5Q0FBeUMsY0FBYztBQUN2RDtBQUNBLGdCQUFnQix1RUFBbUM7QUFDbkQ7QUFDQTtBQUNBLDBCQUEwQixzREFBRyxDQUFDLG1FQUFnQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLG1FQUFjO0FBQ2hDO0FBQ0E7QUFDQSxrQkFBa0IsbUVBQWM7QUFDaEM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsV0FBVyxtRUFBZ0I7QUFDM0I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxTQUFTLHVFQUFtQztBQUM1QztBQUNBO0FBQ0EsMEJBQTBCLHNEQUFHLENBQUMsbUVBQWtCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUVBQWM7QUFDaEM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLE9BQU8sdUVBQU07QUFDYixXQUFXLHVFQUFJO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLFdBQVcsdUVBQUk7QUFDZjtBQUNBLE9BQU87QUFDUCxjQUFjLHVFQUFPO0FBQ3JCO0FBQ0EsT0FBTztBQUNQLGFBQWEsdUVBQU87QUFDcEI7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSwwQkFBMEIsc0RBQUcsQ0FBQyxtRUFBb0I7QUFDbEQ7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw4QkFBOEIsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFO0FBQzVDLGNBQWMsT0FBTztBQUNyQjtBQUNBO0FBQ0EsY0FBYyxPQUFPO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPLGdCQUFnQix5QkFBeUI7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPLHdCQUF3Qix5QkFBeUI7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxTQUFTLHVFQUFtQztBQUM1QztBQUNBO0FBQ0EsMEJBQTBCLHNEQUFHLENBQUMsbUVBQWM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsS0FBSyxHQUFHLE1BQU0sR0FBRyxJQUFJO0FBQ3JDLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLEtBQUssR0FBRyxNQUFNLEdBQUcsSUFBSTtBQUN2QztBQUNBO0FBQ0Esa0JBQWtCLG1FQUFjO0FBQ2hDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLG1FQUFjO0FBQ2hDO0FBQ0EsTUFBTSx1RUFBYztBQUNwQjtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0EsOEJBQThCLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFO0FBQ3hELGNBQWMsT0FBTztBQUNyQjtBQUNBO0FBQ0EsY0FBYyxPQUFPO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPLGdCQUFnQixrQkFBa0I7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPLHdCQUF3QixrQkFBa0I7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxTQUFTLHVFQUFtQztBQUM1QztBQUNBO0FBQ0EsMEJBQTBCLHNEQUFHLENBQUMsbUVBQWtCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixtRUFBYztBQUNoQztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixtRUFBYztBQUNoQztBQUNBLE1BQU0sdUVBQWM7QUFDcEI7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBLFNBQVMsdUVBQW1DO0FBQzVDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTCwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQUcsQ0FBQyxtRUFBYztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSwyQkFBMkIsdUVBQVk7QUFDdkM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUVBQWM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLHVFQUFZO0FBQzFDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxNQUFNLHVFQUFjO0FBQ3BCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix1RUFBWSx3QkFBd0IsRUFBRSxTQUFTO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsMkJBQTJCLHVFQUFPO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixtRUFBYztBQUNsQztBQUNBO0FBQ0EsUUFBUSx1RUFBYztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQUcsQ0FBQyxtRUFBZTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSwyQkFBMkIsdUVBQVk7QUFDdkM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUVBQWM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLHVFQUFZO0FBQzFDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxNQUFNLHVFQUFjO0FBQ3BCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix1RUFBWSx3QkFBd0IsRUFBRSxTQUFTO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsMkJBQTJCLHVFQUFPO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixtRUFBYztBQUNsQztBQUNBO0FBQ0EsUUFBUSx1RUFBYztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSx3QkFBd0IsT0FBTyxFQUFFLFFBQVE7QUFDekM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQSxLQUFLLEVBQUU7QUFDUDtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQSxLQUFLLEVBQUU7QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsU0FBUyx1RUFBbUM7QUFDNUM7QUFDQTtBQUNBLDBCQUEwQixzREFBRyxDQUFDLG1FQUFzQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELDJDQUFRO0FBQ3hELGtCQUFrQixtRUFBYztBQUNoQztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixtRUFBYztBQUNoQztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLGdCQUFnQix1RUFBbUM7QUFDbkQ7QUFDQTtBQUNBLDBCQUEwQixzREFBRyxDQUFDLG1FQUFxQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLG1FQUFjO0FBQ2hDO0FBQ0E7QUFDQSxrQkFBa0IsbUVBQWMsaUNBQWlDLHFDQUFxQztBQUN0RztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxjQUFjLE9BQU87QUFDckI7QUFDQTtBQUNBLGNBQWMsT0FBTztBQUNyQjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsT0FBTyxtQkFBbUIsZUFBZTtBQUN6RDtBQUNBO0FBQ0EsZ0JBQWdCLE9BQU8sa0JBQWtCLGVBQWU7QUFDeEQ7QUFDQTtBQUNBLGdCQUFnQixPQUFPLHdCQUF3QixLQUFLO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELFNBQVMsdUVBQW1DO0FBQzVDO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQUcsQ0FBQyxtRUFBZ0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixtRUFBYztBQUM5QixLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLG1FQUFjO0FBQ2hDO0FBQ0EsTUFBTSx1RUFBYztBQUNwQjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsU0FBUyx1RUFBbUM7QUFDNUM7QUFDQTtBQUNBLDBCQUEwQixzREFBRyxDQUFDLG1FQUFrQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUVBQWM7QUFDaEM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLE1BQU0sdUVBQWM7QUFDcEI7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELFNBQVMsdUVBQW1DO0FBQzVDO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQUcsQ0FBQyxtRUFBaUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLG1FQUFjO0FBQ2hDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxNQUFNLHVFQUFjO0FBQ3BCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsbUVBQWM7QUFDNUI7QUFDQTtBQUNBLGNBQWMsbUVBQWM7QUFDNUI7QUFDQTtBQUNBLGNBQWMsbUVBQWM7QUFDNUI7QUFDQTtBQUNBLGNBQWMsbUVBQWM7QUFDNUI7QUFDQTtBQUNBLGNBQWMsbUVBQWM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsbUVBQWM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkhBQTJILG1FQUFPO0FBQ2xJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsR0FBRztBQUNIO0FBQ0Esd0JBQXdCLHVFQUFZO0FBQ3BDO0FBQ0EsZ0JBQWdCLG1FQUFjO0FBQzlCO0FBQ0Esd0JBQXdCLHVFQUFZO0FBQ3BDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxnQkFBZ0IsbUVBQWM7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHNEQUFHLENBQUMsbUVBQWM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsaUJBQWlCLG9FQUFXO0FBQzVCOztBQUVBO0FBQ0E7QUFDQSxjQUFjLE9BQU87QUFDckI7QUFDQTtBQUNBLGNBQWMsT0FBTztBQUNyQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsU0FBUyx1RUFBbUM7QUFDNUM7QUFDQTtBQUNBLDBCQUEwQixzREFBRyxDQUFDLG1FQUFhO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUVBQWM7QUFDaEM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUVBQWM7QUFDaEM7QUFDQSxNQUFNLHVFQUFjO0FBQ3BCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksbUVBQVE7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsbUVBQU87QUFDbEI7QUFDQTtBQUNBO0FBQ0EsVUFBVSxtRUFBTTtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsbUVBQUk7QUFDWjtBQUNBO0FBQ0EsT0FBTyxtRUFBRztBQUNWLFdBQVcsbUVBQU87QUFDbEIsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7O0FBRXVHIiwic291cmNlcyI6WyIvVXNlcnMvamFtZXMvRG93bmxvYWRzL25ldy1rZXlzdGF0aWMtcHJvamVjdC9ub2RlX21vZHVsZXMvQGtleXN0YXRpYy9jb3JlL2Rpc3Qva2V5c3RhdGljLWNvcmUubm9kZS5yZWFjdC1zZXJ2ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHsgYyBhcyBjb21wb25lbnQgfSBmcm9tICcuL2FwaS1jNWM3M2I1Mi5ub2RlLnJlYWN0LXNlcnZlci5qcyc7XG5pbXBvcnQgeyBiIGFzIGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlLCBTIGFzIFNlbGVjdEZpZWxkSW5wdXQsIEYgYXMgRmllbGREYXRhRXJyb3IsIEIgYXMgQmxvY2tzRmllbGRJbnB1dCwgQyBhcyBDaGVja2JveEZpZWxkSW5wdXQsIHQgYXMgdGV4dCwgYSBhcyBDbG91ZEltYWdlRmllbGRJbnB1dCwgRCBhcyBEYXRlRmllbGRJbnB1dCwgYyBhcyBhc3NlcnRSZXF1aXJlZCwgZCBhcyBEYXRldGltZUZpZWxkSW5wdXQsIGUgYXMgRmlsZUZpZWxkSW5wdXQsIEkgYXMgSW1hZ2VGaWVsZElucHV0LCBNIGFzIE11bHRpUmVsYXRpb25zaGlwSW5wdXQsIGYgYXMgTXVsdGlzZWxlY3RGaWVsZElucHV0LCBOIGFzIE51bWJlckZpZWxkSW5wdXQsIFAgYXMgUGF0aFJlZmVyZW5jZUlucHV0LCBSIGFzIFJlbGF0aW9uc2hpcElucHV0LCBzIGFzIHNsdWdpZnksIGcgYXMgU2x1Z0ZpZWxkSW5wdXQsIHYgYXMgdmFsaWRhdGVUZXh0LCBVIGFzIFVybEZpZWxkSW5wdXQgfSBmcm9tICcuL2luZGV4LTEwZWE1MGUyLm5vZGUucmVhY3Qtc2VydmVyLmpzJztcbmltcG9ydCB7IGpzeCB9IGZyb20gJ3JlYWN0L2pzeC1ydW50aW1lJztcbmltcG9ydCB7IG8gYXMgb2JqZWN0LCBnIGFzIGdldFNyY1ByZWZpeCwgZiBhcyBmaXhQYXRoLCBkIGFzIGRvY3VtZW50LCBtIGFzIG1keCwgYSBhcyBtYXJrZG9jIH0gZnJvbSAnLi9pbmRleC1jYTI3MDMxMS5ub2RlLnJlYWN0LXNlcnZlci5qcyc7XG5pbXBvcnQgeyBpc1N0cmluZyB9IGZyb20gJ2VtZXJ5JztcbmltcG9ydCB7IHNhbml0aXplVXJsIH0gZnJvbSAnQGJyYWludHJlZS9zYW5pdGl6ZS11cmwnO1xuaW1wb3J0IHsgaSBhcyBpbnRlZ2VyIH0gZnJvbSAnLi9pbmRleC05NzIyNzkzZC5ub2RlLnJlYWN0LXNlcnZlci5qcyc7XG5pbXBvcnQgJ0BtYXJrZG9jL21hcmtkb2MvZGlzdC9pbmRleC5tanMnO1xuaW1wb3J0ICdlbWVyeS9hc3NlcnRpb25zJztcbmltcG9ydCAnY3J5cHRvJztcblxuLy8gQ29tbW9uXG5cbi8vIFN0b3JhZ2Vcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRnVuY3Rpb25zXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmZ1bmN0aW9uIGNvbmZpZyhjb25maWcpIHtcbiAgcmV0dXJuIGNvbmZpZztcbn1cbmZ1bmN0aW9uIGNvbGxlY3Rpb24oY29sbGVjdGlvbikge1xuICByZXR1cm4gY29sbGVjdGlvbjtcbn1cbmZ1bmN0aW9uIHNpbmdsZXRvbihjb2xsZWN0aW9uKSB7XG4gIHJldHVybiBjb2xsZWN0aW9uO1xufVxuXG5mdW5jdGlvbiBhcnJheShlbGVtZW50LCBvcHRzKSB7XG4gIHZhciBfb3B0cyRsYWJlbDtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnYXJyYXknLFxuICAgIGVsZW1lbnQsXG4gICAgbGFiZWw6IChfb3B0cyRsYWJlbCA9IG9wdHMgPT09IG51bGwgfHwgb3B0cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0cy5sYWJlbCkgIT09IG51bGwgJiYgX29wdHMkbGFiZWwgIT09IHZvaWQgMCA/IF9vcHRzJGxhYmVsIDogJ0l0ZW1zJyxcbiAgICBkZXNjcmlwdGlvbjogb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLmRlc2NyaXB0aW9uLFxuICAgIGl0ZW1MYWJlbDogb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLml0ZW1MYWJlbCxcbiAgICBhc0NoaWxkVGFnOiBvcHRzID09PSBudWxsIHx8IG9wdHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdHMuYXNDaGlsZFRhZyxcbiAgICBzbHVnRmllbGQ6IG9wdHMgPT09IG51bGwgfHwgb3B0cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0cy5zbHVnRmllbGQsXG4gICAgdmFsaWRhdGlvbjogb3B0cyA9PT0gbnVsbCB8fCBvcHRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRzLnZhbGlkYXRpb25cbiAgfTtcbn1cblxuZnVuY3Rpb24gc2VsZWN0KHtcbiAgbGFiZWwsXG4gIG9wdGlvbnMsXG4gIGRlZmF1bHRWYWx1ZSxcbiAgZGVzY3JpcHRpb25cbn0pIHtcbiAgY29uc3Qgb3B0aW9uVmFsdWVzU2V0ID0gbmV3IFNldChvcHRpb25zLm1hcCh4ID0+IHgudmFsdWUpKTtcbiAgaWYgKCFvcHRpb25WYWx1ZXNTZXQuaGFzKGRlZmF1bHRWYWx1ZSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEEgZGVmYXVsdFZhbHVlIG9mICR7ZGVmYXVsdFZhbHVlfSB3YXMgcHJvdmlkZWQgdG8gYSBzZWxlY3QgZmllbGQgYnV0IGl0IGRvZXMgbm90IG1hdGNoIHRoZSB2YWx1ZSBvZiBvbmUgb2YgdGhlIG9wdGlvbnMgcHJvdmlkZWRgKTtcbiAgfVxuICBjb25zdCBmaWVsZCA9IGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlKHtcbiAgICBsYWJlbCxcbiAgICBJbnB1dChwcm9wcykge1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9qc3goU2VsZWN0RmllbGRJbnB1dCwge1xuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIG9wdGlvbnM6IG9wdGlvbnMsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgLi4ucHJvcHNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICB9XG4gICAgICBpZiAoIW9wdGlvblZhbHVlc1NldC5oYXModmFsdWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHZhbGlkIG9wdGlvbicpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWVcbiAgICAgIH07XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICAuLi5maWVsZCxcbiAgICBvcHRpb25zXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJsb2NrcyhibG9ja3MsIG9wdHMpIHtcbiAgY29uc3QgZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKGJsb2Nrcyk7XG4gIGlmICghZW50cmllcy5sZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2ZpZWxkcy5ibG9ja3MgbXVzdCBoYXZlIGF0IGxlYXN0IG9uZSBlbnRyeScpO1xuICB9XG4gIGNvbnN0IHNlbGVjdCQxID0gc2VsZWN0KHtcbiAgICBsYWJlbDogJ0tpbmQnLFxuICAgIGRlZmF1bHRWYWx1ZTogZW50cmllc1swXVswXSxcbiAgICBvcHRpb25zOiBPYmplY3QuZW50cmllcyhibG9ja3MpLm1hcCgoW2tleSwge1xuICAgICAgbGFiZWxcbiAgICB9XSkgPT4gKHtcbiAgICAgIGxhYmVsLFxuICAgICAgdmFsdWU6IGtleVxuICAgIH0pKVxuICB9KTtcbiAgY29uc3QgZWxlbWVudCA9IGNvbmRpdGlvbmFsKHNlbGVjdCQxLCBPYmplY3QuZnJvbUVudHJpZXMoZW50cmllcy5tYXAoKFtrZXksIHtcbiAgICBzY2hlbWFcbiAgfV0pID0+IFtrZXksIHNjaGVtYV0pKSk7XG4gIHJldHVybiB7XG4gICAgLi4uYXJyYXkoZWxlbWVudCwge1xuICAgICAgbGFiZWw6IG9wdHMubGFiZWwsXG4gICAgICBkZXNjcmlwdGlvbjogb3B0cy5kZXNjcmlwdGlvbixcbiAgICAgIHZhbGlkYXRpb246IG9wdHMudmFsaWRhdGlvbixcbiAgICAgIGl0ZW1MYWJlbChwcm9wcykge1xuICAgICAgICBjb25zdCBraW5kID0gcHJvcHMuZGlzY3JpbWluYW50O1xuICAgICAgICBjb25zdCBibG9jayA9IGJsb2Nrc1traW5kXTtcbiAgICAgICAgaWYgKCFibG9jay5pdGVtTGFiZWwpIHJldHVybiBibG9jay5sYWJlbDtcbiAgICAgICAgcmV0dXJuIGJsb2NrLml0ZW1MYWJlbChwcm9wcy52YWx1ZSk7XG4gICAgICB9XG4gICAgfSksXG4gICAgSW5wdXQ6IEJsb2Nrc0ZpZWxkSW5wdXRcbiAgfTtcbn1cblxuZnVuY3Rpb24gY2hlY2tib3goe1xuICBsYWJlbCxcbiAgZGVmYXVsdFZhbHVlID0gZmFsc2UsXG4gIGRlc2NyaXB0aW9uXG59KSB7XG4gIHJldHVybiBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KENoZWNrYm94RmllbGRJbnB1dCwge1xuICAgICAgICAuLi5wcm9wcyxcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb25cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdib29sZWFuJykge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYSBib29sZWFuJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKHZhbHVlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZVxuICAgICAgfTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjaGlsZChvcHRpb25zKSB7XG4gIHJldHVybiB7XG4gICAga2luZDogJ2NoaWxkJyxcbiAgICBvcHRpb25zOiBvcHRpb25zLmtpbmQgPT09ICdibG9jaycgPyB7XG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgZGl2aWRlcnM6IG9wdGlvbnMuZGl2aWRlcnMsXG4gICAgICBmb3JtYXR0aW5nOiBvcHRpb25zLmZvcm1hdHRpbmcgPT09ICdpbmhlcml0JyA/IHtcbiAgICAgICAgYmxvY2tUeXBlczogJ2luaGVyaXQnLFxuICAgICAgICBoZWFkaW5nTGV2ZWxzOiAnaW5oZXJpdCcsXG4gICAgICAgIGlubGluZU1hcmtzOiAnaW5oZXJpdCcsXG4gICAgICAgIGxpc3RUeXBlczogJ2luaGVyaXQnLFxuICAgICAgICBhbGlnbm1lbnQ6ICdpbmhlcml0JyxcbiAgICAgICAgc29mdEJyZWFrczogJ2luaGVyaXQnXG4gICAgICB9IDogb3B0aW9ucy5mb3JtYXR0aW5nLFxuICAgICAgbGlua3M6IG9wdGlvbnMubGlua3MsXG4gICAgICBpbWFnZXM6IG9wdGlvbnMuaW1hZ2VzLFxuICAgICAgdGFibGVzOiBvcHRpb25zLnRhYmxlcyxcbiAgICAgIGNvbXBvbmVudEJsb2Nrczogb3B0aW9ucy5jb21wb25lbnRCbG9ja3NcbiAgICB9IDoge1xuICAgICAga2luZDogJ2lubGluZScsXG4gICAgICBwbGFjZWhvbGRlcjogb3B0aW9ucy5wbGFjZWhvbGRlcixcbiAgICAgIGZvcm1hdHRpbmc6IG9wdGlvbnMuZm9ybWF0dGluZyA9PT0gJ2luaGVyaXQnID8ge1xuICAgICAgICBpbmxpbmVNYXJrczogJ2luaGVyaXQnLFxuICAgICAgICBzb2Z0QnJlYWtzOiAnaW5oZXJpdCdcbiAgICAgIH0gOiBvcHRpb25zLmZvcm1hdHRpbmcsXG4gICAgICBsaW5rczogb3B0aW9ucy5saW5rc1xuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gY2xvdWRJbWFnZSh7XG4gIGxhYmVsLFxuICBkZXNjcmlwdGlvbixcbiAgdmFsaWRhdGlvblxufSkge1xuICByZXR1cm4ge1xuICAgIC4uLm9iamVjdCh7XG4gICAgICBzcmM6IHRleHQoe1xuICAgICAgICBsYWJlbDogJ1VSTCcsXG4gICAgICAgIHZhbGlkYXRpb246IHtcbiAgICAgICAgICBsZW5ndGg6IHtcbiAgICAgICAgICAgIG1pbjogdmFsaWRhdGlvbiAhPT0gbnVsbCAmJiB2YWxpZGF0aW9uICE9PSB2b2lkIDAgJiYgdmFsaWRhdGlvbi5pc1JlcXVpcmVkID8gMSA6IDBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgICAgYWx0OiB0ZXh0KHtcbiAgICAgICAgbGFiZWw6ICdBbHQgdGV4dCdcbiAgICAgIH0pLFxuICAgICAgaGVpZ2h0OiBpbnRlZ2VyKHtcbiAgICAgICAgbGFiZWw6ICdIZWlnaHQnXG4gICAgICB9KSxcbiAgICAgIHdpZHRoOiBpbnRlZ2VyKHtcbiAgICAgICAgbGFiZWw6ICdXaWR0aCdcbiAgICAgIH0pXG4gICAgfSwge1xuICAgICAgbGFiZWwsXG4gICAgICBkZXNjcmlwdGlvblxuICAgIH0pLFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChDbG91ZEltYWdlRmllbGRJbnB1dCwge1xuICAgICAgICAuLi5wcm9wcyxcbiAgICAgICAgaXNSZXF1aXJlZDogdmFsaWRhdGlvbiA9PT0gbnVsbCB8fCB2YWxpZGF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiB2YWxpZGF0aW9uLmlzUmVxdWlyZWRcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gY29uZGl0aW9uYWwoZGlzY3JpbWluYW50LCB2YWx1ZXMpIHtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnY29uZGl0aW9uYWwnLFxuICAgIGRpc2NyaW1pbmFudCxcbiAgICB2YWx1ZXM6IHZhbHVlc1xuICB9O1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZURhdGUodmFsaWRhdGlvbiwgdmFsdWUsIGxhYmVsKSB7XG4gIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiAhL15cXGR7NH0tXFxkezJ9LVxcZHsyfSQvLnRlc3QodmFsdWUpKSB7XG4gICAgcmV0dXJuIGAke2xhYmVsfSBpcyBub3QgYSB2YWxpZCBkYXRlYDtcbiAgfVxuICBpZiAodmFsaWRhdGlvbiAhPT0gbnVsbCAmJiB2YWxpZGF0aW9uICE9PSB2b2lkIDAgJiYgdmFsaWRhdGlvbi5pc1JlcXVpcmVkICYmIHZhbHVlID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGAke2xhYmVsfSBpcyByZXF1aXJlZGA7XG4gIH1cbiAgaWYgKCh2YWxpZGF0aW9uICE9PSBudWxsICYmIHZhbGlkYXRpb24gIT09IHZvaWQgMCAmJiB2YWxpZGF0aW9uLm1pbiB8fCB2YWxpZGF0aW9uICE9PSBudWxsICYmIHZhbGlkYXRpb24gIT09IHZvaWQgMCAmJiB2YWxpZGF0aW9uLm1heCkgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodmFsdWUpO1xuICAgIGlmICgodmFsaWRhdGlvbiA9PT0gbnVsbCB8fCB2YWxpZGF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiB2YWxpZGF0aW9uLm1pbikgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc3QgbWluID0gbmV3IERhdGUodmFsaWRhdGlvbi5taW4pO1xuICAgICAgaWYgKGRhdGUgPCBtaW4pIHtcbiAgICAgICAgcmV0dXJuIGAke2xhYmVsfSBtdXN0IGJlIGFmdGVyICR7bWluLnRvTG9jYWxlRGF0ZVN0cmluZygpfWA7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICgodmFsaWRhdGlvbiA9PT0gbnVsbCB8fCB2YWxpZGF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiB2YWxpZGF0aW9uLm1heCkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc3QgbWF4ID0gbmV3IERhdGUodmFsaWRhdGlvbi5tYXgpO1xuICAgICAgaWYgKGRhdGUgPiBtYXgpIHtcbiAgICAgICAgcmV0dXJuIGAke2xhYmVsfSBtdXN0IGJlIG5vIGxhdGVyIHRoYW4gJHttYXgudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZGF0ZSh7XG4gIGxhYmVsLFxuICBkZWZhdWx0VmFsdWUsXG4gIHZhbGlkYXRpb24sXG4gIGRlc2NyaXB0aW9uXG59KSB7XG4gIHJldHVybiBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KERhdGVGaWVsZElucHV0LCB7XG4gICAgICAgIHZhbGlkYXRpb246IHZhbGlkYXRpb24sXG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICBpZiAoZGVmYXVsdFZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIGRlZmF1bHRWYWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICAgIGNvbnN0IHllYXIgPSB0b2RheS5nZXRGdWxsWWVhcigpO1xuICAgICAgY29uc3QgbW9udGggPSBTdHJpbmcodG9kYXkuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsICcwJyk7XG4gICAgICBjb25zdCBkYXkgPSBTdHJpbmcodG9kYXkuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgICAgcmV0dXJuIGAke3llYXJ9LSR7bW9udGh9LSR7ZGF5fWA7XG4gICAgfSxcbiAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgIGNvbnN0IHllYXIgPSB2YWx1ZS5nZXRVVENGdWxsWWVhcigpO1xuICAgICAgICBjb25zdCBtb250aCA9IFN0cmluZyh2YWx1ZS5nZXRVVENNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTtcbiAgICAgICAgY29uc3QgZGF5ID0gU3RyaW5nKHZhbHVlLmdldFVUQ0RhdGUoKSkucGFkU3RhcnQoMiwgJzAnKTtcbiAgICAgICAgcmV0dXJuIGAke3llYXJ9LSR7bW9udGh9LSR7ZGF5fWA7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYSBzdHJpbmcnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlID09PSBudWxsKSByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogdW5kZWZpbmVkXG4gICAgICB9O1xuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHZhbHVlKTtcbiAgICAgIGRhdGUudG9JU09TdHJpbmcgPSAoKSA9PiB2YWx1ZTtcbiAgICAgIGRhdGUudG9TdHJpbmcgPSAoKSA9PiB2YWx1ZTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiBkYXRlXG4gICAgICB9O1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSB2YWxpZGF0ZURhdGUodmFsaWRhdGlvbiwgdmFsdWUsIGxhYmVsKTtcbiAgICAgIGlmIChtZXNzYWdlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKG1lc3NhZ2UpO1xuICAgICAgfVxuICAgICAgYXNzZXJ0UmVxdWlyZWQodmFsdWUsIHZhbGlkYXRpb24sIGxhYmVsKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZURhdGV0aW1lKHZhbGlkYXRpb24sIHZhbHVlLCBsYWJlbCkge1xuICBpZiAodmFsdWUgIT09IG51bGwgJiYgIS9eXFxkezR9LVxcZHsyfS1cXGR7Mn1UXFxkezJ9OlxcZHsyfSQvLnRlc3QodmFsdWUpKSB7XG4gICAgcmV0dXJuIGAke2xhYmVsfSBpcyBub3QgYSB2YWxpZCBkYXRldGltZWA7XG4gIH1cbiAgaWYgKHZhbGlkYXRpb24gIT09IG51bGwgJiYgdmFsaWRhdGlvbiAhPT0gdm9pZCAwICYmIHZhbGlkYXRpb24uaXNSZXF1aXJlZCAmJiB2YWx1ZSA9PT0gbnVsbCkge1xuICAgIHJldHVybiBgJHtsYWJlbH0gaXMgcmVxdWlyZWRgO1xuICB9XG4gIGlmICgodmFsaWRhdGlvbiAhPT0gbnVsbCAmJiB2YWxpZGF0aW9uICE9PSB2b2lkIDAgJiYgdmFsaWRhdGlvbi5taW4gfHwgdmFsaWRhdGlvbiAhPT0gbnVsbCAmJiB2YWxpZGF0aW9uICE9PSB2b2lkIDAgJiYgdmFsaWRhdGlvbi5tYXgpICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgY29uc3QgZGF0ZXRpbWUgPSBuZXcgRGF0ZSh2YWx1ZSk7XG4gICAgaWYgKCh2YWxpZGF0aW9uID09PSBudWxsIHx8IHZhbGlkYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbGlkYXRpb24ubWluKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBtaW4gPSBuZXcgRGF0ZSh2YWxpZGF0aW9uLm1pbik7XG4gICAgICBpZiAoZGF0ZXRpbWUgPCBtaW4pIHtcbiAgICAgICAgcmV0dXJuIGAke2xhYmVsfSBtdXN0IGJlIGFmdGVyICR7bWluLnRvSVNPU3RyaW5nKCl9YDtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCh2YWxpZGF0aW9uID09PSBudWxsIHx8IHZhbGlkYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbGlkYXRpb24ubWF4KSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBtYXggPSBuZXcgRGF0ZSh2YWxpZGF0aW9uLm1heCk7XG4gICAgICBpZiAoZGF0ZXRpbWUgPiBtYXgpIHtcbiAgICAgICAgcmV0dXJuIGAke2xhYmVsfSBtdXN0IGJlIG5vIGxhdGVyIHRoYW4gJHttYXgudG9JU09TdHJpbmcoKX1gO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBkYXRldGltZSh7XG4gIGxhYmVsLFxuICBkZWZhdWx0VmFsdWUsXG4gIHZhbGlkYXRpb24sXG4gIGRlc2NyaXB0aW9uXG59KSB7XG4gIHJldHVybiBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KERhdGV0aW1lRmllbGRJbnB1dCwge1xuICAgICAgICB2YWxpZGF0aW9uOiB2YWxpZGF0aW9uLFxuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgLi4ucHJvcHNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgaWYgKGRlZmF1bHRWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBkZWZhdWx0VmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gICAgICB9XG4gICAgICBpZiAoZGVmYXVsdFZhbHVlLmtpbmQgPT09ICdub3cnKSB7XG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShub3cuZ2V0VGltZSgpIC0gbm93LmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MCAqIDEwMDApLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgLTgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcbiAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZS50b0lTT1N0cmluZygpLnNsaWNlKDAsIC04KTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHN0cmluZyBvciBkYXRlJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBzZXJpYWxpemUodmFsdWUpIHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHVuZGVmaW5lZFxuICAgICAgfTtcbiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh2YWx1ZSArICdaJyk7XG4gICAgICBkYXRlLnRvSlNPTiA9ICgpID0+IGRhdGUudG9JU09TdHJpbmcoKS5zbGljZSgwLCAtOCk7XG4gICAgICBkYXRlLnRvU3RyaW5nID0gKCkgPT4gZGF0ZS50b0lTT1N0cmluZygpLnNsaWNlKDAsIC04KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiBkYXRlXG4gICAgICB9O1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSB2YWxpZGF0ZURhdGV0aW1lKHZhbGlkYXRpb24sIHZhbHVlLCBsYWJlbCk7XG4gICAgICBpZiAobWVzc2FnZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcihtZXNzYWdlKTtcbiAgICAgIH1cbiAgICAgIGFzc2VydFJlcXVpcmVkKHZhbHVlLCB2YWxpZGF0aW9uLCBsYWJlbCk7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gZW1wdHkoKSB7XG4gIHJldHVybiBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gICAgSW5wdXQoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgcGFyc2UoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB1bmRlZmluZWRcbiAgICAgIH07XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgbGFiZWw6ICdFbXB0eSdcbiAgfSk7XG59XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgYGVtcHR5RG9jdW1lbnRgIGhhcyBiZWVuIHJlcGxhY2VkIHdpdGggdGhlIGBlbXB0eUNvbnRlbnRgIGZpZWxkXG4gKi9cbmZ1bmN0aW9uIGVtcHR5RG9jdW1lbnQoKSB7XG4gIHJldHVybiB7XG4gICAga2luZDogJ2Zvcm0nLFxuICAgIGZvcm1LaW5kOiAnY29udGVudCcsXG4gICAgSW5wdXQoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgcGFyc2UoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIGNvbnRlbnRFeHRlbnNpb246ICcubWRvYycsXG4gICAgc2VyaWFsaXplKCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgY29udGVudDogbmV3IFVpbnQ4QXJyYXkoKSxcbiAgICAgICAgZXh0ZXJuYWw6IG5ldyBNYXAoKSxcbiAgICAgICAgb3RoZXI6IG5ldyBNYXAoKVxuICAgICAgfTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICByZWFkZXI6IHtcbiAgICAgIHBhcnNlKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG5cbmZ1bmN0aW9uIGVtcHR5Q29udGVudChvcHRzKSB7XG4gIHJldHVybiB7XG4gICAga2luZDogJ2Zvcm0nLFxuICAgIGZvcm1LaW5kOiAnY29udGVudCcsXG4gICAgSW5wdXQoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgcGFyc2UoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIGNvbnRlbnRFeHRlbnNpb246IGAuJHtvcHRzLmV4dGVuc2lvbn1gLFxuICAgIHNlcmlhbGl6ZSgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB1bmRlZmluZWQsXG4gICAgICAgIGNvbnRlbnQ6IG5ldyBVaW50OEFycmF5KCksXG4gICAgICAgIGV4dGVybmFsOiBuZXcgTWFwKCksXG4gICAgICAgIG90aGVyOiBuZXcgTWFwKClcbiAgICAgIH07XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgcmVhZGVyOiB7XG4gICAgICBwYXJzZSgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBmaWxlKHtcbiAgbGFiZWwsXG4gIGRpcmVjdG9yeSxcbiAgdmFsaWRhdGlvbixcbiAgZGVzY3JpcHRpb24sXG4gIHB1YmxpY1BhdGgsXG4gIHRyYW5zZm9ybUZpbGVuYW1lXG59KSB7XG4gIHJldHVybiB7XG4gICAga2luZDogJ2Zvcm0nLFxuICAgIGZvcm1LaW5kOiAnYXNzZXQnLFxuICAgIGxhYmVsLFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChGaWxlRmllbGRJbnB1dCwge1xuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgdmFsaWRhdGlvbjogdmFsaWRhdGlvbixcbiAgICAgICAgdHJhbnNmb3JtRmlsZW5hbWU6IHRyYW5zZm9ybUZpbGVuYW1lLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIGZpbGVuYW1lKHZhbHVlLCBhcmdzKSB7XG4gICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gdmFsdWUuc2xpY2UoZ2V0U3JjUHJlZml4KHB1YmxpY1BhdGgsIGFyZ3Muc2x1ZykubGVuZ3RoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfSxcbiAgICBwYXJzZSh2YWx1ZSwgYXJncykge1xuICAgICAgdmFyIF92YWx1ZSRtYXRjaCQsIF92YWx1ZSRtYXRjaDtcbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICB9XG4gICAgICBpZiAoYXJncy5hc3NldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YTogYXJncy5hc3NldCxcbiAgICAgICAgZmlsZW5hbWU6IHZhbHVlLnNsaWNlKGdldFNyY1ByZWZpeChwdWJsaWNQYXRoLCBhcmdzLnNsdWcpLmxlbmd0aCksXG4gICAgICAgIGV4dGVuc2lvbjogKF92YWx1ZSRtYXRjaCQgPSAoX3ZhbHVlJG1hdGNoID0gdmFsdWUubWF0Y2goL1xcLihbXi5dKyQpLykpID09PSBudWxsIHx8IF92YWx1ZSRtYXRjaCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3ZhbHVlJG1hdGNoWzFdKSAhPT0gbnVsbCAmJiBfdmFsdWUkbWF0Y2gkICE9PSB2b2lkIDAgPyBfdmFsdWUkbWF0Y2gkIDogJydcbiAgICAgIH07XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgYXNzZXJ0UmVxdWlyZWQodmFsdWUsIHZhbGlkYXRpb24sIGxhYmVsKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSwgYXJncykge1xuICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICBhc3NldDogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBjb25zdCBmaWxlbmFtZSA9IGFyZ3Muc3VnZ2VzdGVkRmlsZW5hbWVQcmVmaXggPyBhcmdzLnN1Z2dlc3RlZEZpbGVuYW1lUHJlZml4ICsgJy4nICsgdmFsdWUuZXh0ZW5zaW9uIDogdmFsdWUuZmlsZW5hbWU7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogYCR7Z2V0U3JjUHJlZml4KHB1YmxpY1BhdGgsIGFyZ3Muc2x1Zyl9JHtmaWxlbmFtZX1gLFxuICAgICAgICBhc3NldDoge1xuICAgICAgICAgIGZpbGVuYW1lLFxuICAgICAgICAgIGNvbnRlbnQ6IHZhbHVlLmRhdGFcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9LFxuICAgIGRpcmVjdG9yeTogZGlyZWN0b3J5ID8gZml4UGF0aChkaXJlY3RvcnkpIDogdW5kZWZpbmVkLFxuICAgIHJlYWRlcjoge1xuICAgICAgcGFyc2UodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZhbCA9IHZhbHVlID09PSB1bmRlZmluZWQgPyBudWxsIDogdmFsdWU7XG4gICAgICAgIGFzc2VydFJlcXVpcmVkKHZhbCwgdmFsaWRhdGlvbiwgbGFiZWwpO1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gaW1hZ2Uoe1xuICBsYWJlbCxcbiAgZGlyZWN0b3J5LFxuICB2YWxpZGF0aW9uLFxuICBkZXNjcmlwdGlvbixcbiAgcHVibGljUGF0aCxcbiAgdHJhbnNmb3JtRmlsZW5hbWVcbn0pIHtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgZm9ybUtpbmQ6ICdhc3NldCcsXG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KEltYWdlRmllbGRJbnB1dCwge1xuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgdmFsaWRhdGlvbjogdmFsaWRhdGlvbixcbiAgICAgICAgdHJhbnNmb3JtRmlsZW5hbWU6IHRyYW5zZm9ybUZpbGVuYW1lLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIGZpbGVuYW1lKHZhbHVlLCBhcmdzKSB7XG4gICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gdmFsdWUuc2xpY2UoZ2V0U3JjUHJlZml4KHB1YmxpY1BhdGgsIGFyZ3Muc2x1ZykubGVuZ3RoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfSxcbiAgICBwYXJzZSh2YWx1ZSwgYXJncykge1xuICAgICAgdmFyIF92YWx1ZSRtYXRjaCQsIF92YWx1ZSRtYXRjaDtcbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICB9XG4gICAgICBpZiAoYXJncy5hc3NldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YTogYXJncy5hc3NldCxcbiAgICAgICAgZmlsZW5hbWU6IHZhbHVlLnNsaWNlKGdldFNyY1ByZWZpeChwdWJsaWNQYXRoLCBhcmdzLnNsdWcpLmxlbmd0aCksXG4gICAgICAgIGV4dGVuc2lvbjogKF92YWx1ZSRtYXRjaCQgPSAoX3ZhbHVlJG1hdGNoID0gdmFsdWUubWF0Y2goL1xcLihbXi5dKyQpLykpID09PSBudWxsIHx8IF92YWx1ZSRtYXRjaCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3ZhbHVlJG1hdGNoWzFdKSAhPT0gbnVsbCAmJiBfdmFsdWUkbWF0Y2gkICE9PSB2b2lkIDAgPyBfdmFsdWUkbWF0Y2gkIDogJydcbiAgICAgIH07XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgYXNzZXJ0UmVxdWlyZWQodmFsdWUsIHZhbGlkYXRpb24sIGxhYmVsKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSwgYXJncykge1xuICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICBhc3NldDogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBjb25zdCBmaWxlbmFtZSA9IGFyZ3Muc3VnZ2VzdGVkRmlsZW5hbWVQcmVmaXggPyBhcmdzLnN1Z2dlc3RlZEZpbGVuYW1lUHJlZml4ICsgJy4nICsgdmFsdWUuZXh0ZW5zaW9uIDogdmFsdWUuZmlsZW5hbWU7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogYCR7Z2V0U3JjUHJlZml4KHB1YmxpY1BhdGgsIGFyZ3Muc2x1Zyl9JHtmaWxlbmFtZX1gLFxuICAgICAgICBhc3NldDoge1xuICAgICAgICAgIGZpbGVuYW1lLFxuICAgICAgICAgIGNvbnRlbnQ6IHZhbHVlLmRhdGFcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9LFxuICAgIGRpcmVjdG9yeTogZGlyZWN0b3J5ID8gZml4UGF0aChkaXJlY3RvcnkpIDogdW5kZWZpbmVkLFxuICAgIHJlYWRlcjoge1xuICAgICAgcGFyc2UodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZhbCA9IHZhbHVlID09PSB1bmRlZmluZWQgPyBudWxsIDogdmFsdWU7XG4gICAgICAgIGFzc2VydFJlcXVpcmVkKHZhbCwgdmFsaWRhdGlvbiwgbGFiZWwpO1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gcGx1cmFsaXplKGNvdW50LCBvcHRpb25zKSB7XG4gIGNvbnN0IHtcbiAgICBzaW5ndWxhcixcbiAgICBwbHVyYWwgPSBzaW5ndWxhciArICdzJyxcbiAgICBpbmNsdXNpdmUgPSB0cnVlXG4gIH0gPSBvcHRpb25zO1xuICBjb25zdCB2YXJpYW50ID0gY291bnQgPT09IDEgPyBzaW5ndWxhciA6IHBsdXJhbDtcbiAgcmV0dXJuIGluY2x1c2l2ZSA/IGAke2NvdW50fSAke3ZhcmlhbnR9YCA6IHZhcmlhbnQ7XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlTXVsdGlSZWxhdGlvbnNoaXBMZW5ndGgodmFsaWRhdGlvbiwgdmFsdWUpIHtcbiAgdmFyIF92YWxpZGF0aW9uJGxlbmd0aCRtaSwgX3ZhbGlkYXRpb24kbGVuZ3RoLCBfdmFsaWRhdGlvbiRsZW5ndGgkbWEsIF92YWxpZGF0aW9uJGxlbmd0aDI7XG4gIGNvbnN0IG1pbkxlbmd0aCA9IChfdmFsaWRhdGlvbiRsZW5ndGgkbWkgPSB2YWxpZGF0aW9uID09PSBudWxsIHx8IHZhbGlkYXRpb24gPT09IHZvaWQgMCB8fCAoX3ZhbGlkYXRpb24kbGVuZ3RoID0gdmFsaWRhdGlvbi5sZW5ndGgpID09PSBudWxsIHx8IF92YWxpZGF0aW9uJGxlbmd0aCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3ZhbGlkYXRpb24kbGVuZ3RoLm1pbikgIT09IG51bGwgJiYgX3ZhbGlkYXRpb24kbGVuZ3RoJG1pICE9PSB2b2lkIDAgPyBfdmFsaWRhdGlvbiRsZW5ndGgkbWkgOiAwO1xuICBpZiAodmFsdWUubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgcmV0dXJuIGBNdXN0IGhhdmUgYXQgbGVhc3QgJHtwbHVyYWxpemUobWluTGVuZ3RoLCB7XG4gICAgICBzaW5ndWxhcjogJ2l0ZW0nXG4gICAgfSl9LmA7XG4gIH1cbiAgY29uc3QgbWF4TGVuZ3RoID0gKF92YWxpZGF0aW9uJGxlbmd0aCRtYSA9IHZhbGlkYXRpb24gPT09IG51bGwgfHwgdmFsaWRhdGlvbiA9PT0gdm9pZCAwIHx8IChfdmFsaWRhdGlvbiRsZW5ndGgyID0gdmFsaWRhdGlvbi5sZW5ndGgpID09PSBudWxsIHx8IF92YWxpZGF0aW9uJGxlbmd0aDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF92YWxpZGF0aW9uJGxlbmd0aDIubWF4KSAhPT0gbnVsbCAmJiBfdmFsaWRhdGlvbiRsZW5ndGgkbWEgIT09IHZvaWQgMCA/IF92YWxpZGF0aW9uJGxlbmd0aCRtYSA6IEluZmluaXR5O1xuICBpZiAodmFsdWUubGVuZ3RoID4gbWF4TGVuZ3RoKSB7XG4gICAgcmV0dXJuIGBNdXN0IGhhdmUgYXQgbW9zdCAke3BsdXJhbGl6ZShtYXhMZW5ndGgsIHtcbiAgICAgIHNpbmd1bGFyOiAnaXRlbSdcbiAgICB9KX0uYDtcbiAgfVxufVxuXG5mdW5jdGlvbiBtdWx0aVJlbGF0aW9uc2hpcCh7XG4gIGxhYmVsLFxuICBjb2xsZWN0aW9uLFxuICB2YWxpZGF0aW9uLFxuICBkZXNjcmlwdGlvblxufSkge1xuICByZXR1cm4gYmFzaWNGb3JtRmllbGRXaXRoU2ltcGxlUmVhZGVyUGFyc2Uoe1xuICAgIGxhYmVsLFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChNdWx0aVJlbGF0aW9uc2hpcElucHV0LCB7XG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgY29sbGVjdGlvbjogY29sbGVjdGlvbixcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICB2YWxpZGF0aW9uOiB2YWxpZGF0aW9uLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfSxcbiAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSB8fCAhdmFsdWUuZXZlcnkoaXNTdHJpbmcpKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhbiBhcnJheSBvZiBzdHJpbmdzJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgY29uc3QgZXJyb3IgPSB2YWxpZGF0ZU11bHRpUmVsYXRpb25zaGlwTGVuZ3RoKHZhbGlkYXRpb24sIHZhbHVlKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoZXJyb3IpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKHZhbHVlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZVxuICAgICAgfTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBtdWx0aXNlbGVjdCh7XG4gIGxhYmVsLFxuICBvcHRpb25zLFxuICBkZWZhdWx0VmFsdWUgPSBbXSxcbiAgZGVzY3JpcHRpb25cbn0pIHtcbiAgY29uc3QgdmFsdWVzVG9PcHRpb24gPSBuZXcgTWFwKG9wdGlvbnMubWFwKHggPT4gW3gudmFsdWUsIHhdKSk7XG4gIGNvbnN0IGZpZWxkID0gYmFzaWNGb3JtRmllbGRXaXRoU2ltcGxlUmVhZGVyUGFyc2Uoe1xuICAgIGxhYmVsLFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChNdWx0aXNlbGVjdEZpZWxkSW5wdXQsIHtcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIG9wdGlvbnM6IG9wdGlvbnMsXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gICAgfSxcbiAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYW4gYXJyYXkgb2Ygb3B0aW9ucycpO1xuICAgICAgfVxuICAgICAgaWYgKCF2YWx1ZS5ldmVyeSh4ID0+IHR5cGVvZiB4ID09PSAnc3RyaW5nJyAmJiB2YWx1ZXNUb09wdGlvbi5oYXMoeCkpKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcihgTXVzdCBiZSBhbiBhcnJheSB3aXRoIG9uZSBvZiAke29wdGlvbnMubWFwKHggPT4geC52YWx1ZSkuam9pbignLCAnKX1gKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBzZXJpYWxpemUodmFsdWUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlXG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiB7XG4gICAgLi4uZmllbGQsXG4gICAgb3B0aW9uc1xuICB9O1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZU51bWJlcih2YWxpZGF0aW9uLCB2YWx1ZSwgc3RlcCwgbGFiZWwpIHtcbiAgaWYgKHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSAhPT0gJ251bWJlcicpIHtcbiAgICByZXR1cm4gYCR7bGFiZWx9IG11c3QgYmUgYSBudW1iZXJgO1xuICB9XG4gIGlmICh2YWxpZGF0aW9uICE9PSBudWxsICYmIHZhbGlkYXRpb24gIT09IHZvaWQgMCAmJiB2YWxpZGF0aW9uLmlzUmVxdWlyZWQgJiYgdmFsdWUgPT09IG51bGwpIHtcbiAgICByZXR1cm4gYCR7bGFiZWx9IGlzIHJlcXVpcmVkYDtcbiAgfVxuICBpZiAodmFsdWUgIT09IG51bGwpIHtcbiAgICBpZiAoKHZhbGlkYXRpb24gPT09IG51bGwgfHwgdmFsaWRhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogdmFsaWRhdGlvbi5taW4pICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgPCB2YWxpZGF0aW9uLm1pbikge1xuICAgICAgcmV0dXJuIGAke2xhYmVsfSBtdXN0IGJlIGF0IGxlYXN0ICR7dmFsaWRhdGlvbi5taW59YDtcbiAgICB9XG4gICAgaWYgKCh2YWxpZGF0aW9uID09PSBudWxsIHx8IHZhbGlkYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbGlkYXRpb24ubWF4KSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlID4gdmFsaWRhdGlvbi5tYXgpIHtcbiAgICAgIHJldHVybiBgJHtsYWJlbH0gbXVzdCBiZSBhdCBtb3N0ICR7dmFsaWRhdGlvbi5tYXh9YDtcbiAgICB9XG4gICAgaWYgKHN0ZXAgIT09IHVuZGVmaW5lZCAmJiAodmFsaWRhdGlvbiA9PT0gbnVsbCB8fCB2YWxpZGF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiB2YWxpZGF0aW9uLnZhbGlkYXRlU3RlcCkgIT09IHVuZGVmaW5lZCAmJiAhaXNBdFN0ZXAodmFsdWUsIHN0ZXApKSB7XG4gICAgICByZXR1cm4gYCR7bGFiZWx9IG11c3QgYmUgYSBtdWx0aXBsZSBvZiAke3N0ZXB9YDtcbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIGRlY2ltYWxQbGFjZXModmFsdWUpIHtcbiAgY29uc3Qgc3RyaW5naWZpZWQgPSB2YWx1ZS50b1N0cmluZygpO1xuICBjb25zdCBpbmRleE9mRGVjaW1hbCA9IHN0cmluZ2lmaWVkLmluZGV4T2YoJy4nKTtcbiAgaWYgKGluZGV4T2ZEZWNpbWFsID09PSAtMSkge1xuICAgIGNvbnN0IGluZGV4T2ZFID0gc3RyaW5naWZpZWQuaW5kZXhPZignZS0nKTtcbiAgICByZXR1cm4gaW5kZXhPZkUgPT09IC0xID8gMCA6IHBhcnNlSW50KHN0cmluZ2lmaWVkLnNsaWNlKGluZGV4T2ZFICsgMikpO1xuICB9XG4gIHJldHVybiBzdHJpbmdpZmllZC5sZW5ndGggLSBpbmRleE9mRGVjaW1hbCAtIDE7XG59XG5mdW5jdGlvbiBpc0F0U3RlcCh2YWx1ZSwgc3RlcCkge1xuICBjb25zdCBkYyA9IE1hdGgubWF4KGRlY2ltYWxQbGFjZXMoc3RlcCksIGRlY2ltYWxQbGFjZXModmFsdWUpKTtcbiAgY29uc3QgYmFzZSA9IE1hdGgucG93KDEwLCBkYyk7XG4gIHJldHVybiB2YWx1ZSAqIGJhc2UgJSAoc3RlcCAqIGJhc2UpID09PSAwO1xufVxuXG5mdW5jdGlvbiBudW1iZXIoe1xuICBsYWJlbCxcbiAgZGVmYXVsdFZhbHVlLFxuICBzdGVwLFxuICB2YWxpZGF0aW9uLFxuICBkZXNjcmlwdGlvblxufSkge1xuICByZXR1cm4gYmFzaWNGb3JtRmllbGRXaXRoU2ltcGxlUmVhZGVyUGFyc2Uoe1xuICAgIGxhYmVsLFxuICAgIElucHV0KHByb3BzKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL2pzeChOdW1iZXJGaWVsZElucHV0LCB7XG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICB2YWxpZGF0aW9uOiB2YWxpZGF0aW9uLFxuICAgICAgICBzdGVwOiBzdGVwLFxuICAgICAgICAuLi5wcm9wc1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gZGVmYXVsdFZhbHVlICE9PSBudWxsICYmIGRlZmF1bHRWYWx1ZSAhPT0gdm9pZCAwID8gZGVmYXVsdFZhbHVlIDogbnVsbDtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIG51bWJlcicpO1xuICAgIH0sXG4gICAgdmFsaWRhdGUodmFsdWUpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSB2YWxpZGF0ZU51bWJlcih2YWxpZGF0aW9uLCB2YWx1ZSwgc3RlcCwgbGFiZWwpO1xuICAgICAgaWYgKG1lc3NhZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IobWVzc2FnZSk7XG4gICAgICB9XG4gICAgICBhc3NlcnRSZXF1aXJlZCh2YWx1ZSwgdmFsaWRhdGlvbiwgbGFiZWwpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKHZhbHVlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogdmFsdWUgPT09IG51bGwgPyB1bmRlZmluZWQgOiB2YWx1ZVxuICAgICAgfTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBwYXRoUmVmZXJlbmNlKHtcbiAgbGFiZWwsXG4gIHBhdHRlcm4sXG4gIHZhbGlkYXRpb24sXG4gIGRlc2NyaXB0aW9uXG59KSB7XG4gIHJldHVybiBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KFBhdGhSZWZlcmVuY2VJbnB1dCwge1xuICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgIHBhdHRlcm46IHBhdHRlcm4sXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgdmFsaWRhdGlvbjogdmFsaWRhdGlvbixcbiAgICAgICAgLi4ucHJvcHNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcbiAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRmllbGREYXRhRXJyb3IoJ011c3QgYmUgYSBzdHJpbmcnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICBhc3NlcnRSZXF1aXJlZCh2YWx1ZSwgdmFsaWRhdGlvbiwgbGFiZWwpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgc2VyaWFsaXplKHZhbHVlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogdmFsdWUgPT09IG51bGwgPyB1bmRlZmluZWQgOiB2YWx1ZVxuICAgICAgfTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiByZWxhdGlvbnNoaXAoe1xuICBsYWJlbCxcbiAgY29sbGVjdGlvbixcbiAgdmFsaWRhdGlvbixcbiAgZGVzY3JpcHRpb25cbn0pIHtcbiAgcmV0dXJuIGJhc2ljRm9ybUZpZWxkV2l0aFNpbXBsZVJlYWRlclBhcnNlKHtcbiAgICBsYWJlbCxcbiAgICBJbnB1dChwcm9wcykge1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9qc3goUmVsYXRpb25zaGlwSW5wdXQsIHtcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBjb2xsZWN0aW9uOiBjb2xsZWN0aW9uLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIHZhbGlkYXRpb246IHZhbGlkYXRpb24sXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgcGFyc2UodmFsdWUpIHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICB2YWxpZGF0ZSh2YWx1ZSkge1xuICAgICAgYXNzZXJ0UmVxdWlyZWQodmFsdWUsIHZhbGlkYXRpb24sIGxhYmVsKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHZhbHVlID09PSBudWxsID8gdW5kZWZpbmVkIDogdmFsdWVcbiAgICAgIH07XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gcGFyc2VTbHVnRmllbGRBc05vcm1hbEZpZWxkKHZhbHVlKSB7XG4gIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6ICcnLFxuICAgICAgc2x1ZzogJydcbiAgICB9O1xuICB9XG4gIGlmICh0eXBlb2YgdmFsdWUgIT09ICdvYmplY3QnKSB7XG4gICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGFuIG9iamVjdCcpO1xuICB9XG4gIGlmIChPYmplY3Qua2V5cyh2YWx1ZSkubGVuZ3RoICE9PSAyKSB7XG4gICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdVbmV4cGVjdGVkIGtleXMnKTtcbiAgfVxuICBpZiAoISgnbmFtZScgaW4gdmFsdWUpIHx8ICEoJ3NsdWcnIGluIHZhbHVlKSkge1xuICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTWlzc2luZyBuYW1lIG9yIHNsdWcnKTtcbiAgfVxuICBpZiAodHlwZW9mIHZhbHVlLm5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCduYW1lIG11c3QgYmUgYSBzdHJpbmcnKTtcbiAgfVxuICBpZiAodHlwZW9mIHZhbHVlLnNsdWcgIT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdzbHVnIG11c3QgYmUgYSBzdHJpbmcnKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIG5hbWU6IHZhbHVlLm5hbWUsXG4gICAgc2x1ZzogdmFsdWUuc2x1Z1xuICB9O1xufVxuZnVuY3Rpb24gcGFyc2VBc1NsdWdGaWVsZCh2YWx1ZSwgc2x1Zykge1xuICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiAnJyxcbiAgICAgIHNsdWdcbiAgICB9O1xuICB9XG4gIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKCdNdXN0IGJlIGEgc3RyaW5nJyk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBuYW1lOiB2YWx1ZSxcbiAgICBzbHVnXG4gIH07XG59XG5mdW5jdGlvbiBzbHVnKF9hcmdzKSB7XG4gIHZhciBfYXJncyRuYW1lJHZhbGlkYXRpb24sIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjIsIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjMsIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjQsIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjUsIF9hcmdzJHNsdWc7XG4gIGNvbnN0IGFyZ3MgPSB7XG4gICAgLi4uX2FyZ3MsXG4gICAgbmFtZToge1xuICAgICAgLi4uX2FyZ3MubmFtZSxcbiAgICAgIHZhbGlkYXRpb246IHtcbiAgICAgICAgcGF0dGVybjogKF9hcmdzJG5hbWUkdmFsaWRhdGlvbiA9IF9hcmdzLm5hbWUudmFsaWRhdGlvbikgPT09IG51bGwgfHwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXJncyRuYW1lJHZhbGlkYXRpb24ucGF0dGVybixcbiAgICAgICAgbGVuZ3RoOiB7XG4gICAgICAgICAgbWluOiBNYXRoLm1heCgoX2FyZ3MkbmFtZSR2YWxpZGF0aW9uMiA9IF9hcmdzLm5hbWUudmFsaWRhdGlvbikgIT09IG51bGwgJiYgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uMiAhPT0gdm9pZCAwICYmIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjIuaXNSZXF1aXJlZCA/IDEgOiAwLCAoX2FyZ3MkbmFtZSR2YWxpZGF0aW9uMyA9IChfYXJncyRuYW1lJHZhbGlkYXRpb240ID0gX2FyZ3MubmFtZS52YWxpZGF0aW9uKSA9PT0gbnVsbCB8fCBfYXJncyRuYW1lJHZhbGlkYXRpb240ID09PSB2b2lkIDAgfHwgKF9hcmdzJG5hbWUkdmFsaWRhdGlvbjQgPSBfYXJncyRuYW1lJHZhbGlkYXRpb240Lmxlbmd0aCkgPT09IG51bGwgfHwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNC5taW4pICE9PSBudWxsICYmIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjMgIT09IHZvaWQgMCA/IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjMgOiAwKSxcbiAgICAgICAgICBtYXg6IChfYXJncyRuYW1lJHZhbGlkYXRpb241ID0gX2FyZ3MubmFtZS52YWxpZGF0aW9uKSA9PT0gbnVsbCB8fCBfYXJncyRuYW1lJHZhbGlkYXRpb241ID09PSB2b2lkIDAgfHwgKF9hcmdzJG5hbWUkdmFsaWRhdGlvbjUgPSBfYXJncyRuYW1lJHZhbGlkYXRpb241Lmxlbmd0aCkgPT09IG51bGwgfHwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNS5tYXhcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgY29uc3QgbmFpdmVHZW5lcmF0ZVNsdWcgPSAoKF9hcmdzJHNsdWcgPSBhcmdzLnNsdWcpID09PSBudWxsIHx8IF9hcmdzJHNsdWcgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcmdzJHNsdWcuZ2VuZXJhdGUpIHx8IHNsdWdpZnk7XG4gIGxldCBfZGVmYXVsdFZhbHVlO1xuICBmdW5jdGlvbiBkZWZhdWx0VmFsdWUoKSB7XG4gICAgaWYgKCFfZGVmYXVsdFZhbHVlKSB7XG4gICAgICB2YXIgX2FyZ3MkbmFtZSRkZWZhdWx0VmFsLCBfYXJncyRuYW1lJGRlZmF1bHRWYWwyO1xuICAgICAgX2RlZmF1bHRWYWx1ZSA9IHtcbiAgICAgICAgbmFtZTogKF9hcmdzJG5hbWUkZGVmYXVsdFZhbCA9IGFyZ3MubmFtZS5kZWZhdWx0VmFsdWUpICE9PSBudWxsICYmIF9hcmdzJG5hbWUkZGVmYXVsdFZhbCAhPT0gdm9pZCAwID8gX2FyZ3MkbmFtZSRkZWZhdWx0VmFsIDogJycsXG4gICAgICAgIHNsdWc6IG5haXZlR2VuZXJhdGVTbHVnKChfYXJncyRuYW1lJGRlZmF1bHRWYWwyID0gYXJncy5uYW1lLmRlZmF1bHRWYWx1ZSkgIT09IG51bGwgJiYgX2FyZ3MkbmFtZSRkZWZhdWx0VmFsMiAhPT0gdm9pZCAwID8gX2FyZ3MkbmFtZSRkZWZhdWx0VmFsMiA6ICcnKVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIF9kZWZhdWx0VmFsdWU7XG4gIH1cbiAgZnVuY3Rpb24gdmFsaWRhdGUodmFsdWUsIHtcbiAgICBzbHVnRmllbGRcbiAgfSA9IHtcbiAgICBzbHVnRmllbGQ6IHVuZGVmaW5lZFxuICB9KSB7XG4gICAgdmFyIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjYsIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjcsIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjgsIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjksIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjEwLCBfYXJncyRzbHVnJHZhbGlkYXRpb24sIF9hcmdzJHNsdWcyLCBfYXJncyRzbHVnJHZhbGlkYXRpb24yLCBfYXJncyRzbHVnMywgX2FyZ3Mkc2x1ZyRsYWJlbCwgX2FyZ3Mkc2x1ZzQsIF9hcmdzJHNsdWc1O1xuICAgIGNvbnN0IG5hbWVNZXNzYWdlID0gdmFsaWRhdGVUZXh0KHZhbHVlLm5hbWUsIChfYXJncyRuYW1lJHZhbGlkYXRpb242ID0gKF9hcmdzJG5hbWUkdmFsaWRhdGlvbjcgPSBhcmdzLm5hbWUudmFsaWRhdGlvbikgPT09IG51bGwgfHwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNyA9PT0gdm9pZCAwIHx8IChfYXJncyRuYW1lJHZhbGlkYXRpb243ID0gX2FyZ3MkbmFtZSR2YWxpZGF0aW9uNy5sZW5ndGgpID09PSBudWxsIHx8IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjcgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjcubWluKSAhPT0gbnVsbCAmJiBfYXJncyRuYW1lJHZhbGlkYXRpb242ICE9PSB2b2lkIDAgPyBfYXJncyRuYW1lJHZhbGlkYXRpb242IDogMCwgKF9hcmdzJG5hbWUkdmFsaWRhdGlvbjggPSAoX2FyZ3MkbmFtZSR2YWxpZGF0aW9uOSA9IGFyZ3MubmFtZS52YWxpZGF0aW9uKSA9PT0gbnVsbCB8fCBfYXJncyRuYW1lJHZhbGlkYXRpb245ID09PSB2b2lkIDAgfHwgKF9hcmdzJG5hbWUkdmFsaWRhdGlvbjkgPSBfYXJncyRuYW1lJHZhbGlkYXRpb245Lmxlbmd0aCkgPT09IG51bGwgfHwgX2FyZ3MkbmFtZSR2YWxpZGF0aW9uOSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FyZ3MkbmFtZSR2YWxpZGF0aW9uOS5tYXgpICE9PSBudWxsICYmIF9hcmdzJG5hbWUkdmFsaWRhdGlvbjggIT09IHZvaWQgMCA/IF9hcmdzJG5hbWUkdmFsaWRhdGlvbjggOiBJbmZpbml0eSwgYXJncy5uYW1lLmxhYmVsLCB1bmRlZmluZWQsIChfYXJncyRuYW1lJHZhbGlkYXRpb24xMCA9IGFyZ3MubmFtZS52YWxpZGF0aW9uKSA9PT0gbnVsbCB8fCBfYXJncyRuYW1lJHZhbGlkYXRpb24xMCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FyZ3MkbmFtZSR2YWxpZGF0aW9uMTAucGF0dGVybik7XG4gICAgaWYgKG5hbWVNZXNzYWdlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcihuYW1lTWVzc2FnZSk7XG4gICAgfVxuICAgIGNvbnN0IHNsdWdNZXNzYWdlID0gdmFsaWRhdGVUZXh0KHZhbHVlLnNsdWcsIChfYXJncyRzbHVnJHZhbGlkYXRpb24gPSAoX2FyZ3Mkc2x1ZzIgPSBhcmdzLnNsdWcpID09PSBudWxsIHx8IF9hcmdzJHNsdWcyID09PSB2b2lkIDAgfHwgKF9hcmdzJHNsdWcyID0gX2FyZ3Mkc2x1ZzIudmFsaWRhdGlvbikgPT09IG51bGwgfHwgX2FyZ3Mkc2x1ZzIgPT09IHZvaWQgMCB8fCAoX2FyZ3Mkc2x1ZzIgPSBfYXJncyRzbHVnMi5sZW5ndGgpID09PSBudWxsIHx8IF9hcmdzJHNsdWcyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXJncyRzbHVnMi5taW4pICE9PSBudWxsICYmIF9hcmdzJHNsdWckdmFsaWRhdGlvbiAhPT0gdm9pZCAwID8gX2FyZ3Mkc2x1ZyR2YWxpZGF0aW9uIDogMSwgKF9hcmdzJHNsdWckdmFsaWRhdGlvbjIgPSAoX2FyZ3Mkc2x1ZzMgPSBhcmdzLnNsdWcpID09PSBudWxsIHx8IF9hcmdzJHNsdWczID09PSB2b2lkIDAgfHwgKF9hcmdzJHNsdWczID0gX2FyZ3Mkc2x1ZzMudmFsaWRhdGlvbikgPT09IG51bGwgfHwgX2FyZ3Mkc2x1ZzMgPT09IHZvaWQgMCB8fCAoX2FyZ3Mkc2x1ZzMgPSBfYXJncyRzbHVnMy5sZW5ndGgpID09PSBudWxsIHx8IF9hcmdzJHNsdWczID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXJncyRzbHVnMy5tYXgpICE9PSBudWxsICYmIF9hcmdzJHNsdWckdmFsaWRhdGlvbjIgIT09IHZvaWQgMCA/IF9hcmdzJHNsdWckdmFsaWRhdGlvbjIgOiBJbmZpbml0eSwgKF9hcmdzJHNsdWckbGFiZWwgPSAoX2FyZ3Mkc2x1ZzQgPSBhcmdzLnNsdWcpID09PSBudWxsIHx8IF9hcmdzJHNsdWc0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXJncyRzbHVnNC5sYWJlbCkgIT09IG51bGwgJiYgX2FyZ3Mkc2x1ZyRsYWJlbCAhPT0gdm9pZCAwID8gX2FyZ3Mkc2x1ZyRsYWJlbCA6ICdTbHVnJywgc2x1Z0ZpZWxkID8gc2x1Z0ZpZWxkIDoge1xuICAgICAgc2x1Z3M6IGVtcHR5U2V0LFxuICAgICAgZ2xvYjogJyonXG4gICAgfSwgKF9hcmdzJHNsdWc1ID0gYXJncy5zbHVnKSA9PT0gbnVsbCB8fCBfYXJncyRzbHVnNSA9PT0gdm9pZCAwIHx8IChfYXJncyRzbHVnNSA9IF9hcmdzJHNsdWc1LnZhbGlkYXRpb24pID09PSBudWxsIHx8IF9hcmdzJHNsdWc1ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYXJncyRzbHVnNS5wYXR0ZXJuKTtcbiAgICBpZiAoc2x1Z01lc3NhZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKHNsdWdNZXNzYWdlKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGNvbnN0IGVtcHR5U2V0ID0gbmV3IFNldCgpO1xuICByZXR1cm4ge1xuICAgIGtpbmQ6ICdmb3JtJyxcbiAgICBmb3JtS2luZDogJ3NsdWcnLFxuICAgIGxhYmVsOiBhcmdzLm5hbWUubGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KFNsdWdGaWVsZElucHV0LCB7XG4gICAgICAgIGFyZ3M6IGFyZ3MsXG4gICAgICAgIG5haXZlR2VuZXJhdGVTbHVnOiBuYWl2ZUdlbmVyYXRlU2x1ZyxcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBkZWZhdWx0VmFsdWUoKSxcbiAgICAgICAgLi4ucHJvcHNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVmYXVsdFZhbHVlLFxuICAgIHBhcnNlKHZhbHVlLCBhcmdzKSB7XG4gICAgICBpZiAoKGFyZ3MgPT09IG51bGwgfHwgYXJncyA9PT0gdm9pZCAwID8gdm9pZCAwIDogYXJncy5zbHVnKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBwYXJzZUFzU2x1Z0ZpZWxkKHZhbHVlLCBhcmdzLnNsdWcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHBhcnNlU2x1Z0ZpZWxkQXNOb3JtYWxGaWVsZCh2YWx1ZSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZSxcbiAgICBzZXJpYWxpemUodmFsdWUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlXG4gICAgICB9O1xuICAgIH0sXG4gICAgc2VyaWFsaXplV2l0aFNsdWcodmFsdWUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB2YWx1ZS5uYW1lLFxuICAgICAgICBzbHVnOiB2YWx1ZS5zbHVnXG4gICAgICB9O1xuICAgIH0sXG4gICAgcmVhZGVyOiB7XG4gICAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgICBjb25zdCBwYXJzZWQgPSBwYXJzZVNsdWdGaWVsZEFzTm9ybWFsRmllbGQodmFsdWUpO1xuICAgICAgICByZXR1cm4gdmFsaWRhdGUocGFyc2VkKTtcbiAgICAgIH0sXG4gICAgICBwYXJzZVdpdGhTbHVnKHZhbHVlLCBhcmdzKSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZShwYXJzZUFzU2x1Z0ZpZWxkKHZhbHVlLCBhcmdzLnNsdWcpLCB7XG4gICAgICAgICAgc2x1Z0ZpZWxkOiB7XG4gICAgICAgICAgICBnbG9iOiBhcmdzLmdsb2IsXG4gICAgICAgICAgICBzbHVnczogZW1wdHlTZXRcbiAgICAgICAgICB9XG4gICAgICAgIH0pLm5hbWU7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBpc1ZhbGlkVVJMKHVybCkge1xuICByZXR1cm4gdXJsID09PSBzYW5pdGl6ZVVybCh1cmwpO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZVVybCh2YWxpZGF0aW9uLCB2YWx1ZSwgbGFiZWwpIHtcbiAgaWYgKHZhbHVlICE9PSBudWxsICYmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnIHx8ICFpc1ZhbGlkVVJMKHZhbHVlKSkpIHtcbiAgICByZXR1cm4gYCR7bGFiZWx9IGlzIG5vdCBhIHZhbGlkIFVSTGA7XG4gIH1cbiAgaWYgKHZhbGlkYXRpb24gIT09IG51bGwgJiYgdmFsaWRhdGlvbiAhPT0gdm9pZCAwICYmIHZhbGlkYXRpb24uaXNSZXF1aXJlZCAmJiB2YWx1ZSA9PT0gbnVsbCkge1xuICAgIHJldHVybiBgJHtsYWJlbH0gaXMgcmVxdWlyZWRgO1xuICB9XG59XG5cbmZ1bmN0aW9uIHVybCh7XG4gIGxhYmVsLFxuICBkZWZhdWx0VmFsdWUsXG4gIHZhbGlkYXRpb24sXG4gIGRlc2NyaXB0aW9uXG59KSB7XG4gIHJldHVybiBiYXNpY0Zvcm1GaWVsZFdpdGhTaW1wbGVSZWFkZXJQYXJzZSh7XG4gICAgbGFiZWwsXG4gICAgSW5wdXQocHJvcHMpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovanN4KFVybEZpZWxkSW5wdXQsIHtcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIHZhbGlkYXRpb246IHZhbGlkYXRpb24sXG4gICAgICAgIC4uLnByb3BzXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiBkZWZhdWx0VmFsdWUgfHwgbnVsbDtcbiAgICB9LFxuICAgIHBhcnNlKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBGaWVsZERhdGFFcnJvcignTXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlID09PSAnJyA/IG51bGwgOiB2YWx1ZTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gdmFsaWRhdGVVcmwodmFsaWRhdGlvbiwgdmFsdWUsIGxhYmVsKTtcbiAgICAgIGlmIChtZXNzYWdlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZpZWxkRGF0YUVycm9yKG1lc3NhZ2UpO1xuICAgICAgfVxuICAgICAgYXNzZXJ0UmVxdWlyZWQodmFsdWUsIHZhbGlkYXRpb24sIGxhYmVsKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHNlcmlhbGl6ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHZhbHVlID09PSBudWxsID8gdW5kZWZpbmVkIDogdmFsdWVcbiAgICAgIH07XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gaWdub3JlZCgpIHtcbiAgcmV0dXJuIHtcbiAgICBraW5kOiAnZm9ybScsXG4gICAgSW5wdXQoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB1bmRlZmluZWRcbiAgICAgIH07XG4gICAgfSxcbiAgICBwYXJzZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWVcbiAgICAgIH07XG4gICAgfSxcbiAgICBzZXJpYWxpemUodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHZhbGlkYXRlKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBsYWJlbDogJ0lnbm9yZWQnLFxuICAgIHJlYWRlcjoge1xuICAgICAgcGFyc2UodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxudmFyIGluZGV4ID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICBfX3Byb3RvX186IG51bGwsXG4gIGFycmF5OiBhcnJheSxcbiAgYmxvY2tzOiBibG9ja3MsXG4gIGNoZWNrYm94OiBjaGVja2JveCxcbiAgY2hpbGQ6IGNoaWxkLFxuICBjbG91ZEltYWdlOiBjbG91ZEltYWdlLFxuICBjb25kaXRpb25hbDogY29uZGl0aW9uYWwsXG4gIGRhdGU6IGRhdGUsXG4gIGRhdGV0aW1lOiBkYXRldGltZSxcbiAgZG9jdW1lbnQ6IGRvY3VtZW50LFxuICBlbXB0eTogZW1wdHksXG4gIGVtcHR5RG9jdW1lbnQ6IGVtcHR5RG9jdW1lbnQsXG4gIGVtcHR5Q29udGVudDogZW1wdHlDb250ZW50LFxuICBmaWxlOiBmaWxlLFxuICBpbWFnZTogaW1hZ2UsXG4gIGludGVnZXI6IGludGVnZXIsXG4gIG11bHRpUmVsYXRpb25zaGlwOiBtdWx0aVJlbGF0aW9uc2hpcCxcbiAgbXVsdGlzZWxlY3Q6IG11bHRpc2VsZWN0LFxuICBudW1iZXI6IG51bWJlcixcbiAgb2JqZWN0OiBvYmplY3QsXG4gIHBhdGhSZWZlcmVuY2U6IHBhdGhSZWZlcmVuY2UsXG4gIHJlbGF0aW9uc2hpcDogcmVsYXRpb25zaGlwLFxuICBzZWxlY3Q6IHNlbGVjdCxcbiAgc2x1Zzogc2x1ZyxcbiAgdGV4dDogdGV4dCxcbiAgdXJsOiB1cmwsXG4gIGlnbm9yZWQ6IGlnbm9yZWQsXG4gIG1keDogbWR4LFxuICBtYXJrZG9jOiBtYXJrZG9jXG59KTtcblxuZnVuY3Rpb24gQmxvY2tXcmFwcGVyKCkge31cbmZ1bmN0aW9uIE5vdEVkaXRhYmxlKCkge31cbmZ1bmN0aW9uIFRvb2xiYXJTZXBhcmF0b3IoKSB7fVxuXG5leHBvcnQgeyBCbG9ja1dyYXBwZXIsIE5vdEVkaXRhYmxlLCBUb29sYmFyU2VwYXJhdG9yLCBjb2xsZWN0aW9uLCBjb25maWcsIGluZGV4IGFzIGZpZWxkcywgc2luZ2xldG9uIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@keystatic/core/dist/keystatic-core.node.react-server.js\n");

/***/ })

};
;